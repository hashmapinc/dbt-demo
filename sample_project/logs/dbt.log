2020-06-28 23:54:05.918607 (MainThread): Running with dbt=0.17.0
2020-06-28 23:54:07.584875 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2020-06-28 23:54:07.585845 (MainThread): Tracking: tracking
2020-06-28 23:54:07.586117 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100fc690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11010dd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11010dc50>]}
2020-06-28 23:54:07.607383 (MainThread): Partial parsing not enabled
2020-06-28 23:54:07.610550 (MainThread): Parsing macros/core.sql
2020-06-28 23:54:07.615940 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-28 23:54:07.624335 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-28 23:54:07.626287 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-28 23:54:07.644493 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-28 23:54:07.674485 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-28 23:54:07.696667 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-28 23:54:07.699172 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-28 23:54:07.709472 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-28 23:54:07.724624 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-28 23:54:07.732558 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-28 23:54:07.740938 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-28 23:54:07.746546 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-28 23:54:07.747649 (MainThread): Parsing macros/etc/query.sql
2020-06-28 23:54:07.749008 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-28 23:54:07.750988 (MainThread): Parsing macros/etc/datetime.sql
2020-06-28 23:54:07.760402 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-28 23:54:07.762558 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-28 23:54:07.764546 (MainThread): Parsing macros/adapters/common.sql
2020-06-28 23:54:07.817775 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-28 23:54:07.819492 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-28 23:54:07.820844 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-28 23:54:07.822212 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-28 23:54:07.825083 (MainThread): Parsing macros/catalog.sql
2020-06-28 23:54:07.827428 (MainThread): Parsing macros/adapters.sql
2020-06-28 23:54:07.851472 (MainThread): Parsing macros/materializations/merge.sql
2020-06-28 23:54:07.853891 (MainThread): Parsing macros/materializations/view.sql
2020-06-28 23:54:07.855443 (MainThread): Parsing macros/materializations/table.sql
2020-06-28 23:54:07.860052 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-28 23:54:07.888025 (MainThread): Partial parsing not enabled
2020-06-28 23:54:07.927236 (MainThread): Acquiring new snowflake connection "model.sample_project.my_first_dbt_model".
2020-06-28 23:54:07.927358 (MainThread): Opening a new connection, currently in state init
2020-06-28 23:54:07.955721 (MainThread): Acquiring new snowflake connection "model.sample_project.my_second_dbt_model".
2020-06-28 23:54:07.955818 (MainThread): Opening a new connection, currently in state init
2020-06-28 23:54:07.965895 (MainThread): Acquiring new snowflake connection "model.sample_project.supplier".
2020-06-28 23:54:07.965999 (MainThread): Opening a new connection, currently in state init
2020-06-28 23:54:08.217532 (MainThread): WARNING: Found documentation for resource "customer" which was not found or is disabled
2020-06-28 23:54:08.217637 (MainThread): WARNING: Found documentation for resource "nation" which was not found or is disabled
2020-06-28 23:54:08.217705 (MainThread): WARNING: Found documentation for resource "orders" which was not found or is disabled
2020-06-28 23:54:08.217768 (MainThread): WARNING: Found documentation for resource "lineitem" which was not found or is disabled
2020-06-28 23:54:08.217950 (MainThread): WARNING: Test 'test.sample_project.unique_customer_id' (models/reports/schema.yml) depends on a node named 'customer' which was not found
2020-06-28 23:54:08.218059 (MainThread): WARNING: Test 'test.sample_project.not_null_customer_id' (models/reports/schema.yml) depends on a node named 'customer' which was not found
2020-06-28 23:54:08.218152 (MainThread): WARNING: Test 'test.sample_project.unique_nation_id' (models/reports/schema.yml) depends on a node named 'nation' which was not found
2020-06-28 23:54:08.218242 (MainThread): WARNING: Test 'test.sample_project.not_null_nation_id' (models/reports/schema.yml) depends on a node named 'nation' which was not found
2020-06-28 23:54:08.218331 (MainThread): WARNING: Test 'test.sample_project.unique_orders_id' (models/reports/schema.yml) depends on a node named 'orders' which was not found
2020-06-28 23:54:08.218419 (MainThread): WARNING: Test 'test.sample_project.not_null_orders_id' (models/reports/schema.yml) depends on a node named 'orders' which was not found
2020-06-28 23:54:08.218505 (MainThread): WARNING: Test 'test.sample_project.unique_lineitem_id' (models/reports/schema.yml) depends on a node named 'lineitem' which was not found
2020-06-28 23:54:08.218591 (MainThread): WARNING: Test 'test.sample_project.not_null_lineitem_id' (models/reports/schema.yml) depends on a node named 'lineitem' which was not found
2020-06-28 23:54:08.251381 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.sample_project.reports
- models.sample_project.transforms

2020-06-28 23:54:08.319061 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 136 macros, 0 operations, 0 seed files, 4 sources
2020-06-28 23:54:08.321362 (MainThread): 
2020-06-28 23:54:08.322494 (MainThread): Acquiring new snowflake connection "master".
2020-06-28 23:54:08.322840 (MainThread): Opening a new connection, currently in state init
2020-06-28 23:54:08.326748 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_javen_testing".
2020-06-28 23:54:08.327132 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-06-28 23:54:08.346216 (ThreadPoolExecutor-0_0): Using snowflake connection "list_javen_testing".
2020-06-28 23:54:08.346364 (ThreadPoolExecutor-0_0): On list_javen_testing: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "snowflake-sso", "target_name": "dev", "connection_name": "list_javen_testing"} */

    show terse schemas in database javen_testing
    limit 10000
2020-06-28 23:54:08.842124 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/certifi/cacert.pem'>
2020-06-28 23:54:25.277361 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 16.93 seconds
2020-06-28 23:54:25.307872 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_javen_testing_test".
2020-06-28 23:54:25.307990 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_javen_testing).
2020-06-28 23:54:25.315649 (ThreadPoolExecutor-1_0): Using snowflake connection "list_javen_testing_test".
2020-06-28 23:54:25.315760 (ThreadPoolExecutor-1_0): On list_javen_testing_test: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "snowflake-sso", "target_name": "dev", "connection_name": "list_javen_testing_test"} */

    show terse objects in javen_testing.test
2020-06-28 23:54:25.545296 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 4 in 0.23 seconds
2020-06-28 23:54:25.550163 (MainThread): 18:54:25 | Concurrency: 3 threads (target='dev')
2020-06-28 23:54:25.550324 (MainThread): 18:54:25 | 
2020-06-28 23:54:25.551252 (Thread-1): Began running node model.sample_project.my_first_dbt_model
2020-06-28 23:54:25.551463 (Thread-2): Began running node model.sample_project.supplier
2020-06-28 23:54:25.551736 (Thread-1): Acquiring new snowflake connection "model.sample_project.my_first_dbt_model".
2020-06-28 23:54:25.552002 (Thread-2): Acquiring new snowflake connection "model.sample_project.supplier".
2020-06-28 23:54:25.552109 (Thread-1): Re-using an available connection from the pool (formerly list_javen_testing_test).
2020-06-28 23:54:25.552202 (Thread-2): Opening a new connection, currently in state init
2020-06-28 23:54:25.552321 (Thread-1): Compiling model.sample_project.my_first_dbt_model
2020-06-28 23:54:25.552416 (Thread-2): Compiling model.sample_project.supplier
2020-06-28 23:54:25.584243 (Thread-2): Writing injected SQL for node "model.sample_project.supplier"
2020-06-28 23:54:25.585561 (Thread-1): Writing injected SQL for node "model.sample_project.my_first_dbt_model"
2020-06-28 23:54:25.586389 (Thread-1): finished collecting timing info
2020-06-28 23:54:25.586715 (Thread-1): finished collecting timing info
2020-06-28 23:54:25.587152 (Thread-1): Finished running node model.sample_project.my_first_dbt_model
2020-06-28 23:54:25.587529 (Thread-2): finished collecting timing info
2020-06-28 23:54:25.587928 (Thread-2): Finished running node model.sample_project.supplier
2020-06-28 23:54:25.588087 (Thread-2): Began running node model.sample_project.my_second_dbt_model
2020-06-28 23:54:25.588342 (Thread-2): Acquiring new snowflake connection "model.sample_project.my_second_dbt_model".
2020-06-28 23:54:25.588446 (Thread-2): Opening a new connection, currently in state init
2020-06-28 23:54:25.588544 (Thread-2): Compiling model.sample_project.my_second_dbt_model
2020-06-28 23:54:25.594256 (Thread-3): Began running node test.sample_project.not_null_my_first_dbt_model_id
2020-06-28 23:54:25.594599 (Thread-3): Acquiring new snowflake connection "test.sample_project.not_null_my_first_dbt_model_id".
2020-06-28 23:54:25.594707 (Thread-3): Opening a new connection, currently in state init
2020-06-28 23:54:25.594806 (Thread-3): Compiling test.sample_project.not_null_my_first_dbt_model_id
2020-06-28 23:54:25.603001 (Thread-2): Writing injected SQL for node "model.sample_project.my_second_dbt_model"
2020-06-28 23:54:25.603251 (Thread-1): Began running node test.sample_project.unique_my_first_dbt_model_id
2020-06-28 23:54:25.603563 (Thread-1): Acquiring new snowflake connection "test.sample_project.unique_my_first_dbt_model_id".
2020-06-28 23:54:25.603665 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.my_first_dbt_model).
2020-06-28 23:54:25.603760 (Thread-1): Compiling test.sample_project.unique_my_first_dbt_model_id
2020-06-28 23:54:25.620995 (Thread-3): Writing injected SQL for node "test.sample_project.not_null_my_first_dbt_model_id"
2020-06-28 23:54:25.627783 (Thread-1): Writing injected SQL for node "test.sample_project.unique_my_first_dbt_model_id"
2020-06-28 23:54:25.628053 (Thread-2): finished collecting timing info
2020-06-28 23:54:25.628325 (Thread-2): finished collecting timing info
2020-06-28 23:54:25.628720 (Thread-2): Finished running node model.sample_project.my_second_dbt_model
2020-06-28 23:54:25.629226 (Thread-2): Began running node test.sample_project.not_null_my_second_dbt_model_id
2020-06-28 23:54:25.629597 (Thread-2): Acquiring new snowflake connection "test.sample_project.not_null_my_second_dbt_model_id".
2020-06-28 23:54:25.629736 (Thread-3): finished collecting timing info
2020-06-28 23:54:25.630011 (Thread-1): finished collecting timing info
2020-06-28 23:54:25.630261 (Thread-2): Opening a new connection, currently in state init
2020-06-28 23:54:25.630405 (Thread-3): finished collecting timing info
2020-06-28 23:54:25.630690 (Thread-1): finished collecting timing info
2020-06-28 23:54:25.630934 (Thread-2): Compiling test.sample_project.not_null_my_second_dbt_model_id
2020-06-28 23:54:25.631197 (Thread-3): Finished running node test.sample_project.not_null_my_first_dbt_model_id
2020-06-28 23:54:25.631450 (Thread-1): Finished running node test.sample_project.unique_my_first_dbt_model_id
2020-06-28 23:54:25.639864 (Thread-2): Writing injected SQL for node "test.sample_project.not_null_my_second_dbt_model_id"
2020-06-28 23:54:25.640006 (Thread-3): Began running node test.sample_project.unique_my_second_dbt_model_id
2020-06-28 23:54:25.640519 (Thread-3): Acquiring new snowflake connection "test.sample_project.unique_my_second_dbt_model_id".
2020-06-28 23:54:25.640625 (Thread-3): Opening a new connection, currently in state init
2020-06-28 23:54:25.640718 (Thread-3): Compiling test.sample_project.unique_my_second_dbt_model_id
2020-06-28 23:54:25.649037 (Thread-3): Writing injected SQL for node "test.sample_project.unique_my_second_dbt_model_id"
2020-06-28 23:54:25.649319 (Thread-2): finished collecting timing info
2020-06-28 23:54:25.649569 (Thread-2): finished collecting timing info
2020-06-28 23:54:25.649931 (Thread-2): Finished running node test.sample_project.not_null_my_second_dbt_model_id
2020-06-28 23:54:25.650112 (Thread-3): finished collecting timing info
2020-06-28 23:54:25.650343 (Thread-3): finished collecting timing info
2020-06-28 23:54:25.650711 (Thread-3): Finished running node test.sample_project.unique_my_second_dbt_model_id
2020-06-28 23:54:25.656554 (MainThread): Connection 'master' was properly closed.
2020-06-28 23:54:25.656927 (MainThread): Connection 'test.sample_project.unique_my_first_dbt_model_id' was left open.
2020-06-28 23:54:25.657197 (MainThread): On test.sample_project.unique_my_first_dbt_model_id: Close
2020-06-28 23:54:25.933267 (MainThread): Connection 'test.sample_project.not_null_my_second_dbt_model_id' was properly closed.
2020-06-28 23:54:25.933411 (MainThread): Connection 'test.sample_project.unique_my_second_dbt_model_id' was properly closed.
2020-06-28 23:54:25.950600 (MainThread): 18:54:25 | Done.
2020-06-28 23:54:25.950828 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110184d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ad7710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ad72d0>]}
2020-06-28 23:54:25.951027 (MainThread): Flushing usage events
2020-06-28 23:59:56.503234 (MainThread): Running with dbt=0.17.0
2020-06-28 23:59:56.973314 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2020-06-28 23:59:56.974736 (MainThread): Tracking: tracking
2020-06-28 23:59:56.975276 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147a9350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147a92d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147a9f50>]}
2020-06-28 23:59:56.998926 (MainThread): Partial parsing not enabled
2020-06-28 23:59:57.000769 (MainThread): Parsing macros/core.sql
2020-06-28 23:59:57.006033 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-28 23:59:57.015107 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-28 23:59:57.017351 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-28 23:59:57.038225 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-28 23:59:57.074204 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-28 23:59:57.097505 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-28 23:59:57.099756 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-28 23:59:57.107236 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-28 23:59:57.122536 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-28 23:59:57.134301 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-28 23:59:57.142341 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-28 23:59:57.148154 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-28 23:59:57.149444 (MainThread): Parsing macros/etc/query.sql
2020-06-28 23:59:57.150806 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-28 23:59:57.152758 (MainThread): Parsing macros/etc/datetime.sql
2020-06-28 23:59:57.163124 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-28 23:59:57.165539 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-28 23:59:57.167551 (MainThread): Parsing macros/adapters/common.sql
2020-06-28 23:59:57.222456 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-28 23:59:57.223965 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-28 23:59:57.225169 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-28 23:59:57.226542 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-28 23:59:57.229305 (MainThread): Parsing macros/catalog.sql
2020-06-28 23:59:57.231512 (MainThread): Parsing macros/adapters.sql
2020-06-28 23:59:57.255630 (MainThread): Parsing macros/materializations/merge.sql
2020-06-28 23:59:57.258010 (MainThread): Parsing macros/materializations/view.sql
2020-06-28 23:59:57.259495 (MainThread): Parsing macros/materializations/table.sql
2020-06-28 23:59:57.264103 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-28 23:59:57.292153 (MainThread): Partial parsing not enabled
2020-06-28 23:59:57.329926 (MainThread): Acquiring new snowflake connection "model.sample_project.my_first_dbt_model".
2020-06-28 23:59:57.330085 (MainThread): Opening a new connection, currently in state init
2020-06-28 23:59:57.359909 (MainThread): Acquiring new snowflake connection "model.sample_project.my_second_dbt_model".
2020-06-28 23:59:57.360024 (MainThread): Opening a new connection, currently in state init
2020-06-28 23:59:57.373275 (MainThread): Acquiring new snowflake connection "model.sample_project.supplier".
2020-06-28 23:59:57.373395 (MainThread): Opening a new connection, currently in state init
2020-06-28 23:59:57.642389 (MainThread): WARNING: Found documentation for resource "customer" which was not found or is disabled
2020-06-28 23:59:57.642494 (MainThread): WARNING: Found documentation for resource "nation" which was not found or is disabled
2020-06-28 23:59:57.642562 (MainThread): WARNING: Found documentation for resource "orders" which was not found or is disabled
2020-06-28 23:59:57.642624 (MainThread): WARNING: Found documentation for resource "lineitem" which was not found or is disabled
2020-06-28 23:59:57.642811 (MainThread): WARNING: Test 'test.sample_project.unique_customer_id' (models/reports/schema.yml) depends on a node named 'customer' which was not found
2020-06-28 23:59:57.642924 (MainThread): WARNING: Test 'test.sample_project.not_null_customer_id' (models/reports/schema.yml) depends on a node named 'customer' which was not found
2020-06-28 23:59:57.643017 (MainThread): WARNING: Test 'test.sample_project.unique_nation_id' (models/reports/schema.yml) depends on a node named 'nation' which was not found
2020-06-28 23:59:57.643105 (MainThread): WARNING: Test 'test.sample_project.not_null_nation_id' (models/reports/schema.yml) depends on a node named 'nation' which was not found
2020-06-28 23:59:57.643318 (MainThread): WARNING: Test 'test.sample_project.unique_orders_id' (models/reports/schema.yml) depends on a node named 'orders' which was not found
2020-06-28 23:59:57.643496 (MainThread): WARNING: Test 'test.sample_project.not_null_orders_id' (models/reports/schema.yml) depends on a node named 'orders' which was not found
2020-06-28 23:59:57.643679 (MainThread): WARNING: Test 'test.sample_project.unique_lineitem_id' (models/reports/schema.yml) depends on a node named 'lineitem' which was not found
2020-06-28 23:59:57.643797 (MainThread): WARNING: Test 'test.sample_project.not_null_lineitem_id' (models/reports/schema.yml) depends on a node named 'lineitem' which was not found
2020-06-28 23:59:57.680557 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.sample_project.transforms
- models.sample_project.reports

2020-06-28 23:59:57.751212 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 136 macros, 0 operations, 0 seed files, 4 sources
2020-06-28 23:59:57.752702 (MainThread): 
2020-06-28 23:59:57.753015 (MainThread): Acquiring new snowflake connection "master".
2020-06-28 23:59:57.753100 (MainThread): Opening a new connection, currently in state init
2020-06-28 23:59:57.757429 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_javen_testing".
2020-06-28 23:59:57.757587 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-06-28 23:59:57.777134 (ThreadPoolExecutor-0_0): Using snowflake connection "list_javen_testing".
2020-06-28 23:59:57.777289 (ThreadPoolExecutor-0_0): On list_javen_testing: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "snowflake-sso", "target_name": "dev", "connection_name": "list_javen_testing"} */

    show terse schemas in database javen_testing
    limit 10000
2020-06-28 23:59:59.529585 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/certifi/cacert.pem'>
2020-06-29 00:00:10.146661 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 12.37 seconds
2020-06-29 00:00:10.176088 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_javen_testing_test".
2020-06-29 00:00:10.176206 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_javen_testing).
2020-06-29 00:00:10.183828 (ThreadPoolExecutor-1_0): Using snowflake connection "list_javen_testing_test".
2020-06-29 00:00:10.183941 (ThreadPoolExecutor-1_0): On list_javen_testing_test: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "snowflake-sso", "target_name": "dev", "connection_name": "list_javen_testing_test"} */

    show terse objects in javen_testing.test
2020-06-29 00:00:11.382441 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 0 in 1.20 seconds
2020-06-29 00:00:11.384183 (MainThread): 19:00:11 | Concurrency: 3 threads (target='dev')
2020-06-29 00:00:11.384455 (MainThread): 19:00:11 | 
2020-06-29 00:00:11.386241 (Thread-1): Began running node model.sample_project.my_first_dbt_model
2020-06-29 00:00:11.386537 (Thread-2): Began running node model.sample_project.supplier
2020-06-29 00:00:11.386993 (Thread-1): Acquiring new snowflake connection "model.sample_project.my_first_dbt_model".
2020-06-29 00:00:11.387452 (Thread-2): Acquiring new snowflake connection "model.sample_project.supplier".
2020-06-29 00:00:11.387707 (Thread-1): Re-using an available connection from the pool (formerly list_javen_testing_test).
2020-06-29 00:00:11.387887 (Thread-2): Opening a new connection, currently in state init
2020-06-29 00:00:11.388140 (Thread-1): Compiling model.sample_project.my_first_dbt_model
2020-06-29 00:00:11.388358 (Thread-2): Compiling model.sample_project.supplier
2020-06-29 00:00:11.414006 (Thread-1): Writing injected SQL for node "model.sample_project.my_first_dbt_model"
2020-06-29 00:00:11.416622 (Thread-2): Writing injected SQL for node "model.sample_project.supplier"
2020-06-29 00:00:11.417166 (Thread-2): finished collecting timing info
2020-06-29 00:00:11.417528 (Thread-2): finished collecting timing info
2020-06-29 00:00:11.418076 (Thread-2): Finished running node model.sample_project.supplier
2020-06-29 00:00:11.418360 (Thread-1): finished collecting timing info
2020-06-29 00:00:11.418625 (Thread-1): finished collecting timing info
2020-06-29 00:00:11.419046 (Thread-1): Finished running node model.sample_project.my_first_dbt_model
2020-06-29 00:00:11.419437 (Thread-3): Began running node model.sample_project.my_second_dbt_model
2020-06-29 00:00:11.419780 (Thread-3): Acquiring new snowflake connection "model.sample_project.my_second_dbt_model".
2020-06-29 00:00:11.419896 (Thread-3): Opening a new connection, currently in state init
2020-06-29 00:00:11.420051 (Thread-2): Began running node test.sample_project.not_null_my_first_dbt_model_id
2020-06-29 00:00:11.420206 (Thread-3): Compiling model.sample_project.my_second_dbt_model
2020-06-29 00:00:11.420343 (Thread-1): Began running node test.sample_project.unique_my_first_dbt_model_id
2020-06-29 00:00:11.421176 (Thread-2): Acquiring new snowflake connection "test.sample_project.not_null_my_first_dbt_model_id".
2020-06-29 00:00:11.432735 (Thread-3): Writing injected SQL for node "model.sample_project.my_second_dbt_model"
2020-06-29 00:00:11.433155 (Thread-1): Acquiring new snowflake connection "test.sample_project.unique_my_first_dbt_model_id".
2020-06-29 00:00:11.433334 (Thread-2): Opening a new connection, currently in state init
2020-06-29 00:00:11.433582 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.my_first_dbt_model).
2020-06-29 00:00:11.433807 (Thread-2): Compiling test.sample_project.not_null_my_first_dbt_model_id
2020-06-29 00:00:11.434050 (Thread-1): Compiling test.sample_project.unique_my_first_dbt_model_id
2020-06-29 00:00:11.439427 (Thread-3): finished collecting timing info
2020-06-29 00:00:11.465481 (Thread-2): Writing injected SQL for node "test.sample_project.not_null_my_first_dbt_model_id"
2020-06-29 00:00:11.470725 (Thread-1): Writing injected SQL for node "test.sample_project.unique_my_first_dbt_model_id"
2020-06-29 00:00:11.470873 (Thread-3): finished collecting timing info
2020-06-29 00:00:11.471683 (Thread-3): Finished running node model.sample_project.my_second_dbt_model
2020-06-29 00:00:11.471999 (Thread-2): finished collecting timing info
2020-06-29 00:00:11.472255 (Thread-2): finished collecting timing info
2020-06-29 00:00:11.472629 (Thread-2): Finished running node test.sample_project.not_null_my_first_dbt_model_id
2020-06-29 00:00:11.472843 (Thread-3): Began running node test.sample_project.not_null_my_second_dbt_model_id
2020-06-29 00:00:11.473138 (Thread-3): Acquiring new snowflake connection "test.sample_project.not_null_my_second_dbt_model_id".
2020-06-29 00:00:11.473239 (Thread-3): Opening a new connection, currently in state init
2020-06-29 00:00:11.473343 (Thread-3): Compiling test.sample_project.not_null_my_second_dbt_model_id
2020-06-29 00:00:11.478886 (Thread-1): finished collecting timing info
2020-06-29 00:00:11.482979 (Thread-3): Writing injected SQL for node "test.sample_project.not_null_my_second_dbt_model_id"
2020-06-29 00:00:11.483185 (Thread-1): finished collecting timing info
2020-06-29 00:00:11.483417 (Thread-2): Began running node test.sample_project.unique_my_second_dbt_model_id
2020-06-29 00:00:11.484020 (Thread-1): Finished running node test.sample_project.unique_my_first_dbt_model_id
2020-06-29 00:00:11.484312 (Thread-2): Acquiring new snowflake connection "test.sample_project.unique_my_second_dbt_model_id".
2020-06-29 00:00:11.484618 (Thread-2): Opening a new connection, currently in state init
2020-06-29 00:00:11.484729 (Thread-2): Compiling test.sample_project.unique_my_second_dbt_model_id
2020-06-29 00:00:11.484865 (Thread-3): finished collecting timing info
2020-06-29 00:00:11.494003 (Thread-2): Writing injected SQL for node "test.sample_project.unique_my_second_dbt_model_id"
2020-06-29 00:00:11.494159 (Thread-3): finished collecting timing info
2020-06-29 00:00:11.494820 (Thread-3): Finished running node test.sample_project.not_null_my_second_dbt_model_id
2020-06-29 00:00:11.495178 (Thread-2): finished collecting timing info
2020-06-29 00:00:11.495426 (Thread-2): finished collecting timing info
2020-06-29 00:00:11.495799 (Thread-2): Finished running node test.sample_project.unique_my_second_dbt_model_id
2020-06-29 00:00:11.592872 (MainThread): Connection 'master' was properly closed.
2020-06-29 00:00:11.593084 (MainThread): Connection 'test.sample_project.unique_my_first_dbt_model_id' was left open.
2020-06-29 00:00:11.593229 (MainThread): On test.sample_project.unique_my_first_dbt_model_id: Close
2020-06-29 00:00:12.678534 (MainThread): Connection 'test.sample_project.unique_my_second_dbt_model_id' was properly closed.
2020-06-29 00:00:12.678745 (MainThread): Connection 'test.sample_project.not_null_my_second_dbt_model_id' was properly closed.
2020-06-29 00:00:12.701109 (MainThread): 19:00:12 | Done.
2020-06-29 00:00:12.701360 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11507b050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1151e1350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115165b10>]}
2020-06-29 00:00:12.701578 (MainThread): Flushing usage events
2020-06-29 00:00:16.171074 (MainThread): Running with dbt=0.17.0
2020-06-29 00:00:16.469979 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-06-29 00:00:16.470955 (MainThread): Tracking: tracking
2020-06-29 00:00:16.471214 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114207f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114218e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114218310>]}
2020-06-29 00:00:16.490573 (MainThread): Partial parsing not enabled
2020-06-29 00:00:16.492441 (MainThread): Parsing macros/core.sql
2020-06-29 00:00:16.497004 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-29 00:00:16.505428 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-29 00:00:16.507194 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-29 00:00:16.525369 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-29 00:00:16.555367 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-29 00:00:16.577790 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-29 00:00:16.579915 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-29 00:00:16.586944 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-29 00:00:16.602350 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-29 00:00:16.611065 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-29 00:00:16.618354 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-29 00:00:16.623764 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-29 00:00:16.624703 (MainThread): Parsing macros/etc/query.sql
2020-06-29 00:00:16.625774 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-29 00:00:16.627441 (MainThread): Parsing macros/etc/datetime.sql
2020-06-29 00:00:16.636624 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-29 00:00:16.638622 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-29 00:00:16.640318 (MainThread): Parsing macros/adapters/common.sql
2020-06-29 00:00:16.689523 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-29 00:00:16.690673 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-29 00:00:16.691592 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-29 00:00:16.692704 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-29 00:00:16.695005 (MainThread): Parsing macros/catalog.sql
2020-06-29 00:00:16.697139 (MainThread): Parsing macros/adapters.sql
2020-06-29 00:00:16.721935 (MainThread): Parsing macros/materializations/merge.sql
2020-06-29 00:00:16.724013 (MainThread): Parsing macros/materializations/view.sql
2020-06-29 00:00:16.725459 (MainThread): Parsing macros/materializations/table.sql
2020-06-29 00:00:16.729515 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-29 00:00:16.756008 (MainThread): Partial parsing not enabled
2020-06-29 00:00:16.792163 (MainThread): Acquiring new snowflake connection "model.sample_project.my_first_dbt_model".
2020-06-29 00:00:16.792260 (MainThread): Opening a new connection, currently in state init
2020-06-29 00:00:16.819913 (MainThread): Acquiring new snowflake connection "model.sample_project.my_second_dbt_model".
2020-06-29 00:00:16.820002 (MainThread): Opening a new connection, currently in state init
2020-06-29 00:00:16.830351 (MainThread): Acquiring new snowflake connection "model.sample_project.supplier".
2020-06-29 00:00:16.830436 (MainThread): Opening a new connection, currently in state init
2020-06-29 00:00:17.101366 (MainThread): WARNING: Found documentation for resource "customer" which was not found or is disabled
2020-06-29 00:00:17.101557 (MainThread): WARNING: Found documentation for resource "nation" which was not found or is disabled
2020-06-29 00:00:17.101723 (MainThread): WARNING: Found documentation for resource "orders" which was not found or is disabled
2020-06-29 00:00:17.101851 (MainThread): WARNING: Found documentation for resource "lineitem" which was not found or is disabled
2020-06-29 00:00:17.102137 (MainThread): WARNING: Test 'test.sample_project.unique_customer_id' (models/reports/schema.yml) depends on a node named 'customer' which was not found
2020-06-29 00:00:17.102318 (MainThread): WARNING: Test 'test.sample_project.not_null_customer_id' (models/reports/schema.yml) depends on a node named 'customer' which was not found
2020-06-29 00:00:17.102491 (MainThread): WARNING: Test 'test.sample_project.unique_nation_id' (models/reports/schema.yml) depends on a node named 'nation' which was not found
2020-06-29 00:00:17.102700 (MainThread): WARNING: Test 'test.sample_project.not_null_nation_id' (models/reports/schema.yml) depends on a node named 'nation' which was not found
2020-06-29 00:00:17.102859 (MainThread): WARNING: Test 'test.sample_project.unique_orders_id' (models/reports/schema.yml) depends on a node named 'orders' which was not found
2020-06-29 00:00:17.103015 (MainThread): WARNING: Test 'test.sample_project.not_null_orders_id' (models/reports/schema.yml) depends on a node named 'orders' which was not found
2020-06-29 00:00:17.103227 (MainThread): WARNING: Test 'test.sample_project.unique_lineitem_id' (models/reports/schema.yml) depends on a node named 'lineitem' which was not found
2020-06-29 00:00:17.103417 (MainThread): WARNING: Test 'test.sample_project.not_null_lineitem_id' (models/reports/schema.yml) depends on a node named 'lineitem' which was not found
2020-06-29 00:00:17.147229 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.sample_project.transforms
- models.sample_project.reports

2020-06-29 00:00:17.228458 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 136 macros, 0 operations, 0 seed files, 4 sources
2020-06-29 00:00:17.229496 (MainThread): 
2020-06-29 00:00:17.229802 (MainThread): Acquiring new snowflake connection "master".
2020-06-29 00:00:17.229920 (MainThread): Opening a new connection, currently in state init
2020-06-29 00:00:17.234172 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_javen_testing".
2020-06-29 00:00:17.234293 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-06-29 00:00:17.251998 (ThreadPoolExecutor-0_0): Using snowflake connection "list_javen_testing".
2020-06-29 00:00:17.252168 (ThreadPoolExecutor-0_0): On list_javen_testing: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "snowflake-sso", "target_name": "dev", "connection_name": "list_javen_testing"} */

    show terse schemas in database javen_testing
    limit 10000
2020-06-29 00:00:17.672257 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/certifi/cacert.pem'>
2020-06-29 00:00:28.114537 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 10.86 seconds
2020-06-29 00:00:28.141375 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_javen_testing_test".
2020-06-29 00:00:28.141662 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_javen_testing).
2020-06-29 00:00:28.149301 (ThreadPoolExecutor-1_0): Using snowflake connection "list_javen_testing_test".
2020-06-29 00:00:28.149404 (ThreadPoolExecutor-1_0): On list_javen_testing_test: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "snowflake-sso", "target_name": "dev", "connection_name": "list_javen_testing_test"} */

    show terse objects in javen_testing.test
2020-06-29 00:00:28.409437 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 0 in 0.26 seconds
2020-06-29 00:00:28.411070 (MainThread): Acquiring new snowflake connection "master".
2020-06-29 00:00:28.411276 (MainThread): Opening a new connection, currently in state init
2020-06-29 00:00:28.411585 (MainThread): Using snowflake connection "master".
2020-06-29 00:00:28.411750 (MainThread): On master: BEGIN
2020-06-29 00:00:34.956299 (MainThread): Connection 'master' was properly closed.
2020-06-29 00:00:34.956682 (MainThread): Connection 'list_javen_testing_test' was left open.
2020-06-29 00:00:34.956856 (MainThread): On list_javen_testing_test: Close
2020-06-29 00:00:35.290518 (MainThread): Flushing usage events
2020-06-29 00:00:35.631512 (MainThread): ctrl-c
2020-06-29 00:00:37.395401 (MainThread): Running with dbt=0.17.0
2020-06-29 00:00:37.700061 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-06-29 00:00:37.700915 (MainThread): Tracking: tracking
2020-06-29 00:00:37.701236 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d39f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d4bd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d4bc90>]}
2020-06-29 00:00:37.720735 (MainThread): Partial parsing not enabled
2020-06-29 00:00:37.722399 (MainThread): Parsing macros/core.sql
2020-06-29 00:00:37.727041 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-29 00:00:37.739584 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-29 00:00:37.742322 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-29 00:00:37.761318 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-29 00:00:37.791507 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-29 00:00:37.813511 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-29 00:00:37.815554 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-29 00:00:37.822210 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-29 00:00:37.836552 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-29 00:00:37.844024 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-29 00:00:37.850871 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-29 00:00:37.856032 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-29 00:00:37.856990 (MainThread): Parsing macros/etc/query.sql
2020-06-29 00:00:37.858109 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-29 00:00:37.859956 (MainThread): Parsing macros/etc/datetime.sql
2020-06-29 00:00:37.869322 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-29 00:00:37.871343 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-29 00:00:37.873024 (MainThread): Parsing macros/adapters/common.sql
2020-06-29 00:00:37.942419 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-29 00:00:37.943864 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-29 00:00:37.944977 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-29 00:00:37.946309 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-29 00:00:37.949101 (MainThread): Parsing macros/catalog.sql
2020-06-29 00:00:37.951392 (MainThread): Parsing macros/adapters.sql
2020-06-29 00:00:37.975354 (MainThread): Parsing macros/materializations/merge.sql
2020-06-29 00:00:37.977709 (MainThread): Parsing macros/materializations/view.sql
2020-06-29 00:00:37.978915 (MainThread): Parsing macros/materializations/table.sql
2020-06-29 00:00:37.983759 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-29 00:00:38.011787 (MainThread): Partial parsing not enabled
2020-06-29 00:00:38.047885 (MainThread): Acquiring new snowflake connection "model.sample_project.my_first_dbt_model".
2020-06-29 00:00:38.047994 (MainThread): Opening a new connection, currently in state init
2020-06-29 00:00:38.078755 (MainThread): Acquiring new snowflake connection "model.sample_project.my_second_dbt_model".
2020-06-29 00:00:38.078915 (MainThread): Opening a new connection, currently in state init
2020-06-29 00:00:38.091839 (MainThread): Acquiring new snowflake connection "model.sample_project.supplier".
2020-06-29 00:00:38.091947 (MainThread): Opening a new connection, currently in state init
2020-06-29 00:00:38.346350 (MainThread): WARNING: Found documentation for resource "customer" which was not found or is disabled
2020-06-29 00:00:38.346459 (MainThread): WARNING: Found documentation for resource "nation" which was not found or is disabled
2020-06-29 00:00:38.346527 (MainThread): WARNING: Found documentation for resource "orders" which was not found or is disabled
2020-06-29 00:00:38.346589 (MainThread): WARNING: Found documentation for resource "lineitem" which was not found or is disabled
2020-06-29 00:00:38.346782 (MainThread): WARNING: Test 'test.sample_project.unique_customer_id' (models/reports/schema.yml) depends on a node named 'customer' which was not found
2020-06-29 00:00:38.346892 (MainThread): WARNING: Test 'test.sample_project.not_null_customer_id' (models/reports/schema.yml) depends on a node named 'customer' which was not found
2020-06-29 00:00:38.346984 (MainThread): WARNING: Test 'test.sample_project.unique_nation_id' (models/reports/schema.yml) depends on a node named 'nation' which was not found
2020-06-29 00:00:38.347074 (MainThread): WARNING: Test 'test.sample_project.not_null_nation_id' (models/reports/schema.yml) depends on a node named 'nation' which was not found
2020-06-29 00:00:38.347207 (MainThread): WARNING: Test 'test.sample_project.unique_orders_id' (models/reports/schema.yml) depends on a node named 'orders' which was not found
2020-06-29 00:00:38.347437 (MainThread): WARNING: Test 'test.sample_project.not_null_orders_id' (models/reports/schema.yml) depends on a node named 'orders' which was not found
2020-06-29 00:00:38.347554 (MainThread): WARNING: Test 'test.sample_project.unique_lineitem_id' (models/reports/schema.yml) depends on a node named 'lineitem' which was not found
2020-06-29 00:00:38.347665 (MainThread): WARNING: Test 'test.sample_project.not_null_lineitem_id' (models/reports/schema.yml) depends on a node named 'lineitem' which was not found
2020-06-29 00:00:38.383280 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.sample_project.transforms
- models.sample_project.reports

2020-06-29 00:00:38.459726 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 136 macros, 0 operations, 0 seed files, 4 sources
2020-06-29 00:00:38.460813 (MainThread): 
2020-06-29 00:00:38.461155 (MainThread): Acquiring new snowflake connection "master".
2020-06-29 00:00:38.461252 (MainThread): Opening a new connection, currently in state init
2020-06-29 00:00:38.465582 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_javen_testing".
2020-06-29 00:00:38.465721 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-06-29 00:00:38.488255 (ThreadPoolExecutor-0_0): Using snowflake connection "list_javen_testing".
2020-06-29 00:00:38.488438 (ThreadPoolExecutor-0_0): On list_javen_testing: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "snowflake-sso", "target_name": "dev", "connection_name": "list_javen_testing"} */

    show terse schemas in database javen_testing
    limit 10000
2020-06-29 00:00:38.910087 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/certifi/cacert.pem'>
2020-06-29 00:00:49.546756 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 11.06 seconds
2020-06-29 00:00:49.576185 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_javen_testing_test".
2020-06-29 00:00:49.576331 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_javen_testing).
2020-06-29 00:00:49.584067 (ThreadPoolExecutor-1_0): Using snowflake connection "list_javen_testing_test".
2020-06-29 00:00:49.584217 (ThreadPoolExecutor-1_0): On list_javen_testing_test: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "snowflake-sso", "target_name": "dev", "connection_name": "list_javen_testing_test"} */

    show terse objects in javen_testing.test
2020-06-29 00:00:49.790918 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 0 in 0.21 seconds
2020-06-29 00:00:49.792473 (MainThread): Acquiring new snowflake connection "master".
2020-06-29 00:00:49.792701 (MainThread): Opening a new connection, currently in state init
2020-06-29 00:00:49.792956 (MainThread): Using snowflake connection "master".
2020-06-29 00:00:49.793088 (MainThread): On master: BEGIN
2020-06-29 00:00:59.727945 (MainThread): SQL status: SUCCESS 1 in 9.93 seconds
2020-06-29 00:00:59.728446 (MainThread): On master: COMMIT
2020-06-29 00:00:59.728727 (MainThread): Using snowflake connection "master".
2020-06-29 00:00:59.728896 (MainThread): On master: COMMIT
2020-06-29 00:01:00.120904 (MainThread): SQL status: SUCCESS 1 in 0.39 seconds
2020-06-29 00:01:00.121935 (MainThread): 19:01:00 | Concurrency: 3 threads (target='dev')
2020-06-29 00:01:00.122208 (MainThread): 19:01:00 | 
2020-06-29 00:01:00.123799 (Thread-1): Began running node model.sample_project.my_first_dbt_model
2020-06-29 00:01:00.125926 (Thread-1): 19:01:00 | 1 of 3 START table model test.my_first_dbt_model..................... [RUN]
2020-06-29 00:01:00.126348 (Thread-1): Acquiring new snowflake connection "model.sample_project.my_first_dbt_model".
2020-06-29 00:01:00.126507 (Thread-1): Re-using an available connection from the pool (formerly list_javen_testing_test).
2020-06-29 00:01:00.126660 (Thread-2): Began running node model.sample_project.supplier
2020-06-29 00:01:00.126830 (Thread-1): Compiling model.sample_project.my_first_dbt_model
2020-06-29 00:01:00.128011 (Thread-2): 19:01:00 | 2 of 3 START table model test.supplier............................... [RUN]
2020-06-29 00:01:00.139976 (Thread-2): Acquiring new snowflake connection "model.sample_project.supplier".
2020-06-29 00:01:00.145901 (Thread-2): Opening a new connection, currently in state init
2020-06-29 00:01:00.151453 (Thread-2): Compiling model.sample_project.supplier
2020-06-29 00:01:00.152673 (Thread-1): Writing injected SQL for node "model.sample_project.my_first_dbt_model"
2020-06-29 00:01:00.163859 (Thread-2): Writing injected SQL for node "model.sample_project.supplier"
2020-06-29 00:01:00.164550 (Thread-1): finished collecting timing info
2020-06-29 00:01:00.177248 (Thread-2): finished collecting timing info
2020-06-29 00:01:00.222720 (Thread-2): Writing runtime SQL for node "model.sample_project.supplier"
2020-06-29 00:01:00.224024 (Thread-1): Writing runtime SQL for node "model.sample_project.my_first_dbt_model"
2020-06-29 00:01:00.225169 (Thread-1): Using snowflake connection "model.sample_project.my_first_dbt_model".
2020-06-29 00:01:00.225272 (Thread-1): On model.sample_project.my_first_dbt_model: BEGIN
2020-06-29 00:01:00.226708 (Thread-2): Using snowflake connection "model.sample_project.supplier".
2020-06-29 00:01:00.226812 (Thread-2): On model.sample_project.supplier: BEGIN
2020-06-29 00:01:00.476330 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2020-06-29 00:01:00.476492 (Thread-1): Using snowflake connection "model.sample_project.my_first_dbt_model".
2020-06-29 00:01:00.476597 (Thread-1): On model.sample_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "snowflake-sso", "target_name": "dev", "node_id": "model.sample_project.my_first_dbt_model"} */


      create or replace transient table javen_testing.test.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2020-06-29 00:01:06.264407 (Thread-1): SQL status: SUCCESS 1 in 5.79 seconds
2020-06-29 00:01:06.265904 (Thread-1): On model.sample_project.my_first_dbt_model: COMMIT
2020-06-29 00:01:06.266052 (Thread-1): Using snowflake connection "model.sample_project.my_first_dbt_model".
2020-06-29 00:01:06.266136 (Thread-1): On model.sample_project.my_first_dbt_model: COMMIT
2020-06-29 00:01:06.418884 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2020-06-29 00:01:06.428394 (Thread-1): finished collecting timing info
2020-06-29 00:01:06.429010 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0b77375-62bb-4460-9fdd-341b2d070623', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1149cd1d0>]}
2020-06-29 00:01:06.429965 (Thread-1): 19:01:06 | 1 of 3 OK created table model test.my_first_dbt_model................ [SUCCESS 1 in 6.30s]
2020-06-29 00:01:06.430171 (Thread-1): Finished running node model.sample_project.my_first_dbt_model
2020-06-29 00:01:06.430566 (Thread-3): Began running node model.sample_project.my_second_dbt_model
2020-06-29 00:01:06.431416 (Thread-3): 19:01:06 | 3 of 3 START view model test.my_second_dbt_model..................... [RUN]
2020-06-29 00:01:06.431661 (Thread-3): Acquiring new snowflake connection "model.sample_project.my_second_dbt_model".
2020-06-29 00:01:06.431746 (Thread-3): Opening a new connection, currently in state init
2020-06-29 00:01:06.431838 (Thread-3): Compiling model.sample_project.my_second_dbt_model
2020-06-29 00:01:06.439258 (Thread-3): Writing injected SQL for node "model.sample_project.my_second_dbt_model"
2020-06-29 00:01:06.439754 (Thread-3): finished collecting timing info
2020-06-29 00:01:06.463876 (Thread-3): Writing runtime SQL for node "model.sample_project.my_second_dbt_model"
2020-06-29 00:01:06.464646 (Thread-3): Using snowflake connection "model.sample_project.my_second_dbt_model".
2020-06-29 00:01:06.464734 (Thread-3): On model.sample_project.my_second_dbt_model: BEGIN
2020-06-29 00:01:10.576189 (Thread-2): SQL status: SUCCESS 1 in 10.35 seconds
2020-06-29 00:01:10.577432 (Thread-2): Using snowflake connection "model.sample_project.supplier".
2020-06-29 00:01:10.577704 (Thread-2): On model.sample_project.supplier: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "snowflake-sso", "target_name": "dev", "node_id": "model.sample_project.supplier"} */


      create or replace transient table javen_testing.test.supplier  as
      (/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select *
from snowflake_sample_data.tpch_sf1.supplier
      );
2020-06-29 00:01:12.364433 (Thread-2): SQL status: SUCCESS 1 in 1.79 seconds
2020-06-29 00:01:12.366618 (Thread-2): On model.sample_project.supplier: COMMIT
2020-06-29 00:01:12.366861 (Thread-2): Using snowflake connection "model.sample_project.supplier".
2020-06-29 00:01:12.367002 (Thread-2): On model.sample_project.supplier: COMMIT
2020-06-29 00:01:12.535383 (Thread-2): SQL status: SUCCESS 1 in 0.17 seconds
2020-06-29 00:01:12.539352 (Thread-2): finished collecting timing info
2020-06-29 00:01:12.540403 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0b77375-62bb-4460-9fdd-341b2d070623', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114546a50>]}
2020-06-29 00:01:12.541785 (Thread-2): 19:01:12 | 2 of 3 OK created table model test.supplier.......................... [SUCCESS 1 in 12.40s]
2020-06-29 00:01:12.541961 (Thread-2): Finished running node model.sample_project.supplier
2020-06-29 00:01:23.291233 (Thread-3): SQL status: SUCCESS 1 in 16.83 seconds
2020-06-29 00:01:23.291513 (Thread-3): Using snowflake connection "model.sample_project.my_second_dbt_model".
2020-06-29 00:01:23.291684 (Thread-3): On model.sample_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "snowflake-sso", "target_name": "dev", "node_id": "model.sample_project.my_second_dbt_model"} */

  create or replace  view javen_testing.test.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from javen_testing.test.my_first_dbt_model
where id = 1
  );
2020-06-29 00:01:23.877333 (Thread-3): SQL status: SUCCESS 1 in 0.59 seconds
2020-06-29 00:01:23.878596 (Thread-3): On model.sample_project.my_second_dbt_model: COMMIT
2020-06-29 00:01:23.878769 (Thread-3): Using snowflake connection "model.sample_project.my_second_dbt_model".
2020-06-29 00:01:23.878881 (Thread-3): On model.sample_project.my_second_dbt_model: COMMIT
2020-06-29 00:01:24.132110 (Thread-3): SQL status: SUCCESS 1 in 0.25 seconds
2020-06-29 00:01:24.136401 (Thread-3): finished collecting timing info
2020-06-29 00:01:24.137236 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0b77375-62bb-4460-9fdd-341b2d070623', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11469d690>]}
2020-06-29 00:01:24.138372 (Thread-3): 19:01:24 | 3 of 3 OK created view model test.my_second_dbt_model................ [SUCCESS 1 in 17.71s]
2020-06-29 00:01:24.138524 (Thread-3): Finished running node model.sample_project.my_second_dbt_model
2020-06-29 00:01:24.149026 (MainThread): Using snowflake connection "master".
2020-06-29 00:01:24.149263 (MainThread): On master: BEGIN
2020-06-29 00:01:24.328267 (MainThread): SQL status: SUCCESS 1 in 0.18 seconds
2020-06-29 00:01:24.328585 (MainThread): On master: COMMIT
2020-06-29 00:01:24.328834 (MainThread): Using snowflake connection "master".
2020-06-29 00:01:24.328959 (MainThread): On master: COMMIT
2020-06-29 00:01:24.586910 (MainThread): SQL status: SUCCESS 1 in 0.26 seconds
2020-06-29 00:01:24.587335 (MainThread): 19:01:24 | 
2020-06-29 00:01:24.587480 (MainThread): 19:01:24 | Finished running 2 table models, 1 view model in 46.13s.
2020-06-29 00:01:24.587652 (MainThread): Connection 'master' was left open.
2020-06-29 00:01:24.587753 (MainThread): On master: Close
2020-06-29 00:01:24.835679 (MainThread): Connection 'model.sample_project.my_first_dbt_model' was left open.
2020-06-29 00:01:24.835867 (MainThread): On model.sample_project.my_first_dbt_model: Close
2020-06-29 00:01:25.089205 (MainThread): Connection 'model.sample_project.supplier' was left open.
2020-06-29 00:01:25.089416 (MainThread): On model.sample_project.supplier: Close
2020-06-29 00:01:25.344126 (MainThread): Connection 'model.sample_project.my_second_dbt_model' was left open.
2020-06-29 00:01:25.344293 (MainThread): On model.sample_project.my_second_dbt_model: Close
2020-06-29 00:01:25.599194 (MainThread): 
2020-06-29 00:01:25.599378 (MainThread): Completed successfully
2020-06-29 00:01:25.599511 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2020-06-29 00:01:25.599743 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d71890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114565990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1149cd990>]}
2020-06-29 00:01:25.599943 (MainThread): Flushing usage events
2020-06-29 00:07:00.182998 (MainThread): Running with dbt=0.17.0
2020-06-29 00:07:00.672018 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-06-29 00:07:00.673053 (MainThread): Tracking: tracking
2020-06-29 00:07:00.673366 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110007690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110007090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110019d10>]}
2020-06-29 00:07:00.693770 (MainThread): Partial parsing not enabled
2020-06-29 00:07:00.696486 (MainThread): Parsing macros/core.sql
2020-06-29 00:07:00.702494 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-29 00:07:00.711718 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-29 00:07:00.714803 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-29 00:07:00.735549 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-29 00:07:00.770120 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-29 00:07:00.793418 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-29 00:07:00.796028 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-29 00:07:00.803397 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-29 00:07:00.818444 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-29 00:07:00.826008 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-29 00:07:00.833661 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-29 00:07:00.839872 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-29 00:07:00.841217 (MainThread): Parsing macros/etc/query.sql
2020-06-29 00:07:00.842650 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-29 00:07:00.844818 (MainThread): Parsing macros/etc/datetime.sql
2020-06-29 00:07:00.855599 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-29 00:07:00.857998 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-29 00:07:00.859980 (MainThread): Parsing macros/adapters/common.sql
2020-06-29 00:07:00.912792 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-29 00:07:00.914149 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-29 00:07:00.915242 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-29 00:07:00.916590 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-29 00:07:00.919133 (MainThread): Parsing macros/catalog.sql
2020-06-29 00:07:00.921313 (MainThread): Parsing macros/adapters.sql
2020-06-29 00:07:00.945429 (MainThread): Parsing macros/materializations/merge.sql
2020-06-29 00:07:00.948013 (MainThread): Parsing macros/materializations/view.sql
2020-06-29 00:07:00.949456 (MainThread): Parsing macros/materializations/table.sql
2020-06-29 00:07:00.953859 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-29 00:07:00.984407 (MainThread): Partial parsing not enabled
2020-06-29 00:07:01.023576 (MainThread): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-29 00:07:01.023698 (MainThread): Opening a new connection, currently in state init
2020-06-29 00:07:01.052948 (MainThread): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-29 00:07:01.053061 (MainThread): Opening a new connection, currently in state init
2020-06-29 00:07:01.055998 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101a56d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101ce110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101e1e90>]}
2020-06-29 00:07:01.056169 (MainThread): Flushing usage events
2020-06-29 00:07:01.605874 (MainThread): Connection 'model.sample_project.nation' was properly closed.
2020-06-29 00:07:01.606145 (MainThread): Encountered an error:
2020-06-29 00:07:01.606349 (MainThread): Compilation Error in model nation (models/source_reads/nation.sql)
  expected token ',', got 'tpch'
    line 19
      from {{ source("tpch", "from {{ source("tpch", "") }}
2020-06-29 00:07:01.618020 (MainThread): Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 449, in catch_jinja
    yield
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 476, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/environment.py", line 941, in from_string
    return cls.from_code(self, self.compile(source), globals, None)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/environment.py", line 638, in compile
    self.handle_exception(source=source_hint)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 19, in template
jinja2.exceptions.TemplateSyntaxError: expected token ',', got 'tpch'
  line 19
    from {{ source("tpch", "from {{ source("tpch", "") }}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/main.py", line 81, in main
    results, succeeded = handle_and_check(args)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/main.py", line 159, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/main.py", line 212, in run_from_args
    results = task.run()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/task/runnable.py", line 389, in run
    self._runtime_initialize()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/task/runnable.py", line 103, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/task/runnable.py", line 71, in _runtime_initialize
    self.load_manifest()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/task/runnable.py", line 60, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/perf_utils.py", line 23, in get_full_manifest
    return load_manifest(config, internal, set_header)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/manifest.py", line 641, in load_manifest
    return ManifestLoader.load_all(config, internal_manifest, macro_hook)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/manifest.py", line 356, in load_all
    loader.load(internal_manifest=internal_manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/manifest.py", line 212, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/manifest.py", line 186, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/manifest.py", line 142, in parse_with_cache
    parser.parse_file(block)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/base.py", line 419, in parse_file
    self.parse_node(file_block)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/base.py", line 392, in parse_node
    self.render_update(node, config)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/base.py", line 367, in render_update
    self.render_with_context(node, config)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/base.py", line 279, in render_with_context
    parsed_node.raw_sql, context, parsed_node, capture_macros=True
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 528, in get_rendered
    native=native,
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 476, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/usr/local/opt/python/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 452, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in model nation (models/source_reads/nation.sql)
  expected token ',', got 'tpch'
    line 19
      from {{ source("tpch", "from {{ source("tpch", "") }}

2020-06-29 00:07:39.800249 (MainThread): Running with dbt=0.17.0
2020-06-29 00:07:40.100928 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-06-29 00:07:40.101655 (MainThread): Tracking: tracking
2020-06-29 00:07:40.101922 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cc1250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cd3110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cd3d90>]}
2020-06-29 00:07:40.121642 (MainThread): Partial parsing not enabled
2020-06-29 00:07:40.123262 (MainThread): Parsing macros/core.sql
2020-06-29 00:07:40.127786 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-29 00:07:40.135672 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-29 00:07:40.137676 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-29 00:07:40.155774 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-29 00:07:40.185415 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-29 00:07:40.212255 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-29 00:07:40.214243 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-29 00:07:40.220981 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-29 00:07:40.235287 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-29 00:07:40.242514 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-29 00:07:40.249505 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-29 00:07:40.254715 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-29 00:07:40.256609 (MainThread): Parsing macros/etc/query.sql
2020-06-29 00:07:40.257721 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-29 00:07:40.259501 (MainThread): Parsing macros/etc/datetime.sql
2020-06-29 00:07:40.269518 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-29 00:07:40.271572 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-29 00:07:40.273289 (MainThread): Parsing macros/adapters/common.sql
2020-06-29 00:07:40.324341 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-29 00:07:40.325605 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-29 00:07:40.326591 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-29 00:07:40.327726 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-29 00:07:40.330080 (MainThread): Parsing macros/catalog.sql
2020-06-29 00:07:40.332655 (MainThread): Parsing macros/adapters.sql
2020-06-29 00:07:40.357349 (MainThread): Parsing macros/materializations/merge.sql
2020-06-29 00:07:40.359621 (MainThread): Parsing macros/materializations/view.sql
2020-06-29 00:07:40.361011 (MainThread): Parsing macros/materializations/table.sql
2020-06-29 00:07:40.365394 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-29 00:07:40.392614 (MainThread): Partial parsing not enabled
2020-06-29 00:07:40.427329 (MainThread): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-29 00:07:40.427426 (MainThread): Opening a new connection, currently in state init
2020-06-29 00:07:40.456433 (MainThread): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-29 00:07:40.456524 (MainThread): Opening a new connection, currently in state init
2020-06-29 00:07:40.459051 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111465710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114b8dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114b8b50>]}
2020-06-29 00:07:40.459422 (MainThread): Flushing usage events
2020-06-29 00:07:40.873435 (MainThread): Connection 'model.sample_project.nation' was properly closed.
2020-06-29 00:07:40.873680 (MainThread): Encountered an error:
2020-06-29 00:07:40.873873 (MainThread): Compilation Error in model nation (models/source_reads/nation.sql)
  expected token ',', got 'tpch'
    line 19
      from {{ source("tpch", "from {{ source("tpch", "") }}
2020-06-29 00:07:40.876334 (MainThread): Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 449, in catch_jinja
    yield
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 476, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/environment.py", line 941, in from_string
    return cls.from_code(self, self.compile(source), globals, None)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/environment.py", line 638, in compile
    self.handle_exception(source=source_hint)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 19, in template
jinja2.exceptions.TemplateSyntaxError: expected token ',', got 'tpch'
  line 19
    from {{ source("tpch", "from {{ source("tpch", "") }}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/main.py", line 81, in main
    results, succeeded = handle_and_check(args)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/main.py", line 159, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/main.py", line 212, in run_from_args
    results = task.run()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/task/runnable.py", line 389, in run
    self._runtime_initialize()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/task/runnable.py", line 103, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/task/runnable.py", line 71, in _runtime_initialize
    self.load_manifest()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/task/runnable.py", line 60, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/perf_utils.py", line 23, in get_full_manifest
    return load_manifest(config, internal, set_header)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/manifest.py", line 641, in load_manifest
    return ManifestLoader.load_all(config, internal_manifest, macro_hook)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/manifest.py", line 356, in load_all
    loader.load(internal_manifest=internal_manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/manifest.py", line 212, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/manifest.py", line 186, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/manifest.py", line 142, in parse_with_cache
    parser.parse_file(block)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/base.py", line 419, in parse_file
    self.parse_node(file_block)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/base.py", line 392, in parse_node
    self.render_update(node, config)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/base.py", line 367, in render_update
    self.render_with_context(node, config)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/base.py", line 279, in render_with_context
    parsed_node.raw_sql, context, parsed_node, capture_macros=True
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 528, in get_rendered
    native=native,
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 476, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/usr/local/opt/python/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 452, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in model nation (models/source_reads/nation.sql)
  expected token ',', got 'tpch'
    line 19
      from {{ source("tpch", "from {{ source("tpch", "") }}

2020-06-29 00:08:02.554466 (MainThread): Running with dbt=0.17.0
2020-06-29 00:08:02.848900 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-06-29 00:08:02.849691 (MainThread): Tracking: tracking
2020-06-29 00:08:02.849984 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe5a650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe6be50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe6bd90>]}
2020-06-29 00:08:02.870412 (MainThread): Partial parsing not enabled
2020-06-29 00:08:02.872015 (MainThread): Parsing macros/core.sql
2020-06-29 00:08:02.876761 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-29 00:08:02.884721 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-29 00:08:02.886466 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-29 00:08:02.904781 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-29 00:08:02.935483 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-29 00:08:02.960893 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-29 00:08:02.962884 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-29 00:08:02.969530 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-29 00:08:02.983993 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-29 00:08:02.991129 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-29 00:08:02.998009 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-29 00:08:03.003295 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-29 00:08:03.004585 (MainThread): Parsing macros/etc/query.sql
2020-06-29 00:08:03.005676 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-29 00:08:03.007370 (MainThread): Parsing macros/etc/datetime.sql
2020-06-29 00:08:03.018868 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-29 00:08:03.022768 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-29 00:08:03.024872 (MainThread): Parsing macros/adapters/common.sql
2020-06-29 00:08:03.075712 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-29 00:08:03.076925 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-29 00:08:03.077857 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-29 00:08:03.078960 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-29 00:08:03.081592 (MainThread): Parsing macros/catalog.sql
2020-06-29 00:08:03.083863 (MainThread): Parsing macros/adapters.sql
2020-06-29 00:08:03.109486 (MainThread): Parsing macros/materializations/merge.sql
2020-06-29 00:08:03.111901 (MainThread): Parsing macros/materializations/view.sql
2020-06-29 00:08:03.113142 (MainThread): Parsing macros/materializations/table.sql
2020-06-29 00:08:03.117253 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-29 00:08:03.143498 (MainThread): Partial parsing not enabled
2020-06-29 00:08:03.178894 (MainThread): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-29 00:08:03.178998 (MainThread): Opening a new connection, currently in state init
2020-06-29 00:08:03.206718 (MainThread): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-29 00:08:03.206807 (MainThread): Opening a new connection, currently in state init
2020-06-29 00:08:03.218082 (MainThread): Acquiring new snowflake connection "model.sample_project.supplier".
2020-06-29 00:08:03.218174 (MainThread): Opening a new connection, currently in state init
2020-06-29 00:08:03.228909 (MainThread): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-29 00:08:03.228997 (MainThread): Opening a new connection, currently in state init
2020-06-29 00:08:03.435203 (MainThread): WARNING: Found documentation for resource "orders" which was not found or is disabled
2020-06-29 00:08:03.435447 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110785c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110762410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107a0750>]}
2020-06-29 00:08:03.435611 (MainThread): Flushing usage events
2020-06-29 00:08:03.860148 (MainThread): Connection 'model.sample_project.lineitem' was properly closed.
2020-06-29 00:08:03.860411 (MainThread): Encountered an error:
2020-06-29 00:08:03.860612 (MainThread): Compilation Error in model nation (models/source_reads/nation.sql)
  Model 'model.sample_project.nation' (models/source_reads/nation.sql) depends on a source named 'tpch.nation' which was not found
2020-06-29 00:08:03.865057 (MainThread): Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/main.py", line 81, in main
    results, succeeded = handle_and_check(args)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/main.py", line 159, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/main.py", line 212, in run_from_args
    results = task.run()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/task/runnable.py", line 389, in run
    self._runtime_initialize()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/task/runnable.py", line 103, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/task/runnable.py", line 71, in _runtime_initialize
    self.load_manifest()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/task/runnable.py", line 60, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/perf_utils.py", line 23, in get_full_manifest
    return load_manifest(config, internal, set_header)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/manifest.py", line 641, in load_manifest
    return ManifestLoader.load_all(config, internal_manifest, macro_hook)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/manifest.py", line 358, in load_all
    manifest = loader.create_manifest()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/manifest.py", line 334, in create_manifest
    self.process_manifest(manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/manifest.py", line 305, in process_manifest
    process_sources(manifest, project_name)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/manifest.py", line 600, in process_sources
    _process_sources_for_node(manifest, current_project, node)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/manifest.py", line 587, in _process_sources_for_node
    disabled=(isinstance(target_source, Disabled))
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/utils.py", line 337, in invalid_source_fail_unless_test
    disabled=disabled
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/exceptions.py", line 554, in source_target_not_found
    raise_compiler_error(msg, model)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/exceptions.py", line 392, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model nation (models/source_reads/nation.sql)
  Model 'model.sample_project.nation' (models/source_reads/nation.sql) depends on a source named 'tpch.nation' which was not found

2020-06-29 00:09:08.077064 (MainThread): Running with dbt=0.17.0
2020-06-29 00:09:08.379971 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-06-29 00:09:08.380626 (MainThread): Tracking: tracking
2020-06-29 00:09:08.380985 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d614650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6251d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d625e50>]}
2020-06-29 00:09:08.401361 (MainThread): Partial parsing not enabled
2020-06-29 00:09:08.402978 (MainThread): Parsing macros/core.sql
2020-06-29 00:09:08.407605 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-29 00:09:08.415591 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-29 00:09:08.417344 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-29 00:09:08.434810 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-29 00:09:08.465402 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-29 00:09:08.492082 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-29 00:09:08.494103 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-29 00:09:08.501002 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-29 00:09:08.515343 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-29 00:09:08.522408 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-29 00:09:08.529080 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-29 00:09:08.534123 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-29 00:09:08.535079 (MainThread): Parsing macros/etc/query.sql
2020-06-29 00:09:08.536163 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-29 00:09:08.537864 (MainThread): Parsing macros/etc/datetime.sql
2020-06-29 00:09:08.547023 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-29 00:09:08.549428 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-29 00:09:08.551162 (MainThread): Parsing macros/adapters/common.sql
2020-06-29 00:09:08.601996 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-29 00:09:08.604104 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-29 00:09:08.606108 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-29 00:09:08.607942 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-29 00:09:08.614110 (MainThread): Parsing macros/catalog.sql
2020-06-29 00:09:08.618281 (MainThread): Parsing macros/adapters.sql
2020-06-29 00:09:08.645514 (MainThread): Parsing macros/materializations/merge.sql
2020-06-29 00:09:08.647635 (MainThread): Parsing macros/materializations/view.sql
2020-06-29 00:09:08.649015 (MainThread): Parsing macros/materializations/table.sql
2020-06-29 00:09:08.653578 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-29 00:09:08.680722 (MainThread): Partial parsing not enabled
2020-06-29 00:09:08.718149 (MainThread): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-29 00:09:08.718260 (MainThread): Opening a new connection, currently in state init
2020-06-29 00:09:08.747547 (MainThread): Acquiring new snowflake connection "model.sample_project.supplier".
2020-06-29 00:09:08.747645 (MainThread): Opening a new connection, currently in state init
2020-06-29 00:09:08.761801 (MainThread): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-29 00:09:08.761954 (MainThread): Opening a new connection, currently in state init
2020-06-29 00:09:08.773732 (MainThread): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-29 00:09:08.773826 (MainThread): Opening a new connection, currently in state init
2020-06-29 00:09:08.982282 (MainThread): WARNING: Found documentation for resource "nation" which was not found or is disabled
2020-06-29 00:09:08.982542 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df21d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df29e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df29f50>]}
2020-06-29 00:09:08.982712 (MainThread): Flushing usage events
2020-06-29 00:09:09.475047 (MainThread): Connection 'model.sample_project.orders' was properly closed.
2020-06-29 00:09:09.475321 (MainThread): Encountered an error:
2020-06-29 00:09:09.475533 (MainThread): Compilation Error in model supplier (models/source_reads/supplier.sql)
  Model 'model.sample_project.supplier' (models/source_reads/supplier.sql) depends on a source named 'tpch.supplier' which was not found
2020-06-29 00:09:09.477473 (MainThread): Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/main.py", line 81, in main
    results, succeeded = handle_and_check(args)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/main.py", line 159, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/main.py", line 212, in run_from_args
    results = task.run()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/task/runnable.py", line 389, in run
    self._runtime_initialize()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/task/runnable.py", line 103, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/task/runnable.py", line 71, in _runtime_initialize
    self.load_manifest()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/task/runnable.py", line 60, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/perf_utils.py", line 23, in get_full_manifest
    return load_manifest(config, internal, set_header)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/manifest.py", line 641, in load_manifest
    return ManifestLoader.load_all(config, internal_manifest, macro_hook)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/manifest.py", line 358, in load_all
    manifest = loader.create_manifest()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/manifest.py", line 334, in create_manifest
    self.process_manifest(manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/manifest.py", line 305, in process_manifest
    process_sources(manifest, project_name)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/manifest.py", line 600, in process_sources
    _process_sources_for_node(manifest, current_project, node)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/manifest.py", line 587, in _process_sources_for_node
    disabled=(isinstance(target_source, Disabled))
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/utils.py", line 337, in invalid_source_fail_unless_test
    disabled=disabled
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/exceptions.py", line 554, in source_target_not_found
    raise_compiler_error(msg, model)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/exceptions.py", line 392, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model supplier (models/source_reads/supplier.sql)
  Model 'model.sample_project.supplier' (models/source_reads/supplier.sql) depends on a source named 'tpch.supplier' which was not found

2020-06-29 00:09:35.224883 (MainThread): Running with dbt=0.17.0
2020-06-29 00:09:35.526819 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-06-29 00:09:35.527788 (MainThread): Tracking: tracking
2020-06-29 00:09:35.528067 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dae0a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10daf2f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10daf24d0>]}
2020-06-29 00:09:35.547860 (MainThread): Partial parsing not enabled
2020-06-29 00:09:35.549623 (MainThread): Parsing macros/core.sql
2020-06-29 00:09:35.554269 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-29 00:09:35.562430 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-29 00:09:35.564213 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-29 00:09:35.584400 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-29 00:09:35.617578 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-29 00:09:35.641608 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-29 00:09:35.643681 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-29 00:09:35.650545 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-29 00:09:35.667007 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-29 00:09:35.674548 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-29 00:09:35.681129 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-29 00:09:35.686158 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-29 00:09:35.687273 (MainThread): Parsing macros/etc/query.sql
2020-06-29 00:09:35.688432 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-29 00:09:35.690133 (MainThread): Parsing macros/etc/datetime.sql
2020-06-29 00:09:35.699754 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-29 00:09:35.701837 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-29 00:09:35.703932 (MainThread): Parsing macros/adapters/common.sql
2020-06-29 00:09:35.758930 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-29 00:09:35.761190 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-29 00:09:35.762494 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-29 00:09:35.763717 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-29 00:09:35.766368 (MainThread): Parsing macros/catalog.sql
2020-06-29 00:09:35.768678 (MainThread): Parsing macros/adapters.sql
2020-06-29 00:09:35.793011 (MainThread): Parsing macros/materializations/merge.sql
2020-06-29 00:09:35.795089 (MainThread): Parsing macros/materializations/view.sql
2020-06-29 00:09:35.796317 (MainThread): Parsing macros/materializations/table.sql
2020-06-29 00:09:35.800442 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-29 00:09:35.828123 (MainThread): Partial parsing not enabled
2020-06-29 00:09:35.866491 (MainThread): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-29 00:09:35.866609 (MainThread): Opening a new connection, currently in state init
2020-06-29 00:09:35.896465 (MainThread): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-29 00:09:35.896614 (MainThread): Opening a new connection, currently in state init
2020-06-29 00:09:35.907518 (MainThread): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-29 00:09:35.907612 (MainThread): Opening a new connection, currently in state init
2020-06-29 00:09:35.918693 (MainThread): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-29 00:09:35.918785 (MainThread): Opening a new connection, currently in state init
2020-06-29 00:09:36.157085 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.sample_project.transforms
- models.sample_project.reports

2020-06-29 00:09:36.221130 (MainThread): Found 4 models, 8 tests, 0 snapshots, 0 analyses, 136 macros, 0 operations, 0 seed files, 4 sources
2020-06-29 00:09:36.222085 (MainThread): 
2020-06-29 00:09:36.222345 (MainThread): Acquiring new snowflake connection "master".
2020-06-29 00:09:36.222428 (MainThread): Opening a new connection, currently in state init
2020-06-29 00:09:36.227167 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_javen_testing".
2020-06-29 00:09:36.227266 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-06-29 00:09:36.243871 (ThreadPoolExecutor-0_0): Using snowflake connection "list_javen_testing".
2020-06-29 00:09:36.244029 (ThreadPoolExecutor-0_0): On list_javen_testing: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "snowflake-sso", "target_name": "dev", "connection_name": "list_javen_testing"} */

    show terse schemas in database javen_testing
    limit 10000
2020-06-29 00:09:36.723561 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/certifi/cacert.pem'>
2020-06-29 00:09:45.861085 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 9.62 seconds
2020-06-29 00:09:45.888675 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_javen_testing_test".
2020-06-29 00:09:45.888798 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_javen_testing).
2020-06-29 00:09:45.930624 (ThreadPoolExecutor-1_0): Using snowflake connection "list_javen_testing_test".
2020-06-29 00:09:45.930793 (ThreadPoolExecutor-1_0): On list_javen_testing_test: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "snowflake-sso", "target_name": "dev", "connection_name": "list_javen_testing_test"} */

    show terse objects in javen_testing.test
2020-06-29 00:09:46.135626 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 0.20 seconds
2020-06-29 00:09:46.139130 (MainThread): Acquiring new snowflake connection "master".
2020-06-29 00:09:46.139291 (MainThread): Opening a new connection, currently in state init
2020-06-29 00:09:46.139523 (MainThread): Using snowflake connection "master".
2020-06-29 00:09:46.139658 (MainThread): On master: BEGIN
2020-06-29 00:09:55.259878 (MainThread): SQL status: SUCCESS 1 in 9.12 seconds
2020-06-29 00:09:55.260922 (MainThread): On master: COMMIT
2020-06-29 00:09:55.261122 (MainThread): Using snowflake connection "master".
2020-06-29 00:09:55.261236 (MainThread): On master: COMMIT
2020-06-29 00:09:55.510209 (MainThread): SQL status: SUCCESS 1 in 0.25 seconds
2020-06-29 00:09:55.511091 (MainThread): 19:09:55 | Concurrency: 1 threads (target='dev')
2020-06-29 00:09:55.511334 (MainThread): 19:09:55 | 
2020-06-29 00:09:55.512633 (Thread-1): Began running node model.sample_project.customer
2020-06-29 00:09:55.514748 (Thread-1): 19:09:55 | 1 of 4 START table model test.customer............................... [RUN]
2020-06-29 00:09:55.515123 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-29 00:09:55.515242 (Thread-1): Re-using an available connection from the pool (formerly list_javen_testing_test).
2020-06-29 00:09:55.515386 (Thread-1): Compiling model.sample_project.customer
2020-06-29 00:09:55.536779 (Thread-1): Writing injected SQL for node "model.sample_project.customer"
2020-06-29 00:09:55.537219 (Thread-1): finished collecting timing info
2020-06-29 00:09:55.569625 (Thread-1): Writing runtime SQL for node "model.sample_project.customer"
2020-06-29 00:09:55.570604 (Thread-1): Using snowflake connection "model.sample_project.customer".
2020-06-29 00:09:55.570711 (Thread-1): On model.sample_project.customer: BEGIN
2020-06-29 00:09:55.829519 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2020-06-29 00:09:55.829750 (Thread-1): Using snowflake connection "model.sample_project.customer".
2020-06-29 00:09:55.829890 (Thread-1): On model.sample_project.customer: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "snowflake-sso", "target_name": "dev", "node_id": "model.sample_project.customer"} */


      create or replace transient table javen_testing.test.customer  as
      (/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select *
from snowflake_sample_data.tpch_sf1.customer
      );
2020-06-29 00:09:58.899265 (Thread-1): SQL status: SUCCESS 1 in 3.07 seconds
2020-06-29 00:09:58.900750 (Thread-1): On model.sample_project.customer: COMMIT
2020-06-29 00:09:58.900968 (Thread-1): Using snowflake connection "model.sample_project.customer".
2020-06-29 00:09:58.901086 (Thread-1): On model.sample_project.customer: COMMIT
2020-06-29 00:09:59.038373 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2020-06-29 00:09:59.049887 (Thread-1): finished collecting timing info
2020-06-29 00:09:59.050960 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2191e98f-e3bb-49de-a865-9934acc570a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e2c0710>]}
2020-06-29 00:09:59.052357 (Thread-1): 19:09:59 | 1 of 4 OK created table model test.customer.......................... [SUCCESS 1 in 3.54s]
2020-06-29 00:09:59.052523 (Thread-1): Finished running node model.sample_project.customer
2020-06-29 00:09:59.052672 (Thread-1): Began running node model.sample_project.lineitem
2020-06-29 00:09:59.053674 (Thread-1): 19:09:59 | 2 of 4 START table model test.lineitem............................... [RUN]
2020-06-29 00:09:59.054103 (Thread-1): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-29 00:09:59.054219 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer).
2020-06-29 00:09:59.054319 (Thread-1): Compiling model.sample_project.lineitem
2020-06-29 00:09:59.065323 (Thread-1): Writing injected SQL for node "model.sample_project.lineitem"
2020-06-29 00:09:59.065788 (Thread-1): finished collecting timing info
2020-06-29 00:09:59.069974 (Thread-1): Writing runtime SQL for node "model.sample_project.lineitem"
2020-06-29 00:09:59.070822 (Thread-1): Using snowflake connection "model.sample_project.lineitem".
2020-06-29 00:09:59.070928 (Thread-1): On model.sample_project.lineitem: BEGIN
2020-06-29 00:09:59.277310 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2020-06-29 00:09:59.277497 (Thread-1): Using snowflake connection "model.sample_project.lineitem".
2020-06-29 00:09:59.277598 (Thread-1): On model.sample_project.lineitem: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "snowflake-sso", "target_name": "dev", "node_id": "model.sample_project.lineitem"} */


      create or replace transient table javen_testing.test.lineitem  as
      (/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select *
from snowflake_sample_data.tpch_sf1.lineitem
      );
2020-06-29 00:10:06.524771 (Thread-1): SQL status: SUCCESS 1 in 7.25 seconds
2020-06-29 00:10:06.525773 (Thread-1): On model.sample_project.lineitem: COMMIT
2020-06-29 00:10:06.525919 (Thread-1): Using snowflake connection "model.sample_project.lineitem".
2020-06-29 00:10:06.526013 (Thread-1): On model.sample_project.lineitem: COMMIT
2020-06-29 00:10:06.701420 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2020-06-29 00:10:06.704644 (Thread-1): finished collecting timing info
2020-06-29 00:10:06.705416 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2191e98f-e3bb-49de-a865-9934acc570a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e362c50>]}
2020-06-29 00:10:06.706689 (Thread-1): 19:10:06 | 2 of 4 OK created table model test.lineitem.......................... [SUCCESS 1 in 7.65s]
2020-06-29 00:10:06.706853 (Thread-1): Finished running node model.sample_project.lineitem
2020-06-29 00:10:06.707019 (Thread-1): Began running node model.sample_project.nation
2020-06-29 00:10:06.708285 (Thread-1): 19:10:06 | 3 of 4 START table model test.nation................................. [RUN]
2020-06-29 00:10:06.708606 (Thread-1): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-29 00:10:06.708720 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.lineitem).
2020-06-29 00:10:06.708835 (Thread-1): Compiling model.sample_project.nation
2020-06-29 00:10:06.717489 (Thread-1): Writing injected SQL for node "model.sample_project.nation"
2020-06-29 00:10:06.717865 (Thread-1): finished collecting timing info
2020-06-29 00:10:06.721907 (Thread-1): Writing runtime SQL for node "model.sample_project.nation"
2020-06-29 00:10:06.722791 (Thread-1): Using snowflake connection "model.sample_project.nation".
2020-06-29 00:10:06.722985 (Thread-1): On model.sample_project.nation: BEGIN
2020-06-29 00:10:06.923761 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2020-06-29 00:10:06.924033 (Thread-1): Using snowflake connection "model.sample_project.nation".
2020-06-29 00:10:06.924206 (Thread-1): On model.sample_project.nation: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "snowflake-sso", "target_name": "dev", "node_id": "model.sample_project.nation"} */


      create or replace transient table javen_testing.test.nation  as
      (/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select *
from snowflake_sample_data.tpch_sf1.nation
      );
2020-06-29 00:10:08.784030 (Thread-1): SQL status: SUCCESS 1 in 1.86 seconds
2020-06-29 00:10:08.785139 (Thread-1): On model.sample_project.nation: COMMIT
2020-06-29 00:10:08.785309 (Thread-1): Using snowflake connection "model.sample_project.nation".
2020-06-29 00:10:08.785418 (Thread-1): On model.sample_project.nation: COMMIT
2020-06-29 00:10:08.950213 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2020-06-29 00:10:08.953825 (Thread-1): finished collecting timing info
2020-06-29 00:10:08.954696 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2191e98f-e3bb-49de-a865-9934acc570a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e2a4e10>]}
2020-06-29 00:10:08.956131 (Thread-1): 19:10:08 | 3 of 4 OK created table model test.nation............................ [SUCCESS 1 in 2.25s]
2020-06-29 00:10:08.956300 (Thread-1): Finished running node model.sample_project.nation
2020-06-29 00:10:08.956469 (Thread-1): Began running node model.sample_project.orders
2020-06-29 00:10:08.957687 (Thread-1): 19:10:08 | 4 of 4 START table model test.orders................................. [RUN]
2020-06-29 00:10:08.958114 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-29 00:10:08.958240 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.nation).
2020-06-29 00:10:08.958357 (Thread-1): Compiling model.sample_project.orders
2020-06-29 00:10:08.970114 (Thread-1): Writing injected SQL for node "model.sample_project.orders"
2020-06-29 00:10:08.970658 (Thread-1): finished collecting timing info
2020-06-29 00:10:08.976143 (Thread-1): Writing runtime SQL for node "model.sample_project.orders"
2020-06-29 00:10:08.977465 (Thread-1): Using snowflake connection "model.sample_project.orders".
2020-06-29 00:10:08.977615 (Thread-1): On model.sample_project.orders: BEGIN
2020-06-29 00:10:09.181426 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2020-06-29 00:10:09.181705 (Thread-1): Using snowflake connection "model.sample_project.orders".
2020-06-29 00:10:09.181877 (Thread-1): On model.sample_project.orders: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "snowflake-sso", "target_name": "dev", "node_id": "model.sample_project.orders"} */


      create or replace transient table javen_testing.test.orders  as
      (/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select *
from snowflake_sample_data.tpch_sf1.orders
      );
2020-06-29 00:10:12.256299 (Thread-1): SQL status: SUCCESS 1 in 3.07 seconds
2020-06-29 00:10:12.257388 (Thread-1): On model.sample_project.orders: COMMIT
2020-06-29 00:10:12.257559 (Thread-1): Using snowflake connection "model.sample_project.orders".
2020-06-29 00:10:12.257674 (Thread-1): On model.sample_project.orders: COMMIT
2020-06-29 00:10:12.410910 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2020-06-29 00:10:12.414244 (Thread-1): finished collecting timing info
2020-06-29 00:10:12.415124 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2191e98f-e3bb-49de-a865-9934acc570a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e226f50>]}
2020-06-29 00:10:12.416837 (Thread-1): 19:10:12 | 4 of 4 OK created table model test.orders............................ [SUCCESS 1 in 3.46s]
2020-06-29 00:10:12.417001 (Thread-1): Finished running node model.sample_project.orders
2020-06-29 00:10:12.450493 (MainThread): Using snowflake connection "master".
2020-06-29 00:10:12.450669 (MainThread): On master: BEGIN
2020-06-29 00:10:12.621657 (MainThread): SQL status: SUCCESS 1 in 0.17 seconds
2020-06-29 00:10:12.621941 (MainThread): On master: COMMIT
2020-06-29 00:10:12.622207 (MainThread): Using snowflake connection "master".
2020-06-29 00:10:12.622344 (MainThread): On master: COMMIT
2020-06-29 00:10:12.870456 (MainThread): SQL status: SUCCESS 1 in 0.25 seconds
2020-06-29 00:10:12.871093 (MainThread): 19:10:12 | 
2020-06-29 00:10:12.871347 (MainThread): 19:10:12 | Finished running 4 table models in 36.65s.
2020-06-29 00:10:12.871559 (MainThread): Connection 'master' was left open.
2020-06-29 00:10:12.871733 (MainThread): On master: Close
2020-06-29 00:10:13.427741 (MainThread): Connection 'model.sample_project.orders' was left open.
2020-06-29 00:10:13.427955 (MainThread): On model.sample_project.orders: Close
2020-06-29 00:10:13.688181 (MainThread): 
2020-06-29 00:10:13.688436 (MainThread): Completed successfully
2020-06-29 00:10:13.688618 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-06-29 00:10:13.688884 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e2a45d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db904d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e2ab110>]}
2020-06-29 00:10:13.689126 (MainThread): Flushing usage events
2020-06-29 19:19:17.038651 (MainThread): Running with dbt=0.17.0
2020-06-29 19:19:17.555415 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-06-29 19:19:17.557076 (MainThread): Tracking: tracking
2020-06-29 19:19:17.557416 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10628e090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062a0e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062a0dd0>]}
2020-06-29 19:19:17.582147 (MainThread): Partial parsing not enabled
2020-06-29 19:19:17.585394 (MainThread): Parsing macros/core.sql
2020-06-29 19:19:17.590779 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-29 19:19:17.603056 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-29 19:19:17.606107 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-29 19:19:17.627488 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-29 19:19:17.660302 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-29 19:19:17.682761 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-29 19:19:17.684937 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-29 19:19:17.691982 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-29 19:19:17.706815 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-29 19:19:17.714763 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-29 19:19:17.722889 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-29 19:19:17.729797 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-29 19:19:17.731215 (MainThread): Parsing macros/etc/query.sql
2020-06-29 19:19:17.732720 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-29 19:19:17.734957 (MainThread): Parsing macros/etc/datetime.sql
2020-06-29 19:19:17.745617 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-29 19:19:17.747954 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-29 19:19:17.750181 (MainThread): Parsing macros/adapters/common.sql
2020-06-29 19:19:17.803702 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-29 19:19:17.806578 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-29 19:19:17.808440 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-29 19:19:17.810413 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-29 19:19:17.814026 (MainThread): Parsing macros/catalog.sql
2020-06-29 19:19:17.816917 (MainThread): Parsing macros/adapters.sql
2020-06-29 19:19:17.842433 (MainThread): Parsing macros/materializations/merge.sql
2020-06-29 19:19:17.846669 (MainThread): Parsing macros/materializations/view.sql
2020-06-29 19:19:17.848819 (MainThread): Parsing macros/materializations/table.sql
2020-06-29 19:19:17.854930 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-29 19:19:17.885845 (MainThread): Partial parsing not enabled
2020-06-29 19:19:17.924567 (MainThread): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-29 19:19:17.924691 (MainThread): Opening a new connection, currently in state init
2020-06-29 19:19:17.954570 (MainThread): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-29 19:19:17.954704 (MainThread): Opening a new connection, currently in state init
2020-06-29 19:19:17.967715 (MainThread): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-29 19:19:17.967847 (MainThread): Opening a new connection, currently in state init
2020-06-29 19:19:17.979831 (MainThread): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-29 19:19:17.979923 (MainThread): Opening a new connection, currently in state init
2020-06-29 19:19:18.240436 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.sample_project.reports
- models.sample_project.transforms

2020-06-29 19:19:18.306414 (MainThread): Found 4 models, 8 tests, 0 snapshots, 0 analyses, 136 macros, 0 operations, 0 seed files, 4 sources
2020-06-29 19:19:18.307726 (MainThread): 
2020-06-29 19:19:18.308049 (MainThread): Acquiring new snowflake connection "master".
2020-06-29 19:19:18.308149 (MainThread): Opening a new connection, currently in state init
2020-06-29 19:19:18.313660 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_javen_testing".
2020-06-29 19:19:18.313777 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-06-29 19:19:18.333154 (ThreadPoolExecutor-0_0): Using snowflake connection "list_javen_testing".
2020-06-29 19:19:18.333380 (ThreadPoolExecutor-0_0): On list_javen_testing: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "snowflake-sso", "target_name": "dev", "connection_name": "list_javen_testing"} */

    show terse schemas in database javen_testing
    limit 10000
2020-06-29 19:19:18.903104 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/certifi/cacert.pem'>
2020-06-29 19:19:30.911947 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 12.58 seconds
2020-06-29 19:19:30.939873 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_javen_testing_test".
2020-06-29 19:19:30.940081 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_javen_testing).
2020-06-29 19:19:30.981023 (ThreadPoolExecutor-1_0): Using snowflake connection "list_javen_testing_test".
2020-06-29 19:19:30.981189 (ThreadPoolExecutor-1_0): On list_javen_testing_test: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "snowflake-sso", "target_name": "dev", "connection_name": "list_javen_testing_test"} */

    show terse objects in javen_testing.test
2020-06-29 19:19:31.212140 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 0.23 seconds
2020-06-29 19:19:31.220045 (MainThread): 14:19:31 | Concurrency: 1 threads (target='dev')
2020-06-29 19:19:31.220229 (MainThread): 14:19:31 | 
2020-06-29 19:19:31.221032 (Thread-1): Began running node model.sample_project.customer
2020-06-29 19:19:31.221383 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-29 19:19:31.221509 (Thread-1): Re-using an available connection from the pool (formerly list_javen_testing_test).
2020-06-29 19:19:31.221635 (Thread-1): Compiling model.sample_project.customer
2020-06-29 19:19:31.244131 (Thread-1): Writing injected SQL for node "model.sample_project.customer"
2020-06-29 19:19:31.245830 (Thread-1): finished collecting timing info
2020-06-29 19:19:31.246312 (Thread-1): finished collecting timing info
2020-06-29 19:19:31.246869 (Thread-1): Finished running node model.sample_project.customer
2020-06-29 19:19:31.247035 (Thread-1): Began running node model.sample_project.lineitem
2020-06-29 19:19:31.247338 (Thread-1): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-29 19:19:31.247450 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer).
2020-06-29 19:19:31.247558 (Thread-1): Compiling model.sample_project.lineitem
2020-06-29 19:19:31.257652 (Thread-1): Writing injected SQL for node "model.sample_project.lineitem"
2020-06-29 19:19:31.258090 (Thread-1): finished collecting timing info
2020-06-29 19:19:31.258384 (Thread-1): finished collecting timing info
2020-06-29 19:19:31.258810 (Thread-1): Finished running node model.sample_project.lineitem
2020-06-29 19:19:31.258967 (Thread-1): Began running node model.sample_project.nation
2020-06-29 19:19:31.259249 (Thread-1): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-29 19:19:31.259362 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.lineitem).
2020-06-29 19:19:31.259469 (Thread-1): Compiling model.sample_project.nation
2020-06-29 19:19:31.268098 (Thread-1): Writing injected SQL for node "model.sample_project.nation"
2020-06-29 19:19:31.268523 (Thread-1): finished collecting timing info
2020-06-29 19:19:31.268897 (Thread-1): finished collecting timing info
2020-06-29 19:19:31.269280 (Thread-1): Finished running node model.sample_project.nation
2020-06-29 19:19:31.269431 (Thread-1): Began running node model.sample_project.orders
2020-06-29 19:19:31.269831 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-29 19:19:31.270149 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.nation).
2020-06-29 19:19:31.270282 (Thread-1): Compiling model.sample_project.orders
2020-06-29 19:19:31.279583 (Thread-1): Writing injected SQL for node "model.sample_project.orders"
2020-06-29 19:19:31.280445 (Thread-1): finished collecting timing info
2020-06-29 19:19:31.280725 (Thread-1): finished collecting timing info
2020-06-29 19:19:31.281142 (Thread-1): Finished running node model.sample_project.orders
2020-06-29 19:19:31.281289 (Thread-1): Began running node test.sample_project.not_null_customer_id
2020-06-29 19:19:31.281545 (Thread-1): Acquiring new snowflake connection "test.sample_project.not_null_customer_id".
2020-06-29 19:19:31.281650 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders).
2020-06-29 19:19:31.281747 (Thread-1): Compiling test.sample_project.not_null_customer_id
2020-06-29 19:19:31.297035 (Thread-1): Writing injected SQL for node "test.sample_project.not_null_customer_id"
2020-06-29 19:19:31.297727 (Thread-1): finished collecting timing info
2020-06-29 19:19:31.298010 (Thread-1): finished collecting timing info
2020-06-29 19:19:31.298391 (Thread-1): Finished running node test.sample_project.not_null_customer_id
2020-06-29 19:19:31.298530 (Thread-1): Began running node test.sample_project.unique_customer_id
2020-06-29 19:19:31.298776 (Thread-1): Acquiring new snowflake connection "test.sample_project.unique_customer_id".
2020-06-29 19:19:31.298881 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.not_null_customer_id).
2020-06-29 19:19:31.298974 (Thread-1): Compiling test.sample_project.unique_customer_id
2020-06-29 19:19:31.308277 (Thread-1): Writing injected SQL for node "test.sample_project.unique_customer_id"
2020-06-29 19:19:31.308656 (Thread-1): finished collecting timing info
2020-06-29 19:19:31.308919 (Thread-1): finished collecting timing info
2020-06-29 19:19:31.309311 (Thread-1): Finished running node test.sample_project.unique_customer_id
2020-06-29 19:19:31.309452 (Thread-1): Began running node test.sample_project.not_null_lineitem_id
2020-06-29 19:19:31.309701 (Thread-1): Acquiring new snowflake connection "test.sample_project.not_null_lineitem_id".
2020-06-29 19:19:31.309801 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.unique_customer_id).
2020-06-29 19:19:31.309896 (Thread-1): Compiling test.sample_project.not_null_lineitem_id
2020-06-29 19:19:31.318499 (Thread-1): Writing injected SQL for node "test.sample_project.not_null_lineitem_id"
2020-06-29 19:19:31.318933 (Thread-1): finished collecting timing info
2020-06-29 19:19:31.319151 (Thread-1): finished collecting timing info
2020-06-29 19:19:31.319478 (Thread-1): Finished running node test.sample_project.not_null_lineitem_id
2020-06-29 19:19:31.319593 (Thread-1): Began running node test.sample_project.unique_lineitem_id
2020-06-29 19:19:31.319804 (Thread-1): Acquiring new snowflake connection "test.sample_project.unique_lineitem_id".
2020-06-29 19:19:31.319889 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.not_null_lineitem_id).
2020-06-29 19:19:31.319966 (Thread-1): Compiling test.sample_project.unique_lineitem_id
2020-06-29 19:19:31.327170 (Thread-1): Writing injected SQL for node "test.sample_project.unique_lineitem_id"
2020-06-29 19:19:31.327436 (Thread-1): finished collecting timing info
2020-06-29 19:19:31.327635 (Thread-1): finished collecting timing info
2020-06-29 19:19:31.327936 (Thread-1): Finished running node test.sample_project.unique_lineitem_id
2020-06-29 19:19:31.328050 (Thread-1): Began running node test.sample_project.not_null_nation_id
2020-06-29 19:19:31.328253 (Thread-1): Acquiring new snowflake connection "test.sample_project.not_null_nation_id".
2020-06-29 19:19:31.328335 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.unique_lineitem_id).
2020-06-29 19:19:31.328411 (Thread-1): Compiling test.sample_project.not_null_nation_id
2020-06-29 19:19:31.336189 (Thread-1): Writing injected SQL for node "test.sample_project.not_null_nation_id"
2020-06-29 19:19:31.336523 (Thread-1): finished collecting timing info
2020-06-29 19:19:31.336722 (Thread-1): finished collecting timing info
2020-06-29 19:19:31.337023 (Thread-1): Finished running node test.sample_project.not_null_nation_id
2020-06-29 19:19:31.337136 (Thread-1): Began running node test.sample_project.unique_nation_id
2020-06-29 19:19:31.337339 (Thread-1): Acquiring new snowflake connection "test.sample_project.unique_nation_id".
2020-06-29 19:19:31.337421 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.not_null_nation_id).
2020-06-29 19:19:31.337497 (Thread-1): Compiling test.sample_project.unique_nation_id
2020-06-29 19:19:31.345033 (Thread-1): Writing injected SQL for node "test.sample_project.unique_nation_id"
2020-06-29 19:19:31.345315 (Thread-1): finished collecting timing info
2020-06-29 19:19:31.345526 (Thread-1): finished collecting timing info
2020-06-29 19:19:31.345832 (Thread-1): Finished running node test.sample_project.unique_nation_id
2020-06-29 19:19:31.345948 (Thread-1): Began running node test.sample_project.not_null_orders_id
2020-06-29 19:19:31.346155 (Thread-1): Acquiring new snowflake connection "test.sample_project.not_null_orders_id".
2020-06-29 19:19:31.346238 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.unique_nation_id).
2020-06-29 19:19:31.346316 (Thread-1): Compiling test.sample_project.not_null_orders_id
2020-06-29 19:19:31.353625 (Thread-1): Writing injected SQL for node "test.sample_project.not_null_orders_id"
2020-06-29 19:19:31.353988 (Thread-1): finished collecting timing info
2020-06-29 19:19:31.354287 (Thread-1): finished collecting timing info
2020-06-29 19:19:31.354589 (Thread-1): Finished running node test.sample_project.not_null_orders_id
2020-06-29 19:19:31.354703 (Thread-1): Began running node test.sample_project.unique_orders_id
2020-06-29 19:19:31.354908 (Thread-1): Acquiring new snowflake connection "test.sample_project.unique_orders_id".
2020-06-29 19:19:31.354989 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.not_null_orders_id).
2020-06-29 19:19:31.355065 (Thread-1): Compiling test.sample_project.unique_orders_id
2020-06-29 19:19:31.362906 (Thread-1): Writing injected SQL for node "test.sample_project.unique_orders_id"
2020-06-29 19:19:31.363186 (Thread-1): finished collecting timing info
2020-06-29 19:19:31.363390 (Thread-1): finished collecting timing info
2020-06-29 19:19:31.363696 (Thread-1): Finished running node test.sample_project.unique_orders_id
2020-06-29 19:19:31.426001 (MainThread): Connection 'master' was properly closed.
2020-06-29 19:19:31.426191 (MainThread): Connection 'test.sample_project.unique_orders_id' was left open.
2020-06-29 19:19:31.426311 (MainThread): On test.sample_project.unique_orders_id: Close
2020-06-29 19:19:31.814137 (MainThread): 14:19:31 | Done.
2020-06-29 19:19:31.818668 (MainThread): Acquiring new snowflake connection "generate_catalog".
2020-06-29 19:19:31.818785 (MainThread): Opening a new connection, currently in state init
2020-06-29 19:19:31.818885 (MainThread): 14:19:31 | Building catalog
2020-06-29 19:19:31.879592 (ThreadPoolExecutor-2_0): Acquiring new snowflake connection "javen_testing.information_schema".
2020-06-29 19:19:31.879862 (ThreadPoolExecutor-2_0): Opening a new connection, currently in state init
2020-06-29 19:19:31.888028 (ThreadPoolExecutor-2_0): Using snowflake connection "javen_testing.information_schema".
2020-06-29 19:19:31.888141 (ThreadPoolExecutor-2_0): On javen_testing.information_schema: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "snowflake-sso", "target_name": "dev", "connection_name": "javen_testing.information_schema"} */

    
      with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include"

          from javen_testing.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              null as "table_comment",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              null as "column_comment"

          from javen_testing.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('test'))
      order by "column_index"
2020-06-29 19:19:45.439847 (ThreadPoolExecutor-2_0): SQL status: SUCCESS 44 in 13.55 seconds
2020-06-29 19:19:45.453473 (ThreadPoolExecutor-2_0): Acquiring new snowflake connection "snowflake_sample_data.information_schema".
2020-06-29 19:19:45.453589 (ThreadPoolExecutor-2_0): Re-using an available connection from the pool (formerly javen_testing.information_schema).
2020-06-29 19:19:45.457177 (ThreadPoolExecutor-2_0): Using snowflake connection "snowflake_sample_data.information_schema".
2020-06-29 19:19:45.457289 (ThreadPoolExecutor-2_0): On snowflake_sample_data.information_schema: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "snowflake-sso", "target_name": "dev", "connection_name": "snowflake_sample_data.information_schema"} */

    
      with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include"

          from snowflake_sample_data.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              null as "table_comment",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              null as "column_comment"

          from snowflake_sample_data.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('tpch_sf1'))
      order by "column_index"
2020-06-29 19:19:49.437798 (ThreadPoolExecutor-2_0): SQL status: SUCCESS 61 in 3.98 seconds
2020-06-29 19:19:49.555968 (MainThread): 14:19:49 | Catalog written to /Users/johnaven/Documents/gitlab_projects/dbt-demo-June-2020/sample_project/target/catalog.json
2020-06-29 19:19:49.556264 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e18f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e18ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106307950>]}
2020-06-29 19:19:49.556456 (MainThread): Flushing usage events
2020-06-29 19:19:49.951747 (MainThread): Connection 'generate_catalog' was properly closed.
2020-06-29 19:19:49.951946 (MainThread): Connection 'snowflake_sample_data.information_schema' was left open.
2020-06-29 19:19:49.952073 (MainThread): On snowflake_sample_data.information_schema: Close
2020-06-29 19:35:06.100653 (MainThread): Running with dbt=0.17.0
2020-06-29 19:35:06.579624 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-06-29 19:35:06.580630 (MainThread): Tracking: tracking
2020-06-29 19:35:06.580948 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f335d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f347f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f347e90>]}
2020-06-29 19:35:06.602883 (MainThread): Partial parsing not enabled
2020-06-29 19:35:06.605366 (MainThread): Parsing macros/core.sql
2020-06-29 19:35:06.610827 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-29 19:35:06.619482 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-29 19:35:06.622264 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-29 19:35:06.645600 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-29 19:35:06.679452 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-29 19:35:06.702762 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-29 19:35:06.704918 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-29 19:35:06.712267 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-29 19:35:06.727065 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-29 19:35:06.734725 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-29 19:35:06.741966 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-29 19:35:06.747757 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-29 19:35:06.748959 (MainThread): Parsing macros/etc/query.sql
2020-06-29 19:35:06.750318 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-29 19:35:06.752303 (MainThread): Parsing macros/etc/datetime.sql
2020-06-29 19:35:06.761854 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-29 19:35:06.764482 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-29 19:35:06.766370 (MainThread): Parsing macros/adapters/common.sql
2020-06-29 19:35:06.820137 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-29 19:35:06.821879 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-29 19:35:06.823165 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-29 19:35:06.824425 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-29 19:35:06.826998 (MainThread): Parsing macros/catalog.sql
2020-06-29 19:35:06.829117 (MainThread): Parsing macros/adapters.sql
2020-06-29 19:35:06.852424 (MainThread): Parsing macros/materializations/merge.sql
2020-06-29 19:35:06.854738 (MainThread): Parsing macros/materializations/view.sql
2020-06-29 19:35:06.856266 (MainThread): Parsing macros/materializations/table.sql
2020-06-29 19:35:06.860762 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-29 19:35:06.887940 (MainThread): Partial parsing not enabled
2020-06-29 19:35:06.925605 (MainThread): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-29 19:35:06.925725 (MainThread): Opening a new connection, currently in state init
2020-06-29 19:35:06.956413 (MainThread): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-29 19:35:06.956541 (MainThread): Opening a new connection, currently in state init
2020-06-29 19:35:06.969177 (MainThread): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-29 19:35:06.969314 (MainThread): Opening a new connection, currently in state init
2020-06-29 19:35:06.982600 (MainThread): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-29 19:35:06.982729 (MainThread): Opening a new connection, currently in state init
2020-06-29 19:35:06.993478 (MainThread): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-29 19:35:06.993563 (MainThread): Opening a new connection, currently in state init
2020-06-29 19:35:07.253301 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sample_project.reports

2020-06-29 19:35:07.326884 (MainThread): Found 5 models, 8 tests, 0 snapshots, 0 analyses, 136 macros, 0 operations, 0 seed files, 4 sources
2020-06-29 19:35:07.328259 (MainThread): 
2020-06-29 19:35:07.328573 (MainThread): Acquiring new snowflake connection "master".
2020-06-29 19:35:07.328676 (MainThread): Opening a new connection, currently in state init
2020-06-29 19:35:07.334344 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_javen_testing".
2020-06-29 19:35:07.334560 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-06-29 19:35:07.351227 (ThreadPoolExecutor-0_0): Using snowflake connection "list_javen_testing".
2020-06-29 19:35:07.351552 (ThreadPoolExecutor-0_0): On list_javen_testing: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "snowflake-sso", "target_name": "dev", "connection_name": "list_javen_testing"} */

    show terse schemas in database javen_testing
    limit 10000
2020-06-29 19:35:07.864730 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/certifi/cacert.pem'>
2020-06-29 19:35:39.378836 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 32.03 seconds
2020-06-29 19:35:39.449002 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_javen_testing_test".
2020-06-29 19:35:39.449248 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_javen_testing).
2020-06-29 19:35:39.457661 (ThreadPoolExecutor-1_0): Using snowflake connection "list_javen_testing_test".
2020-06-29 19:35:39.457786 (ThreadPoolExecutor-1_0): On list_javen_testing_test: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "snowflake-sso", "target_name": "dev", "connection_name": "list_javen_testing_test"} */

    show terse objects in javen_testing.test
2020-06-29 19:35:39.633945 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 0.18 seconds
2020-06-29 19:35:39.642058 (MainThread): 14:35:39 | Concurrency: 1 threads (target='dev')
2020-06-29 19:35:39.642262 (MainThread): 14:35:39 | 
2020-06-29 19:35:39.643166 (Thread-1): Began running node model.sample_project.customer
2020-06-29 19:35:39.643548 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-29 19:35:39.643686 (Thread-1): Re-using an available connection from the pool (formerly list_javen_testing_test).
2020-06-29 19:35:39.643820 (Thread-1): Compiling model.sample_project.customer
2020-06-29 19:35:39.668671 (Thread-1): Writing injected SQL for node "model.sample_project.customer"
2020-06-29 19:35:39.669315 (Thread-1): finished collecting timing info
2020-06-29 19:35:39.669734 (Thread-1): finished collecting timing info
2020-06-29 19:35:39.670288 (Thread-1): Finished running node model.sample_project.customer
2020-06-29 19:35:39.670478 (Thread-1): Began running node model.sample_project.lineitem
2020-06-29 19:35:39.670799 (Thread-1): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-29 19:35:39.670920 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer).
2020-06-29 19:35:39.671035 (Thread-1): Compiling model.sample_project.lineitem
2020-06-29 19:35:39.681668 (Thread-1): Writing injected SQL for node "model.sample_project.lineitem"
2020-06-29 19:35:39.682309 (Thread-1): finished collecting timing info
2020-06-29 19:35:39.682622 (Thread-1): finished collecting timing info
2020-06-29 19:35:39.683098 (Thread-1): Finished running node model.sample_project.lineitem
2020-06-29 19:35:39.683265 (Thread-1): Began running node model.sample_project.nation
2020-06-29 19:35:39.683561 (Thread-1): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-29 19:35:39.683678 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.lineitem).
2020-06-29 19:35:39.683789 (Thread-1): Compiling model.sample_project.nation
2020-06-29 19:35:39.692929 (Thread-1): Writing injected SQL for node "model.sample_project.nation"
2020-06-29 19:35:39.693659 (Thread-1): finished collecting timing info
2020-06-29 19:35:39.694026 (Thread-1): finished collecting timing info
2020-06-29 19:35:39.694535 (Thread-1): Finished running node model.sample_project.nation
2020-06-29 19:35:39.694709 (Thread-1): Began running node model.sample_project.orders
2020-06-29 19:35:39.695028 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-29 19:35:39.695147 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.nation).
2020-06-29 19:35:39.695263 (Thread-1): Compiling model.sample_project.orders
2020-06-29 19:35:39.706429 (Thread-1): Writing injected SQL for node "model.sample_project.orders"
2020-06-29 19:35:39.706915 (Thread-1): finished collecting timing info
2020-06-29 19:35:39.707205 (Thread-1): finished collecting timing info
2020-06-29 19:35:39.707656 (Thread-1): Finished running node model.sample_project.orders
2020-06-29 19:35:39.707819 (Thread-1): Began running node test.sample_project.not_null_customer_id
2020-06-29 19:35:39.708114 (Thread-1): Acquiring new snowflake connection "test.sample_project.not_null_customer_id".
2020-06-29 19:35:39.708233 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders).
2020-06-29 19:35:39.708341 (Thread-1): Compiling test.sample_project.not_null_customer_id
2020-06-29 19:35:39.725215 (Thread-1): Writing injected SQL for node "test.sample_project.not_null_customer_id"
2020-06-29 19:35:39.725665 (Thread-1): finished collecting timing info
2020-06-29 19:35:39.725921 (Thread-1): finished collecting timing info
2020-06-29 19:35:39.726303 (Thread-1): Finished running node test.sample_project.not_null_customer_id
2020-06-29 19:35:39.726442 (Thread-1): Began running node test.sample_project.unique_customer_id
2020-06-29 19:35:39.726689 (Thread-1): Acquiring new snowflake connection "test.sample_project.unique_customer_id".
2020-06-29 19:35:39.726789 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.not_null_customer_id).
2020-06-29 19:35:39.726882 (Thread-1): Compiling test.sample_project.unique_customer_id
2020-06-29 19:35:39.735351 (Thread-1): Writing injected SQL for node "test.sample_project.unique_customer_id"
2020-06-29 19:35:39.735703 (Thread-1): finished collecting timing info
2020-06-29 19:35:39.735940 (Thread-1): finished collecting timing info
2020-06-29 19:35:39.736297 (Thread-1): Finished running node test.sample_project.unique_customer_id
2020-06-29 19:35:39.736432 (Thread-1): Began running node test.sample_project.not_null_lineitem_id
2020-06-29 19:35:39.736674 (Thread-1): Acquiring new snowflake connection "test.sample_project.not_null_lineitem_id".
2020-06-29 19:35:39.736771 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.unique_customer_id).
2020-06-29 19:35:39.736862 (Thread-1): Compiling test.sample_project.not_null_lineitem_id
2020-06-29 19:35:39.746186 (Thread-1): Writing injected SQL for node "test.sample_project.not_null_lineitem_id"
2020-06-29 19:35:39.746628 (Thread-1): finished collecting timing info
2020-06-29 19:35:39.746950 (Thread-1): finished collecting timing info
2020-06-29 19:35:39.747344 (Thread-1): Finished running node test.sample_project.not_null_lineitem_id
2020-06-29 19:35:39.747526 (Thread-1): Began running node test.sample_project.unique_lineitem_id
2020-06-29 19:35:39.747805 (Thread-1): Acquiring new snowflake connection "test.sample_project.unique_lineitem_id".
2020-06-29 19:35:39.747905 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.not_null_lineitem_id).
2020-06-29 19:35:39.747998 (Thread-1): Compiling test.sample_project.unique_lineitem_id
2020-06-29 19:35:39.756506 (Thread-1): Writing injected SQL for node "test.sample_project.unique_lineitem_id"
2020-06-29 19:35:39.756831 (Thread-1): finished collecting timing info
2020-06-29 19:35:39.757080 (Thread-1): finished collecting timing info
2020-06-29 19:35:39.757449 (Thread-1): Finished running node test.sample_project.unique_lineitem_id
2020-06-29 19:35:39.757587 (Thread-1): Began running node model.sample_project.customer_nation
2020-06-29 19:35:39.757834 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-29 19:35:39.757933 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.unique_lineitem_id).
2020-06-29 19:35:39.758025 (Thread-1): Compiling model.sample_project.customer_nation
2020-06-29 19:35:39.765661 (Thread-1): Writing injected SQL for node "model.sample_project.customer_nation"
2020-06-29 19:35:39.766029 (Thread-1): finished collecting timing info
2020-06-29 19:35:39.766350 (Thread-1): Finished running node model.sample_project.customer_nation
2020-06-29 19:35:39.766464 (Thread-1): Began running node test.sample_project.not_null_nation_id
2020-06-29 19:35:39.766668 (Thread-1): Acquiring new snowflake connection "test.sample_project.not_null_nation_id".
2020-06-29 19:35:39.766750 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer_nation).
2020-06-29 19:35:39.766881 (Thread-1): Compiling test.sample_project.not_null_nation_id
2020-06-29 19:35:39.774387 (Thread-1): Writing injected SQL for node "test.sample_project.not_null_nation_id"
2020-06-29 19:35:39.774648 (Thread-1): finished collecting timing info
2020-06-29 19:35:39.774854 (Thread-1): finished collecting timing info
2020-06-29 19:35:39.775158 (Thread-1): Finished running node test.sample_project.not_null_nation_id
2020-06-29 19:35:39.775274 (Thread-1): Began running node test.sample_project.unique_nation_id
2020-06-29 19:35:39.775481 (Thread-1): Acquiring new snowflake connection "test.sample_project.unique_nation_id".
2020-06-29 19:35:39.775567 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.not_null_nation_id).
2020-06-29 19:35:39.775648 (Thread-1): Compiling test.sample_project.unique_nation_id
2020-06-29 19:35:39.783392 (Thread-1): Writing injected SQL for node "test.sample_project.unique_nation_id"
2020-06-29 19:35:39.783644 (Thread-1): finished collecting timing info
2020-06-29 19:35:39.783853 (Thread-1): finished collecting timing info
2020-06-29 19:35:39.784160 (Thread-1): Finished running node test.sample_project.unique_nation_id
2020-06-29 19:35:39.784275 (Thread-1): Began running node test.sample_project.not_null_orders_id
2020-06-29 19:35:39.784481 (Thread-1): Acquiring new snowflake connection "test.sample_project.not_null_orders_id".
2020-06-29 19:35:39.784564 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.unique_nation_id).
2020-06-29 19:35:39.784641 (Thread-1): Compiling test.sample_project.not_null_orders_id
2020-06-29 19:35:39.792231 (Thread-1): Writing injected SQL for node "test.sample_project.not_null_orders_id"
2020-06-29 19:35:39.792705 (Thread-1): finished collecting timing info
2020-06-29 19:35:39.792968 (Thread-1): finished collecting timing info
2020-06-29 19:35:39.793271 (Thread-1): Finished running node test.sample_project.not_null_orders_id
2020-06-29 19:35:39.793385 (Thread-1): Began running node test.sample_project.unique_orders_id
2020-06-29 19:35:39.793589 (Thread-1): Acquiring new snowflake connection "test.sample_project.unique_orders_id".
2020-06-29 19:35:39.793672 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.not_null_orders_id).
2020-06-29 19:35:39.793749 (Thread-1): Compiling test.sample_project.unique_orders_id
2020-06-29 19:35:39.801124 (Thread-1): Writing injected SQL for node "test.sample_project.unique_orders_id"
2020-06-29 19:35:39.801389 (Thread-1): finished collecting timing info
2020-06-29 19:35:39.801596 (Thread-1): finished collecting timing info
2020-06-29 19:35:39.801900 (Thread-1): Finished running node test.sample_project.unique_orders_id
2020-06-29 19:35:39.850921 (MainThread): Connection 'master' was properly closed.
2020-06-29 19:35:39.851309 (MainThread): Connection 'test.sample_project.unique_orders_id' was left open.
2020-06-29 19:35:39.851482 (MainThread): On test.sample_project.unique_orders_id: Close
2020-06-29 19:35:40.205708 (MainThread): 14:35:40 | Done.
2020-06-29 19:35:40.210533 (MainThread): Acquiring new snowflake connection "generate_catalog".
2020-06-29 19:35:40.210718 (MainThread): Opening a new connection, currently in state init
2020-06-29 19:35:40.210823 (MainThread): 14:35:40 | Building catalog
2020-06-29 19:35:40.273753 (ThreadPoolExecutor-2_0): Acquiring new snowflake connection "javen_testing.information_schema".
2020-06-29 19:35:40.273908 (ThreadPoolExecutor-2_0): Opening a new connection, currently in state init
2020-06-29 19:35:40.281657 (ThreadPoolExecutor-2_0): Using snowflake connection "javen_testing.information_schema".
2020-06-29 19:35:40.281870 (ThreadPoolExecutor-2_0): On javen_testing.information_schema: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "snowflake-sso", "target_name": "dev", "connection_name": "javen_testing.information_schema"} */

    
      with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include"

          from javen_testing.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              null as "table_comment",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              null as "column_comment"

          from javen_testing.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('test'))
      order by "column_index"
2020-06-29 19:35:52.051061 (ThreadPoolExecutor-2_0): SQL status: SUCCESS 44 in 11.77 seconds
2020-06-29 19:35:52.069575 (ThreadPoolExecutor-2_0): Acquiring new snowflake connection "snowflake_sample_data.information_schema".
2020-06-29 19:35:52.069817 (ThreadPoolExecutor-2_0): Re-using an available connection from the pool (formerly javen_testing.information_schema).
2020-06-29 19:35:52.074034 (ThreadPoolExecutor-2_0): Using snowflake connection "snowflake_sample_data.information_schema".
2020-06-29 19:35:52.074161 (ThreadPoolExecutor-2_0): On snowflake_sample_data.information_schema: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "snowflake-sso", "target_name": "dev", "connection_name": "snowflake_sample_data.information_schema"} */

    
      with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include"

          from snowflake_sample_data.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              null as "table_comment",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              null as "column_comment"

          from snowflake_sample_data.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('tpch_sf1'))
      order by "column_index"
2020-06-29 19:35:54.552516 (ThreadPoolExecutor-2_0): SQL status: SUCCESS 61 in 2.48 seconds
2020-06-29 19:35:54.670913 (MainThread): 14:35:54 | Catalog written to /Users/johnaven/Documents/gitlab_projects/dbt-demo-June-2020/sample_project/target/catalog.json
2020-06-29 19:35:54.671265 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0ca110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d95ca10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d95c910>]}
2020-06-29 19:35:54.671463 (MainThread): Flushing usage events
2020-06-29 19:35:55.069733 (MainThread): Connection 'generate_catalog' was properly closed.
2020-06-29 19:35:55.069949 (MainThread): Connection 'snowflake_sample_data.information_schema' was left open.
2020-06-29 19:35:55.070083 (MainThread): On snowflake_sample_data.information_schema: Close
2020-06-29 19:36:44.916743 (MainThread): Running with dbt=0.17.0
2020-06-29 19:36:45.432688 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', open_browser=True, partial_parse=None, port=8080, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-06-29 19:36:45.434615 (MainThread): Tracking: tracking
2020-06-29 19:36:45.434898 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4564d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a467e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a467d50>]}
2020-06-29 19:36:45.436800 (MainThread): Serving docs at 0.0.0.0:8080
2020-06-29 19:36:45.436936 (MainThread): To access from your browser, navigate to:  http://localhost:8080
2020-06-29 19:36:45.437022 (MainThread): Press Ctrl+C to exit.


2020-06-29 19:37:17.053576 (MainThread): Flushing usage events
2020-06-29 19:37:17.608307 (MainThread): ctrl-c
2020-06-29 19:37:23.441594 (MainThread): Running with dbt=0.17.0
2020-06-29 19:37:23.954379 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-06-29 19:37:23.955271 (MainThread): Tracking: tracking
2020-06-29 19:37:23.955587 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdbbd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d779ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d779e10>]}
2020-06-29 19:37:23.981011 (MainThread): Partial parsing not enabled
2020-06-29 19:37:23.983866 (MainThread): Parsing macros/core.sql
2020-06-29 19:37:23.989912 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-29 19:37:23.999769 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-29 19:37:24.002099 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-29 19:37:24.021890 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-29 19:37:24.059001 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-29 19:37:24.083880 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-29 19:37:24.086108 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-29 19:37:24.093355 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-29 19:37:24.107886 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-29 19:37:24.115572 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-29 19:37:24.123042 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-29 19:37:24.128942 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-29 19:37:24.130125 (MainThread): Parsing macros/etc/query.sql
2020-06-29 19:37:24.131574 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-29 19:37:24.133670 (MainThread): Parsing macros/etc/datetime.sql
2020-06-29 19:37:24.144474 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-29 19:37:24.146938 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-29 19:37:24.149074 (MainThread): Parsing macros/adapters/common.sql
2020-06-29 19:37:24.208085 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-29 19:37:24.209536 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-29 19:37:24.210946 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-29 19:37:24.212405 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-29 19:37:24.215126 (MainThread): Parsing macros/catalog.sql
2020-06-29 19:37:24.217259 (MainThread): Parsing macros/adapters.sql
2020-06-29 19:37:24.241786 (MainThread): Parsing macros/materializations/merge.sql
2020-06-29 19:37:24.246023 (MainThread): Parsing macros/materializations/view.sql
2020-06-29 19:37:24.248270 (MainThread): Parsing macros/materializations/table.sql
2020-06-29 19:37:24.253590 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-29 19:37:24.283235 (MainThread): Partial parsing not enabled
2020-06-29 19:37:24.321847 (MainThread): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-29 19:37:24.321979 (MainThread): Opening a new connection, currently in state init
2020-06-29 19:37:24.353006 (MainThread): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-29 19:37:24.353144 (MainThread): Opening a new connection, currently in state init
2020-06-29 19:37:24.365516 (MainThread): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-29 19:37:24.365649 (MainThread): Opening a new connection, currently in state init
2020-06-29 19:37:24.378294 (MainThread): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-29 19:37:24.378385 (MainThread): Opening a new connection, currently in state init
2020-06-29 19:37:24.390364 (MainThread): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-29 19:37:24.390454 (MainThread): Opening a new connection, currently in state init
2020-06-29 19:37:24.645473 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sample_project.reports

2020-06-29 19:37:24.712705 (MainThread): Found 5 models, 8 tests, 0 snapshots, 0 analyses, 136 macros, 0 operations, 0 seed files, 4 sources
2020-06-29 19:37:24.713923 (MainThread): 
2020-06-29 19:37:24.714223 (MainThread): Acquiring new snowflake connection "master".
2020-06-29 19:37:24.714322 (MainThread): Opening a new connection, currently in state init
2020-06-29 19:37:24.721207 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_javen_testing".
2020-06-29 19:37:24.721329 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-06-29 19:37:24.736373 (ThreadPoolExecutor-0_0): Using snowflake connection "list_javen_testing".
2020-06-29 19:37:24.736520 (ThreadPoolExecutor-0_0): On list_javen_testing: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "snowflake-sso", "target_name": "dev", "connection_name": "list_javen_testing"} */

    show terse schemas in database javen_testing
    limit 10000
2020-06-29 19:37:25.234757 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/certifi/cacert.pem'>
2020-06-29 19:37:36.526083 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 11.79 seconds
2020-06-29 19:37:36.598517 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_javen_testing_test".
2020-06-29 19:37:36.598759 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_javen_testing).
2020-06-29 19:37:36.607461 (ThreadPoolExecutor-1_0): Using snowflake connection "list_javen_testing_test".
2020-06-29 19:37:36.607595 (ThreadPoolExecutor-1_0): On list_javen_testing_test: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "snowflake-sso", "target_name": "dev", "connection_name": "list_javen_testing_test"} */

    show terse objects in javen_testing.test
2020-06-29 19:37:36.866106 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 0.26 seconds
2020-06-29 19:37:36.873498 (MainThread): Acquiring new snowflake connection "master".
2020-06-29 19:37:36.873635 (MainThread): Opening a new connection, currently in state init
2020-06-29 19:37:36.873836 (MainThread): Using snowflake connection "master".
2020-06-29 19:37:36.873951 (MainThread): On master: BEGIN
2020-06-29 19:37:46.351394 (MainThread): SQL status: SUCCESS 1 in 9.48 seconds
2020-06-29 19:37:46.351888 (MainThread): On master: COMMIT
2020-06-29 19:37:46.352158 (MainThread): Using snowflake connection "master".
2020-06-29 19:37:46.352273 (MainThread): On master: COMMIT
2020-06-29 19:37:46.761285 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2020-06-29 19:37:46.762135 (MainThread): 14:37:46 | Concurrency: 1 threads (target='dev')
2020-06-29 19:37:46.762370 (MainThread): 14:37:46 | 
2020-06-29 19:37:46.763682 (Thread-1): Began running node model.sample_project.customer
2020-06-29 19:37:46.765769 (Thread-1): 14:37:46 | 1 of 5 START table model test.customer............................... [RUN]
2020-06-29 19:37:46.766160 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-29 19:37:46.766280 (Thread-1): Re-using an available connection from the pool (formerly list_javen_testing_test).
2020-06-29 19:37:46.766416 (Thread-1): Compiling model.sample_project.customer
2020-06-29 19:37:46.792598 (Thread-1): Writing injected SQL for node "model.sample_project.customer"
2020-06-29 19:37:46.793970 (Thread-1): finished collecting timing info
2020-06-29 19:37:46.833340 (Thread-1): Writing runtime SQL for node "model.sample_project.customer"
2020-06-29 19:37:46.835631 (Thread-1): Using snowflake connection "model.sample_project.customer".
2020-06-29 19:37:46.835743 (Thread-1): On model.sample_project.customer: BEGIN
2020-06-29 19:37:47.167328 (Thread-1): SQL status: SUCCESS 1 in 0.33 seconds
2020-06-29 19:37:47.167597 (Thread-1): Using snowflake connection "model.sample_project.customer".
2020-06-29 19:37:47.167768 (Thread-1): On model.sample_project.customer: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "snowflake-sso", "target_name": "dev", "node_id": "model.sample_project.customer"} */


      create or replace transient table javen_testing.test.customer  as
      (/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select *
from snowflake_sample_data.tpch_sf1.customer
      );
2020-06-29 19:37:50.447420 (Thread-1): SQL status: SUCCESS 1 in 3.28 seconds
2020-06-29 19:37:50.449380 (Thread-1): On model.sample_project.customer: COMMIT
2020-06-29 19:37:50.449590 (Thread-1): Using snowflake connection "model.sample_project.customer".
2020-06-29 19:37:50.449736 (Thread-1): On model.sample_project.customer: COMMIT
2020-06-29 19:37:50.781375 (Thread-1): SQL status: SUCCESS 1 in 0.33 seconds
2020-06-29 19:37:50.794000 (Thread-1): finished collecting timing info
2020-06-29 19:37:50.795021 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40adcf0d-4593-4aeb-9139-2da253b83a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1b0f10>]}
2020-06-29 19:37:50.796398 (Thread-1): 14:37:50 | 1 of 5 OK created table model test.customer.......................... [SUCCESS 1 in 4.03s]
2020-06-29 19:37:50.796572 (Thread-1): Finished running node model.sample_project.customer
2020-06-29 19:37:50.796741 (Thread-1): Began running node model.sample_project.nation
2020-06-29 19:37:50.798070 (Thread-1): 14:37:50 | 2 of 5 START table model test.nation................................. [RUN]
2020-06-29 19:37:50.798392 (Thread-1): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-29 19:37:50.798506 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer).
2020-06-29 19:37:50.798618 (Thread-1): Compiling model.sample_project.nation
2020-06-29 19:37:50.807723 (Thread-1): Writing injected SQL for node "model.sample_project.nation"
2020-06-29 19:37:50.809681 (Thread-1): finished collecting timing info
2020-06-29 19:37:50.814639 (Thread-1): Writing runtime SQL for node "model.sample_project.nation"
2020-06-29 19:37:50.815526 (Thread-1): Using snowflake connection "model.sample_project.nation".
2020-06-29 19:37:50.815637 (Thread-1): On model.sample_project.nation: BEGIN
2020-06-29 19:37:51.129762 (Thread-1): SQL status: SUCCESS 1 in 0.31 seconds
2020-06-29 19:37:51.129922 (Thread-1): Using snowflake connection "model.sample_project.nation".
2020-06-29 19:37:51.130040 (Thread-1): On model.sample_project.nation: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "snowflake-sso", "target_name": "dev", "node_id": "model.sample_project.nation"} */


      create or replace transient table javen_testing.test.nation  as
      (/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select *
from snowflake_sample_data.tpch_sf1.nation
      );
2020-06-29 19:37:52.797220 (Thread-1): SQL status: SUCCESS 1 in 1.67 seconds
2020-06-29 19:37:52.798886 (Thread-1): On model.sample_project.nation: COMMIT
2020-06-29 19:37:52.799093 (Thread-1): Using snowflake connection "model.sample_project.nation".
2020-06-29 19:37:52.799231 (Thread-1): On model.sample_project.nation: COMMIT
2020-06-29 19:37:53.009003 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2020-06-29 19:37:53.012344 (Thread-1): finished collecting timing info
2020-06-29 19:37:53.013244 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40adcf0d-4593-4aeb-9139-2da253b83a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e190890>]}
2020-06-29 19:37:53.014702 (Thread-1): 14:37:53 | 2 of 5 OK created table model test.nation............................ [SUCCESS 1 in 2.21s]
2020-06-29 19:37:53.014869 (Thread-1): Finished running node model.sample_project.nation
2020-06-29 19:37:53.015033 (Thread-1): Began running node model.sample_project.lineitem
2020-06-29 19:37:53.016497 (Thread-1): 14:37:53 | 3 of 5 START table model test.lineitem............................... [RUN]
2020-06-29 19:37:53.016812 (Thread-1): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-29 19:37:53.016931 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.nation).
2020-06-29 19:37:53.017048 (Thread-1): Compiling model.sample_project.lineitem
2020-06-29 19:37:53.026571 (Thread-1): Writing injected SQL for node "model.sample_project.lineitem"
2020-06-29 19:37:53.027196 (Thread-1): finished collecting timing info
2020-06-29 19:37:53.034739 (Thread-1): Writing runtime SQL for node "model.sample_project.lineitem"
2020-06-29 19:37:53.036089 (Thread-1): Using snowflake connection "model.sample_project.lineitem".
2020-06-29 19:37:53.036238 (Thread-1): On model.sample_project.lineitem: BEGIN
2020-06-29 19:37:53.266213 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2020-06-29 19:37:53.266460 (Thread-1): Using snowflake connection "model.sample_project.lineitem".
2020-06-29 19:37:53.266596 (Thread-1): On model.sample_project.lineitem: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "snowflake-sso", "target_name": "dev", "node_id": "model.sample_project.lineitem"} */


      create or replace transient table javen_testing.test.lineitem  as
      (/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select *
from snowflake_sample_data.tpch_sf1.lineitem
      );
2020-06-29 19:37:59.906548 (Thread-1): SQL status: SUCCESS 1 in 6.64 seconds
2020-06-29 19:37:59.907661 (Thread-1): On model.sample_project.lineitem: COMMIT
2020-06-29 19:37:59.907839 (Thread-1): Using snowflake connection "model.sample_project.lineitem".
2020-06-29 19:37:59.907956 (Thread-1): On model.sample_project.lineitem: COMMIT
2020-06-29 19:38:00.091185 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2020-06-29 19:38:00.094603 (Thread-1): finished collecting timing info
2020-06-29 19:38:00.095514 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40adcf0d-4593-4aeb-9139-2da253b83a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e104750>]}
2020-06-29 19:38:00.097037 (Thread-1): 14:38:00 | 3 of 5 OK created table model test.lineitem.......................... [SUCCESS 1 in 7.08s]
2020-06-29 19:38:00.097213 (Thread-1): Finished running node model.sample_project.lineitem
2020-06-29 19:38:00.097443 (Thread-1): Began running node model.sample_project.orders
2020-06-29 19:38:00.098781 (Thread-1): 14:38:00 | 4 of 5 START table model test.orders................................. [RUN]
2020-06-29 19:38:00.099107 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-29 19:38:00.099221 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.lineitem).
2020-06-29 19:38:00.099332 (Thread-1): Compiling model.sample_project.orders
2020-06-29 19:38:00.108974 (Thread-1): Writing injected SQL for node "model.sample_project.orders"
2020-06-29 19:38:00.110165 (Thread-1): finished collecting timing info
2020-06-29 19:38:00.116804 (Thread-1): Writing runtime SQL for node "model.sample_project.orders"
2020-06-29 19:38:00.118285 (Thread-1): Using snowflake connection "model.sample_project.orders".
2020-06-29 19:38:00.118512 (Thread-1): On model.sample_project.orders: BEGIN
2020-06-29 19:38:00.369114 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2020-06-29 19:38:00.369370 (Thread-1): Using snowflake connection "model.sample_project.orders".
2020-06-29 19:38:00.369537 (Thread-1): On model.sample_project.orders: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "snowflake-sso", "target_name": "dev", "node_id": "model.sample_project.orders"} */


      create or replace transient table javen_testing.test.orders  as
      (/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select *
from snowflake_sample_data.tpch_sf1.orders
      );
2020-06-29 19:38:04.168657 (Thread-1): SQL status: SUCCESS 1 in 3.80 seconds
2020-06-29 19:38:04.170050 (Thread-1): On model.sample_project.orders: COMMIT
2020-06-29 19:38:04.170257 (Thread-1): Using snowflake connection "model.sample_project.orders".
2020-06-29 19:38:04.170395 (Thread-1): On model.sample_project.orders: COMMIT
2020-06-29 19:38:04.336402 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2020-06-29 19:38:04.339656 (Thread-1): finished collecting timing info
2020-06-29 19:38:04.340557 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40adcf0d-4593-4aeb-9139-2da253b83a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0a40d0>]}
2020-06-29 19:38:04.341895 (Thread-1): 14:38:04 | 4 of 5 OK created table model test.orders............................ [SUCCESS 1 in 4.24s]
2020-06-29 19:38:04.342065 (Thread-1): Finished running node model.sample_project.orders
2020-06-29 19:38:04.342233 (Thread-1): Began running node model.sample_project.customer_nation
2020-06-29 19:38:04.343452 (Thread-1): 14:38:04 | 5 of 5 START table model test.customer_nation........................ [RUN]
2020-06-29 19:38:04.343776 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-29 19:38:04.343899 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders).
2020-06-29 19:38:04.344020 (Thread-1): Compiling model.sample_project.customer_nation
2020-06-29 19:38:04.354325 (Thread-1): Writing injected SQL for node "model.sample_project.customer_nation"
2020-06-29 19:38:04.355902 (Thread-1): finished collecting timing info
2020-06-29 19:38:04.363713 (Thread-1): Writing runtime SQL for node "model.sample_project.customer_nation"
2020-06-29 19:38:04.365300 (Thread-1): Using snowflake connection "model.sample_project.customer_nation".
2020-06-29 19:38:04.365440 (Thread-1): On model.sample_project.customer_nation: BEGIN
2020-06-29 19:38:04.553798 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2020-06-29 19:38:04.554057 (Thread-1): Using snowflake connection "model.sample_project.customer_nation".
2020-06-29 19:38:04.554230 (Thread-1): On model.sample_project.customer_nation: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "snowflake-sso", "target_name": "dev", "node_id": "model.sample_project.customer_nation"} */


      create or replace transient table javen_testing.test.customer_nation  as
      (/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select *
from javen_testing.test.customer, javen_testing.test.nation
ON nation_key
      );
2020-06-29 19:38:04.823726 (Thread-1): Snowflake query id: 01953cda-02f6-a0c7-0000-2aed011c96a6
2020-06-29 19:38:04.823971 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 20 at position 0 unexpected 'ON'.
syntax error line 20 at position 3 unexpected 'nation_key'.
2020-06-29 19:38:04.824125 (Thread-1): On model.sample_project.customer_nation: ROLLBACK
2020-06-29 19:38:04.824250 (Thread-1): initiating rollback
2020-06-29 19:38:05.105303 (Thread-1): finished collecting timing info
2020-06-29 19:38:05.105965 (Thread-1): Database Error in model customer_nation (models/transforms/customer_nation.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 0 unexpected 'ON'.
  syntax error line 20 at position 3 unexpected 'nation_key'.
  compiled SQL at target/run/sample_project/models/transforms/customer_nation.sql
Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 158, in exception_handler
    yield
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/cursor.py", line 597, in execute
    errvalue)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/errors.py", line 97, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, errorclass, errorvalue)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/errors.py", line 73, in default_errorhandler
    done_format_msg=errorvalue.get(u'done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 20 at position 0 unexpected 'ON'.
syntax error line 20 at position 3 unexpected 'nation_key'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 119, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 306, in add_query
    abridge_sql_log=abridge_sql_log
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/usr/local/opt/python/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 177, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model customer_nation (models/transforms/customer_nation.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 0 unexpected 'ON'.
  syntax error line 20 at position 3 unexpected 'nation_key'.
  compiled SQL at target/run/sample_project/models/transforms/customer_nation.sql
2020-06-29 19:38:05.118198 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40adcf0d-4593-4aeb-9139-2da253b83a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df38c90>]}
2020-06-29 19:38:05.119504 (Thread-1): 14:38:05 | 5 of 5 ERROR creating table model test.customer_nation............... [ERROR in 0.77s]
2020-06-29 19:38:05.119668 (Thread-1): Finished running node model.sample_project.customer_nation
2020-06-29 19:38:05.182393 (MainThread): Using snowflake connection "master".
2020-06-29 19:38:05.182722 (MainThread): On master: BEGIN
2020-06-29 19:38:05.471159 (MainThread): SQL status: SUCCESS 1 in 0.29 seconds
2020-06-29 19:38:05.471437 (MainThread): On master: COMMIT
2020-06-29 19:38:05.471676 (MainThread): Using snowflake connection "master".
2020-06-29 19:38:05.471838 (MainThread): On master: COMMIT
2020-06-29 19:38:05.783406 (MainThread): SQL status: SUCCESS 1 in 0.31 seconds
2020-06-29 19:38:05.783866 (MainThread): 14:38:05 | 
2020-06-29 19:38:05.784029 (MainThread): 14:38:05 | Finished running 5 table models in 41.07s.
2020-06-29 19:38:05.784163 (MainThread): Connection 'master' was left open.
2020-06-29 19:38:05.784273 (MainThread): On master: Close
2020-06-29 19:38:06.061537 (MainThread): Connection 'model.sample_project.customer_nation' was left open.
2020-06-29 19:38:06.061748 (MainThread): On model.sample_project.customer_nation: Close
2020-06-29 19:38:06.340863 (MainThread): 
2020-06-29 19:38:06.341034 (MainThread): Completed with 1 error and 0 warnings:
2020-06-29 19:38:06.341155 (MainThread): 
2020-06-29 19:38:06.341270 (MainThread): Database Error in model customer_nation (models/transforms/customer_nation.sql)
2020-06-29 19:38:06.341383 (MainThread):   001003 (42000): SQL compilation error:
2020-06-29 19:38:06.341500 (MainThread):   syntax error line 20 at position 0 unexpected 'ON'.
2020-06-29 19:38:06.341596 (MainThread):   syntax error line 20 at position 3 unexpected 'nation_key'.
2020-06-29 19:38:06.341693 (MainThread):   compiled SQL at target/run/sample_project/models/transforms/customer_nation.sql
2020-06-29 19:38:06.341802 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2020-06-29 19:38:06.342002 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df5e050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e216fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d747690>]}
2020-06-29 19:38:06.342193 (MainThread): Flushing usage events
2020-06-29 19:41:46.900493 (MainThread): Running with dbt=0.17.0
2020-06-29 19:41:47.365229 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-06-29 19:41:47.366734 (MainThread): Tracking: tracking
2020-06-29 19:41:47.367018 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a084d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c059e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0593d0>]}
2020-06-29 19:41:47.394268 (MainThread): Partial parsing not enabled
2020-06-29 19:41:47.396819 (MainThread): Parsing macros/core.sql
2020-06-29 19:41:47.402885 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-29 19:41:47.412330 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-29 19:41:47.414942 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-29 19:41:47.435194 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-29 19:41:47.470645 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-29 19:41:47.495039 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-29 19:41:47.497621 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-29 19:41:47.505525 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-29 19:41:47.522579 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-29 19:41:47.533099 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-29 19:41:47.543405 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-29 19:41:47.550926 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-29 19:41:47.552239 (MainThread): Parsing macros/etc/query.sql
2020-06-29 19:41:47.553761 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-29 19:41:47.555982 (MainThread): Parsing macros/etc/datetime.sql
2020-06-29 19:41:47.567375 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-29 19:41:47.569965 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-29 19:41:47.572280 (MainThread): Parsing macros/adapters/common.sql
2020-06-29 19:41:47.630897 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-29 19:41:47.632461 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-29 19:41:47.633743 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-29 19:41:47.635114 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-29 19:41:47.637842 (MainThread): Parsing macros/catalog.sql
2020-06-29 19:41:47.640901 (MainThread): Parsing macros/adapters.sql
2020-06-29 19:41:47.671843 (MainThread): Parsing macros/materializations/merge.sql
2020-06-29 19:41:47.675344 (MainThread): Parsing macros/materializations/view.sql
2020-06-29 19:41:47.676903 (MainThread): Parsing macros/materializations/table.sql
2020-06-29 19:41:47.682068 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-29 19:41:47.713919 (MainThread): Partial parsing not enabled
2020-06-29 19:41:47.756882 (MainThread): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-29 19:41:47.757022 (MainThread): Opening a new connection, currently in state init
2020-06-29 19:41:47.790810 (MainThread): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-29 19:41:47.790936 (MainThread): Opening a new connection, currently in state init
2020-06-29 19:41:47.803927 (MainThread): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-29 19:41:47.804030 (MainThread): Opening a new connection, currently in state init
2020-06-29 19:41:47.816610 (MainThread): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-29 19:41:47.816733 (MainThread): Opening a new connection, currently in state init
2020-06-29 19:41:47.833038 (MainThread): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-29 19:41:47.833171 (MainThread): Opening a new connection, currently in state init
2020-06-29 19:41:48.103842 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sample_project.reports

2020-06-29 19:41:48.173487 (MainThread): Found 5 models, 8 tests, 0 snapshots, 0 analyses, 136 macros, 0 operations, 0 seed files, 4 sources
2020-06-29 19:41:48.174720 (MainThread): 
2020-06-29 19:41:48.175029 (MainThread): Acquiring new snowflake connection "master".
2020-06-29 19:41:48.175128 (MainThread): Opening a new connection, currently in state init
2020-06-29 19:41:48.182367 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_javen_testing".
2020-06-29 19:41:48.182502 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-06-29 19:41:48.200285 (ThreadPoolExecutor-0_0): Using snowflake connection "list_javen_testing".
2020-06-29 19:41:48.200430 (ThreadPoolExecutor-0_0): On list_javen_testing: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "snowflake-sso", "target_name": "dev", "connection_name": "list_javen_testing"} */

    show terse schemas in database javen_testing
    limit 10000
2020-06-29 19:41:48.714705 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/certifi/cacert.pem'>
2020-06-29 19:41:57.330975 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 9.13 seconds
2020-06-29 19:41:57.401170 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_javen_testing_test".
2020-06-29 19:41:57.401405 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_javen_testing).
2020-06-29 19:41:57.409658 (ThreadPoolExecutor-1_0): Using snowflake connection "list_javen_testing_test".
2020-06-29 19:41:57.409778 (ThreadPoolExecutor-1_0): On list_javen_testing_test: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "snowflake-sso", "target_name": "dev", "connection_name": "list_javen_testing_test"} */

    show terse objects in javen_testing.test
2020-06-29 19:41:57.634979 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 0.23 seconds
2020-06-29 19:41:57.643011 (MainThread): Acquiring new snowflake connection "master".
2020-06-29 19:41:57.643149 (MainThread): Opening a new connection, currently in state init
2020-06-29 19:41:57.643348 (MainThread): Using snowflake connection "master".
2020-06-29 19:41:57.643463 (MainThread): On master: BEGIN
2020-06-29 19:42:07.677208 (MainThread): SQL status: SUCCESS 1 in 10.03 seconds
2020-06-29 19:42:07.677716 (MainThread): On master: COMMIT
2020-06-29 19:42:07.678015 (MainThread): Using snowflake connection "master".
2020-06-29 19:42:07.678189 (MainThread): On master: COMMIT
2020-06-29 19:42:08.090735 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2020-06-29 19:42:08.091501 (MainThread): 14:42:08 | Concurrency: 1 threads (target='dev')
2020-06-29 19:42:08.091686 (MainThread): 14:42:08 | 
2020-06-29 19:42:08.092617 (Thread-1): Began running node model.sample_project.customer
2020-06-29 19:42:08.094230 (Thread-1): 14:42:08 | 1 of 5 START table model test.customer............................... [RUN]
2020-06-29 19:42:08.094576 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-29 19:42:08.094680 (Thread-1): Re-using an available connection from the pool (formerly list_javen_testing_test).
2020-06-29 19:42:08.094805 (Thread-1): Compiling model.sample_project.customer
2020-06-29 19:42:08.118800 (Thread-1): Writing injected SQL for node "model.sample_project.customer"
2020-06-29 19:42:08.120048 (Thread-1): finished collecting timing info
2020-06-29 19:42:08.161282 (Thread-1): Writing runtime SQL for node "model.sample_project.customer"
2020-06-29 19:42:08.162338 (Thread-1): Using snowflake connection "model.sample_project.customer".
2020-06-29 19:42:08.162460 (Thread-1): On model.sample_project.customer: BEGIN
2020-06-29 19:42:08.503435 (Thread-1): SQL status: SUCCESS 1 in 0.34 seconds
2020-06-29 19:42:08.503606 (Thread-1): Using snowflake connection "model.sample_project.customer".
2020-06-29 19:42:08.503714 (Thread-1): On model.sample_project.customer: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "snowflake-sso", "target_name": "dev", "node_id": "model.sample_project.customer"} */


      create or replace transient table javen_testing.test.customer  as
      (/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select *
from snowflake_sample_data.tpch_sf1.customer
      );
2020-06-29 19:42:12.398724 (Thread-1): SQL status: SUCCESS 1 in 3.89 seconds
2020-06-29 19:42:12.400716 (Thread-1): On model.sample_project.customer: COMMIT
2020-06-29 19:42:12.400929 (Thread-1): Using snowflake connection "model.sample_project.customer".
2020-06-29 19:42:12.401063 (Thread-1): On model.sample_project.customer: COMMIT
2020-06-29 19:42:12.549137 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2020-06-29 19:42:12.558751 (Thread-1): finished collecting timing info
2020-06-29 19:42:12.559688 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e41252ae-399c-4aa1-80b7-694f6e863221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4540d0>]}
2020-06-29 19:42:12.560946 (Thread-1): 14:42:12 | 1 of 5 OK created table model test.customer.......................... [SUCCESS 1 in 4.46s]
2020-06-29 19:42:12.561119 (Thread-1): Finished running node model.sample_project.customer
2020-06-29 19:42:12.561275 (Thread-1): Began running node model.sample_project.nation
2020-06-29 19:42:12.562552 (Thread-1): 14:42:12 | 2 of 5 START table model test.nation................................. [RUN]
2020-06-29 19:42:12.562856 (Thread-1): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-29 19:42:12.562951 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer).
2020-06-29 19:42:12.563047 (Thread-1): Compiling model.sample_project.nation
2020-06-29 19:42:12.573842 (Thread-1): Writing injected SQL for node "model.sample_project.nation"
2020-06-29 19:42:12.575222 (Thread-1): finished collecting timing info
2020-06-29 19:42:12.581383 (Thread-1): Writing runtime SQL for node "model.sample_project.nation"
2020-06-29 19:42:12.582431 (Thread-1): Using snowflake connection "model.sample_project.nation".
2020-06-29 19:42:12.582559 (Thread-1): On model.sample_project.nation: BEGIN
2020-06-29 19:42:12.782711 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2020-06-29 19:42:12.782882 (Thread-1): Using snowflake connection "model.sample_project.nation".
2020-06-29 19:42:12.782979 (Thread-1): On model.sample_project.nation: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "snowflake-sso", "target_name": "dev", "node_id": "model.sample_project.nation"} */


      create or replace transient table javen_testing.test.nation  as
      (/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select *
from snowflake_sample_data.tpch_sf1.nation
      );
2020-06-29 19:42:14.444004 (Thread-1): SQL status: SUCCESS 1 in 1.66 seconds
2020-06-29 19:42:14.445213 (Thread-1): On model.sample_project.nation: COMMIT
2020-06-29 19:42:14.445385 (Thread-1): Using snowflake connection "model.sample_project.nation".
2020-06-29 19:42:14.445494 (Thread-1): On model.sample_project.nation: COMMIT
2020-06-29 19:42:14.869961 (Thread-1): SQL status: SUCCESS 1 in 0.42 seconds
2020-06-29 19:42:14.873256 (Thread-1): finished collecting timing info
2020-06-29 19:42:14.874123 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e41252ae-399c-4aa1-80b7-694f6e863221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4d6c50>]}
2020-06-29 19:42:14.875618 (Thread-1): 14:42:14 | 2 of 5 OK created table model test.nation............................ [SUCCESS 1 in 2.31s]
2020-06-29 19:42:14.875790 (Thread-1): Finished running node model.sample_project.nation
2020-06-29 19:42:14.875958 (Thread-1): Began running node model.sample_project.lineitem
2020-06-29 19:42:14.877590 (Thread-1): 14:42:14 | 3 of 5 START table model test.lineitem............................... [RUN]
2020-06-29 19:42:14.877929 (Thread-1): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-29 19:42:14.878055 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.nation).
2020-06-29 19:42:14.878306 (Thread-1): Compiling model.sample_project.lineitem
2020-06-29 19:42:14.888057 (Thread-1): Writing injected SQL for node "model.sample_project.lineitem"
2020-06-29 19:42:14.888603 (Thread-1): finished collecting timing info
2020-06-29 19:42:14.893897 (Thread-1): Writing runtime SQL for node "model.sample_project.lineitem"
2020-06-29 19:42:14.894985 (Thread-1): Using snowflake connection "model.sample_project.lineitem".
2020-06-29 19:42:14.895124 (Thread-1): On model.sample_project.lineitem: BEGIN
2020-06-29 19:42:15.254417 (Thread-1): SQL status: SUCCESS 1 in 0.36 seconds
2020-06-29 19:42:15.254671 (Thread-1): Using snowflake connection "model.sample_project.lineitem".
2020-06-29 19:42:15.254834 (Thread-1): On model.sample_project.lineitem: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "snowflake-sso", "target_name": "dev", "node_id": "model.sample_project.lineitem"} */


      create or replace transient table javen_testing.test.lineitem  as
      (/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select *
from snowflake_sample_data.tpch_sf1.lineitem
      );
2020-06-29 19:42:21.334463 (Thread-1): SQL status: SUCCESS 1 in 6.08 seconds
2020-06-29 19:42:21.336058 (Thread-1): On model.sample_project.lineitem: COMMIT
2020-06-29 19:42:21.336316 (Thread-1): Using snowflake connection "model.sample_project.lineitem".
2020-06-29 19:42:21.336447 (Thread-1): On model.sample_project.lineitem: COMMIT
2020-06-29 19:42:21.541581 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2020-06-29 19:42:21.544730 (Thread-1): finished collecting timing info
2020-06-29 19:42:21.545612 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e41252ae-399c-4aa1-80b7-694f6e863221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3a5150>]}
2020-06-29 19:42:21.546962 (Thread-1): 14:42:21 | 3 of 5 OK created table model test.lineitem.......................... [SUCCESS 1 in 6.67s]
2020-06-29 19:42:21.547127 (Thread-1): Finished running node model.sample_project.lineitem
2020-06-29 19:42:21.547297 (Thread-1): Began running node model.sample_project.orders
2020-06-29 19:42:21.548503 (Thread-1): 14:42:21 | 4 of 5 START table model test.orders................................. [RUN]
2020-06-29 19:42:21.548916 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-29 19:42:21.549039 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.lineitem).
2020-06-29 19:42:21.549152 (Thread-1): Compiling model.sample_project.orders
2020-06-29 19:42:21.557997 (Thread-1): Writing injected SQL for node "model.sample_project.orders"
2020-06-29 19:42:21.559514 (Thread-1): finished collecting timing info
2020-06-29 19:42:21.564000 (Thread-1): Writing runtime SQL for node "model.sample_project.orders"
2020-06-29 19:42:21.564842 (Thread-1): Using snowflake connection "model.sample_project.orders".
2020-06-29 19:42:21.564964 (Thread-1): On model.sample_project.orders: BEGIN
2020-06-29 19:42:21.844368 (Thread-1): SQL status: SUCCESS 1 in 0.28 seconds
2020-06-29 19:42:21.844633 (Thread-1): Using snowflake connection "model.sample_project.orders".
2020-06-29 19:42:21.844802 (Thread-1): On model.sample_project.orders: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "snowflake-sso", "target_name": "dev", "node_id": "model.sample_project.orders"} */


      create or replace transient table javen_testing.test.orders  as
      (/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select *
from snowflake_sample_data.tpch_sf1.orders
      );
2020-06-29 19:42:25.085016 (Thread-1): SQL status: SUCCESS 1 in 3.24 seconds
2020-06-29 19:42:25.086604 (Thread-1): On model.sample_project.orders: COMMIT
2020-06-29 19:42:25.086867 (Thread-1): Using snowflake connection "model.sample_project.orders".
2020-06-29 19:42:25.087000 (Thread-1): On model.sample_project.orders: COMMIT
2020-06-29 19:42:25.251532 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2020-06-29 19:42:25.254495 (Thread-1): finished collecting timing info
2020-06-29 19:42:25.255267 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e41252ae-399c-4aa1-80b7-694f6e863221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c34f050>]}
2020-06-29 19:42:25.256575 (Thread-1): 14:42:25 | 4 of 5 OK created table model test.orders............................ [SUCCESS 1 in 3.71s]
2020-06-29 19:42:25.256740 (Thread-1): Finished running node model.sample_project.orders
2020-06-29 19:42:25.256904 (Thread-1): Began running node model.sample_project.customer_nation
2020-06-29 19:42:25.258184 (Thread-1): 14:42:25 | 5 of 5 START table model test.customer_nation........................ [RUN]
2020-06-29 19:42:25.258511 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-29 19:42:25.258627 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders).
2020-06-29 19:42:25.258739 (Thread-1): Compiling model.sample_project.customer_nation
2020-06-29 19:42:25.268871 (Thread-1): Writing injected SQL for node "model.sample_project.customer_nation"
2020-06-29 19:42:25.269333 (Thread-1): finished collecting timing info
2020-06-29 19:42:25.278415 (Thread-1): Writing runtime SQL for node "model.sample_project.customer_nation"
2020-06-29 19:42:25.280559 (Thread-1): Using snowflake connection "model.sample_project.customer_nation".
2020-06-29 19:42:25.280692 (Thread-1): On model.sample_project.customer_nation: BEGIN
2020-06-29 19:42:25.529946 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2020-06-29 19:42:25.530205 (Thread-1): Using snowflake connection "model.sample_project.customer_nation".
2020-06-29 19:42:25.530373 (Thread-1): On model.sample_project.customer_nation: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "snowflake-sso", "target_name": "dev", "node_id": "model.sample_project.customer_nation"} */


      create or replace transient table javen_testing.test.customer_nation  as
      (/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select *
from javen_testing.test.customer, javen_testing.test.nation
ON nationkey
      );
2020-06-29 19:42:25.734720 (Thread-1): Snowflake query id: 01953cde-0240-62b0-0000-2aed011cb222
2020-06-29 19:42:25.734975 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 20 at position 0 unexpected 'ON'.
syntax error line 20 at position 3 unexpected 'nationkey'.
2020-06-29 19:42:25.735137 (Thread-1): On model.sample_project.customer_nation: ROLLBACK
2020-06-29 19:42:25.735258 (Thread-1): initiating rollback
2020-06-29 19:42:25.982284 (Thread-1): finished collecting timing info
2020-06-29 19:42:25.982870 (Thread-1): Database Error in model customer_nation (models/transforms/customer_nation.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 0 unexpected 'ON'.
  syntax error line 20 at position 3 unexpected 'nationkey'.
  compiled SQL at target/run/sample_project/models/transforms/customer_nation.sql
Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 158, in exception_handler
    yield
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/cursor.py", line 597, in execute
    errvalue)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/errors.py", line 97, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, errorclass, errorvalue)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/errors.py", line 73, in default_errorhandler
    done_format_msg=errorvalue.get(u'done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 20 at position 0 unexpected 'ON'.
syntax error line 20 at position 3 unexpected 'nationkey'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 119, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 306, in add_query
    abridge_sql_log=abridge_sql_log
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/usr/local/opt/python/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 177, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model customer_nation (models/transforms/customer_nation.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 0 unexpected 'ON'.
  syntax error line 20 at position 3 unexpected 'nationkey'.
  compiled SQL at target/run/sample_project/models/transforms/customer_nation.sql
2020-06-29 19:42:25.992867 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e41252ae-399c-4aa1-80b7-694f6e863221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2cc9d0>]}
2020-06-29 19:42:25.994335 (Thread-1): 14:42:25 | 5 of 5 ERROR creating table model test.customer_nation............... [ERROR in 0.73s]
2020-06-29 19:42:25.994578 (Thread-1): Finished running node model.sample_project.customer_nation
2020-06-29 19:42:26.047609 (MainThread): Using snowflake connection "master".
2020-06-29 19:42:26.047894 (MainThread): On master: BEGIN
2020-06-29 19:42:26.219379 (MainThread): SQL status: SUCCESS 1 in 0.17 seconds
2020-06-29 19:42:26.219569 (MainThread): On master: COMMIT
2020-06-29 19:42:26.219706 (MainThread): Using snowflake connection "master".
2020-06-29 19:42:26.219798 (MainThread): On master: COMMIT
2020-06-29 19:42:26.583819 (MainThread): SQL status: SUCCESS 1 in 0.36 seconds
2020-06-29 19:42:26.584454 (MainThread): 14:42:26 | 
2020-06-29 19:42:26.584699 (MainThread): 14:42:26 | Finished running 5 table models in 38.41s.
2020-06-29 19:42:26.584901 (MainThread): Connection 'master' was left open.
2020-06-29 19:42:26.585066 (MainThread): On master: Close
2020-06-29 19:42:26.908785 (MainThread): Connection 'model.sample_project.customer_nation' was left open.
2020-06-29 19:42:26.909007 (MainThread): On model.sample_project.customer_nation: Close
2020-06-29 19:42:27.312823 (MainThread): 
2020-06-29 19:42:27.313014 (MainThread): Completed with 1 error and 0 warnings:
2020-06-29 19:42:27.313158 (MainThread): 
2020-06-29 19:42:27.313294 (MainThread): Database Error in model customer_nation (models/transforms/customer_nation.sql)
2020-06-29 19:42:27.313417 (MainThread):   001003 (42000): SQL compilation error:
2020-06-29 19:42:27.313532 (MainThread):   syntax error line 20 at position 0 unexpected 'ON'.
2020-06-29 19:42:27.313643 (MainThread):   syntax error line 20 at position 3 unexpected 'nationkey'.
2020-06-29 19:42:27.313752 (MainThread):   compiled SQL at target/run/sample_project/models/transforms/customer_nation.sql
2020-06-29 19:42:27.313876 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2020-06-29 19:42:27.314103 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4e9610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c480350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c018550>]}
2020-06-29 19:42:27.314312 (MainThread): Flushing usage events
2020-06-29 19:43:53.165602 (MainThread): Running with dbt=0.17.0
2020-06-29 19:43:53.621554 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-06-29 19:43:53.622207 (MainThread): Tracking: tracking
2020-06-29 19:43:53.622655 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108aa4f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ab6d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ab6cd0>]}
2020-06-29 19:43:53.647874 (MainThread): Partial parsing not enabled
2020-06-29 19:43:53.650514 (MainThread): Parsing macros/core.sql
2020-06-29 19:43:53.655937 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-29 19:43:53.666226 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-29 19:43:53.668427 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-29 19:43:53.688805 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-29 19:43:53.726541 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-29 19:43:53.750624 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-29 19:43:53.753316 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-29 19:43:53.760582 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-29 19:43:53.777250 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-29 19:43:53.785444 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-29 19:43:53.792774 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-29 19:43:53.801218 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-29 19:43:53.802501 (MainThread): Parsing macros/etc/query.sql
2020-06-29 19:43:53.803994 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-29 19:43:53.806678 (MainThread): Parsing macros/etc/datetime.sql
2020-06-29 19:43:53.822112 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-29 19:43:53.824815 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-29 19:43:53.827277 (MainThread): Parsing macros/adapters/common.sql
2020-06-29 19:43:53.896445 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-29 19:43:53.898430 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-29 19:43:53.900140 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-29 19:43:53.902066 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-29 19:43:53.905685 (MainThread): Parsing macros/catalog.sql
2020-06-29 19:43:53.908581 (MainThread): Parsing macros/adapters.sql
2020-06-29 19:43:53.945578 (MainThread): Parsing macros/materializations/merge.sql
2020-06-29 19:43:53.948725 (MainThread): Parsing macros/materializations/view.sql
2020-06-29 19:43:53.950665 (MainThread): Parsing macros/materializations/table.sql
2020-06-29 19:43:53.956769 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-29 19:43:53.991801 (MainThread): Partial parsing not enabled
2020-06-29 19:43:54.035664 (MainThread): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-29 19:43:54.035830 (MainThread): Opening a new connection, currently in state init
2020-06-29 19:43:54.071994 (MainThread): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-29 19:43:54.072152 (MainThread): Opening a new connection, currently in state init
2020-06-29 19:43:54.086534 (MainThread): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-29 19:43:54.086689 (MainThread): Opening a new connection, currently in state init
2020-06-29 19:43:54.100708 (MainThread): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-29 19:43:54.100857 (MainThread): Opening a new connection, currently in state init
2020-06-29 19:43:54.114475 (MainThread): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-29 19:43:54.114623 (MainThread): Opening a new connection, currently in state init
2020-06-29 19:43:54.396445 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sample_project.reports

2020-06-29 19:43:54.468179 (MainThread): Found 5 models, 8 tests, 0 snapshots, 0 analyses, 136 macros, 0 operations, 0 seed files, 4 sources
2020-06-29 19:43:54.469437 (MainThread): 
2020-06-29 19:43:54.469751 (MainThread): Acquiring new snowflake connection "master".
2020-06-29 19:43:54.469850 (MainThread): Opening a new connection, currently in state init
2020-06-29 19:43:54.478790 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_javen_testing".
2020-06-29 19:43:54.479321 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-06-29 19:43:54.497735 (ThreadPoolExecutor-0_0): Using snowflake connection "list_javen_testing".
2020-06-29 19:43:54.497911 (ThreadPoolExecutor-0_0): On list_javen_testing: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "snowflake-sso", "target_name": "dev", "connection_name": "list_javen_testing"} */

    show terse schemas in database javen_testing
    limit 10000
2020-06-29 19:43:55.023916 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/certifi/cacert.pem'>
2020-06-29 19:44:06.886658 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 12.39 seconds
2020-06-29 19:44:06.950563 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_javen_testing_test".
2020-06-29 19:44:06.950802 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_javen_testing).
2020-06-29 19:44:06.959324 (ThreadPoolExecutor-1_0): Using snowflake connection "list_javen_testing_test".
2020-06-29 19:44:06.959456 (ThreadPoolExecutor-1_0): On list_javen_testing_test: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "snowflake-sso", "target_name": "dev", "connection_name": "list_javen_testing_test"} */

    show terse objects in javen_testing.test
2020-06-29 19:44:07.190205 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 0.23 seconds
2020-06-29 19:44:07.197546 (MainThread): Acquiring new snowflake connection "master".
2020-06-29 19:44:07.197697 (MainThread): Opening a new connection, currently in state init
2020-06-29 19:44:07.197890 (MainThread): Using snowflake connection "master".
2020-06-29 19:44:07.197998 (MainThread): On master: BEGIN
2020-06-29 19:44:16.066862 (MainThread): SQL status: SUCCESS 1 in 8.87 seconds
2020-06-29 19:44:16.067342 (MainThread): On master: COMMIT
2020-06-29 19:44:16.067622 (MainThread): Using snowflake connection "master".
2020-06-29 19:44:16.067793 (MainThread): On master: COMMIT
2020-06-29 19:44:16.710717 (MainThread): SQL status: SUCCESS 1 in 0.64 seconds
2020-06-29 19:44:16.711738 (MainThread): 14:44:16 | Concurrency: 1 threads (target='dev')
2020-06-29 19:44:16.712015 (MainThread): 14:44:16 | 
2020-06-29 19:44:16.713382 (Thread-1): Began running node model.sample_project.customer
2020-06-29 19:44:16.715455 (Thread-1): 14:44:16 | 1 of 5 START table model test.customer............................... [RUN]
2020-06-29 19:44:16.715876 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-29 19:44:16.716041 (Thread-1): Re-using an available connection from the pool (formerly list_javen_testing_test).
2020-06-29 19:44:16.716192 (Thread-1): Compiling model.sample_project.customer
2020-06-29 19:44:16.742339 (Thread-1): Writing injected SQL for node "model.sample_project.customer"
2020-06-29 19:44:16.743007 (Thread-1): finished collecting timing info
2020-06-29 19:44:16.780796 (Thread-1): Writing runtime SQL for node "model.sample_project.customer"
2020-06-29 19:44:16.781780 (Thread-1): Using snowflake connection "model.sample_project.customer".
2020-06-29 19:44:16.781885 (Thread-1): On model.sample_project.customer: BEGIN
2020-06-29 19:44:16.995800 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2020-06-29 19:44:16.996057 (Thread-1): Using snowflake connection "model.sample_project.customer".
2020-06-29 19:44:16.996223 (Thread-1): On model.sample_project.customer: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "snowflake-sso", "target_name": "dev", "node_id": "model.sample_project.customer"} */


      create or replace transient table javen_testing.test.customer  as
      (/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select *
from snowflake_sample_data.tpch_sf1.customer
      );
2020-06-29 19:44:19.054616 (Thread-1): SQL status: SUCCESS 1 in 2.06 seconds
2020-06-29 19:44:19.056690 (Thread-1): On model.sample_project.customer: COMMIT
2020-06-29 19:44:19.056970 (Thread-1): Using snowflake connection "model.sample_project.customer".
2020-06-29 19:44:19.057139 (Thread-1): On model.sample_project.customer: COMMIT
2020-06-29 19:44:19.247290 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2020-06-29 19:44:19.257279 (Thread-1): finished collecting timing info
2020-06-29 19:44:19.258192 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c885e980-6043-45fd-bdc6-193b605ea9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10979b250>]}
2020-06-29 19:44:19.259318 (Thread-1): 14:44:19 | 1 of 5 OK created table model test.customer.......................... [SUCCESS 1 in 2.54s]
2020-06-29 19:44:19.259458 (Thread-1): Finished running node model.sample_project.customer
2020-06-29 19:44:19.259596 (Thread-1): Began running node model.sample_project.nation
2020-06-29 19:44:19.260702 (Thread-1): 14:44:19 | 2 of 5 START table model test.nation................................. [RUN]
2020-06-29 19:44:19.260976 (Thread-1): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-29 19:44:19.261072 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer).
2020-06-29 19:44:19.261167 (Thread-1): Compiling model.sample_project.nation
2020-06-29 19:44:19.269023 (Thread-1): Writing injected SQL for node "model.sample_project.nation"
2020-06-29 19:44:19.269421 (Thread-1): finished collecting timing info
2020-06-29 19:44:19.273560 (Thread-1): Writing runtime SQL for node "model.sample_project.nation"
2020-06-29 19:44:19.274342 (Thread-1): Using snowflake connection "model.sample_project.nation".
2020-06-29 19:44:19.274444 (Thread-1): On model.sample_project.nation: BEGIN
2020-06-29 19:44:19.511450 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2020-06-29 19:44:19.511665 (Thread-1): Using snowflake connection "model.sample_project.nation".
2020-06-29 19:44:19.511801 (Thread-1): On model.sample_project.nation: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "snowflake-sso", "target_name": "dev", "node_id": "model.sample_project.nation"} */


      create or replace transient table javen_testing.test.nation  as
      (/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select *
from snowflake_sample_data.tpch_sf1.nation
      );
2020-06-29 19:44:20.795205 (Thread-1): SQL status: SUCCESS 1 in 1.28 seconds
2020-06-29 19:44:20.796541 (Thread-1): On model.sample_project.nation: COMMIT
2020-06-29 19:44:20.796756 (Thread-1): Using snowflake connection "model.sample_project.nation".
2020-06-29 19:44:20.796894 (Thread-1): On model.sample_project.nation: COMMIT
2020-06-29 19:44:20.969669 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2020-06-29 19:44:20.972959 (Thread-1): finished collecting timing info
2020-06-29 19:44:20.973944 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c885e980-6043-45fd-bdc6-193b605ea9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10955f1d0>]}
2020-06-29 19:44:20.975549 (Thread-1): 14:44:20 | 2 of 5 OK created table model test.nation............................ [SUCCESS 1 in 1.71s]
2020-06-29 19:44:20.975742 (Thread-1): Finished running node model.sample_project.nation
2020-06-29 19:44:20.975912 (Thread-1): Began running node model.sample_project.lineitem
2020-06-29 19:44:20.977411 (Thread-1): 14:44:20 | 3 of 5 START table model test.lineitem............................... [RUN]
2020-06-29 19:44:20.977926 (Thread-1): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-29 19:44:20.978052 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.nation).
2020-06-29 19:44:20.978169 (Thread-1): Compiling model.sample_project.lineitem
2020-06-29 19:44:20.987515 (Thread-1): Writing injected SQL for node "model.sample_project.lineitem"
2020-06-29 19:44:20.987947 (Thread-1): finished collecting timing info
2020-06-29 19:44:20.992834 (Thread-1): Writing runtime SQL for node "model.sample_project.lineitem"
2020-06-29 19:44:20.993796 (Thread-1): Using snowflake connection "model.sample_project.lineitem".
2020-06-29 19:44:20.993920 (Thread-1): On model.sample_project.lineitem: BEGIN
2020-06-29 19:44:21.411228 (Thread-1): SQL status: SUCCESS 1 in 0.42 seconds
2020-06-29 19:44:21.411440 (Thread-1): Using snowflake connection "model.sample_project.lineitem".
2020-06-29 19:44:21.411571 (Thread-1): On model.sample_project.lineitem: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "snowflake-sso", "target_name": "dev", "node_id": "model.sample_project.lineitem"} */


      create or replace transient table javen_testing.test.lineitem  as
      (/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select *
from snowflake_sample_data.tpch_sf1.lineitem
      );
2020-06-29 19:44:27.612535 (Thread-1): SQL status: SUCCESS 1 in 6.20 seconds
2020-06-29 19:44:27.613874 (Thread-1): On model.sample_project.lineitem: COMMIT
2020-06-29 19:44:27.614082 (Thread-1): Using snowflake connection "model.sample_project.lineitem".
2020-06-29 19:44:27.614218 (Thread-1): On model.sample_project.lineitem: COMMIT
2020-06-29 19:44:27.799030 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2020-06-29 19:44:27.802284 (Thread-1): finished collecting timing info
2020-06-29 19:44:27.803247 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c885e980-6043-45fd-bdc6-193b605ea9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10942ec90>]}
2020-06-29 19:44:27.804740 (Thread-1): 14:44:27 | 3 of 5 OK created table model test.lineitem.......................... [SUCCESS 1 in 6.83s]
2020-06-29 19:44:27.804912 (Thread-1): Finished running node model.sample_project.lineitem
2020-06-29 19:44:27.805088 (Thread-1): Began running node model.sample_project.orders
2020-06-29 19:44:27.806343 (Thread-1): 14:44:27 | 4 of 5 START table model test.orders................................. [RUN]
2020-06-29 19:44:27.806676 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-29 19:44:27.806796 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.lineitem).
2020-06-29 19:44:27.806917 (Thread-1): Compiling model.sample_project.orders
2020-06-29 19:44:27.817026 (Thread-1): Writing injected SQL for node "model.sample_project.orders"
2020-06-29 19:44:27.817459 (Thread-1): finished collecting timing info
2020-06-29 19:44:27.822339 (Thread-1): Writing runtime SQL for node "model.sample_project.orders"
2020-06-29 19:44:27.823294 (Thread-1): Using snowflake connection "model.sample_project.orders".
2020-06-29 19:44:27.823417 (Thread-1): On model.sample_project.orders: BEGIN
2020-06-29 19:44:28.073385 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2020-06-29 19:44:28.073631 (Thread-1): Using snowflake connection "model.sample_project.orders".
2020-06-29 19:44:28.073799 (Thread-1): On model.sample_project.orders: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "snowflake-sso", "target_name": "dev", "node_id": "model.sample_project.orders"} */


      create or replace transient table javen_testing.test.orders  as
      (/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select *
from snowflake_sample_data.tpch_sf1.orders
      );
2020-06-29 19:44:31.034648 (Thread-1): SQL status: SUCCESS 1 in 2.96 seconds
2020-06-29 19:44:31.036240 (Thread-1): On model.sample_project.orders: COMMIT
2020-06-29 19:44:31.036512 (Thread-1): Using snowflake connection "model.sample_project.orders".
2020-06-29 19:44:31.036644 (Thread-1): On model.sample_project.orders: COMMIT
2020-06-29 19:44:31.233557 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2020-06-29 19:44:31.236486 (Thread-1): finished collecting timing info
2020-06-29 19:44:31.237329 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c885e980-6043-45fd-bdc6-193b605ea9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092d3d90>]}
2020-06-29 19:44:31.238580 (Thread-1): 14:44:31 | 4 of 5 OK created table model test.orders............................ [SUCCESS 1 in 3.43s]
2020-06-29 19:44:31.238747 (Thread-1): Finished running node model.sample_project.orders
2020-06-29 19:44:31.238908 (Thread-1): Began running node model.sample_project.customer_nation
2020-06-29 19:44:31.240038 (Thread-1): 14:44:31 | 5 of 5 START table model test.customer_nation........................ [RUN]
2020-06-29 19:44:31.240353 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-29 19:44:31.240466 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders).
2020-06-29 19:44:31.240579 (Thread-1): Compiling model.sample_project.customer_nation
2020-06-29 19:44:31.249153 (Thread-1): Writing injected SQL for node "model.sample_project.customer_nation"
2020-06-29 19:44:31.250279 (Thread-1): finished collecting timing info
2020-06-29 19:44:31.256337 (Thread-1): Writing runtime SQL for node "model.sample_project.customer_nation"
2020-06-29 19:44:31.257638 (Thread-1): Using snowflake connection "model.sample_project.customer_nation".
2020-06-29 19:44:31.257867 (Thread-1): On model.sample_project.customer_nation: BEGIN
2020-06-29 19:44:31.652146 (Thread-1): SQL status: SUCCESS 1 in 0.39 seconds
2020-06-29 19:44:31.652422 (Thread-1): Using snowflake connection "model.sample_project.customer_nation".
2020-06-29 19:44:31.652591 (Thread-1): On model.sample_project.customer_nation: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "snowflake-sso", "target_name": "dev", "node_id": "model.sample_project.customer_nation"} */


      create or replace transient table javen_testing.test.customer_nation  as
      (/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select *
from javen_testing.test.customer, javen_testing.test.nation
ON c_nationkey=n_nationkey
      );
2020-06-29 19:44:31.855103 (Thread-1): Snowflake query id: 01953ce0-0223-3f5f-0000-2aed011c9762
2020-06-29 19:44:31.855297 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 20 at position 0 unexpected 'ON'.
syntax error line 20 at position 3 unexpected 'c_nationkey'.
2020-06-29 19:44:31.855446 (Thread-1): On model.sample_project.customer_nation: ROLLBACK
2020-06-29 19:44:31.855563 (Thread-1): initiating rollback
2020-06-29 19:44:32.096392 (Thread-1): finished collecting timing info
2020-06-29 19:44:32.097206 (Thread-1): Database Error in model customer_nation (models/transforms/customer_nation.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 0 unexpected 'ON'.
  syntax error line 20 at position 3 unexpected 'c_nationkey'.
  compiled SQL at target/run/sample_project/models/transforms/customer_nation.sql
Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 158, in exception_handler
    yield
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/cursor.py", line 597, in execute
    errvalue)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/errors.py", line 97, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, errorclass, errorvalue)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/errors.py", line 73, in default_errorhandler
    done_format_msg=errorvalue.get(u'done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 20 at position 0 unexpected 'ON'.
syntax error line 20 at position 3 unexpected 'c_nationkey'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 119, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 306, in add_query
    abridge_sql_log=abridge_sql_log
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/usr/local/opt/python/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 177, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model customer_nation (models/transforms/customer_nation.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 0 unexpected 'ON'.
  syntax error line 20 at position 3 unexpected 'c_nationkey'.
  compiled SQL at target/run/sample_project/models/transforms/customer_nation.sql
2020-06-29 19:44:32.110992 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c885e980-6043-45fd-bdc6-193b605ea9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109343c90>]}
2020-06-29 19:44:32.112656 (Thread-1): 14:44:32 | 5 of 5 ERROR creating table model test.customer_nation............... [ERROR in 0.87s]
2020-06-29 19:44:32.112870 (Thread-1): Finished running node model.sample_project.customer_nation
2020-06-29 19:44:32.177268 (MainThread): Using snowflake connection "master".
2020-06-29 19:44:32.177575 (MainThread): On master: BEGIN
2020-06-29 19:44:32.675696 (MainThread): SQL status: SUCCESS 1 in 0.50 seconds
2020-06-29 19:44:32.675972 (MainThread): On master: COMMIT
2020-06-29 19:44:32.676206 (MainThread): Using snowflake connection "master".
2020-06-29 19:44:32.676365 (MainThread): On master: COMMIT
2020-06-29 19:44:32.938263 (MainThread): SQL status: SUCCESS 1 in 0.26 seconds
2020-06-29 19:44:32.938868 (MainThread): 14:44:32 | 
2020-06-29 19:44:32.939112 (MainThread): 14:44:32 | Finished running 5 table models in 38.47s.
2020-06-29 19:44:32.939311 (MainThread): Connection 'master' was left open.
2020-06-29 19:44:32.939475 (MainThread): On master: Close
2020-06-29 19:44:33.285583 (MainThread): Connection 'model.sample_project.customer_nation' was left open.
2020-06-29 19:44:33.285784 (MainThread): On model.sample_project.customer_nation: Close
2020-06-29 19:44:33.561257 (MainThread): 
2020-06-29 19:44:33.561451 (MainThread): Completed with 1 error and 0 warnings:
2020-06-29 19:44:33.561594 (MainThread): 
2020-06-29 19:44:33.561734 (MainThread): Database Error in model customer_nation (models/transforms/customer_nation.sql)
2020-06-29 19:44:33.561859 (MainThread):   001003 (42000): SQL compilation error:
2020-06-29 19:44:33.561974 (MainThread):   syntax error line 20 at position 0 unexpected 'ON'.
2020-06-29 19:44:33.562086 (MainThread):   syntax error line 20 at position 3 unexpected 'c_nationkey'.
2020-06-29 19:44:33.562197 (MainThread):   compiled SQL at target/run/sample_project/models/transforms/customer_nation.sql
2020-06-29 19:44:33.562349 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2020-06-29 19:44:33.562656 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109472dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094795d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092efd50>]}
2020-06-29 19:44:33.562887 (MainThread): Flushing usage events
2020-06-29 19:58:02.487807 (MainThread): Running with dbt=0.17.0
2020-06-29 19:58:02.985429 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-06-29 19:58:02.986885 (MainThread): Tracking: tracking
2020-06-29 19:58:02.987165 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112bb4f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11455ef90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114570d90>]}
2020-06-29 19:58:03.012274 (MainThread): Partial parsing not enabled
2020-06-29 19:58:03.015471 (MainThread): Parsing macros/core.sql
2020-06-29 19:58:03.021537 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-29 19:58:03.035053 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-29 19:58:03.037477 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-29 19:58:03.058531 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-29 19:58:03.093396 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-29 19:58:03.117952 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-29 19:58:03.120238 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-29 19:58:03.127834 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-29 19:58:03.143632 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-29 19:58:03.151386 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-29 19:58:03.159868 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-29 19:58:03.166155 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-29 19:58:03.167483 (MainThread): Parsing macros/etc/query.sql
2020-06-29 19:58:03.168943 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-29 19:58:03.171204 (MainThread): Parsing macros/etc/datetime.sql
2020-06-29 19:58:03.181518 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-29 19:58:03.183984 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-29 19:58:03.185969 (MainThread): Parsing macros/adapters/common.sql
2020-06-29 19:58:03.240653 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-29 19:58:03.242299 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-29 19:58:03.243508 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-29 19:58:03.244938 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-29 19:58:03.247625 (MainThread): Parsing macros/catalog.sql
2020-06-29 19:58:03.249896 (MainThread): Parsing macros/adapters.sql
2020-06-29 19:58:03.275909 (MainThread): Parsing macros/materializations/merge.sql
2020-06-29 19:58:03.278289 (MainThread): Parsing macros/materializations/view.sql
2020-06-29 19:58:03.279815 (MainThread): Parsing macros/materializations/table.sql
2020-06-29 19:58:03.284487 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-29 19:58:03.312653 (MainThread): Partial parsing not enabled
2020-06-29 19:58:03.349414 (MainThread): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-29 19:58:03.349544 (MainThread): Opening a new connection, currently in state init
2020-06-29 19:58:03.379965 (MainThread): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-29 19:58:03.380097 (MainThread): Opening a new connection, currently in state init
2020-06-29 19:58:03.392187 (MainThread): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-29 19:58:03.392315 (MainThread): Opening a new connection, currently in state init
2020-06-29 19:58:03.404150 (MainThread): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-29 19:58:03.404284 (MainThread): Opening a new connection, currently in state init
2020-06-29 19:58:03.416482 (MainThread): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-29 19:58:03.416613 (MainThread): Opening a new connection, currently in state init
2020-06-29 19:58:03.676127 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sample_project.reports

2020-06-29 19:58:03.744585 (MainThread): Found 5 models, 8 tests, 0 snapshots, 0 analyses, 136 macros, 0 operations, 0 seed files, 4 sources
2020-06-29 19:58:03.745922 (MainThread): 
2020-06-29 19:58:03.746267 (MainThread): Acquiring new snowflake connection "master".
2020-06-29 19:58:03.746370 (MainThread): Opening a new connection, currently in state init
2020-06-29 19:58:03.753633 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_javen_testing".
2020-06-29 19:58:03.754025 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-06-29 19:58:03.776729 (ThreadPoolExecutor-0_0): Using snowflake connection "list_javen_testing".
2020-06-29 19:58:03.776898 (ThreadPoolExecutor-0_0): On list_javen_testing: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "snowflake-sso", "target_name": "dev", "connection_name": "list_javen_testing"} */

    show terse schemas in database javen_testing
    limit 10000
2020-06-29 19:58:04.318251 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/certifi/cacert.pem'>
2020-06-29 19:58:16.021991 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 12.24 seconds
2020-06-29 19:58:16.089902 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_javen_testing_test".
2020-06-29 19:58:16.090151 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_javen_testing).
2020-06-29 19:58:16.099062 (ThreadPoolExecutor-1_0): Using snowflake connection "list_javen_testing_test".
2020-06-29 19:58:16.099204 (ThreadPoolExecutor-1_0): On list_javen_testing_test: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "snowflake-sso", "target_name": "dev", "connection_name": "list_javen_testing_test"} */

    show terse objects in javen_testing.test
2020-06-29 19:58:16.315289 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 0.22 seconds
2020-06-29 19:58:16.322645 (MainThread): Acquiring new snowflake connection "master".
2020-06-29 19:58:16.322786 (MainThread): Opening a new connection, currently in state init
2020-06-29 19:58:16.322974 (MainThread): Using snowflake connection "master".
2020-06-29 19:58:16.323081 (MainThread): On master: BEGIN
2020-06-29 19:58:24.449103 (MainThread): SQL status: SUCCESS 1 in 8.13 seconds
2020-06-29 19:58:24.449487 (MainThread): On master: COMMIT
2020-06-29 19:58:24.449744 (MainThread): Using snowflake connection "master".
2020-06-29 19:58:24.449869 (MainThread): On master: COMMIT
2020-06-29 19:58:24.705805 (MainThread): SQL status: SUCCESS 1 in 0.26 seconds
2020-06-29 19:58:24.706400 (MainThread): 14:58:24 | Concurrency: 1 threads (target='dev')
2020-06-29 19:58:24.706579 (MainThread): 14:58:24 | 
2020-06-29 19:58:24.707843 (Thread-1): Began running node model.sample_project.customer
2020-06-29 19:58:24.710012 (Thread-1): 14:58:24 | 1 of 5 START table model test.customer............................... [RUN]
2020-06-29 19:58:24.710618 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-29 19:58:24.710875 (Thread-1): Re-using an available connection from the pool (formerly list_javen_testing_test).
2020-06-29 19:58:24.711032 (Thread-1): Compiling model.sample_project.customer
2020-06-29 19:58:24.734993 (Thread-1): Writing injected SQL for node "model.sample_project.customer"
2020-06-29 19:58:24.736191 (Thread-1): finished collecting timing info
2020-06-29 19:58:24.770146 (Thread-1): Writing runtime SQL for node "model.sample_project.customer"
2020-06-29 19:58:24.771125 (Thread-1): Using snowflake connection "model.sample_project.customer".
2020-06-29 19:58:24.771234 (Thread-1): On model.sample_project.customer: BEGIN
2020-06-29 19:58:24.988289 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2020-06-29 19:58:24.988491 (Thread-1): Using snowflake connection "model.sample_project.customer".
2020-06-29 19:58:24.988626 (Thread-1): On model.sample_project.customer: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "snowflake-sso", "target_name": "dev", "node_id": "model.sample_project.customer"} */


      create or replace transient table javen_testing.test.customer  as
      (/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select *
from snowflake_sample_data.tpch_sf1.customer
      );
2020-06-29 19:58:28.262712 (Thread-1): SQL status: SUCCESS 1 in 3.27 seconds
2020-06-29 19:58:28.263822 (Thread-1): On model.sample_project.customer: COMMIT
2020-06-29 19:58:28.263945 (Thread-1): Using snowflake connection "model.sample_project.customer".
2020-06-29 19:58:28.264021 (Thread-1): On model.sample_project.customer: COMMIT
2020-06-29 19:58:28.459513 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2020-06-29 19:58:28.470231 (Thread-1): finished collecting timing info
2020-06-29 19:58:28.471140 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f21457a-6e36-45e3-a135-9252206c2a58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117266c90>]}
2020-06-29 19:58:28.472287 (Thread-1): 14:58:28 | 1 of 5 OK created table model test.customer.......................... [SUCCESS 1 in 3.76s]
2020-06-29 19:58:28.472431 (Thread-1): Finished running node model.sample_project.customer
2020-06-29 19:58:28.472576 (Thread-1): Began running node model.sample_project.nation
2020-06-29 19:58:28.473568 (Thread-1): 14:58:28 | 2 of 5 START table model test.nation................................. [RUN]
2020-06-29 19:58:28.473843 (Thread-1): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-29 19:58:28.474039 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer).
2020-06-29 19:58:28.474152 (Thread-1): Compiling model.sample_project.nation
2020-06-29 19:58:28.481821 (Thread-1): Writing injected SQL for node "model.sample_project.nation"
2020-06-29 19:58:28.483324 (Thread-1): finished collecting timing info
2020-06-29 19:58:28.487031 (Thread-1): Writing runtime SQL for node "model.sample_project.nation"
2020-06-29 19:58:28.487875 (Thread-1): Using snowflake connection "model.sample_project.nation".
2020-06-29 19:58:28.488047 (Thread-1): On model.sample_project.nation: BEGIN
2020-06-29 19:58:28.671669 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2020-06-29 19:58:28.671881 (Thread-1): Using snowflake connection "model.sample_project.nation".
2020-06-29 19:58:28.672011 (Thread-1): On model.sample_project.nation: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "snowflake-sso", "target_name": "dev", "node_id": "model.sample_project.nation"} */


      create or replace transient table javen_testing.test.nation  as
      (/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select *
from snowflake_sample_data.tpch_sf1.nation
      );
2020-06-29 19:58:29.813924 (Thread-1): SQL status: SUCCESS 1 in 1.14 seconds
2020-06-29 19:58:29.815240 (Thread-1): On model.sample_project.nation: COMMIT
2020-06-29 19:58:29.815438 (Thread-1): Using snowflake connection "model.sample_project.nation".
2020-06-29 19:58:29.815591 (Thread-1): On model.sample_project.nation: COMMIT
2020-06-29 19:58:29.988024 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2020-06-29 19:58:29.991055 (Thread-1): finished collecting timing info
2020-06-29 19:58:29.991935 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f21457a-6e36-45e3-a135-9252206c2a58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114d38590>]}
2020-06-29 19:58:29.993206 (Thread-1): 14:58:29 | 2 of 5 OK created table model test.nation............................ [SUCCESS 1 in 1.52s]
2020-06-29 19:58:29.993360 (Thread-1): Finished running node model.sample_project.nation
2020-06-29 19:58:29.993515 (Thread-1): Began running node model.sample_project.lineitem
2020-06-29 19:58:29.994922 (Thread-1): 14:58:29 | 3 of 5 START table model test.lineitem............................... [RUN]
2020-06-29 19:58:29.995340 (Thread-1): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-29 19:58:29.995460 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.nation).
2020-06-29 19:58:29.995571 (Thread-1): Compiling model.sample_project.lineitem
2020-06-29 19:58:30.003720 (Thread-1): Writing injected SQL for node "model.sample_project.lineitem"
2020-06-29 19:58:30.004152 (Thread-1): finished collecting timing info
2020-06-29 19:58:30.011947 (Thread-1): Writing runtime SQL for node "model.sample_project.lineitem"
2020-06-29 19:58:30.013435 (Thread-1): Using snowflake connection "model.sample_project.lineitem".
2020-06-29 19:58:30.013583 (Thread-1): On model.sample_project.lineitem: BEGIN
2020-06-29 19:58:30.196637 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2020-06-29 19:58:30.196894 (Thread-1): Using snowflake connection "model.sample_project.lineitem".
2020-06-29 19:58:30.197066 (Thread-1): On model.sample_project.lineitem: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "snowflake-sso", "target_name": "dev", "node_id": "model.sample_project.lineitem"} */


      create or replace transient table javen_testing.test.lineitem  as
      (/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select *
from snowflake_sample_data.tpch_sf1.lineitem
      );
2020-06-29 19:58:36.456947 (Thread-1): SQL status: SUCCESS 1 in 6.26 seconds
2020-06-29 19:58:36.458592 (Thread-1): On model.sample_project.lineitem: COMMIT
2020-06-29 19:58:36.458791 (Thread-1): Using snowflake connection "model.sample_project.lineitem".
2020-06-29 19:58:36.458923 (Thread-1): On model.sample_project.lineitem: COMMIT
2020-06-29 19:58:36.606826 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2020-06-29 19:58:36.610165 (Thread-1): finished collecting timing info
2020-06-29 19:58:36.611046 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f21457a-6e36-45e3-a135-9252206c2a58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1172d5c10>]}
2020-06-29 19:58:36.612546 (Thread-1): 14:58:36 | 3 of 5 OK created table model test.lineitem.......................... [SUCCESS 1 in 6.62s]
2020-06-29 19:58:36.612718 (Thread-1): Finished running node model.sample_project.lineitem
2020-06-29 19:58:36.612887 (Thread-1): Began running node model.sample_project.orders
2020-06-29 19:58:36.614108 (Thread-1): 14:58:36 | 4 of 5 START table model test.orders................................. [RUN]
2020-06-29 19:58:36.614436 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-29 19:58:36.614652 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.lineitem).
2020-06-29 19:58:36.614793 (Thread-1): Compiling model.sample_project.orders
2020-06-29 19:58:36.629060 (Thread-1): Writing injected SQL for node "model.sample_project.orders"
2020-06-29 19:58:36.629678 (Thread-1): finished collecting timing info
2020-06-29 19:58:36.635594 (Thread-1): Writing runtime SQL for node "model.sample_project.orders"
2020-06-29 19:58:36.636878 (Thread-1): Using snowflake connection "model.sample_project.orders".
2020-06-29 19:58:36.637023 (Thread-1): On model.sample_project.orders: BEGIN
2020-06-29 19:58:36.903055 (Thread-1): SQL status: SUCCESS 1 in 0.27 seconds
2020-06-29 19:58:36.903309 (Thread-1): Using snowflake connection "model.sample_project.orders".
2020-06-29 19:58:36.903470 (Thread-1): On model.sample_project.orders: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "snowflake-sso", "target_name": "dev", "node_id": "model.sample_project.orders"} */


      create or replace transient table javen_testing.test.orders  as
      (/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select *
from snowflake_sample_data.tpch_sf1.orders
      );
2020-06-29 19:58:39.984945 (Thread-1): SQL status: SUCCESS 1 in 3.08 seconds
2020-06-29 19:58:39.986565 (Thread-1): On model.sample_project.orders: COMMIT
2020-06-29 19:58:39.986804 (Thread-1): Using snowflake connection "model.sample_project.orders".
2020-06-29 19:58:39.986940 (Thread-1): On model.sample_project.orders: COMMIT
2020-06-29 19:58:40.129728 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2020-06-29 19:58:40.133012 (Thread-1): finished collecting timing info
2020-06-29 19:58:40.133861 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f21457a-6e36-45e3-a135-9252206c2a58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114d927d0>]}
2020-06-29 19:58:40.135348 (Thread-1): 14:58:40 | 4 of 5 OK created table model test.orders............................ [SUCCESS 1 in 3.52s]
2020-06-29 19:58:40.135518 (Thread-1): Finished running node model.sample_project.orders
2020-06-29 19:58:40.135688 (Thread-1): Began running node model.sample_project.customer_nation
2020-06-29 19:58:40.136928 (Thread-1): 14:58:40 | 5 of 5 START table model test.customer_nation........................ [RUN]
2020-06-29 19:58:40.137380 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-29 19:58:40.137510 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders).
2020-06-29 19:58:40.137628 (Thread-1): Compiling model.sample_project.customer_nation
2020-06-29 19:58:40.148095 (Thread-1): Writing injected SQL for node "model.sample_project.customer_nation"
2020-06-29 19:58:40.148543 (Thread-1): finished collecting timing info
2020-06-29 19:58:40.158176 (Thread-1): Writing runtime SQL for node "model.sample_project.customer_nation"
2020-06-29 19:58:40.160544 (Thread-1): Using snowflake connection "model.sample_project.customer_nation".
2020-06-29 19:58:40.160705 (Thread-1): On model.sample_project.customer_nation: BEGIN
2020-06-29 19:58:40.330345 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2020-06-29 19:58:40.330602 (Thread-1): Using snowflake connection "model.sample_project.customer_nation".
2020-06-29 19:58:40.330768 (Thread-1): On model.sample_project.customer_nation: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "snowflake-sso", "target_name": "dev", "node_id": "model.sample_project.customer_nation"} */


      create or replace transient table javen_testing.test.customer_nation  as
      (/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select *
from javen_testing.test.customer as c, javen_testing.test.nation as n
ON c.c_nationkey=n.n_nationkey
      );
2020-06-29 19:58:40.489795 (Thread-1): Snowflake query id: 01953cee-0236-4c0f-0000-2aed011c977a
2020-06-29 19:58:40.490026 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 20 at position 0 unexpected 'ON'.
syntax error line 20 at position 3 unexpected 'c'.
2020-06-29 19:58:40.490209 (Thread-1): On model.sample_project.customer_nation: ROLLBACK
2020-06-29 19:58:40.490351 (Thread-1): initiating rollback
2020-06-29 19:58:40.761151 (Thread-1): finished collecting timing info
2020-06-29 19:58:40.761966 (Thread-1): Database Error in model customer_nation (models/transforms/customer_nation.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 0 unexpected 'ON'.
  syntax error line 20 at position 3 unexpected 'c'.
  compiled SQL at target/run/sample_project/models/transforms/customer_nation.sql
Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 158, in exception_handler
    yield
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/cursor.py", line 597, in execute
    errvalue)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/errors.py", line 97, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, errorclass, errorvalue)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/errors.py", line 73, in default_errorhandler
    done_format_msg=errorvalue.get(u'done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 20 at position 0 unexpected 'ON'.
syntax error line 20 at position 3 unexpected 'c'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 119, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 306, in add_query
    abridge_sql_log=abridge_sql_log
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/usr/local/opt/python/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 177, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model customer_nation (models/transforms/customer_nation.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 0 unexpected 'ON'.
  syntax error line 20 at position 3 unexpected 'c'.
  compiled SQL at target/run/sample_project/models/transforms/customer_nation.sql
2020-06-29 19:58:40.776367 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f21457a-6e36-45e3-a135-9252206c2a58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114e1a150>]}
2020-06-29 19:58:40.778074 (Thread-1): 14:58:40 | 5 of 5 ERROR creating table model test.customer_nation............... [ERROR in 0.64s]
2020-06-29 19:58:40.778284 (Thread-1): Finished running node model.sample_project.customer_nation
2020-06-29 19:58:40.831399 (MainThread): Using snowflake connection "master".
2020-06-29 19:58:40.831650 (MainThread): On master: BEGIN
2020-06-29 19:58:41.016017 (MainThread): SQL status: SUCCESS 1 in 0.18 seconds
2020-06-29 19:58:41.016239 (MainThread): On master: COMMIT
2020-06-29 19:58:41.016423 (MainThread): Using snowflake connection "master".
2020-06-29 19:58:41.016547 (MainThread): On master: COMMIT
2020-06-29 19:58:41.282511 (MainThread): SQL status: SUCCESS 1 in 0.27 seconds
2020-06-29 19:58:41.283128 (MainThread): 14:58:41 | 
2020-06-29 19:58:41.283373 (MainThread): 14:58:41 | Finished running 5 table models in 37.54s.
2020-06-29 19:58:41.283573 (MainThread): Connection 'master' was left open.
2020-06-29 19:58:41.283739 (MainThread): On master: Close
2020-06-29 19:58:41.648349 (MainThread): Connection 'model.sample_project.customer_nation' was left open.
2020-06-29 19:58:41.648581 (MainThread): On model.sample_project.customer_nation: Close
2020-06-29 19:58:42.209508 (MainThread): 
2020-06-29 19:58:42.209713 (MainThread): Completed with 1 error and 0 warnings:
2020-06-29 19:58:42.209858 (MainThread): 
2020-06-29 19:58:42.209995 (MainThread): Database Error in model customer_nation (models/transforms/customer_nation.sql)
2020-06-29 19:58:42.210123 (MainThread):   001003 (42000): SQL compilation error:
2020-06-29 19:58:42.210240 (MainThread):   syntax error line 20 at position 0 unexpected 'ON'.
2020-06-29 19:58:42.210353 (MainThread):   syntax error line 20 at position 3 unexpected 'c'.
2020-06-29 19:58:42.210463 (MainThread):   compiled SQL at target/run/sample_project/models/transforms/customer_nation.sql
2020-06-29 19:58:42.210589 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2020-06-29 19:58:42.210818 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114ee52d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114f31bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114f25e10>]}
2020-06-29 19:58:42.211036 (MainThread): Flushing usage events
2020-06-29 20:06:09.313159 (MainThread): Running with dbt=0.17.0
2020-06-29 20:06:09.814167 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-06-29 20:06:09.815044 (MainThread): Tracking: tracking
2020-06-29 20:06:09.815322 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb1a0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb1a7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb2ce50>]}
2020-06-29 20:06:09.836401 (MainThread): Partial parsing not enabled
2020-06-29 20:06:09.839006 (MainThread): Parsing macros/core.sql
2020-06-29 20:06:09.845410 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-29 20:06:09.857365 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-29 20:06:09.859632 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-29 20:06:09.880547 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-29 20:06:09.912674 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-29 20:06:09.935737 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-29 20:06:09.938319 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-29 20:06:09.946414 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-29 20:06:09.961906 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-29 20:06:09.969956 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-29 20:06:09.977015 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-29 20:06:09.982318 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-29 20:06:09.983505 (MainThread): Parsing macros/etc/query.sql
2020-06-29 20:06:09.984934 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-29 20:06:09.986909 (MainThread): Parsing macros/etc/datetime.sql
2020-06-29 20:06:09.996859 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-29 20:06:09.999313 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-29 20:06:10.001963 (MainThread): Parsing macros/adapters/common.sql
2020-06-29 20:06:10.055190 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-29 20:06:10.056865 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-29 20:06:10.058177 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-29 20:06:10.060081 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-29 20:06:10.062823 (MainThread): Parsing macros/catalog.sql
2020-06-29 20:06:10.065173 (MainThread): Parsing macros/adapters.sql
2020-06-29 20:06:10.089607 (MainThread): Parsing macros/materializations/merge.sql
2020-06-29 20:06:10.094036 (MainThread): Parsing macros/materializations/view.sql
2020-06-29 20:06:10.096427 (MainThread): Parsing macros/materializations/table.sql
2020-06-29 20:06:10.102445 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-29 20:06:10.132587 (MainThread): Partial parsing not enabled
2020-06-29 20:06:10.171703 (MainThread): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-29 20:06:10.171819 (MainThread): Opening a new connection, currently in state init
2020-06-29 20:06:10.201635 (MainThread): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-29 20:06:10.201766 (MainThread): Opening a new connection, currently in state init
2020-06-29 20:06:10.213764 (MainThread): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-29 20:06:10.213893 (MainThread): Opening a new connection, currently in state init
2020-06-29 20:06:10.226187 (MainThread): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-29 20:06:10.226316 (MainThread): Opening a new connection, currently in state init
2020-06-29 20:06:10.237358 (MainThread): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-29 20:06:10.237445 (MainThread): Opening a new connection, currently in state init
2020-06-29 20:06:10.486814 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sample_project.reports

2020-06-29 20:06:10.554385 (MainThread): Found 5 models, 8 tests, 0 snapshots, 0 analyses, 136 macros, 0 operations, 0 seed files, 4 sources
2020-06-29 20:06:10.555594 (MainThread): 
2020-06-29 20:06:10.555898 (MainThread): Acquiring new snowflake connection "master".
2020-06-29 20:06:10.555997 (MainThread): Opening a new connection, currently in state init
2020-06-29 20:06:10.562861 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_javen_testing".
2020-06-29 20:06:10.563136 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-06-29 20:06:10.582382 (ThreadPoolExecutor-0_0): Using snowflake connection "list_javen_testing".
2020-06-29 20:06:10.582554 (ThreadPoolExecutor-0_0): On list_javen_testing: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "snowflake-sso", "target_name": "dev", "connection_name": "list_javen_testing"} */

    show terse schemas in database javen_testing
    limit 10000
2020-06-29 20:06:11.127059 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/certifi/cacert.pem'>
2020-06-29 20:06:19.544641 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 8.96 seconds
2020-06-29 20:06:19.613100 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_javen_testing_test".
2020-06-29 20:06:19.613345 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_javen_testing).
2020-06-29 20:06:19.622199 (ThreadPoolExecutor-1_0): Using snowflake connection "list_javen_testing_test".
2020-06-29 20:06:19.622334 (ThreadPoolExecutor-1_0): On list_javen_testing_test: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "snowflake-sso", "target_name": "dev", "connection_name": "list_javen_testing_test"} */

    show terse objects in javen_testing.test
2020-06-29 20:06:19.970007 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 0.35 seconds
2020-06-29 20:06:19.978182 (MainThread): Acquiring new snowflake connection "master".
2020-06-29 20:06:19.978321 (MainThread): Opening a new connection, currently in state init
2020-06-29 20:06:19.978522 (MainThread): Using snowflake connection "master".
2020-06-29 20:06:19.978634 (MainThread): On master: BEGIN
2020-06-29 20:06:30.014657 (MainThread): SQL status: SUCCESS 1 in 10.04 seconds
2020-06-29 20:06:30.015207 (MainThread): On master: COMMIT
2020-06-29 20:06:30.015478 (MainThread): Using snowflake connection "master".
2020-06-29 20:06:30.015620 (MainThread): On master: COMMIT
2020-06-29 20:06:30.363708 (MainThread): SQL status: SUCCESS 1 in 0.35 seconds
2020-06-29 20:06:30.364725 (MainThread): 15:06:30 | Concurrency: 1 threads (target='dev')
2020-06-29 20:06:30.365011 (MainThread): 15:06:30 | 
2020-06-29 20:06:30.366403 (Thread-1): Began running node model.sample_project.customer
2020-06-29 20:06:30.368474 (Thread-1): 15:06:30 | 1 of 5 START table model test.customer............................... [RUN]
2020-06-29 20:06:30.368882 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-29 20:06:30.369027 (Thread-1): Re-using an available connection from the pool (formerly list_javen_testing_test).
2020-06-29 20:06:30.369191 (Thread-1): Compiling model.sample_project.customer
2020-06-29 20:06:30.396137 (Thread-1): Writing injected SQL for node "model.sample_project.customer"
2020-06-29 20:06:30.396826 (Thread-1): finished collecting timing info
2020-06-29 20:06:30.436757 (Thread-1): Writing runtime SQL for node "model.sample_project.customer"
2020-06-29 20:06:30.437761 (Thread-1): Using snowflake connection "model.sample_project.customer".
2020-06-29 20:06:30.437871 (Thread-1): On model.sample_project.customer: BEGIN
2020-06-29 20:06:30.650866 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2020-06-29 20:06:30.651050 (Thread-1): Using snowflake connection "model.sample_project.customer".
2020-06-29 20:06:30.651171 (Thread-1): On model.sample_project.customer: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "snowflake-sso", "target_name": "dev", "node_id": "model.sample_project.customer"} */


      create or replace transient table javen_testing.test.customer  as
      (/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select *
from snowflake_sample_data.tpch_sf1.customer
      );
2020-06-29 20:06:33.184165 (Thread-1): SQL status: SUCCESS 1 in 2.53 seconds
2020-06-29 20:06:33.186169 (Thread-1): On model.sample_project.customer: COMMIT
2020-06-29 20:06:33.186376 (Thread-1): Using snowflake connection "model.sample_project.customer".
2020-06-29 20:06:33.186511 (Thread-1): On model.sample_project.customer: COMMIT
2020-06-29 20:06:33.370942 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2020-06-29 20:06:33.383796 (Thread-1): finished collecting timing info
2020-06-29 20:06:33.384817 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '261d9c8b-1ecd-45b1-834f-14037ae86683', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c546590>]}
2020-06-29 20:06:33.386211 (Thread-1): 15:06:33 | 1 of 5 OK created table model test.customer.......................... [SUCCESS 1 in 3.02s]
2020-06-29 20:06:33.386382 (Thread-1): Finished running node model.sample_project.customer
2020-06-29 20:06:33.386550 (Thread-1): Began running node model.sample_project.nation
2020-06-29 20:06:33.387736 (Thread-1): 15:06:33 | 2 of 5 START table model test.nation................................. [RUN]
2020-06-29 20:06:33.388053 (Thread-1): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-29 20:06:33.388171 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer).
2020-06-29 20:06:33.388287 (Thread-1): Compiling model.sample_project.nation
2020-06-29 20:06:33.397794 (Thread-1): Writing injected SQL for node "model.sample_project.nation"
2020-06-29 20:06:33.398270 (Thread-1): finished collecting timing info
2020-06-29 20:06:33.404652 (Thread-1): Writing runtime SQL for node "model.sample_project.nation"
2020-06-29 20:06:33.405889 (Thread-1): Using snowflake connection "model.sample_project.nation".
2020-06-29 20:06:33.406026 (Thread-1): On model.sample_project.nation: BEGIN
2020-06-29 20:06:33.587459 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2020-06-29 20:06:33.587725 (Thread-1): Using snowflake connection "model.sample_project.nation".
2020-06-29 20:06:33.587896 (Thread-1): On model.sample_project.nation: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "snowflake-sso", "target_name": "dev", "node_id": "model.sample_project.nation"} */


      create or replace transient table javen_testing.test.nation  as
      (/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select *
from snowflake_sample_data.tpch_sf1.nation
      );
2020-06-29 20:06:35.735794 (Thread-1): SQL status: SUCCESS 1 in 2.15 seconds
2020-06-29 20:06:35.737136 (Thread-1): On model.sample_project.nation: COMMIT
2020-06-29 20:06:35.737333 (Thread-1): Using snowflake connection "model.sample_project.nation".
2020-06-29 20:06:35.737466 (Thread-1): On model.sample_project.nation: COMMIT
2020-06-29 20:06:35.899361 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2020-06-29 20:06:35.902624 (Thread-1): finished collecting timing info
2020-06-29 20:06:35.903503 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '261d9c8b-1ecd-45b1-834f-14037ae86683', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c55c410>]}
2020-06-29 20:06:35.904967 (Thread-1): 15:06:35 | 2 of 5 OK created table model test.nation............................ [SUCCESS 1 in 2.52s]
2020-06-29 20:06:35.905135 (Thread-1): Finished running node model.sample_project.nation
2020-06-29 20:06:35.905303 (Thread-1): Began running node model.sample_project.lineitem
2020-06-29 20:06:35.907164 (Thread-1): 15:06:35 | 3 of 5 START table model test.lineitem............................... [RUN]
2020-06-29 20:06:35.907506 (Thread-1): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-29 20:06:35.907624 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.nation).
2020-06-29 20:06:35.907740 (Thread-1): Compiling model.sample_project.lineitem
2020-06-29 20:06:35.917113 (Thread-1): Writing injected SQL for node "model.sample_project.lineitem"
2020-06-29 20:06:35.917573 (Thread-1): finished collecting timing info
2020-06-29 20:06:35.922759 (Thread-1): Writing runtime SQL for node "model.sample_project.lineitem"
2020-06-29 20:06:35.924066 (Thread-1): Using snowflake connection "model.sample_project.lineitem".
2020-06-29 20:06:35.924254 (Thread-1): On model.sample_project.lineitem: BEGIN
2020-06-29 20:06:36.127646 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2020-06-29 20:06:36.127905 (Thread-1): Using snowflake connection "model.sample_project.lineitem".
2020-06-29 20:06:36.128072 (Thread-1): On model.sample_project.lineitem: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "snowflake-sso", "target_name": "dev", "node_id": "model.sample_project.lineitem"} */


      create or replace transient table javen_testing.test.lineitem  as
      (/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select *
from snowflake_sample_data.tpch_sf1.lineitem
      );
2020-06-29 20:06:42.243565 (Thread-1): SQL status: SUCCESS 1 in 6.12 seconds
2020-06-29 20:06:42.244718 (Thread-1): On model.sample_project.lineitem: COMMIT
2020-06-29 20:06:42.244888 (Thread-1): Using snowflake connection "model.sample_project.lineitem".
2020-06-29 20:06:42.245002 (Thread-1): On model.sample_project.lineitem: COMMIT
2020-06-29 20:06:42.856392 (Thread-1): SQL status: SUCCESS 1 in 0.61 seconds
2020-06-29 20:06:42.859762 (Thread-1): finished collecting timing info
2020-06-29 20:06:42.860637 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '261d9c8b-1ecd-45b1-834f-14037ae86683', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e96d410>]}
2020-06-29 20:06:42.862147 (Thread-1): 15:06:42 | 3 of 5 OK created table model test.lineitem.......................... [SUCCESS 1 in 6.95s]
2020-06-29 20:06:42.862317 (Thread-1): Finished running node model.sample_project.lineitem
2020-06-29 20:06:42.862487 (Thread-1): Began running node model.sample_project.orders
2020-06-29 20:06:42.863817 (Thread-1): 15:06:42 | 4 of 5 START table model test.orders................................. [RUN]
2020-06-29 20:06:42.864147 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-29 20:06:42.864263 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.lineitem).
2020-06-29 20:06:42.864377 (Thread-1): Compiling model.sample_project.orders
2020-06-29 20:06:42.874155 (Thread-1): Writing injected SQL for node "model.sample_project.orders"
2020-06-29 20:06:42.874576 (Thread-1): finished collecting timing info
2020-06-29 20:06:42.879581 (Thread-1): Writing runtime SQL for node "model.sample_project.orders"
2020-06-29 20:06:42.880538 (Thread-1): Using snowflake connection "model.sample_project.orders".
2020-06-29 20:06:42.880667 (Thread-1): On model.sample_project.orders: BEGIN
2020-06-29 20:06:43.057832 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2020-06-29 20:06:43.058086 (Thread-1): Using snowflake connection "model.sample_project.orders".
2020-06-29 20:06:43.058252 (Thread-1): On model.sample_project.orders: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "snowflake-sso", "target_name": "dev", "node_id": "model.sample_project.orders"} */


      create or replace transient table javen_testing.test.orders  as
      (/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select *
from snowflake_sample_data.tpch_sf1.orders
      );
2020-06-29 20:06:46.132848 (Thread-1): SQL status: SUCCESS 1 in 3.07 seconds
2020-06-29 20:06:46.134245 (Thread-1): On model.sample_project.orders: COMMIT
2020-06-29 20:06:46.134455 (Thread-1): Using snowflake connection "model.sample_project.orders".
2020-06-29 20:06:46.134591 (Thread-1): On model.sample_project.orders: COMMIT
2020-06-29 20:06:46.324087 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2020-06-29 20:06:46.327303 (Thread-1): finished collecting timing info
2020-06-29 20:06:46.328172 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '261d9c8b-1ecd-45b1-834f-14037ae86683', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3b5290>]}
2020-06-29 20:06:46.329608 (Thread-1): 15:06:46 | 4 of 5 OK created table model test.orders............................ [SUCCESS 1 in 3.46s]
2020-06-29 20:06:46.329779 (Thread-1): Finished running node model.sample_project.orders
2020-06-29 20:06:46.329948 (Thread-1): Began running node model.sample_project.customer_nation
2020-06-29 20:06:46.331269 (Thread-1): 15:06:46 | 5 of 5 START table model test.customer_nation........................ [RUN]
2020-06-29 20:06:46.331605 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-29 20:06:46.331721 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders).
2020-06-29 20:06:46.331837 (Thread-1): Compiling model.sample_project.customer_nation
2020-06-29 20:06:46.344706 (Thread-1): Writing injected SQL for node "model.sample_project.customer_nation"
2020-06-29 20:06:46.345423 (Thread-1): finished collecting timing info
2020-06-29 20:06:46.351663 (Thread-1): Writing runtime SQL for node "model.sample_project.customer_nation"
2020-06-29 20:06:46.352784 (Thread-1): Using snowflake connection "model.sample_project.customer_nation".
2020-06-29 20:06:46.352910 (Thread-1): On model.sample_project.customer_nation: BEGIN
2020-06-29 20:06:46.744235 (Thread-1): SQL status: SUCCESS 1 in 0.39 seconds
2020-06-29 20:06:46.744495 (Thread-1): Using snowflake connection "model.sample_project.customer_nation".
2020-06-29 20:06:46.744667 (Thread-1): On model.sample_project.customer_nation: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "snowflake-sso", "target_name": "dev", "node_id": "model.sample_project.customer_nation"} */


      create or replace transient table javen_testing.test.customer_nation  as
      (/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select *
from javen_testing.test.customer as c
JOIN javen_testing.test.nation as n
ON c.c_nationkey=n.n_nationkey
      );
2020-06-29 20:06:49.053307 (Thread-1): SQL status: SUCCESS 1 in 2.31 seconds
2020-06-29 20:06:49.054992 (Thread-1): On model.sample_project.customer_nation: COMMIT
2020-06-29 20:06:49.055206 (Thread-1): Using snowflake connection "model.sample_project.customer_nation".
2020-06-29 20:06:49.055352 (Thread-1): On model.sample_project.customer_nation: COMMIT
2020-06-29 20:06:49.209247 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2020-06-29 20:06:49.212486 (Thread-1): finished collecting timing info
2020-06-29 20:06:49.213361 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '261d9c8b-1ecd-45b1-834f-14037ae86683', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb64090>]}
2020-06-29 20:06:49.214864 (Thread-1): 15:06:49 | 5 of 5 OK created table model test.customer_nation................... [SUCCESS 1 in 2.88s]
2020-06-29 20:06:49.215045 (Thread-1): Finished running node model.sample_project.customer_nation
2020-06-29 20:06:49.307954 (MainThread): Using snowflake connection "master".
2020-06-29 20:06:49.308268 (MainThread): On master: BEGIN
2020-06-29 20:06:49.671871 (MainThread): SQL status: SUCCESS 1 in 0.36 seconds
2020-06-29 20:06:49.672108 (MainThread): On master: COMMIT
2020-06-29 20:06:49.672307 (MainThread): Using snowflake connection "master".
2020-06-29 20:06:49.672439 (MainThread): On master: COMMIT
2020-06-29 20:06:49.964345 (MainThread): SQL status: SUCCESS 1 in 0.29 seconds
2020-06-29 20:06:49.964987 (MainThread): 15:06:49 | 
2020-06-29 20:06:49.965237 (MainThread): 15:06:49 | Finished running 5 table models in 39.41s.
2020-06-29 20:06:49.965443 (MainThread): Connection 'master' was left open.
2020-06-29 20:06:49.965610 (MainThread): On master: Close
2020-06-29 20:06:50.250669 (MainThread): Connection 'model.sample_project.customer_nation' was left open.
2020-06-29 20:06:50.250886 (MainThread): On model.sample_project.customer_nation: Close
2020-06-29 20:06:50.544617 (MainThread): 
2020-06-29 20:06:50.544817 (MainThread): Completed successfully
2020-06-29 20:06:50.544967 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2020-06-29 20:06:50.545215 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c32c3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c314a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5e51d0>]}
2020-06-29 20:06:50.545434 (MainThread): Flushing usage events
2020-06-30 01:58:09.589570 (MainThread): Running with dbt=0.17.0
2020-06-30 01:58:10.109301 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-06-30 01:58:10.110464 (MainThread): Tracking: tracking
2020-06-30 01:58:10.110784 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8bbf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8bb6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8cce90>]}
2020-06-30 01:58:10.134563 (MainThread): Partial parsing not enabled
2020-06-30 01:58:10.137031 (MainThread): Parsing macros/core.sql
2020-06-30 01:58:10.143619 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-30 01:58:10.153845 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-30 01:58:10.156114 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-30 01:58:10.175779 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-30 01:58:10.210073 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-30 01:58:10.234753 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-30 01:58:10.237209 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-30 01:58:10.244501 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-30 01:58:10.259297 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-30 01:58:10.267181 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-30 01:58:10.275748 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-30 01:58:10.281998 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-30 01:58:10.283341 (MainThread): Parsing macros/etc/query.sql
2020-06-30 01:58:10.284866 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-30 01:58:10.287043 (MainThread): Parsing macros/etc/datetime.sql
2020-06-30 01:58:10.298006 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-30 01:58:10.300730 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-30 01:58:10.302683 (MainThread): Parsing macros/adapters/common.sql
2020-06-30 01:58:10.355964 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-30 01:58:10.357765 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-30 01:58:10.359045 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-30 01:58:10.360513 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-30 01:58:10.363309 (MainThread): Parsing macros/catalog.sql
2020-06-30 01:58:10.365691 (MainThread): Parsing macros/adapters.sql
2020-06-30 01:58:10.389863 (MainThread): Parsing macros/materializations/merge.sql
2020-06-30 01:58:10.392298 (MainThread): Parsing macros/materializations/view.sql
2020-06-30 01:58:10.393805 (MainThread): Parsing macros/materializations/table.sql
2020-06-30 01:58:10.398212 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-30 01:58:10.425518 (MainThread): Partial parsing not enabled
2020-06-30 01:58:10.465836 (MainThread): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 01:58:10.465961 (MainThread): Opening a new connection, currently in state init
2020-06-30 01:58:10.503956 (MainThread): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 01:58:10.504068 (MainThread): Opening a new connection, currently in state init
2020-06-30 01:58:10.515409 (MainThread): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 01:58:10.515511 (MainThread): Opening a new connection, currently in state init
2020-06-30 01:58:10.527708 (MainThread): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 01:58:10.527805 (MainThread): Opening a new connection, currently in state init
2020-06-30 01:58:10.539154 (MainThread): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 01:58:10.539247 (MainThread): Opening a new connection, currently in state init
2020-06-30 01:58:10.551377 (MainThread): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 01:58:10.551469 (MainThread): Opening a new connection, currently in state init
2020-06-30 01:58:10.563481 (MainThread): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 01:58:10.563577 (MainThread): Opening a new connection, currently in state init
2020-06-30 01:58:10.575161 (MainThread): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 01:58:10.575252 (MainThread): Opening a new connection, currently in state init
2020-06-30 01:58:10.914696 (MainThread): Found 8 models, 8 tests, 0 snapshots, 0 analyses, 136 macros, 0 operations, 0 seed files, 4 sources
2020-06-30 01:58:10.916486 (MainThread): 
2020-06-30 01:58:10.916826 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 01:58:10.916929 (MainThread): Opening a new connection, currently in state init
2020-06-30 01:58:10.933841 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_javen_testing".
2020-06-30 01:58:10.934215 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-06-30 01:58:10.951327 (ThreadPoolExecutor-0_0): Using snowflake connection "list_javen_testing".
2020-06-30 01:58:10.951468 (ThreadPoolExecutor-0_0): On list_javen_testing: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "snowflake-sso", "target_name": "dev", "connection_name": "list_javen_testing"} */

    show terse schemas in database javen_testing
    limit 10000
2020-06-30 01:58:11.522948 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/certifi/cacert.pem'>
2020-06-30 01:58:21.321881 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 10.37 seconds
2020-06-30 01:58:21.354431 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_javen_testing_test".
2020-06-30 01:58:21.354553 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_javen_testing).
2020-06-30 01:58:21.362282 (ThreadPoolExecutor-1_0): Using snowflake connection "list_javen_testing_test".
2020-06-30 01:58:21.362393 (ThreadPoolExecutor-1_0): On list_javen_testing_test: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "snowflake-sso", "target_name": "dev", "connection_name": "list_javen_testing_test"} */

    show terse objects in javen_testing.test
2020-06-30 01:58:21.910239 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 0.55 seconds
2020-06-30 01:58:21.918542 (MainThread): 20:58:21 | Concurrency: 1 threads (target='dev')
2020-06-30 01:58:21.918742 (MainThread): 20:58:21 | 
2020-06-30 01:58:21.919684 (Thread-1): Began running node model.sample_project.customer
2020-06-30 01:58:21.920050 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 01:58:21.920175 (Thread-1): Re-using an available connection from the pool (formerly list_javen_testing_test).
2020-06-30 01:58:21.920313 (Thread-1): Compiling model.sample_project.customer
2020-06-30 01:58:21.946152 (Thread-1): Writing injected SQL for node "model.sample_project.customer"
2020-06-30 01:58:21.947427 (Thread-1): finished collecting timing info
2020-06-30 01:58:21.947793 (Thread-1): finished collecting timing info
2020-06-30 01:58:21.948288 (Thread-1): Finished running node model.sample_project.customer
2020-06-30 01:58:21.948461 (Thread-1): Began running node model.sample_project.nation
2020-06-30 01:58:21.948942 (Thread-1): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 01:58:21.949083 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer).
2020-06-30 01:58:21.949309 (Thread-1): Compiling model.sample_project.nation
2020-06-30 01:58:21.958653 (Thread-1): Writing injected SQL for node "model.sample_project.nation"
2020-06-30 01:58:21.959468 (Thread-1): finished collecting timing info
2020-06-30 01:58:21.959770 (Thread-1): finished collecting timing info
2020-06-30 01:58:21.960222 (Thread-1): Finished running node model.sample_project.nation
2020-06-30 01:58:21.960382 (Thread-1): Began running node model.sample_project.lineitem
2020-06-30 01:58:21.960667 (Thread-1): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 01:58:21.960779 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.nation).
2020-06-30 01:58:21.960886 (Thread-1): Compiling model.sample_project.lineitem
2020-06-30 01:58:21.970706 (Thread-1): Writing injected SQL for node "model.sample_project.lineitem"
2020-06-30 01:58:21.971433 (Thread-1): finished collecting timing info
2020-06-30 01:58:21.971752 (Thread-1): finished collecting timing info
2020-06-30 01:58:21.972241 (Thread-1): Finished running node model.sample_project.lineitem
2020-06-30 01:58:21.972402 (Thread-1): Began running node model.sample_project.orders
2020-06-30 01:58:21.972700 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 01:58:21.972924 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.lineitem).
2020-06-30 01:58:21.973199 (Thread-1): Compiling model.sample_project.orders
2020-06-30 01:58:21.983722 (Thread-1): Writing injected SQL for node "model.sample_project.orders"
2020-06-30 01:58:21.984151 (Thread-1): finished collecting timing info
2020-06-30 01:58:21.984422 (Thread-1): finished collecting timing info
2020-06-30 01:58:21.984829 (Thread-1): Finished running node model.sample_project.orders
2020-06-30 01:58:21.984975 (Thread-1): Began running node test.sample_project.not_null_customer_id
2020-06-30 01:58:21.985447 (Thread-1): Acquiring new snowflake connection "test.sample_project.not_null_customer_id".
2020-06-30 01:58:21.985561 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders).
2020-06-30 01:58:21.985662 (Thread-1): Compiling test.sample_project.not_null_customer_id
2020-06-30 01:58:22.000485 (Thread-1): Writing injected SQL for node "test.sample_project.not_null_customer_id"
2020-06-30 01:58:22.001524 (Thread-1): finished collecting timing info
2020-06-30 01:58:22.001873 (Thread-1): finished collecting timing info
2020-06-30 01:58:22.002339 (Thread-1): Finished running node test.sample_project.not_null_customer_id
2020-06-30 01:58:22.002500 (Thread-1): Began running node test.sample_project.unique_customer_id
2020-06-30 01:58:22.002763 (Thread-1): Acquiring new snowflake connection "test.sample_project.unique_customer_id".
2020-06-30 01:58:22.002876 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.not_null_customer_id).
2020-06-30 01:58:22.002974 (Thread-1): Compiling test.sample_project.unique_customer_id
2020-06-30 01:58:22.011911 (Thread-1): Writing injected SQL for node "test.sample_project.unique_customer_id"
2020-06-30 01:58:22.012288 (Thread-1): finished collecting timing info
2020-06-30 01:58:22.012528 (Thread-1): finished collecting timing info
2020-06-30 01:58:22.012889 (Thread-1): Finished running node test.sample_project.unique_customer_id
2020-06-30 01:58:22.013025 (Thread-1): Began running node model.sample_project.customer_nation
2020-06-30 01:58:22.013270 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 01:58:22.013367 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.unique_customer_id).
2020-06-30 01:58:22.013458 (Thread-1): Compiling model.sample_project.customer_nation
2020-06-30 01:58:22.021454 (Thread-1): Writing injected SQL for node "model.sample_project.customer_nation"
2020-06-30 01:58:22.021799 (Thread-1): finished collecting timing info
2020-06-30 01:58:22.022030 (Thread-1): finished collecting timing info
2020-06-30 01:58:22.022373 (Thread-1): Finished running node model.sample_project.customer_nation
2020-06-30 01:58:22.022503 (Thread-1): Began running node test.sample_project.not_null_nation_id
2020-06-30 01:58:22.022749 (Thread-1): Acquiring new snowflake connection "test.sample_project.not_null_nation_id".
2020-06-30 01:58:22.022920 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer_nation).
2020-06-30 01:58:22.023109 (Thread-1): Compiling test.sample_project.not_null_nation_id
2020-06-30 01:58:22.030855 (Thread-1): Writing injected SQL for node "test.sample_project.not_null_nation_id"
2020-06-30 01:58:22.031999 (Thread-1): finished collecting timing info
2020-06-30 01:58:22.032224 (Thread-1): finished collecting timing info
2020-06-30 01:58:22.032550 (Thread-1): Finished running node test.sample_project.not_null_nation_id
2020-06-30 01:58:22.032670 (Thread-1): Began running node test.sample_project.unique_nation_id
2020-06-30 01:58:22.032947 (Thread-1): Acquiring new snowflake connection "test.sample_project.unique_nation_id".
2020-06-30 01:58:22.033035 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.not_null_nation_id).
2020-06-30 01:58:22.033116 (Thread-1): Compiling test.sample_project.unique_nation_id
2020-06-30 01:58:22.040569 (Thread-1): Writing injected SQL for node "test.sample_project.unique_nation_id"
2020-06-30 01:58:22.040863 (Thread-1): finished collecting timing info
2020-06-30 01:58:22.041083 (Thread-1): finished collecting timing info
2020-06-30 01:58:22.041402 (Thread-1): Finished running node test.sample_project.unique_nation_id
2020-06-30 01:58:22.041523 (Thread-1): Began running node test.sample_project.not_null_lineitem_id
2020-06-30 01:58:22.041803 (Thread-1): Acquiring new snowflake connection "test.sample_project.not_null_lineitem_id".
2020-06-30 01:58:22.041901 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.unique_nation_id).
2020-06-30 01:58:22.041985 (Thread-1): Compiling test.sample_project.not_null_lineitem_id
2020-06-30 01:58:22.049689 (Thread-1): Writing injected SQL for node "test.sample_project.not_null_lineitem_id"
2020-06-30 01:58:22.050960 (Thread-1): finished collecting timing info
2020-06-30 01:58:22.051264 (Thread-1): finished collecting timing info
2020-06-30 01:58:22.051640 (Thread-1): Finished running node test.sample_project.not_null_lineitem_id
2020-06-30 01:58:22.051765 (Thread-1): Began running node test.sample_project.unique_lineitem_id
2020-06-30 01:58:22.051993 (Thread-1): Acquiring new snowflake connection "test.sample_project.unique_lineitem_id".
2020-06-30 01:58:22.052079 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.not_null_lineitem_id).
2020-06-30 01:58:22.052161 (Thread-1): Compiling test.sample_project.unique_lineitem_id
2020-06-30 01:58:22.060012 (Thread-1): Writing injected SQL for node "test.sample_project.unique_lineitem_id"
2020-06-30 01:58:22.060341 (Thread-1): finished collecting timing info
2020-06-30 01:58:22.060553 (Thread-1): finished collecting timing info
2020-06-30 01:58:22.060868 (Thread-1): Finished running node test.sample_project.unique_lineitem_id
2020-06-30 01:58:22.060989 (Thread-1): Began running node model.sample_project.orders_lineitem
2020-06-30 01:58:22.061206 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 01:58:22.061347 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.unique_lineitem_id).
2020-06-30 01:58:22.061449 (Thread-1): Compiling model.sample_project.orders_lineitem
2020-06-30 01:58:22.069333 (Thread-1): Writing injected SQL for node "model.sample_project.orders_lineitem"
2020-06-30 01:58:22.069648 (Thread-1): finished collecting timing info
2020-06-30 01:58:22.069862 (Thread-1): finished collecting timing info
2020-06-30 01:58:22.070185 (Thread-1): Finished running node model.sample_project.orders_lineitem
2020-06-30 01:58:22.070304 (Thread-1): Began running node test.sample_project.not_null_orders_id
2020-06-30 01:58:22.070516 (Thread-1): Acquiring new snowflake connection "test.sample_project.not_null_orders_id".
2020-06-30 01:58:22.070601 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders_lineitem).
2020-06-30 01:58:22.070680 (Thread-1): Compiling test.sample_project.not_null_orders_id
2020-06-30 01:58:22.078143 (Thread-1): Writing injected SQL for node "test.sample_project.not_null_orders_id"
2020-06-30 01:58:22.078492 (Thread-1): finished collecting timing info
2020-06-30 01:58:22.078714 (Thread-1): finished collecting timing info
2020-06-30 01:58:22.079035 (Thread-1): Finished running node test.sample_project.not_null_orders_id
2020-06-30 01:58:22.079153 (Thread-1): Began running node test.sample_project.unique_orders_id
2020-06-30 01:58:22.079368 (Thread-1): Acquiring new snowflake connection "test.sample_project.unique_orders_id".
2020-06-30 01:58:22.079455 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.not_null_orders_id).
2020-06-30 01:58:22.079536 (Thread-1): Compiling test.sample_project.unique_orders_id
2020-06-30 01:58:22.087015 (Thread-1): Writing injected SQL for node "test.sample_project.unique_orders_id"
2020-06-30 01:58:22.087331 (Thread-1): finished collecting timing info
2020-06-30 01:58:22.087776 (Thread-1): finished collecting timing info
2020-06-30 01:58:22.088115 (Thread-1): Finished running node test.sample_project.unique_orders_id
2020-06-30 01:58:22.088232 (Thread-1): Began running node model.sample_project.customers_per_nation
2020-06-30 01:58:22.088451 (Thread-1): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 01:58:22.088534 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.unique_orders_id).
2020-06-30 01:58:22.088611 (Thread-1): Compiling model.sample_project.customers_per_nation
2020-06-30 01:58:22.095029 (Thread-1): Writing injected SQL for node "model.sample_project.customers_per_nation"
2020-06-30 01:58:22.095325 (Thread-1): finished collecting timing info
2020-06-30 01:58:22.095536 (Thread-1): finished collecting timing info
2020-06-30 01:58:22.095851 (Thread-1): Finished running node model.sample_project.customers_per_nation
2020-06-30 01:58:22.095968 (Thread-1): Began running node model.sample_project.cust_list_ord_nat
2020-06-30 01:58:22.096180 (Thread-1): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 01:58:22.096263 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customers_per_nation).
2020-06-30 01:58:22.096340 (Thread-1): Compiling model.sample_project.cust_list_ord_nat
2020-06-30 01:58:22.103672 (Thread-1): Writing injected SQL for node "model.sample_project.cust_list_ord_nat"
2020-06-30 01:58:22.103960 (Thread-1): finished collecting timing info
2020-06-30 01:58:22.104175 (Thread-1): finished collecting timing info
2020-06-30 01:58:22.104493 (Thread-1): Finished running node model.sample_project.cust_list_ord_nat
2020-06-30 01:58:22.123009 (MainThread): Connection 'master' was properly closed.
2020-06-30 01:58:22.123378 (MainThread): Connection 'model.sample_project.cust_list_ord_nat' was left open.
2020-06-30 01:58:22.123615 (MainThread): On model.sample_project.cust_list_ord_nat: Close
2020-06-30 01:58:22.532801 (MainThread): 20:58:22 | Done.
2020-06-30 01:58:22.538640 (MainThread): Acquiring new snowflake connection "generate_catalog".
2020-06-30 01:58:22.538872 (MainThread): Opening a new connection, currently in state init
2020-06-30 01:58:22.539061 (MainThread): 20:58:22 | Building catalog
2020-06-30 01:58:22.619277 (ThreadPoolExecutor-2_0): Acquiring new snowflake connection "javen_testing.information_schema".
2020-06-30 01:58:22.619500 (ThreadPoolExecutor-2_0): Opening a new connection, currently in state init
2020-06-30 01:58:22.626973 (ThreadPoolExecutor-2_0): Using snowflake connection "javen_testing.information_schema".
2020-06-30 01:58:22.627070 (ThreadPoolExecutor-2_0): On javen_testing.information_schema: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "snowflake-sso", "target_name": "dev", "connection_name": "javen_testing.information_schema"} */

    
      with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include"

          from javen_testing.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              null as "table_comment",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              null as "column_comment"

          from javen_testing.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('test'))
      order by "column_index"
2020-06-30 01:58:33.127213 (ThreadPoolExecutor-2_0): SQL status: SUCCESS 56 in 10.50 seconds
2020-06-30 01:58:33.145470 (ThreadPoolExecutor-2_0): Acquiring new snowflake connection "snowflake_sample_data.information_schema".
2020-06-30 01:58:33.145697 (ThreadPoolExecutor-2_0): Re-using an available connection from the pool (formerly javen_testing.information_schema).
2020-06-30 01:58:33.150614 (ThreadPoolExecutor-2_0): Using snowflake connection "snowflake_sample_data.information_schema".
2020-06-30 01:58:33.150727 (ThreadPoolExecutor-2_0): On snowflake_sample_data.information_schema: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "snowflake-sso", "target_name": "dev", "connection_name": "snowflake_sample_data.information_schema"} */

    
      with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include"

          from snowflake_sample_data.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              null as "table_comment",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              null as "column_comment"

          from snowflake_sample_data.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('tpch_sf1'))
      order by "column_index"
2020-06-30 01:58:35.642787 (ThreadPoolExecutor-2_0): SQL status: SUCCESS 61 in 2.49 seconds
2020-06-30 01:58:35.779297 (MainThread): 20:58:35 | Catalog written to /Users/johnaven/Documents/gitlab_projects/dbt-demo-June-2020/sample_project/target/catalog.json
2020-06-30 01:58:35.779808 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11022dd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110268710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f922fd0>]}
2020-06-30 01:58:35.780015 (MainThread): Flushing usage events
2020-06-30 01:58:36.205260 (MainThread): Connection 'generate_catalog' was properly closed.
2020-06-30 01:58:36.205432 (MainThread): Connection 'snowflake_sample_data.information_schema' was left open.
2020-06-30 01:58:36.205540 (MainThread): On snowflake_sample_data.information_schema: Close
2020-06-30 01:59:12.145771 (MainThread): Running with dbt=0.17.0
2020-06-30 01:59:12.603806 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-06-30 01:59:12.604540 (MainThread): Tracking: tracking
2020-06-30 01:59:12.604820 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11218bed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11219dd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11219dc50>]}
2020-06-30 01:59:12.624413 (MainThread): Partial parsing not enabled
2020-06-30 01:59:12.626057 (MainThread): Parsing macros/core.sql
2020-06-30 01:59:12.630534 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-30 01:59:12.638270 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-30 01:59:12.639993 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-30 01:59:12.657678 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-30 01:59:12.690648 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-30 01:59:12.714450 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-30 01:59:12.716788 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-30 01:59:12.723442 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-30 01:59:12.737687 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-30 01:59:12.746880 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-30 01:59:12.753793 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-30 01:59:12.758949 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-30 01:59:12.759928 (MainThread): Parsing macros/etc/query.sql
2020-06-30 01:59:12.761340 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-30 01:59:12.763029 (MainThread): Parsing macros/etc/datetime.sql
2020-06-30 01:59:12.772242 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-30 01:59:12.774282 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-30 01:59:12.775976 (MainThread): Parsing macros/adapters/common.sql
2020-06-30 01:59:12.827686 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-30 01:59:12.828883 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-30 01:59:12.829839 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-30 01:59:12.831276 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-30 01:59:12.833833 (MainThread): Parsing macros/catalog.sql
2020-06-30 01:59:12.835766 (MainThread): Parsing macros/adapters.sql
2020-06-30 01:59:12.859250 (MainThread): Parsing macros/materializations/merge.sql
2020-06-30 01:59:12.861354 (MainThread): Parsing macros/materializations/view.sql
2020-06-30 01:59:12.862605 (MainThread): Parsing macros/materializations/table.sql
2020-06-30 01:59:12.866769 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-30 01:59:12.894693 (MainThread): Partial parsing not enabled
2020-06-30 01:59:12.931091 (MainThread): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 01:59:12.931198 (MainThread): Opening a new connection, currently in state init
2020-06-30 01:59:12.960740 (MainThread): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 01:59:12.960832 (MainThread): Opening a new connection, currently in state init
2020-06-30 01:59:12.971636 (MainThread): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 01:59:12.971723 (MainThread): Opening a new connection, currently in state init
2020-06-30 01:59:12.982681 (MainThread): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 01:59:12.982772 (MainThread): Opening a new connection, currently in state init
2020-06-30 01:59:12.996980 (MainThread): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 01:59:12.997184 (MainThread): Opening a new connection, currently in state init
2020-06-30 01:59:13.009952 (MainThread): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 01:59:13.010047 (MainThread): Opening a new connection, currently in state init
2020-06-30 01:59:13.023049 (MainThread): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 01:59:13.023147 (MainThread): Opening a new connection, currently in state init
2020-06-30 01:59:13.034993 (MainThread): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 01:59:13.035081 (MainThread): Opening a new connection, currently in state init
2020-06-30 01:59:13.349602 (MainThread): Found 8 models, 8 tests, 0 snapshots, 0 analyses, 136 macros, 0 operations, 0 seed files, 4 sources
2020-06-30 01:59:13.350859 (MainThread): 
2020-06-30 01:59:13.351109 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 01:59:13.351189 (MainThread): Opening a new connection, currently in state init
2020-06-30 01:59:13.352526 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_javen_testing".
2020-06-30 01:59:13.352621 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-06-30 01:59:13.370736 (ThreadPoolExecutor-0_0): Using snowflake connection "list_javen_testing".
2020-06-30 01:59:13.370983 (ThreadPoolExecutor-0_0): On list_javen_testing: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "snowflake-sso", "target_name": "dev", "connection_name": "list_javen_testing"} */

    show terse schemas in database javen_testing
    limit 10000
2020-06-30 01:59:13.837015 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/certifi/cacert.pem'>
2020-06-30 01:59:23.854867 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 10.48 seconds
2020-06-30 01:59:23.883896 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_javen_testing_test".
2020-06-30 01:59:23.884027 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_javen_testing).
2020-06-30 01:59:23.891717 (ThreadPoolExecutor-1_0): Using snowflake connection "list_javen_testing_test".
2020-06-30 01:59:23.891823 (ThreadPoolExecutor-1_0): On list_javen_testing_test: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "snowflake-sso", "target_name": "dev", "connection_name": "list_javen_testing_test"} */

    show terse objects in javen_testing.test
2020-06-30 01:59:24.070336 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 0.18 seconds
2020-06-30 01:59:24.079204 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 01:59:24.079347 (MainThread): Opening a new connection, currently in state init
2020-06-30 01:59:24.079569 (MainThread): Using snowflake connection "master".
2020-06-30 01:59:24.079687 (MainThread): On master: BEGIN
2020-06-30 01:59:34.236619 (MainThread): SQL status: SUCCESS 1 in 10.16 seconds
2020-06-30 01:59:34.237026 (MainThread): On master: COMMIT
2020-06-30 01:59:34.237255 (MainThread): Using snowflake connection "master".
2020-06-30 01:59:34.237390 (MainThread): On master: COMMIT
2020-06-30 01:59:34.474384 (MainThread): SQL status: SUCCESS 1 in 0.24 seconds
2020-06-30 01:59:34.475349 (MainThread): 20:59:34 | Concurrency: 1 threads (target='dev')
2020-06-30 01:59:34.475584 (MainThread): 20:59:34 | 
2020-06-30 01:59:34.476887 (Thread-1): Began running node model.sample_project.customer
2020-06-30 01:59:34.477360 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 01:59:34.477525 (Thread-1): Re-using an available connection from the pool (formerly list_javen_testing_test).
2020-06-30 01:59:34.477692 (Thread-1): Compiling model.sample_project.customer
2020-06-30 01:59:34.503490 (Thread-1): Writing injected SQL for node "model.sample_project.customer"
2020-06-30 01:59:34.504260 (Thread-1): finished collecting timing info
2020-06-30 01:59:34.504905 (Thread-1): Finished running node model.sample_project.customer
2020-06-30 01:59:34.505082 (Thread-1): Began running node model.sample_project.nation
2020-06-30 01:59:34.505606 (Thread-1): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 01:59:34.505743 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer).
2020-06-30 01:59:34.505863 (Thread-1): Compiling model.sample_project.nation
2020-06-30 01:59:34.517612 (Thread-1): Writing injected SQL for node "model.sample_project.nation"
2020-06-30 01:59:34.518110 (Thread-1): finished collecting timing info
2020-06-30 01:59:34.518629 (Thread-1): Finished running node model.sample_project.nation
2020-06-30 01:59:34.518800 (Thread-1): Began running node model.sample_project.lineitem
2020-06-30 01:59:34.519099 (Thread-1): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 01:59:34.519214 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.nation).
2020-06-30 01:59:34.519325 (Thread-1): Compiling model.sample_project.lineitem
2020-06-30 01:59:34.529017 (Thread-1): Writing injected SQL for node "model.sample_project.lineitem"
2020-06-30 01:59:34.529435 (Thread-1): finished collecting timing info
2020-06-30 01:59:34.529908 (Thread-1): Finished running node model.sample_project.lineitem
2020-06-30 01:59:34.530074 (Thread-1): Began running node model.sample_project.orders
2020-06-30 01:59:34.530372 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 01:59:34.530490 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.lineitem).
2020-06-30 01:59:34.530601 (Thread-1): Compiling model.sample_project.orders
2020-06-30 01:59:34.541242 (Thread-1): Writing injected SQL for node "model.sample_project.orders"
2020-06-30 01:59:34.542070 (Thread-1): finished collecting timing info
2020-06-30 01:59:34.542839 (Thread-1): Finished running node model.sample_project.orders
2020-06-30 01:59:34.543035 (Thread-1): Began running node model.sample_project.customer_nation
2020-06-30 01:59:34.543356 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 01:59:34.543482 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders).
2020-06-30 01:59:34.543601 (Thread-1): Compiling model.sample_project.customer_nation
2020-06-30 01:59:34.557793 (Thread-1): Writing injected SQL for node "model.sample_project.customer_nation"
2020-06-30 01:59:34.558202 (Thread-1): finished collecting timing info
2020-06-30 01:59:34.558636 (Thread-1): Finished running node model.sample_project.customer_nation
2020-06-30 01:59:34.558780 (Thread-1): Began running node model.sample_project.orders_lineitem
2020-06-30 01:59:34.559042 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 01:59:34.559146 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer_nation).
2020-06-30 01:59:34.559245 (Thread-1): Compiling model.sample_project.orders_lineitem
2020-06-30 01:59:34.571778 (Thread-1): Writing injected SQL for node "model.sample_project.orders_lineitem"
2020-06-30 01:59:34.572170 (Thread-1): finished collecting timing info
2020-06-30 01:59:34.572560 (Thread-1): Finished running node model.sample_project.orders_lineitem
2020-06-30 01:59:34.572698 (Thread-1): Began running node model.sample_project.customers_per_nation
2020-06-30 01:59:34.573687 (Thread-1): 20:59:34 | 1 of 1 START table model test.customers_per_nation................... [RUN]
2020-06-30 01:59:34.574077 (Thread-1): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 01:59:34.574182 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders_lineitem).
2020-06-30 01:59:34.574274 (Thread-1): Compiling model.sample_project.customers_per_nation
2020-06-30 01:59:34.583012 (Thread-1): Writing injected SQL for node "model.sample_project.customers_per_nation"
2020-06-30 01:59:34.583361 (Thread-1): finished collecting timing info
2020-06-30 01:59:34.616032 (Thread-1): Writing runtime SQL for node "model.sample_project.customers_per_nation"
2020-06-30 01:59:34.618242 (Thread-1): Using snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 01:59:34.618349 (Thread-1): On model.sample_project.customers_per_nation: BEGIN
2020-06-30 01:59:34.835642 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2020-06-30 01:59:34.835904 (Thread-1): Using snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 01:59:34.836072 (Thread-1): On model.sample_project.customers_per_nation: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "snowflake-sso", "target_name": "dev", "node_id": "model.sample_project.customers_per_nation"} */


      create or replace transient table javen_testing.test.customers_per_nation  as
      (with __dbt__CTE__customer as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  c_custkey as custkey,
        c_nationkey as nationkey,
        c_name as name
from snowflake_sample_data.tpch_sf1.customer
),  __dbt__CTE__nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  n_nationkey as nationkey,
        n_name as name
from snowflake_sample_data.tpch_sf1.nation
),  __dbt__CTE__customer_nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  c.custkey,
        c.nationkey,
        c.name as customer_name,
        n.name as nation_name
from __dbt__CTE__customer as c
JOIN __dbt__CTE__nation as n
ON c.nationkey=n.nationkey
)/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  count(customer_name),
        nation_name
from __dbt__CTE__customer_nation
group by nation_name
order by nation_name
      );
2020-06-30 01:59:35.436854 (Thread-1): Snowflake query id: 01953e57-0245-c11f-0000-2aed011cd13a
2020-06-30 01:59:35.437100 (Thread-1): Snowflake error: 002022 (42601): SQL compilation error:
Missing column specification
2020-06-30 01:59:35.437286 (Thread-1): On model.sample_project.customers_per_nation: ROLLBACK
2020-06-30 01:59:35.437433 (Thread-1): initiating rollback
2020-06-30 01:59:35.667049 (Thread-1): finished collecting timing info
2020-06-30 01:59:35.667878 (Thread-1): Database Error in model customers_per_nation (models/reports/customers_per_nation.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled SQL at target/run/sample_project/models/reports/customers_per_nation.sql
Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 158, in exception_handler
    yield
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/cursor.py", line 597, in execute
    errvalue)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/errors.py", line 97, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, errorclass, errorvalue)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/errors.py", line 73, in default_errorhandler
    done_format_msg=errorvalue.get(u'done_format_msg'))
snowflake.connector.errors.ProgrammingError: 002022 (42601): SQL compilation error:
Missing column specification

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 119, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 306, in add_query
    abridge_sql_log=abridge_sql_log
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/usr/local/opt/python/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 177, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model customers_per_nation (models/reports/customers_per_nation.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled SQL at target/run/sample_project/models/reports/customers_per_nation.sql
2020-06-30 01:59:35.683217 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c087fa7-bb5f-456b-8e46-761041e60446', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11286af50>]}
2020-06-30 01:59:35.684959 (Thread-1): 20:59:35 | 1 of 1 ERROR creating table model test.customers_per_nation.......... [ERROR in 1.11s]
2020-06-30 01:59:35.685165 (Thread-1): Finished running node model.sample_project.customers_per_nation
2020-06-30 01:59:35.685393 (Thread-1): Began running node model.sample_project.cust_list_ord_nat
2020-06-30 01:59:35.685771 (Thread-1): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 01:59:35.685899 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customers_per_nation).
2020-06-30 01:59:35.686025 (Thread-1): Compiling model.sample_project.cust_list_ord_nat
2020-06-30 01:59:35.706239 (Thread-1): Writing injected SQL for node "model.sample_project.cust_list_ord_nat"
2020-06-30 01:59:35.707176 (Thread-1): finished collecting timing info
2020-06-30 01:59:35.708168 (Thread-1): Finished running node model.sample_project.cust_list_ord_nat
2020-06-30 01:59:35.807979 (MainThread): Using snowflake connection "master".
2020-06-30 01:59:35.808234 (MainThread): On master: BEGIN
2020-06-30 01:59:36.044457 (MainThread): SQL status: SUCCESS 1 in 0.24 seconds
2020-06-30 01:59:36.044736 (MainThread): On master: COMMIT
2020-06-30 01:59:36.044970 (MainThread): Using snowflake connection "master".
2020-06-30 01:59:36.045130 (MainThread): On master: COMMIT
2020-06-30 01:59:36.469095 (MainThread): SQL status: SUCCESS 1 in 0.42 seconds
2020-06-30 01:59:36.469564 (MainThread): 20:59:36 | 
2020-06-30 01:59:36.469758 (MainThread): 20:59:36 | Finished running 1 table model in 23.12s.
2020-06-30 01:59:36.469920 (MainThread): Connection 'master' was left open.
2020-06-30 01:59:36.470052 (MainThread): On master: Close
2020-06-30 01:59:36.805949 (MainThread): Connection 'model.sample_project.cust_list_ord_nat' was left open.
2020-06-30 01:59:36.806101 (MainThread): On model.sample_project.cust_list_ord_nat: Close
2020-06-30 01:59:37.090504 (MainThread): 
2020-06-30 01:59:37.090680 (MainThread): Completed with 1 error and 0 warnings:
2020-06-30 01:59:37.090806 (MainThread): 
2020-06-30 01:59:37.090945 (MainThread): Database Error in model customers_per_nation (models/reports/customers_per_nation.sql)
2020-06-30 01:59:37.091096 (MainThread):   002022 (42601): SQL compilation error:
2020-06-30 01:59:37.091202 (MainThread):   Missing column specification
2020-06-30 01:59:37.091306 (MainThread):   compiled SQL at target/run/sample_project/models/reports/customers_per_nation.sql
2020-06-30 01:59:37.091411 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2020-06-30 01:59:37.091617 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b8a110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112bb5ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112bb5c90>]}
2020-06-30 01:59:37.091806 (MainThread): Flushing usage events
2020-06-30 02:00:26.829649 (MainThread): Running with dbt=0.17.0
2020-06-30 02:00:27.145323 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-06-30 02:00:27.146096 (MainThread): Tracking: tracking
2020-06-30 02:00:27.146443 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11158e9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115a0250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115a0ed0>]}
2020-06-30 02:00:27.168907 (MainThread): Partial parsing not enabled
2020-06-30 02:00:27.171244 (MainThread): Parsing macros/core.sql
2020-06-30 02:00:27.176496 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-30 02:00:27.184891 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-30 02:00:27.186654 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-30 02:00:27.204962 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-30 02:00:27.243220 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-30 02:00:27.271136 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-30 02:00:27.273846 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-30 02:00:27.281060 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-30 02:00:27.296620 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-30 02:00:27.304558 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-30 02:00:27.311834 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-30 02:00:27.317235 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-30 02:00:27.318269 (MainThread): Parsing macros/etc/query.sql
2020-06-30 02:00:27.319506 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-30 02:00:27.321331 (MainThread): Parsing macros/etc/datetime.sql
2020-06-30 02:00:27.331413 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-30 02:00:27.333590 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-30 02:00:27.335553 (MainThread): Parsing macros/adapters/common.sql
2020-06-30 02:00:27.393092 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-30 02:00:27.394394 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-30 02:00:27.395395 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-30 02:00:27.396579 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-30 02:00:27.399088 (MainThread): Parsing macros/catalog.sql
2020-06-30 02:00:27.401149 (MainThread): Parsing macros/adapters.sql
2020-06-30 02:00:27.424649 (MainThread): Parsing macros/materializations/merge.sql
2020-06-30 02:00:27.426885 (MainThread): Parsing macros/materializations/view.sql
2020-06-30 02:00:27.428123 (MainThread): Parsing macros/materializations/table.sql
2020-06-30 02:00:27.432517 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-30 02:00:27.465535 (MainThread): Partial parsing not enabled
2020-06-30 02:00:27.503069 (MainThread): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 02:00:27.503194 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:00:27.532055 (MainThread): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 02:00:27.532151 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:00:27.543221 (MainThread): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 02:00:27.543309 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:00:27.554210 (MainThread): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 02:00:27.554302 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:00:27.565565 (MainThread): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 02:00:27.565654 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:00:27.578202 (MainThread): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 02:00:27.578292 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:00:27.590095 (MainThread): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 02:00:27.590189 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:00:27.602419 (MainThread): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 02:00:27.602515 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:00:27.936831 (MainThread): Found 8 models, 8 tests, 0 snapshots, 0 analyses, 136 macros, 0 operations, 0 seed files, 4 sources
2020-06-30 02:00:27.938150 (MainThread): 
2020-06-30 02:00:27.938412 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 02:00:27.938496 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:00:27.939759 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_JAVEN_TESTING".
2020-06-30 02:00:27.939984 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-06-30 02:00:27.953250 (ThreadPoolExecutor-0_0): Using snowflake connection "list_JAVEN_TESTING".
2020-06-30 02:00:27.953341 (ThreadPoolExecutor-0_0): On list_JAVEN_TESTING: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING"} */

    show terse schemas in database JAVEN_TESTING
    limit 10000
2020-06-30 02:00:28.440923 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/certifi/cacert.pem'>
2020-06-30 02:00:37.294160 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 9.34 seconds
2020-06-30 02:00:37.326552 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 02:00:37.326680 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_JAVEN_TESTING).
2020-06-30 02:00:37.334196 (ThreadPoolExecutor-1_0): Using snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 02:00:37.334303 (ThreadPoolExecutor-1_0): On list_JAVEN_TESTING_TEST: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING_TEST"} */

    show terse objects in JAVEN_TESTING.TEST
2020-06-30 02:00:37.517489 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 0.18 seconds
2020-06-30 02:00:37.526642 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 02:00:37.526783 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:00:37.526986 (MainThread): Using snowflake connection "master".
2020-06-30 02:00:37.527099 (MainThread): On master: BEGIN
2020-06-30 02:00:42.099490 (MainThread): SQL status: SUCCESS 1 in 4.57 seconds
2020-06-30 02:00:42.099794 (MainThread): On master: COMMIT
2020-06-30 02:00:42.100033 (MainThread): Using snowflake connection "master".
2020-06-30 02:00:42.100194 (MainThread): On master: COMMIT
2020-06-30 02:00:42.407955 (MainThread): SQL status: SUCCESS 1 in 0.31 seconds
2020-06-30 02:00:42.408309 (MainThread): 21:00:42 | Concurrency: 1 threads (target='dev')
2020-06-30 02:00:42.408449 (MainThread): 21:00:42 | 
2020-06-30 02:00:42.409185 (Thread-1): Began running node model.sample_project.customer
2020-06-30 02:00:42.409496 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 02:00:42.409600 (Thread-1): Re-using an available connection from the pool (formerly list_JAVEN_TESTING_TEST).
2020-06-30 02:00:42.409704 (Thread-1): Compiling model.sample_project.customer
2020-06-30 02:00:42.429235 (Thread-1): Writing injected SQL for node "model.sample_project.customer"
2020-06-30 02:00:42.429714 (Thread-1): finished collecting timing info
2020-06-30 02:00:42.430178 (Thread-1): Finished running node model.sample_project.customer
2020-06-30 02:00:42.430321 (Thread-1): Began running node model.sample_project.nation
2020-06-30 02:00:42.430571 (Thread-1): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 02:00:42.430669 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer).
2020-06-30 02:00:42.430762 (Thread-1): Compiling model.sample_project.nation
2020-06-30 02:00:42.442652 (Thread-1): Writing injected SQL for node "model.sample_project.nation"
2020-06-30 02:00:42.443812 (Thread-1): finished collecting timing info
2020-06-30 02:00:42.444514 (Thread-1): Finished running node model.sample_project.nation
2020-06-30 02:00:42.444726 (Thread-1): Began running node model.sample_project.lineitem
2020-06-30 02:00:42.445070 (Thread-1): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 02:00:42.445191 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.nation).
2020-06-30 02:00:42.445310 (Thread-1): Compiling model.sample_project.lineitem
2020-06-30 02:00:42.455576 (Thread-1): Writing injected SQL for node "model.sample_project.lineitem"
2020-06-30 02:00:42.456518 (Thread-1): finished collecting timing info
2020-06-30 02:00:42.457232 (Thread-1): Finished running node model.sample_project.lineitem
2020-06-30 02:00:42.457479 (Thread-1): Began running node model.sample_project.orders
2020-06-30 02:00:42.458042 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 02:00:42.458193 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.lineitem).
2020-06-30 02:00:42.458314 (Thread-1): Compiling model.sample_project.orders
2020-06-30 02:00:42.469975 (Thread-1): Writing injected SQL for node "model.sample_project.orders"
2020-06-30 02:00:42.470414 (Thread-1): finished collecting timing info
2020-06-30 02:00:42.470909 (Thread-1): Finished running node model.sample_project.orders
2020-06-30 02:00:42.471082 (Thread-1): Began running node model.sample_project.customer_nation
2020-06-30 02:00:42.471380 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 02:00:42.471670 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders).
2020-06-30 02:00:42.471814 (Thread-1): Compiling model.sample_project.customer_nation
2020-06-30 02:00:42.485322 (Thread-1): Writing injected SQL for node "model.sample_project.customer_nation"
2020-06-30 02:00:42.485656 (Thread-1): finished collecting timing info
2020-06-30 02:00:42.486066 (Thread-1): Finished running node model.sample_project.customer_nation
2020-06-30 02:00:42.486211 (Thread-1): Began running node model.sample_project.orders_lineitem
2020-06-30 02:00:42.486479 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 02:00:42.486580 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer_nation).
2020-06-30 02:00:42.486675 (Thread-1): Compiling model.sample_project.orders_lineitem
2020-06-30 02:00:42.498941 (Thread-1): Writing injected SQL for node "model.sample_project.orders_lineitem"
2020-06-30 02:00:42.499391 (Thread-1): finished collecting timing info
2020-06-30 02:00:42.499792 (Thread-1): Finished running node model.sample_project.orders_lineitem
2020-06-30 02:00:42.499929 (Thread-1): Began running node model.sample_project.customers_per_nation
2020-06-30 02:00:42.500904 (Thread-1): 21:00:42 | 1 of 1 START table model TEST.customers_per_nation................... [RUN]
2020-06-30 02:00:42.501286 (Thread-1): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 02:00:42.501393 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders_lineitem).
2020-06-30 02:00:42.501490 (Thread-1): Compiling model.sample_project.customers_per_nation
2020-06-30 02:00:42.510035 (Thread-1): Writing injected SQL for node "model.sample_project.customers_per_nation"
2020-06-30 02:00:42.510327 (Thread-1): finished collecting timing info
2020-06-30 02:00:42.541421 (Thread-1): Writing runtime SQL for node "model.sample_project.customers_per_nation"
2020-06-30 02:00:42.543554 (Thread-1): Using snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 02:00:42.543663 (Thread-1): On model.sample_project.customers_per_nation: BEGIN
2020-06-30 02:00:42.764703 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2020-06-30 02:00:42.764955 (Thread-1): Using snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 02:00:42.765121 (Thread-1): On model.sample_project.customers_per_nation: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "model.sample_project.customers_per_nation"} */


      create or replace transient table JAVEN_TESTING.TEST.customers_per_nation  as
      (with __dbt__CTE__customer as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  c_custkey as custkey,
        c_nationkey as nationkey,
        c_name as name
from snowflake_sample_data.tpch_sf1.customer
),  __dbt__CTE__nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  n_nationkey as nationkey,
        n_name as name
from snowflake_sample_data.tpch_sf1.nation
),  __dbt__CTE__customer_nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  c.custkey,
        c.nationkey,
        c.name as customer_name,
        n.name as nation_name
from __dbt__CTE__customer as c
JOIN __dbt__CTE__nation as n
ON c.nationkey=n.nationkey
)/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  count(customer_name),
        nation_name
from __dbt__CTE__customer_nation
group by nation_name
order by nation_name
      );
2020-06-30 02:00:43.195900 (Thread-1): Snowflake query id: 01953e58-024e-851a-0000-2aed011cd142
2020-06-30 02:00:43.196145 (Thread-1): Snowflake error: 002022 (42601): SQL compilation error:
Missing column specification
2020-06-30 02:00:43.196330 (Thread-1): On model.sample_project.customers_per_nation: ROLLBACK
2020-06-30 02:00:43.196478 (Thread-1): initiating rollback
2020-06-30 02:00:43.434886 (Thread-1): finished collecting timing info
2020-06-30 02:00:43.435692 (Thread-1): Database Error in model customers_per_nation (models/reports/customers_per_nation.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled SQL at target/run/sample_project/models/reports/customers_per_nation.sql
Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 158, in exception_handler
    yield
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/cursor.py", line 597, in execute
    errvalue)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/errors.py", line 97, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, errorclass, errorvalue)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/errors.py", line 73, in default_errorhandler
    done_format_msg=errorvalue.get(u'done_format_msg'))
snowflake.connector.errors.ProgrammingError: 002022 (42601): SQL compilation error:
Missing column specification

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 119, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 306, in add_query
    abridge_sql_log=abridge_sql_log
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/usr/local/opt/python/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 177, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model customers_per_nation (models/reports/customers_per_nation.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled SQL at target/run/sample_project/models/reports/customers_per_nation.sql
2020-06-30 02:00:43.438825 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8bfc6d90-3a71-4689-bd99-1321da4180b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d50d10>]}
2020-06-30 02:00:43.440416 (Thread-1): 21:00:43 | 1 of 1 ERROR creating table model TEST.customers_per_nation.......... [ERROR in 0.94s]
2020-06-30 02:00:43.440596 (Thread-1): Finished running node model.sample_project.customers_per_nation
2020-06-30 02:00:43.440774 (Thread-1): Began running node model.sample_project.cust_list_ord_nat
2020-06-30 02:00:43.441100 (Thread-1): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 02:00:43.441233 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customers_per_nation).
2020-06-30 02:00:43.441493 (Thread-1): Compiling model.sample_project.cust_list_ord_nat
2020-06-30 02:00:43.461518 (Thread-1): Writing injected SQL for node "model.sample_project.cust_list_ord_nat"
2020-06-30 02:00:43.463176 (Thread-1): finished collecting timing info
2020-06-30 02:00:43.463965 (Thread-1): Finished running node model.sample_project.cust_list_ord_nat
2020-06-30 02:00:43.545737 (MainThread): Using snowflake connection "master".
2020-06-30 02:00:43.546065 (MainThread): On master: BEGIN
2020-06-30 02:00:43.756467 (MainThread): SQL status: SUCCESS 1 in 0.21 seconds
2020-06-30 02:00:43.756746 (MainThread): On master: COMMIT
2020-06-30 02:00:43.756979 (MainThread): Using snowflake connection "master".
2020-06-30 02:00:43.757157 (MainThread): On master: COMMIT
2020-06-30 02:00:44.016740 (MainThread): SQL status: SUCCESS 1 in 0.26 seconds
2020-06-30 02:00:44.017303 (MainThread): 21:00:44 | 
2020-06-30 02:00:44.017494 (MainThread): 21:00:44 | Finished running 1 table model in 16.08s.
2020-06-30 02:00:44.017649 (MainThread): Connection 'master' was left open.
2020-06-30 02:00:44.017775 (MainThread): On master: Close
2020-06-30 02:00:44.287102 (MainThread): Connection 'model.sample_project.cust_list_ord_nat' was left open.
2020-06-30 02:00:44.287312 (MainThread): On model.sample_project.cust_list_ord_nat: Close
2020-06-30 02:00:44.580100 (MainThread): 
2020-06-30 02:00:44.580291 (MainThread): Completed with 1 error and 0 warnings:
2020-06-30 02:00:44.580430 (MainThread): 
2020-06-30 02:00:44.580565 (MainThread): Database Error in model customers_per_nation (models/reports/customers_per_nation.sql)
2020-06-30 02:00:44.580688 (MainThread):   002022 (42601): SQL compilation error:
2020-06-30 02:00:44.580802 (MainThread):   Missing column specification
2020-06-30 02:00:44.580914 (MainThread):   compiled SQL at target/run/sample_project/models/reports/customers_per_nation.sql
2020-06-30 02:00:44.581032 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2020-06-30 02:00:44.581217 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111dff510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fcf490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11219c390>]}
2020-06-30 02:00:44.581427 (MainThread): Flushing usage events
2020-06-30 02:01:54.654726 (MainThread): Running with dbt=0.17.0
2020-06-30 02:01:54.992600 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-06-30 02:01:54.993349 (MainThread): Tracking: tracking
2020-06-30 02:01:54.993663 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1c1f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1d21d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1d2e90>]}
2020-06-30 02:01:55.014255 (MainThread): Partial parsing not enabled
2020-06-30 02:01:55.016358 (MainThread): Parsing macros/core.sql
2020-06-30 02:01:55.021822 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-30 02:01:55.030858 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-30 02:01:55.032849 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-30 02:01:55.051150 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-30 02:01:55.084094 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-30 02:01:55.106384 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-30 02:01:55.108952 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-30 02:01:55.115680 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-30 02:01:55.135191 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-30 02:01:55.142869 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-30 02:01:55.149658 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-30 02:01:55.154869 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-30 02:01:55.155968 (MainThread): Parsing macros/etc/query.sql
2020-06-30 02:01:55.157054 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-30 02:01:55.159264 (MainThread): Parsing macros/etc/datetime.sql
2020-06-30 02:01:55.169391 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-30 02:01:55.171930 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-30 02:01:55.173877 (MainThread): Parsing macros/adapters/common.sql
2020-06-30 02:01:55.229747 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-30 02:01:55.231147 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-30 02:01:55.232187 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-30 02:01:55.233406 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-30 02:01:55.235856 (MainThread): Parsing macros/catalog.sql
2020-06-30 02:01:55.237895 (MainThread): Parsing macros/adapters.sql
2020-06-30 02:01:55.261881 (MainThread): Parsing macros/materializations/merge.sql
2020-06-30 02:01:55.264049 (MainThread): Parsing macros/materializations/view.sql
2020-06-30 02:01:55.265348 (MainThread): Parsing macros/materializations/table.sql
2020-06-30 02:01:55.269996 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-30 02:01:55.298390 (MainThread): Partial parsing not enabled
2020-06-30 02:01:55.334830 (MainThread): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 02:01:55.334933 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:01:55.363795 (MainThread): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 02:01:55.363888 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:01:55.375257 (MainThread): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 02:01:55.375344 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:01:55.390440 (MainThread): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 02:01:55.390567 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:01:55.401462 (MainThread): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 02:01:55.401549 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:01:55.413703 (MainThread): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 02:01:55.413791 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:01:55.426277 (MainThread): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 02:01:55.426365 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:01:55.438275 (MainThread): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 02:01:55.438361 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:01:55.765634 (MainThread): Found 8 models, 8 tests, 0 snapshots, 0 analyses, 136 macros, 0 operations, 0 seed files, 4 sources
2020-06-30 02:01:55.767004 (MainThread): 
2020-06-30 02:01:55.767263 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 02:01:55.767384 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:01:55.768776 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_JAVEN_TESTING".
2020-06-30 02:01:55.768872 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-06-30 02:01:55.781994 (ThreadPoolExecutor-0_0): Using snowflake connection "list_JAVEN_TESTING".
2020-06-30 02:01:55.782082 (ThreadPoolExecutor-0_0): On list_JAVEN_TESTING: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING"} */

    show terse schemas in database JAVEN_TESTING
    limit 10000
2020-06-30 02:01:56.315518 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/certifi/cacert.pem'>
2020-06-30 02:02:03.183056 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 7.40 seconds
2020-06-30 02:02:03.214389 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 02:02:03.214505 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_JAVEN_TESTING).
2020-06-30 02:02:03.221578 (ThreadPoolExecutor-1_0): Using snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 02:02:03.221690 (ThreadPoolExecutor-1_0): On list_JAVEN_TESTING_TEST: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING_TEST"} */

    show terse objects in JAVEN_TESTING.TEST
2020-06-30 02:02:03.426964 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 0.21 seconds
2020-06-30 02:02:03.435416 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 02:02:03.435562 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:02:03.435762 (MainThread): Using snowflake connection "master".
2020-06-30 02:02:03.435872 (MainThread): On master: BEGIN
2020-06-30 02:02:07.835557 (MainThread): SQL status: SUCCESS 1 in 4.40 seconds
2020-06-30 02:02:07.835837 (MainThread): On master: COMMIT
2020-06-30 02:02:07.836072 (MainThread): Using snowflake connection "master".
2020-06-30 02:02:07.836229 (MainThread): On master: COMMIT
2020-06-30 02:02:08.225742 (MainThread): SQL status: SUCCESS 1 in 0.39 seconds
2020-06-30 02:02:08.226314 (MainThread): 21:02:08 | Concurrency: 1 threads (target='dev')
2020-06-30 02:02:08.226553 (MainThread): 21:02:08 | 
2020-06-30 02:02:08.227682 (Thread-1): Began running node model.sample_project.customer
2020-06-30 02:02:08.228099 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 02:02:08.228244 (Thread-1): Re-using an available connection from the pool (formerly list_JAVEN_TESTING_TEST).
2020-06-30 02:02:08.228386 (Thread-1): Compiling model.sample_project.customer
2020-06-30 02:02:08.255974 (Thread-1): Writing injected SQL for node "model.sample_project.customer"
2020-06-30 02:02:08.256511 (Thread-1): finished collecting timing info
2020-06-30 02:02:08.257060 (Thread-1): Finished running node model.sample_project.customer
2020-06-30 02:02:08.257229 (Thread-1): Began running node model.sample_project.nation
2020-06-30 02:02:08.257563 (Thread-1): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 02:02:08.257682 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer).
2020-06-30 02:02:08.257792 (Thread-1): Compiling model.sample_project.nation
2020-06-30 02:02:08.271370 (Thread-1): Writing injected SQL for node "model.sample_project.nation"
2020-06-30 02:02:08.271852 (Thread-1): finished collecting timing info
2020-06-30 02:02:08.272380 (Thread-1): Finished running node model.sample_project.nation
2020-06-30 02:02:08.272555 (Thread-1): Began running node model.sample_project.lineitem
2020-06-30 02:02:08.272862 (Thread-1): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 02:02:08.272982 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.nation).
2020-06-30 02:02:08.273097 (Thread-1): Compiling model.sample_project.lineitem
2020-06-30 02:02:08.282764 (Thread-1): Writing injected SQL for node "model.sample_project.lineitem"
2020-06-30 02:02:08.283181 (Thread-1): finished collecting timing info
2020-06-30 02:02:08.283658 (Thread-1): Finished running node model.sample_project.lineitem
2020-06-30 02:02:08.283822 (Thread-1): Began running node model.sample_project.orders
2020-06-30 02:02:08.284114 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 02:02:08.284229 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.lineitem).
2020-06-30 02:02:08.284338 (Thread-1): Compiling model.sample_project.orders
2020-06-30 02:02:08.293552 (Thread-1): Writing injected SQL for node "model.sample_project.orders"
2020-06-30 02:02:08.293907 (Thread-1): finished collecting timing info
2020-06-30 02:02:08.294345 (Thread-1): Finished running node model.sample_project.orders
2020-06-30 02:02:08.294490 (Thread-1): Began running node model.sample_project.customer_nation
2020-06-30 02:02:08.294746 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 02:02:08.294848 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders).
2020-06-30 02:02:08.295085 (Thread-1): Compiling model.sample_project.customer_nation
2020-06-30 02:02:08.306281 (Thread-1): Writing injected SQL for node "model.sample_project.customer_nation"
2020-06-30 02:02:08.306618 (Thread-1): finished collecting timing info
2020-06-30 02:02:08.307010 (Thread-1): Finished running node model.sample_project.customer_nation
2020-06-30 02:02:08.307146 (Thread-1): Began running node model.sample_project.orders_lineitem
2020-06-30 02:02:08.307581 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 02:02:08.307722 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer_nation).
2020-06-30 02:02:08.307836 (Thread-1): Compiling model.sample_project.orders_lineitem
2020-06-30 02:02:08.320752 (Thread-1): Writing injected SQL for node "model.sample_project.orders_lineitem"
2020-06-30 02:02:08.321139 (Thread-1): finished collecting timing info
2020-06-30 02:02:08.321557 (Thread-1): Finished running node model.sample_project.orders_lineitem
2020-06-30 02:02:08.321697 (Thread-1): Began running node model.sample_project.customers_per_nation
2020-06-30 02:02:08.322673 (Thread-1): 21:02:08 | 1 of 1 START table model TEST.customers_per_nation................... [RUN]
2020-06-30 02:02:08.323097 (Thread-1): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 02:02:08.323200 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders_lineitem).
2020-06-30 02:02:08.323298 (Thread-1): Compiling model.sample_project.customers_per_nation
2020-06-30 02:02:08.331804 (Thread-1): Writing injected SQL for node "model.sample_project.customers_per_nation"
2020-06-30 02:02:08.332093 (Thread-1): finished collecting timing info
2020-06-30 02:02:08.364391 (Thread-1): Writing runtime SQL for node "model.sample_project.customers_per_nation"
2020-06-30 02:02:08.366523 (Thread-1): Using snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 02:02:08.366631 (Thread-1): On model.sample_project.customers_per_nation: BEGIN
2020-06-30 02:02:08.639933 (Thread-1): SQL status: SUCCESS 1 in 0.27 seconds
2020-06-30 02:02:08.640188 (Thread-1): Using snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 02:02:08.640349 (Thread-1): On model.sample_project.customers_per_nation: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "model.sample_project.customers_per_nation"} */


      create or replace transient table JAVEN_TESTING.TEST.customers_per_nation  as
      (with __dbt__CTE__customer as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  c_custkey as custkey,
        c_nationkey as nationkey,
        c_name as name
from snowflake_sample_data.tpch_sf1.customer
),  __dbt__CTE__nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  n_nationkey as nationkey,
        n_name as name
from snowflake_sample_data.tpch_sf1.nation
),  __dbt__CTE__customer_nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  c.custkey,
        c.nationkey,
        c.name as customer_name,
        n.name as nation_name
from __dbt__CTE__customer as c
JOIN __dbt__CTE__nation as n
ON c.nationkey=n.nationkey
)/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  count(customer_name) as customer_count,
        nation_name
from __dbt__CTE__customer_nation
group by nation_name
order by nation_name
      );
2020-06-30 02:02:12.114970 (Thread-1): SQL status: SUCCESS 1 in 3.47 seconds
2020-06-30 02:02:12.116743 (Thread-1): On model.sample_project.customers_per_nation: COMMIT
2020-06-30 02:02:12.116953 (Thread-1): Using snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 02:02:12.117090 (Thread-1): On model.sample_project.customers_per_nation: COMMIT
2020-06-30 02:02:12.316215 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2020-06-30 02:02:12.329105 (Thread-1): finished collecting timing info
2020-06-30 02:02:12.329887 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '967514d6-fb00-4b20-85e9-15787c5686e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9b9e90>]}
2020-06-30 02:02:12.331179 (Thread-1): 21:02:12 | 1 of 1 OK created table model TEST.customers_per_nation.............. [SUCCESS 1 in 4.01s]
2020-06-30 02:02:12.331344 (Thread-1): Finished running node model.sample_project.customers_per_nation
2020-06-30 02:02:12.331512 (Thread-1): Began running node model.sample_project.cust_list_ord_nat
2020-06-30 02:02:12.331930 (Thread-1): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 02:02:12.332065 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customers_per_nation).
2020-06-30 02:02:12.332184 (Thread-1): Compiling model.sample_project.cust_list_ord_nat
2020-06-30 02:02:12.347535 (Thread-1): Writing injected SQL for node "model.sample_project.cust_list_ord_nat"
2020-06-30 02:02:12.347961 (Thread-1): finished collecting timing info
2020-06-30 02:02:12.348356 (Thread-1): Finished running node model.sample_project.cust_list_ord_nat
2020-06-30 02:02:12.418645 (MainThread): Using snowflake connection "master".
2020-06-30 02:02:12.418966 (MainThread): On master: BEGIN
2020-06-30 02:02:12.633202 (MainThread): SQL status: SUCCESS 1 in 0.21 seconds
2020-06-30 02:02:12.633448 (MainThread): On master: COMMIT
2020-06-30 02:02:12.633641 (MainThread): Using snowflake connection "master".
2020-06-30 02:02:12.633774 (MainThread): On master: COMMIT
2020-06-30 02:02:13.131632 (MainThread): SQL status: SUCCESS 1 in 0.50 seconds
2020-06-30 02:02:13.132217 (MainThread): 21:02:13 | 
2020-06-30 02:02:13.132454 (MainThread): 21:02:13 | Finished running 1 table model in 17.37s.
2020-06-30 02:02:13.132654 (MainThread): Connection 'master' was left open.
2020-06-30 02:02:13.132813 (MainThread): On master: Close
2020-06-30 02:02:13.529242 (MainThread): Connection 'model.sample_project.cust_list_ord_nat' was left open.
2020-06-30 02:02:13.529450 (MainThread): On model.sample_project.cust_list_ord_nat: Close
2020-06-30 02:02:13.857804 (MainThread): 
2020-06-30 02:02:13.857991 (MainThread): Completed successfully
2020-06-30 02:02:13.858130 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2020-06-30 02:02:13.858324 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ebb7110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ebb73d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ebb79d0>]}
2020-06-30 02:02:13.858532 (MainThread): Flushing usage events
2020-06-30 02:12:50.713579 (MainThread): Running with dbt=0.17.0
2020-06-30 02:12:51.174087 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-06-30 02:12:51.175745 (MainThread): Tracking: tracking
2020-06-30 02:12:51.176076 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113149390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113149090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113149f50>]}
2020-06-30 02:12:51.200931 (MainThread): Partial parsing not enabled
2020-06-30 02:12:51.203200 (MainThread): Parsing macros/core.sql
2020-06-30 02:12:51.209013 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-30 02:12:51.218448 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-30 02:12:51.220533 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-30 02:12:51.240977 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-30 02:12:51.276993 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-30 02:12:51.300761 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-30 02:12:51.303232 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-30 02:12:51.310447 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-30 02:12:51.326008 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-30 02:12:51.335057 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-30 02:12:51.343040 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-30 02:12:51.349738 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-30 02:12:51.352016 (MainThread): Parsing macros/etc/query.sql
2020-06-30 02:12:51.354044 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-30 02:12:51.357818 (MainThread): Parsing macros/etc/datetime.sql
2020-06-30 02:12:51.368986 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-30 02:12:51.371317 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-30 02:12:51.373214 (MainThread): Parsing macros/adapters/common.sql
2020-06-30 02:12:51.427756 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-30 02:12:51.430031 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-30 02:12:51.431267 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-30 02:12:51.433123 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-30 02:12:51.436039 (MainThread): Parsing macros/catalog.sql
2020-06-30 02:12:51.438611 (MainThread): Parsing macros/adapters.sql
2020-06-30 02:12:51.464243 (MainThread): Parsing macros/materializations/merge.sql
2020-06-30 02:12:51.467196 (MainThread): Parsing macros/materializations/view.sql
2020-06-30 02:12:51.468749 (MainThread): Parsing macros/materializations/table.sql
2020-06-30 02:12:51.473709 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-30 02:12:51.504507 (MainThread): Partial parsing not enabled
2020-06-30 02:12:51.542266 (MainThread): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 02:12:51.542404 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:12:51.573584 (MainThread): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 02:12:51.573715 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:12:51.584992 (MainThread): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 02:12:51.585085 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:12:51.604176 (MainThread): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 02:12:51.604310 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:12:51.617723 (MainThread): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 02:12:51.617865 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:12:51.631822 (MainThread): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 02:12:51.631926 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:12:51.645341 (MainThread): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 02:12:51.645449 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:12:51.659838 (MainThread): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 02:12:51.659978 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:12:51.672785 (MainThread): Acquiring new snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 02:12:51.672889 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:12:52.015548 (MainThread): Found 9 models, 8 tests, 0 snapshots, 0 analyses, 136 macros, 0 operations, 0 seed files, 4 sources
2020-06-30 02:12:52.017025 (MainThread): 
2020-06-30 02:12:52.017337 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 02:12:52.017488 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:12:52.019879 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_JAVEN_TESTING".
2020-06-30 02:12:52.019979 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-06-30 02:12:52.040124 (ThreadPoolExecutor-0_0): Using snowflake connection "list_JAVEN_TESTING".
2020-06-30 02:12:52.040629 (ThreadPoolExecutor-0_0): On list_JAVEN_TESTING: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING"} */

    show terse schemas in database JAVEN_TESTING
    limit 10000
2020-06-30 02:12:53.072292 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/certifi/cacert.pem'>
2020-06-30 02:13:00.748714 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 8.71 seconds
2020-06-30 02:13:00.783015 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 02:13:00.783310 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_JAVEN_TESTING).
2020-06-30 02:13:00.794248 (ThreadPoolExecutor-1_0): Using snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 02:13:00.794461 (ThreadPoolExecutor-1_0): On list_JAVEN_TESTING_TEST: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING_TEST"} */

    show terse objects in JAVEN_TESTING.TEST
2020-06-30 02:13:01.009101 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 0.21 seconds
2020-06-30 02:13:01.017872 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 02:13:01.018016 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:13:01.018213 (MainThread): Using snowflake connection "master".
2020-06-30 02:13:01.018325 (MainThread): On master: BEGIN
2020-06-30 02:13:07.057695 (MainThread): SQL status: SUCCESS 1 in 6.04 seconds
2020-06-30 02:13:07.058417 (MainThread): On master: COMMIT
2020-06-30 02:13:07.058711 (MainThread): Using snowflake connection "master".
2020-06-30 02:13:07.058866 (MainThread): On master: COMMIT
2020-06-30 02:13:07.391682 (MainThread): SQL status: SUCCESS 1 in 0.33 seconds
2020-06-30 02:13:07.392174 (MainThread): 21:13:07 | Concurrency: 1 threads (target='dev')
2020-06-30 02:13:07.392355 (MainThread): 21:13:07 | 
2020-06-30 02:13:07.393204 (Thread-1): Began running node model.sample_project.customer
2020-06-30 02:13:07.393617 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 02:13:07.393749 (Thread-1): Re-using an available connection from the pool (formerly list_JAVEN_TESTING_TEST).
2020-06-30 02:13:07.393881 (Thread-1): Compiling model.sample_project.customer
2020-06-30 02:13:07.419475 (Thread-1): Writing injected SQL for node "model.sample_project.customer"
2020-06-30 02:13:07.420735 (Thread-1): finished collecting timing info
2020-06-30 02:13:07.421363 (Thread-1): Finished running node model.sample_project.customer
2020-06-30 02:13:07.421573 (Thread-1): Began running node model.sample_project.lineitem
2020-06-30 02:13:07.422878 (Thread-1): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 02:13:07.423313 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer).
2020-06-30 02:13:07.423626 (Thread-1): Compiling model.sample_project.lineitem
2020-06-30 02:13:07.438370 (Thread-1): Writing injected SQL for node "model.sample_project.lineitem"
2020-06-30 02:13:07.438996 (Thread-1): finished collecting timing info
2020-06-30 02:13:07.439650 (Thread-1): Finished running node model.sample_project.lineitem
2020-06-30 02:13:07.439844 (Thread-1): Began running node model.sample_project.nation
2020-06-30 02:13:07.440177 (Thread-1): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 02:13:07.440324 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.lineitem).
2020-06-30 02:13:07.440443 (Thread-1): Compiling model.sample_project.nation
2020-06-30 02:13:07.452415 (Thread-1): Writing injected SQL for node "model.sample_project.nation"
2020-06-30 02:13:07.452993 (Thread-1): finished collecting timing info
2020-06-30 02:13:07.453589 (Thread-1): Finished running node model.sample_project.nation
2020-06-30 02:13:07.453773 (Thread-1): Began running node model.sample_project.orders
2020-06-30 02:13:07.454252 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 02:13:07.454394 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.nation).
2020-06-30 02:13:07.454520 (Thread-1): Compiling model.sample_project.orders
2020-06-30 02:13:07.464243 (Thread-1): Writing injected SQL for node "model.sample_project.orders"
2020-06-30 02:13:07.464647 (Thread-1): finished collecting timing info
2020-06-30 02:13:07.465115 (Thread-1): Finished running node model.sample_project.orders
2020-06-30 02:13:07.465286 (Thread-1): Began running node model.sample_project.customer_nation
2020-06-30 02:13:07.465584 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 02:13:07.466000 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders).
2020-06-30 02:13:07.466131 (Thread-1): Compiling model.sample_project.customer_nation
2020-06-30 02:13:07.479960 (Thread-1): Writing injected SQL for node "model.sample_project.customer_nation"
2020-06-30 02:13:07.480478 (Thread-1): finished collecting timing info
2020-06-30 02:13:07.480969 (Thread-1): Finished running node model.sample_project.customer_nation
2020-06-30 02:13:07.481158 (Thread-1): Began running node model.sample_project.orders_lineitem
2020-06-30 02:13:07.481580 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 02:13:07.481806 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer_nation).
2020-06-30 02:13:07.481960 (Thread-1): Compiling model.sample_project.orders_lineitem
2020-06-30 02:13:07.495399 (Thread-1): Writing injected SQL for node "model.sample_project.orders_lineitem"
2020-06-30 02:13:07.495813 (Thread-1): finished collecting timing info
2020-06-30 02:13:07.496241 (Thread-1): Finished running node model.sample_project.orders_lineitem
2020-06-30 02:13:07.496386 (Thread-1): Began running node model.sample_project.customers_per_nation
2020-06-30 02:13:07.497483 (Thread-1): 21:13:07 | 1 of 2 START table model TEST.customers_per_nation................... [RUN]
2020-06-30 02:13:07.497877 (Thread-1): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 02:13:07.497996 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders_lineitem).
2020-06-30 02:13:07.498099 (Thread-1): Compiling model.sample_project.customers_per_nation
2020-06-30 02:13:07.509699 (Thread-1): Writing injected SQL for node "model.sample_project.customers_per_nation"
2020-06-30 02:13:07.510388 (Thread-1): finished collecting timing info
2020-06-30 02:13:07.546547 (Thread-1): Writing runtime SQL for node "model.sample_project.customers_per_nation"
2020-06-30 02:13:07.548710 (Thread-1): Using snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 02:13:07.548830 (Thread-1): On model.sample_project.customers_per_nation: BEGIN
2020-06-30 02:13:07.762334 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2020-06-30 02:13:07.762549 (Thread-1): Using snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 02:13:07.762672 (Thread-1): On model.sample_project.customers_per_nation: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "model.sample_project.customers_per_nation"} */


      create or replace transient table JAVEN_TESTING.TEST.customers_per_nation  as
      (with __dbt__CTE__customer as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  c_custkey as custkey,
        c_nationkey as nationkey,
        c_name as name
from snowflake_sample_data.tpch_sf1.customer
),  __dbt__CTE__nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  n_nationkey as nationkey,
        n_name as name
from snowflake_sample_data.tpch_sf1.nation
),  __dbt__CTE__customer_nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  c.custkey,
        c.nationkey,
        c.name as customer_name,
        n.name as nation_name
from __dbt__CTE__customer as c
JOIN __dbt__CTE__nation as n
ON c.nationkey=n.nationkey
)/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  count(customer_name) as customer_count,
        nation_name
from __dbt__CTE__customer_nation
group by nation_name
order by nation_name
      );
2020-06-30 02:13:09.916516 (Thread-1): SQL status: SUCCESS 1 in 2.15 seconds
2020-06-30 02:13:09.917708 (Thread-1): On model.sample_project.customers_per_nation: COMMIT
2020-06-30 02:13:09.917879 (Thread-1): Using snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 02:13:09.917992 (Thread-1): On model.sample_project.customers_per_nation: COMMIT
2020-06-30 02:13:10.139921 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2020-06-30 02:13:10.151366 (Thread-1): finished collecting timing info
2020-06-30 02:13:10.152104 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce02fd6f-7e19-43eb-bc0c-a0a3bd575dec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a48f50>]}
2020-06-30 02:13:10.153405 (Thread-1): 21:13:10 | 1 of 2 OK created table model TEST.customers_per_nation.............. [SUCCESS 1 in 2.65s]
2020-06-30 02:13:10.153577 (Thread-1): Finished running node model.sample_project.customers_per_nation
2020-06-30 02:13:10.153744 (Thread-1): Began running node model.sample_project.average_price_per_order
2020-06-30 02:13:10.155456 (Thread-1): 21:13:10 | 2 of 2 START table model TEST.average_price_per_order................ [RUN]
2020-06-30 02:13:10.156000 (Thread-1): Acquiring new snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 02:13:10.156133 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customers_per_nation).
2020-06-30 02:13:10.156265 (Thread-1): Compiling model.sample_project.average_price_per_order
2020-06-30 02:13:10.167398 (Thread-1): Writing injected SQL for node "model.sample_project.average_price_per_order"
2020-06-30 02:13:10.167856 (Thread-1): finished collecting timing info
2020-06-30 02:13:10.175419 (Thread-1): Writing runtime SQL for node "model.sample_project.average_price_per_order"
2020-06-30 02:13:10.178626 (Thread-1): Using snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 02:13:10.178832 (Thread-1): On model.sample_project.average_price_per_order: BEGIN
2020-06-30 02:13:10.434863 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2020-06-30 02:13:10.435128 (Thread-1): Using snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 02:13:10.435295 (Thread-1): On model.sample_project.average_price_per_order: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "model.sample_project.average_price_per_order"} */


      create or replace transient table JAVEN_TESTING.TEST.average_price_per_order  as
      (with __dbt__CTE__orders as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  o_orderkey as orderkey,
        o_custkey as custkey,
        o_totalprice as totalprice,
        o_orderdate as orderdate
from snowflake_sample_data.tpch_sf1.orders
),  __dbt__CTE__lineitem as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  l_orderkey as orderkey,
        l_extendedprice as extendedprice,
        l_discount as discount,
        l_tax as tax,
        l_quantity as quantity
from snowflake_sample_data.tpch_sf1.lineitem
),  __dbt__CTE__orders_lineitem as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  o.orderkey,
        o.custkey,
        o.totalprice,
        o.orderdate,
        l.extendedprice,
        l.discount,
        l.tax,
        l.quantity
from __dbt__CTE__orders as o
JOIN __dbt__CTE__lineitem as l
ON o.o_orderkey=l.l_orderkey
)/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  average(totalprice) as average_price,
        order_date
from __dbt__CTE__orders_lineitem
group by order_date
      );
2020-06-30 02:13:10.964511 (Thread-1): Snowflake query id: 01953e65-021d-5832-0000-2aed011ce186
2020-06-30 02:13:10.964777 (Thread-1): Snowflake error: 000904 (42000): SQL compilation error: error line 76 at position 3
invalid identifier 'O.O_ORDERKEY'
2020-06-30 02:13:10.964980 (Thread-1): On model.sample_project.average_price_per_order: ROLLBACK
2020-06-30 02:13:10.965132 (Thread-1): initiating rollback
2020-06-30 02:13:11.245224 (Thread-1): finished collecting timing info
2020-06-30 02:13:11.246070 (Thread-1): Database Error in model average_price_per_order (models/reports/average_price_per_order.sql)
  000904 (42000): SQL compilation error: error line 76 at position 3
  invalid identifier 'O.O_ORDERKEY'
  compiled SQL at target/run/sample_project/models/reports/average_price_per_order.sql
Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 158, in exception_handler
    yield
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/cursor.py", line 597, in execute
    errvalue)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/errors.py", line 97, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, errorclass, errorvalue)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/errors.py", line 73, in default_errorhandler
    done_format_msg=errorvalue.get(u'done_format_msg'))
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 76 at position 3
invalid identifier 'O.O_ORDERKEY'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 119, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 306, in add_query
    abridge_sql_log=abridge_sql_log
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/usr/local/opt/python/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 177, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model average_price_per_order (models/reports/average_price_per_order.sql)
  000904 (42000): SQL compilation error: error line 76 at position 3
  invalid identifier 'O.O_ORDERKEY'
  compiled SQL at target/run/sample_project/models/reports/average_price_per_order.sql
2020-06-30 02:13:11.255976 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce02fd6f-7e19-43eb-bc0c-a0a3bd575dec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115e58b10>]}
2020-06-30 02:13:11.257324 (Thread-1): 21:13:11 | 2 of 2 ERROR creating table model TEST.average_price_per_order....... [ERROR in 1.10s]
2020-06-30 02:13:11.257494 (Thread-1): Finished running node model.sample_project.average_price_per_order
2020-06-30 02:13:11.257663 (Thread-1): Began running node model.sample_project.cust_list_ord_nat
2020-06-30 02:13:11.258100 (Thread-1): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 02:13:11.258232 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.average_price_per_order).
2020-06-30 02:13:11.258349 (Thread-1): Compiling model.sample_project.cust_list_ord_nat
2020-06-30 02:13:11.279163 (Thread-1): Writing injected SQL for node "model.sample_project.cust_list_ord_nat"
2020-06-30 02:13:11.279866 (Thread-1): finished collecting timing info
2020-06-30 02:13:11.280433 (Thread-1): Finished running node model.sample_project.cust_list_ord_nat
2020-06-30 02:13:11.324034 (MainThread): Using snowflake connection "master".
2020-06-30 02:13:11.324210 (MainThread): On master: BEGIN
2020-06-30 02:13:11.998169 (MainThread): SQL status: SUCCESS 1 in 0.67 seconds
2020-06-30 02:13:11.998453 (MainThread): On master: COMMIT
2020-06-30 02:13:11.998766 (MainThread): Using snowflake connection "master".
2020-06-30 02:13:11.998925 (MainThread): On master: COMMIT
2020-06-30 02:13:12.268668 (MainThread): SQL status: SUCCESS 1 in 0.27 seconds
2020-06-30 02:13:12.269101 (MainThread): 21:13:12 | 
2020-06-30 02:13:12.269258 (MainThread): 21:13:12 | Finished running 2 table models in 20.25s.
2020-06-30 02:13:12.269386 (MainThread): Connection 'master' was left open.
2020-06-30 02:13:12.269489 (MainThread): On master: Close
2020-06-30 02:13:12.568719 (MainThread): Connection 'model.sample_project.cust_list_ord_nat' was left open.
2020-06-30 02:13:12.568909 (MainThread): On model.sample_project.cust_list_ord_nat: Close
2020-06-30 02:13:12.881781 (MainThread): 
2020-06-30 02:13:12.881950 (MainThread): Completed with 1 error and 0 warnings:
2020-06-30 02:13:12.882068 (MainThread): 
2020-06-30 02:13:12.882180 (MainThread): Database Error in model average_price_per_order (models/reports/average_price_per_order.sql)
2020-06-30 02:13:12.882286 (MainThread):   000904 (42000): SQL compilation error: error line 76 at position 3
2020-06-30 02:13:12.882381 (MainThread):   invalid identifier 'O.O_ORDERKEY'
2020-06-30 02:13:12.882475 (MainThread):   compiled SQL at target/run/sample_project/models/reports/average_price_per_order.sql
2020-06-30 02:13:12.882575 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
2020-06-30 02:13:12.882737 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131acb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139d4590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139d4850>]}
2020-06-30 02:13:12.882916 (MainThread): Flushing usage events
2020-06-30 02:14:06.236650 (MainThread): Running with dbt=0.17.0
2020-06-30 02:14:06.674286 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-06-30 02:14:06.675398 (MainThread): Tracking: tracking
2020-06-30 02:14:06.675671 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104569d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110468250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110468ed0>]}
2020-06-30 02:14:06.701048 (MainThread): Partial parsing not enabled
2020-06-30 02:14:06.703396 (MainThread): Parsing macros/core.sql
2020-06-30 02:14:06.710050 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-30 02:14:06.720256 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-30 02:14:06.723189 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-30 02:14:06.744711 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-30 02:14:06.786869 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-30 02:14:06.815510 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-30 02:14:06.818139 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-30 02:14:06.826522 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-30 02:14:06.844357 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-30 02:14:06.853412 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-30 02:14:06.860523 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-30 02:14:06.867598 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-30 02:14:06.868945 (MainThread): Parsing macros/etc/query.sql
2020-06-30 02:14:06.870479 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-30 02:14:06.872789 (MainThread): Parsing macros/etc/datetime.sql
2020-06-30 02:14:06.884004 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-30 02:14:06.886784 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-30 02:14:06.889260 (MainThread): Parsing macros/adapters/common.sql
2020-06-30 02:14:06.975277 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-30 02:14:06.977275 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-30 02:14:06.978767 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-30 02:14:06.980487 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-30 02:14:06.983643 (MainThread): Parsing macros/catalog.sql
2020-06-30 02:14:06.986116 (MainThread): Parsing macros/adapters.sql
2020-06-30 02:14:07.013183 (MainThread): Parsing macros/materializations/merge.sql
2020-06-30 02:14:07.015624 (MainThread): Parsing macros/materializations/view.sql
2020-06-30 02:14:07.017182 (MainThread): Parsing macros/materializations/table.sql
2020-06-30 02:14:07.022518 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-30 02:14:07.053039 (MainThread): Partial parsing not enabled
2020-06-30 02:14:07.095350 (MainThread): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 02:14:07.095509 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:14:07.131529 (MainThread): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 02:14:07.131723 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:14:07.145695 (MainThread): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 02:14:07.145831 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:14:07.158723 (MainThread): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 02:14:07.158834 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:14:07.171787 (MainThread): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 02:14:07.171902 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:14:07.185013 (MainThread): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 02:14:07.185115 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:14:07.199586 (MainThread): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 02:14:07.199700 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:14:07.213250 (MainThread): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 02:14:07.213364 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:14:07.226449 (MainThread): Acquiring new snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 02:14:07.226576 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:14:07.592914 (MainThread): Found 9 models, 8 tests, 0 snapshots, 0 analyses, 136 macros, 0 operations, 0 seed files, 4 sources
2020-06-30 02:14:07.594631 (MainThread): 
2020-06-30 02:14:07.595070 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 02:14:07.595158 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:14:07.598008 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_JAVEN_TESTING".
2020-06-30 02:14:07.598121 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-06-30 02:14:07.614857 (ThreadPoolExecutor-0_0): Using snowflake connection "list_JAVEN_TESTING".
2020-06-30 02:14:07.615070 (ThreadPoolExecutor-0_0): On list_JAVEN_TESTING: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING"} */

    show terse schemas in database JAVEN_TESTING
    limit 10000
2020-06-30 02:14:08.529546 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/certifi/cacert.pem'>
2020-06-30 02:14:15.968131 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 8.35 seconds
2020-06-30 02:14:15.999412 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 02:14:15.999613 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_JAVEN_TESTING).
2020-06-30 02:14:16.006932 (ThreadPoolExecutor-1_0): Using snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 02:14:16.007080 (ThreadPoolExecutor-1_0): On list_JAVEN_TESTING_TEST: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING_TEST"} */

    show terse objects in JAVEN_TESTING.TEST
2020-06-30 02:14:16.183201 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 0.18 seconds
2020-06-30 02:14:16.193198 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 02:14:16.193343 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:14:16.193546 (MainThread): Using snowflake connection "master".
2020-06-30 02:14:16.193658 (MainThread): On master: BEGIN
2020-06-30 02:14:22.903535 (MainThread): SQL status: SUCCESS 1 in 6.71 seconds
2020-06-30 02:14:22.903778 (MainThread): On master: COMMIT
2020-06-30 02:14:22.903967 (MainThread): Using snowflake connection "master".
2020-06-30 02:14:22.904094 (MainThread): On master: COMMIT
2020-06-30 02:14:23.292071 (MainThread): SQL status: SUCCESS 1 in 0.39 seconds
2020-06-30 02:14:23.292535 (MainThread): 21:14:23 | Concurrency: 1 threads (target='dev')
2020-06-30 02:14:23.292722 (MainThread): 21:14:23 | 
2020-06-30 02:14:23.293667 (Thread-1): Began running node model.sample_project.customer
2020-06-30 02:14:23.294087 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 02:14:23.294224 (Thread-1): Re-using an available connection from the pool (formerly list_JAVEN_TESTING_TEST).
2020-06-30 02:14:23.294363 (Thread-1): Compiling model.sample_project.customer
2020-06-30 02:14:23.321250 (Thread-1): Writing injected SQL for node "model.sample_project.customer"
2020-06-30 02:14:23.322398 (Thread-1): finished collecting timing info
2020-06-30 02:14:23.323134 (Thread-1): Finished running node model.sample_project.customer
2020-06-30 02:14:23.323325 (Thread-1): Began running node model.sample_project.lineitem
2020-06-30 02:14:23.323688 (Thread-1): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 02:14:23.323982 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer).
2020-06-30 02:14:23.324133 (Thread-1): Compiling model.sample_project.lineitem
2020-06-30 02:14:23.334844 (Thread-1): Writing injected SQL for node "model.sample_project.lineitem"
2020-06-30 02:14:23.335333 (Thread-1): finished collecting timing info
2020-06-30 02:14:23.335835 (Thread-1): Finished running node model.sample_project.lineitem
2020-06-30 02:14:23.336005 (Thread-1): Began running node model.sample_project.nation
2020-06-30 02:14:23.336314 (Thread-1): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 02:14:23.336542 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.lineitem).
2020-06-30 02:14:23.336689 (Thread-1): Compiling model.sample_project.nation
2020-06-30 02:14:23.348346 (Thread-1): Writing injected SQL for node "model.sample_project.nation"
2020-06-30 02:14:23.348865 (Thread-1): finished collecting timing info
2020-06-30 02:14:23.349372 (Thread-1): Finished running node model.sample_project.nation
2020-06-30 02:14:23.349544 (Thread-1): Began running node model.sample_project.orders
2020-06-30 02:14:23.349859 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 02:14:23.350172 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.nation).
2020-06-30 02:14:23.350316 (Thread-1): Compiling model.sample_project.orders
2020-06-30 02:14:23.359728 (Thread-1): Writing injected SQL for node "model.sample_project.orders"
2020-06-30 02:14:23.360147 (Thread-1): finished collecting timing info
2020-06-30 02:14:23.360626 (Thread-1): Finished running node model.sample_project.orders
2020-06-30 02:14:23.360795 (Thread-1): Began running node model.sample_project.customer_nation
2020-06-30 02:14:23.361095 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 02:14:23.361214 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders).
2020-06-30 02:14:23.361328 (Thread-1): Compiling model.sample_project.customer_nation
2020-06-30 02:14:23.374588 (Thread-1): Writing injected SQL for node "model.sample_project.customer_nation"
2020-06-30 02:14:23.375143 (Thread-1): finished collecting timing info
2020-06-30 02:14:23.375601 (Thread-1): Finished running node model.sample_project.customer_nation
2020-06-30 02:14:23.375785 (Thread-1): Began running node model.sample_project.orders_lineitem
2020-06-30 02:14:23.376193 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 02:14:23.376300 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer_nation).
2020-06-30 02:14:23.376395 (Thread-1): Compiling model.sample_project.orders_lineitem
2020-06-30 02:14:23.388806 (Thread-1): Writing injected SQL for node "model.sample_project.orders_lineitem"
2020-06-30 02:14:23.389159 (Thread-1): finished collecting timing info
2020-06-30 02:14:23.389575 (Thread-1): Finished running node model.sample_project.orders_lineitem
2020-06-30 02:14:23.389714 (Thread-1): Began running node model.sample_project.customers_per_nation
2020-06-30 02:14:23.390714 (Thread-1): 21:14:23 | 1 of 2 START table model TEST.customers_per_nation................... [RUN]
2020-06-30 02:14:23.391185 (Thread-1): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 02:14:23.391290 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders_lineitem).
2020-06-30 02:14:23.391385 (Thread-1): Compiling model.sample_project.customers_per_nation
2020-06-30 02:14:23.400427 (Thread-1): Writing injected SQL for node "model.sample_project.customers_per_nation"
2020-06-30 02:14:23.400809 (Thread-1): finished collecting timing info
2020-06-30 02:14:23.433363 (Thread-1): Writing runtime SQL for node "model.sample_project.customers_per_nation"
2020-06-30 02:14:23.435650 (Thread-1): Using snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 02:14:23.435832 (Thread-1): On model.sample_project.customers_per_nation: BEGIN
2020-06-30 02:14:23.746965 (Thread-1): SQL status: SUCCESS 1 in 0.31 seconds
2020-06-30 02:14:23.747149 (Thread-1): Using snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 02:14:23.747263 (Thread-1): On model.sample_project.customers_per_nation: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "model.sample_project.customers_per_nation"} */


      create or replace transient table JAVEN_TESTING.TEST.customers_per_nation  as
      (with __dbt__CTE__customer as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  c_custkey as custkey,
        c_nationkey as nationkey,
        c_name as name
from snowflake_sample_data.tpch_sf1.customer
),  __dbt__CTE__nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  n_nationkey as nationkey,
        n_name as name
from snowflake_sample_data.tpch_sf1.nation
),  __dbt__CTE__customer_nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  c.custkey,
        c.nationkey,
        c.name as customer_name,
        n.name as nation_name
from __dbt__CTE__customer as c
JOIN __dbt__CTE__nation as n
ON c.nationkey=n.nationkey
)/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  count(customer_name) as customer_count,
        nation_name
from __dbt__CTE__customer_nation
group by nation_name
order by nation_name
      );
2020-06-30 02:14:27.377465 (Thread-1): SQL status: SUCCESS 1 in 3.63 seconds
2020-06-30 02:14:27.378721 (Thread-1): On model.sample_project.customers_per_nation: COMMIT
2020-06-30 02:14:27.378899 (Thread-1): Using snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 02:14:27.379013 (Thread-1): On model.sample_project.customers_per_nation: COMMIT
2020-06-30 02:14:27.548711 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2020-06-30 02:14:27.559808 (Thread-1): finished collecting timing info
2020-06-30 02:14:27.560563 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88458ef8-fc63-4df1-8d85-bb4736c834ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fadc10>]}
2020-06-30 02:14:27.561880 (Thread-1): 21:14:27 | 1 of 2 OK created table model TEST.customers_per_nation.............. [SUCCESS 1 in 4.17s]
2020-06-30 02:14:27.562030 (Thread-1): Finished running node model.sample_project.customers_per_nation
2020-06-30 02:14:27.562181 (Thread-1): Began running node model.sample_project.average_price_per_order
2020-06-30 02:14:27.563287 (Thread-1): 21:14:27 | 2 of 2 START table model TEST.average_price_per_order................ [RUN]
2020-06-30 02:14:27.563839 (Thread-1): Acquiring new snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 02:14:27.563950 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customers_per_nation).
2020-06-30 02:14:27.564056 (Thread-1): Compiling model.sample_project.average_price_per_order
2020-06-30 02:14:27.575479 (Thread-1): Writing injected SQL for node "model.sample_project.average_price_per_order"
2020-06-30 02:14:27.576501 (Thread-1): finished collecting timing info
2020-06-30 02:14:27.582914 (Thread-1): Writing runtime SQL for node "model.sample_project.average_price_per_order"
2020-06-30 02:14:27.586113 (Thread-1): Using snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 02:14:27.586322 (Thread-1): On model.sample_project.average_price_per_order: BEGIN
2020-06-30 02:14:27.798437 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2020-06-30 02:14:27.798623 (Thread-1): Using snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 02:14:27.798733 (Thread-1): On model.sample_project.average_price_per_order: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "model.sample_project.average_price_per_order"} */


      create or replace transient table JAVEN_TESTING.TEST.average_price_per_order  as
      (with __dbt__CTE__orders as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  o_orderkey as orderkey,
        o_custkey as custkey,
        o_totalprice as totalprice,
        o_orderdate as orderdate
from snowflake_sample_data.tpch_sf1.orders
),  __dbt__CTE__lineitem as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  l_orderkey as orderkey,
        l_extendedprice as extendedprice,
        l_discount as discount,
        l_tax as tax,
        l_quantity as quantity
from snowflake_sample_data.tpch_sf1.lineitem
),  __dbt__CTE__orders_lineitem as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  o.orderkey,
        o.custkey,
        o.totalprice,
        o.orderdate,
        l.extendedprice,
        l.discount,
        l.tax,
        l.quantity
from __dbt__CTE__orders as o
JOIN __dbt__CTE__lineitem as l
ON o.orderkey=l.orderkey
)/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  average(totalprice) as average_price,
        order_date
from __dbt__CTE__orders_lineitem
group by order_date
      );
2020-06-30 02:14:28.400439 (Thread-1): Snowflake query id: 01953e66-02d7-ce48-0000-2aed011ce19a
2020-06-30 02:14:28.400603 (Thread-1): Snowflake error: 000904 (42000): SQL compilation error: error line 94 at position 8
invalid identifier 'ORDER_DATE'
2020-06-30 02:14:28.400725 (Thread-1): On model.sample_project.average_price_per_order: ROLLBACK
2020-06-30 02:14:28.400818 (Thread-1): initiating rollback
2020-06-30 02:14:28.644430 (Thread-1): finished collecting timing info
2020-06-30 02:14:28.645154 (Thread-1): Database Error in model average_price_per_order (models/reports/average_price_per_order.sql)
  000904 (42000): SQL compilation error: error line 94 at position 8
  invalid identifier 'ORDER_DATE'
  compiled SQL at target/run/sample_project/models/reports/average_price_per_order.sql
Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 158, in exception_handler
    yield
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/cursor.py", line 597, in execute
    errvalue)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/errors.py", line 97, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, errorclass, errorvalue)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/errors.py", line 73, in default_errorhandler
    done_format_msg=errorvalue.get(u'done_format_msg'))
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 94 at position 8
invalid identifier 'ORDER_DATE'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 119, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 306, in add_query
    abridge_sql_log=abridge_sql_log
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/usr/local/opt/python/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 177, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model average_price_per_order (models/reports/average_price_per_order.sql)
  000904 (42000): SQL compilation error: error line 94 at position 8
  invalid identifier 'ORDER_DATE'
  compiled SQL at target/run/sample_project/models/reports/average_price_per_order.sql
2020-06-30 02:14:28.655722 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88458ef8-fc63-4df1-8d85-bb4736c834ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a1b250>]}
2020-06-30 02:14:28.657349 (Thread-1): 21:14:28 | 2 of 2 ERROR creating table model TEST.average_price_per_order....... [ERROR in 1.09s]
2020-06-30 02:14:28.657533 (Thread-1): Finished running node model.sample_project.average_price_per_order
2020-06-30 02:14:28.657704 (Thread-1): Began running node model.sample_project.cust_list_ord_nat
2020-06-30 02:14:28.658046 (Thread-1): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 02:14:28.658163 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.average_price_per_order).
2020-06-30 02:14:28.658275 (Thread-1): Compiling model.sample_project.cust_list_ord_nat
2020-06-30 02:14:28.676659 (Thread-1): Writing injected SQL for node "model.sample_project.cust_list_ord_nat"
2020-06-30 02:14:28.677331 (Thread-1): finished collecting timing info
2020-06-30 02:14:28.678277 (Thread-1): Finished running node model.sample_project.cust_list_ord_nat
2020-06-30 02:14:28.752374 (MainThread): Using snowflake connection "master".
2020-06-30 02:14:28.752536 (MainThread): On master: BEGIN
2020-06-30 02:14:28.966773 (MainThread): SQL status: SUCCESS 1 in 0.21 seconds
2020-06-30 02:14:28.966987 (MainThread): On master: COMMIT
2020-06-30 02:14:28.967149 (MainThread): Using snowflake connection "master".
2020-06-30 02:14:28.967259 (MainThread): On master: COMMIT
2020-06-30 02:14:29.287733 (MainThread): SQL status: SUCCESS 1 in 0.32 seconds
2020-06-30 02:14:29.288178 (MainThread): 21:14:29 | 
2020-06-30 02:14:29.288339 (MainThread): 21:14:29 | Finished running 2 table models in 21.69s.
2020-06-30 02:14:29.288470 (MainThread): Connection 'master' was left open.
2020-06-30 02:14:29.288575 (MainThread): On master: Close
2020-06-30 02:14:29.628939 (MainThread): Connection 'model.sample_project.cust_list_ord_nat' was left open.
2020-06-30 02:14:29.629115 (MainThread): On model.sample_project.cust_list_ord_nat: Close
2020-06-30 02:14:29.897054 (MainThread): 
2020-06-30 02:14:29.897242 (MainThread): Completed with 1 error and 0 warnings:
2020-06-30 02:14:29.897388 (MainThread): 
2020-06-30 02:14:29.897519 (MainThread): Database Error in model average_price_per_order (models/reports/average_price_per_order.sql)
2020-06-30 02:14:29.897639 (MainThread):   000904 (42000): SQL compilation error: error line 94 at position 8
2020-06-30 02:14:29.897749 (MainThread):   invalid identifier 'ORDER_DATE'
2020-06-30 02:14:29.897857 (MainThread):   compiled SQL at target/run/sample_project/models/reports/average_price_per_order.sql
2020-06-30 02:14:29.897975 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
2020-06-30 02:14:29.898165 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a9bd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a72dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b7a490>]}
2020-06-30 02:14:29.898384 (MainThread): Flushing usage events
2020-06-30 02:15:18.272010 (MainThread): Running with dbt=0.17.0
2020-06-30 02:15:18.610944 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-06-30 02:15:18.611648 (MainThread): Tracking: tracking
2020-06-30 02:15:18.612015 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107537690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107549e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107549d50>]}
2020-06-30 02:15:18.633973 (MainThread): Partial parsing not enabled
2020-06-30 02:15:18.635589 (MainThread): Parsing macros/core.sql
2020-06-30 02:15:18.641715 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-30 02:15:18.649741 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-30 02:15:18.651795 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-30 02:15:18.670750 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-30 02:15:18.707349 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-30 02:15:18.730976 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-30 02:15:18.733251 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-30 02:15:18.741730 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-30 02:15:18.758750 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-30 02:15:18.766636 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-30 02:15:18.773956 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-30 02:15:18.779540 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-30 02:15:18.780743 (MainThread): Parsing macros/etc/query.sql
2020-06-30 02:15:18.782200 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-30 02:15:18.784113 (MainThread): Parsing macros/etc/datetime.sql
2020-06-30 02:15:18.794326 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-30 02:15:18.798465 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-30 02:15:18.800649 (MainThread): Parsing macros/adapters/common.sql
2020-06-30 02:15:18.858719 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-30 02:15:18.860086 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-30 02:15:18.861081 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-30 02:15:18.862260 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-30 02:15:18.864962 (MainThread): Parsing macros/catalog.sql
2020-06-30 02:15:18.867012 (MainThread): Parsing macros/adapters.sql
2020-06-30 02:15:18.892153 (MainThread): Parsing macros/materializations/merge.sql
2020-06-30 02:15:18.894286 (MainThread): Parsing macros/materializations/view.sql
2020-06-30 02:15:18.895650 (MainThread): Parsing macros/materializations/table.sql
2020-06-30 02:15:18.900018 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-30 02:15:18.930234 (MainThread): Partial parsing not enabled
2020-06-30 02:15:18.968319 (MainThread): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 02:15:18.968440 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:15:18.998496 (MainThread): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 02:15:18.998619 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:15:19.010575 (MainThread): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 02:15:19.010696 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:15:19.022007 (MainThread): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 02:15:19.022101 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:15:19.033880 (MainThread): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 02:15:19.033981 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:15:19.047686 (MainThread): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 02:15:19.047786 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:15:19.061030 (MainThread): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 02:15:19.061184 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:15:19.075646 (MainThread): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 02:15:19.075762 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:15:19.088517 (MainThread): Acquiring new snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 02:15:19.088670 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:15:19.426839 (MainThread): Found 9 models, 8 tests, 0 snapshots, 0 analyses, 136 macros, 0 operations, 0 seed files, 4 sources
2020-06-30 02:15:19.428467 (MainThread): 
2020-06-30 02:15:19.428746 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 02:15:19.428870 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:15:19.431906 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_JAVEN_TESTING".
2020-06-30 02:15:19.432009 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-06-30 02:15:19.455316 (ThreadPoolExecutor-0_0): Using snowflake connection "list_JAVEN_TESTING".
2020-06-30 02:15:19.455701 (ThreadPoolExecutor-0_0): On list_JAVEN_TESTING: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING"} */

    show terse schemas in database JAVEN_TESTING
    limit 10000
2020-06-30 02:15:19.947025 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/certifi/cacert.pem'>
2020-06-30 02:15:29.718158 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 10.26 seconds
2020-06-30 02:15:29.747321 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 02:15:29.747520 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_JAVEN_TESTING).
2020-06-30 02:15:29.754641 (ThreadPoolExecutor-1_0): Using snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 02:15:29.754759 (ThreadPoolExecutor-1_0): On list_JAVEN_TESTING_TEST: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING_TEST"} */

    show terse objects in JAVEN_TESTING.TEST
2020-06-30 02:15:30.657070 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 0.90 seconds
2020-06-30 02:15:30.669414 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 02:15:30.669630 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:15:30.669864 (MainThread): Using snowflake connection "master".
2020-06-30 02:15:30.669986 (MainThread): On master: BEGIN
2020-06-30 02:15:35.838301 (MainThread): SQL status: SUCCESS 1 in 5.17 seconds
2020-06-30 02:15:35.838539 (MainThread): On master: COMMIT
2020-06-30 02:15:35.838729 (MainThread): Using snowflake connection "master".
2020-06-30 02:15:35.838858 (MainThread): On master: COMMIT
2020-06-30 02:15:36.194620 (MainThread): SQL status: SUCCESS 1 in 0.36 seconds
2020-06-30 02:15:36.195099 (MainThread): 21:15:36 | Concurrency: 1 threads (target='dev')
2020-06-30 02:15:36.195275 (MainThread): 21:15:36 | 
2020-06-30 02:15:36.196271 (Thread-1): Began running node model.sample_project.customer
2020-06-30 02:15:36.196647 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 02:15:36.196772 (Thread-1): Re-using an available connection from the pool (formerly list_JAVEN_TESTING_TEST).
2020-06-30 02:15:36.196895 (Thread-1): Compiling model.sample_project.customer
2020-06-30 02:15:36.225122 (Thread-1): Writing injected SQL for node "model.sample_project.customer"
2020-06-30 02:15:36.226077 (Thread-1): finished collecting timing info
2020-06-30 02:15:36.226751 (Thread-1): Finished running node model.sample_project.customer
2020-06-30 02:15:36.226948 (Thread-1): Began running node model.sample_project.lineitem
2020-06-30 02:15:36.227281 (Thread-1): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 02:15:36.227407 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer).
2020-06-30 02:15:36.227537 (Thread-1): Compiling model.sample_project.lineitem
2020-06-30 02:15:36.239026 (Thread-1): Writing injected SQL for node "model.sample_project.lineitem"
2020-06-30 02:15:36.239506 (Thread-1): finished collecting timing info
2020-06-30 02:15:36.240016 (Thread-1): Finished running node model.sample_project.lineitem
2020-06-30 02:15:36.240188 (Thread-1): Began running node model.sample_project.nation
2020-06-30 02:15:36.240486 (Thread-1): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 02:15:36.240606 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.lineitem).
2020-06-30 02:15:36.240719 (Thread-1): Compiling model.sample_project.nation
2020-06-30 02:15:36.250325 (Thread-1): Writing injected SQL for node "model.sample_project.nation"
2020-06-30 02:15:36.250724 (Thread-1): finished collecting timing info
2020-06-30 02:15:36.251185 (Thread-1): Finished running node model.sample_project.nation
2020-06-30 02:15:36.251402 (Thread-1): Began running node model.sample_project.orders
2020-06-30 02:15:36.251708 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 02:15:36.251824 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.nation).
2020-06-30 02:15:36.251932 (Thread-1): Compiling model.sample_project.orders
2020-06-30 02:15:36.260950 (Thread-1): Writing injected SQL for node "model.sample_project.orders"
2020-06-30 02:15:36.261295 (Thread-1): finished collecting timing info
2020-06-30 02:15:36.261717 (Thread-1): Finished running node model.sample_project.orders
2020-06-30 02:15:36.261859 (Thread-1): Began running node model.sample_project.customer_nation
2020-06-30 02:15:36.262108 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 02:15:36.262349 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders).
2020-06-30 02:15:36.262469 (Thread-1): Compiling model.sample_project.customer_nation
2020-06-30 02:15:36.274030 (Thread-1): Writing injected SQL for node "model.sample_project.customer_nation"
2020-06-30 02:15:36.274382 (Thread-1): finished collecting timing info
2020-06-30 02:15:36.274782 (Thread-1): Finished running node model.sample_project.customer_nation
2020-06-30 02:15:36.274923 (Thread-1): Began running node model.sample_project.orders_lineitem
2020-06-30 02:15:36.275171 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 02:15:36.275271 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer_nation).
2020-06-30 02:15:36.275365 (Thread-1): Compiling model.sample_project.orders_lineitem
2020-06-30 02:15:36.287519 (Thread-1): Writing injected SQL for node "model.sample_project.orders_lineitem"
2020-06-30 02:15:36.287912 (Thread-1): finished collecting timing info
2020-06-30 02:15:36.288334 (Thread-1): Finished running node model.sample_project.orders_lineitem
2020-06-30 02:15:36.288478 (Thread-1): Began running node model.sample_project.customers_per_nation
2020-06-30 02:15:36.289496 (Thread-1): 21:15:36 | 1 of 2 START table model TEST.customers_per_nation................... [RUN]
2020-06-30 02:15:36.289813 (Thread-1): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 02:15:36.289930 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders_lineitem).
2020-06-30 02:15:36.290030 (Thread-1): Compiling model.sample_project.customers_per_nation
2020-06-30 02:15:36.299303 (Thread-1): Writing injected SQL for node "model.sample_project.customers_per_nation"
2020-06-30 02:15:36.299774 (Thread-1): finished collecting timing info
2020-06-30 02:15:36.332700 (Thread-1): Writing runtime SQL for node "model.sample_project.customers_per_nation"
2020-06-30 02:15:36.335554 (Thread-1): Using snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 02:15:36.336050 (Thread-1): On model.sample_project.customers_per_nation: BEGIN
2020-06-30 02:15:36.533878 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2020-06-30 02:15:36.534061 (Thread-1): Using snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 02:15:36.534180 (Thread-1): On model.sample_project.customers_per_nation: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "model.sample_project.customers_per_nation"} */


      create or replace transient table JAVEN_TESTING.TEST.customers_per_nation  as
      (with __dbt__CTE__customer as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  c_custkey as custkey,
        c_nationkey as nationkey,
        c_name as name
from snowflake_sample_data.tpch_sf1.customer
),  __dbt__CTE__nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  n_nationkey as nationkey,
        n_name as name
from snowflake_sample_data.tpch_sf1.nation
),  __dbt__CTE__customer_nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  c.custkey,
        c.nationkey,
        c.name as customer_name,
        n.name as nation_name
from __dbt__CTE__customer as c
JOIN __dbt__CTE__nation as n
ON c.nationkey=n.nationkey
)/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  count(customer_name) as customer_count,
        nation_name
from __dbt__CTE__customer_nation
group by nation_name
order by nation_name
      );
2020-06-30 02:15:37.772260 (Thread-1): SQL status: SUCCESS 1 in 1.24 seconds
2020-06-30 02:15:37.773460 (Thread-1): On model.sample_project.customers_per_nation: COMMIT
2020-06-30 02:15:37.773631 (Thread-1): Using snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 02:15:37.773745 (Thread-1): On model.sample_project.customers_per_nation: COMMIT
2020-06-30 02:15:37.979820 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2020-06-30 02:15:37.991893 (Thread-1): finished collecting timing info
2020-06-30 02:15:37.992689 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50abf0b2-3532-4682-9b0a-ae4451d26371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2618d0>]}
2020-06-30 02:15:37.994020 (Thread-1): 21:15:37 | 1 of 2 OK created table model TEST.customers_per_nation.............. [SUCCESS 1 in 1.70s]
2020-06-30 02:15:37.994190 (Thread-1): Finished running node model.sample_project.customers_per_nation
2020-06-30 02:15:37.994357 (Thread-1): Began running node model.sample_project.average_price_per_order
2020-06-30 02:15:37.995789 (Thread-1): 21:15:37 | 2 of 2 START table model TEST.average_price_per_order................ [RUN]
2020-06-30 02:15:37.996195 (Thread-1): Acquiring new snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 02:15:37.996332 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customers_per_nation).
2020-06-30 02:15:37.996452 (Thread-1): Compiling model.sample_project.average_price_per_order
2020-06-30 02:15:38.007389 (Thread-1): Writing injected SQL for node "model.sample_project.average_price_per_order"
2020-06-30 02:15:38.008111 (Thread-1): finished collecting timing info
2020-06-30 02:15:38.015740 (Thread-1): Writing runtime SQL for node "model.sample_project.average_price_per_order"
2020-06-30 02:15:38.019100 (Thread-1): Using snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 02:15:38.019329 (Thread-1): On model.sample_project.average_price_per_order: BEGIN
2020-06-30 02:15:38.234133 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2020-06-30 02:15:38.234396 (Thread-1): Using snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 02:15:38.234563 (Thread-1): On model.sample_project.average_price_per_order: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "model.sample_project.average_price_per_order"} */


      create or replace transient table JAVEN_TESTING.TEST.average_price_per_order  as
      (with __dbt__CTE__orders as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  o_orderkey as orderkey,
        o_custkey as custkey,
        o_totalprice as totalprice,
        o_orderdate as orderdate
from snowflake_sample_data.tpch_sf1.orders
),  __dbt__CTE__lineitem as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  l_orderkey as orderkey,
        l_extendedprice as extendedprice,
        l_discount as discount,
        l_tax as tax,
        l_quantity as quantity
from snowflake_sample_data.tpch_sf1.lineitem
),  __dbt__CTE__orders_lineitem as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  o.orderkey,
        o.custkey,
        o.totalprice,
        o.orderdate,
        l.extendedprice,
        l.discount,
        l.tax,
        l.quantity
from __dbt__CTE__orders as o
JOIN __dbt__CTE__lineitem as l
ON o.orderkey=l.orderkey
)/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  average(totalprice) as average_price,
        orderdate
from __dbt__CTE__orders_lineitem
group by orderdate
      );
2020-06-30 02:15:38.588378 (Thread-1): Snowflake query id: 01953e67-027a-162f-0000-2aed011cd1ca
2020-06-30 02:15:38.588547 (Thread-1): Snowflake error: 002140 (42601): SQL compilation error:
Unknown function AVERAGE
2020-06-30 02:15:38.588676 (Thread-1): On model.sample_project.average_price_per_order: ROLLBACK
2020-06-30 02:15:38.588785 (Thread-1): initiating rollback
2020-06-30 02:15:38.864169 (Thread-1): finished collecting timing info
2020-06-30 02:15:38.864844 (Thread-1): Database Error in model average_price_per_order (models/reports/average_price_per_order.sql)
  002140 (42601): SQL compilation error:
  Unknown function AVERAGE
  compiled SQL at target/run/sample_project/models/reports/average_price_per_order.sql
Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 158, in exception_handler
    yield
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/cursor.py", line 597, in execute
    errvalue)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/errors.py", line 97, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, errorclass, errorvalue)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/errors.py", line 73, in default_errorhandler
    done_format_msg=errorvalue.get(u'done_format_msg'))
snowflake.connector.errors.ProgrammingError: 002140 (42601): SQL compilation error:
Unknown function AVERAGE

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 119, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 306, in add_query
    abridge_sql_log=abridge_sql_log
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/usr/local/opt/python/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 177, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model average_price_per_order (models/reports/average_price_per_order.sql)
  002140 (42601): SQL compilation error:
  Unknown function AVERAGE
  compiled SQL at target/run/sample_project/models/reports/average_price_per_order.sql
2020-06-30 02:15:38.867740 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50abf0b2-3532-4682-9b0a-ae4451d26371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d43890>]}
2020-06-30 02:15:38.869045 (Thread-1): 21:15:38 | 2 of 2 ERROR creating table model TEST.average_price_per_order....... [ERROR in 0.87s]
2020-06-30 02:15:38.869227 (Thread-1): Finished running node model.sample_project.average_price_per_order
2020-06-30 02:15:38.869434 (Thread-1): Began running node model.sample_project.cust_list_ord_nat
2020-06-30 02:15:38.869740 (Thread-1): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 02:15:38.869859 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.average_price_per_order).
2020-06-30 02:15:38.869973 (Thread-1): Compiling model.sample_project.cust_list_ord_nat
2020-06-30 02:15:38.890008 (Thread-1): Writing injected SQL for node "model.sample_project.cust_list_ord_nat"
2020-06-30 02:15:38.890936 (Thread-1): finished collecting timing info
2020-06-30 02:15:38.891597 (Thread-1): Finished running node model.sample_project.cust_list_ord_nat
2020-06-30 02:15:38.991521 (MainThread): Using snowflake connection "master".
2020-06-30 02:15:38.991712 (MainThread): On master: BEGIN
2020-06-30 02:15:39.270717 (MainThread): SQL status: SUCCESS 1 in 0.28 seconds
2020-06-30 02:15:39.270996 (MainThread): On master: COMMIT
2020-06-30 02:15:39.271232 (MainThread): Using snowflake connection "master".
2020-06-30 02:15:39.271398 (MainThread): On master: COMMIT
2020-06-30 02:15:39.671250 (MainThread): SQL status: SUCCESS 1 in 0.40 seconds
2020-06-30 02:15:39.671832 (MainThread): 21:15:39 | 
2020-06-30 02:15:39.672022 (MainThread): 21:15:39 | Finished running 2 table models in 20.24s.
2020-06-30 02:15:39.672177 (MainThread): Connection 'master' was left open.
2020-06-30 02:15:39.672303 (MainThread): On master: Close
2020-06-30 02:15:40.072820 (MainThread): Connection 'model.sample_project.cust_list_ord_nat' was left open.
2020-06-30 02:15:40.073019 (MainThread): On model.sample_project.cust_list_ord_nat: Close
2020-06-30 02:15:40.915652 (MainThread): 
2020-06-30 02:15:40.915859 (MainThread): Completed with 1 error and 0 warnings:
2020-06-30 02:15:40.916006 (MainThread): 
2020-06-30 02:15:40.916143 (MainThread): Database Error in model average_price_per_order (models/reports/average_price_per_order.sql)
2020-06-30 02:15:40.916269 (MainThread):   002140 (42601): SQL compilation error:
2020-06-30 02:15:40.916385 (MainThread):   Unknown function AVERAGE
2020-06-30 02:15:40.916501 (MainThread):   compiled SQL at target/run/sample_project/models/reports/average_price_per_order.sql
2020-06-30 02:15:40.916624 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
2020-06-30 02:15:40.916816 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107def5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075b8190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a115290>]}
2020-06-30 02:15:40.917032 (MainThread): Flushing usage events
2020-06-30 02:16:31.648280 (MainThread): Running with dbt=0.17.0
2020-06-30 02:16:32.090890 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-06-30 02:16:32.092353 (MainThread): Tracking: tracking
2020-06-30 02:16:32.092713 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f7a8690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f7ba210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f7bae90>]}
2020-06-30 02:16:32.115027 (MainThread): Partial parsing not enabled
2020-06-30 02:16:32.116753 (MainThread): Parsing macros/core.sql
2020-06-30 02:16:32.122680 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-30 02:16:32.131835 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-30 02:16:32.133693 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-30 02:16:32.152550 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-30 02:16:32.186533 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-30 02:16:32.213111 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-30 02:16:32.215435 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-30 02:16:32.223195 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-30 02:16:32.238186 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-30 02:16:32.245398 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-30 02:16:32.252312 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-30 02:16:32.259411 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-30 02:16:32.260411 (MainThread): Parsing macros/etc/query.sql
2020-06-30 02:16:32.261718 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-30 02:16:32.263425 (MainThread): Parsing macros/etc/datetime.sql
2020-06-30 02:16:32.273479 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-30 02:16:32.275521 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-30 02:16:32.277228 (MainThread): Parsing macros/adapters/common.sql
2020-06-30 02:16:32.331025 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-30 02:16:32.332228 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-30 02:16:32.333162 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-30 02:16:32.334308 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-30 02:16:32.336813 (MainThread): Parsing macros/catalog.sql
2020-06-30 02:16:32.339625 (MainThread): Parsing macros/adapters.sql
2020-06-30 02:16:32.362536 (MainThread): Parsing macros/materializations/merge.sql
2020-06-30 02:16:32.364945 (MainThread): Parsing macros/materializations/view.sql
2020-06-30 02:16:32.366186 (MainThread): Parsing macros/materializations/table.sql
2020-06-30 02:16:32.370850 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-30 02:16:32.400045 (MainThread): Partial parsing not enabled
2020-06-30 02:16:32.436744 (MainThread): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 02:16:32.436868 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:16:32.467593 (MainThread): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 02:16:32.467721 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:16:32.480127 (MainThread): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 02:16:32.480230 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:16:32.492853 (MainThread): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 02:16:32.492952 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:16:32.504341 (MainThread): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 02:16:32.504437 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:16:32.517652 (MainThread): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 02:16:32.517774 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:16:32.530565 (MainThread): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 02:16:32.530668 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:16:32.543314 (MainThread): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 02:16:32.543429 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:16:32.555720 (MainThread): Acquiring new snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 02:16:32.555829 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:16:32.917412 (MainThread): Found 9 models, 8 tests, 0 snapshots, 0 analyses, 136 macros, 0 operations, 0 seed files, 4 sources
2020-06-30 02:16:32.918962 (MainThread): 
2020-06-30 02:16:32.919279 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 02:16:32.919368 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:16:32.922116 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_JAVEN_TESTING".
2020-06-30 02:16:32.922303 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-06-30 02:16:32.939760 (ThreadPoolExecutor-0_0): Using snowflake connection "list_JAVEN_TESTING".
2020-06-30 02:16:32.939994 (ThreadPoolExecutor-0_0): On list_JAVEN_TESTING: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING"} */

    show terse schemas in database JAVEN_TESTING
    limit 10000
2020-06-30 02:16:33.464201 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/certifi/cacert.pem'>
2020-06-30 02:16:38.397644 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 5.46 seconds
2020-06-30 02:16:38.430940 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 02:16:38.431189 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_JAVEN_TESTING).
2020-06-30 02:16:38.438467 (ThreadPoolExecutor-1_0): Using snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 02:16:38.438586 (ThreadPoolExecutor-1_0): On list_JAVEN_TESTING_TEST: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING_TEST"} */

    show terse objects in JAVEN_TESTING.TEST
2020-06-30 02:16:38.732186 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 0.29 seconds
2020-06-30 02:16:38.741592 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 02:16:38.741732 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:16:38.741935 (MainThread): Using snowflake connection "master".
2020-06-30 02:16:38.742048 (MainThread): On master: BEGIN
2020-06-30 02:16:44.122243 (MainThread): SQL status: SUCCESS 1 in 5.38 seconds
2020-06-30 02:16:44.122464 (MainThread): On master: COMMIT
2020-06-30 02:16:44.122633 (MainThread): Using snowflake connection "master".
2020-06-30 02:16:44.122745 (MainThread): On master: COMMIT
2020-06-30 02:16:44.405973 (MainThread): SQL status: SUCCESS 1 in 0.28 seconds
2020-06-30 02:16:44.406549 (MainThread): 21:16:44 | Concurrency: 1 threads (target='dev')
2020-06-30 02:16:44.406792 (MainThread): 21:16:44 | 
2020-06-30 02:16:44.408006 (Thread-1): Began running node model.sample_project.customer
2020-06-30 02:16:44.408464 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 02:16:44.408661 (Thread-1): Re-using an available connection from the pool (formerly list_JAVEN_TESTING_TEST).
2020-06-30 02:16:44.408815 (Thread-1): Compiling model.sample_project.customer
2020-06-30 02:16:44.441058 (Thread-1): Writing injected SQL for node "model.sample_project.customer"
2020-06-30 02:16:44.441765 (Thread-1): finished collecting timing info
2020-06-30 02:16:44.442456 (Thread-1): Finished running node model.sample_project.customer
2020-06-30 02:16:44.442644 (Thread-1): Began running node model.sample_project.lineitem
2020-06-30 02:16:44.442968 (Thread-1): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 02:16:44.443096 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer).
2020-06-30 02:16:44.443219 (Thread-1): Compiling model.sample_project.lineitem
2020-06-30 02:16:44.453397 (Thread-1): Writing injected SQL for node "model.sample_project.lineitem"
2020-06-30 02:16:44.453816 (Thread-1): finished collecting timing info
2020-06-30 02:16:44.454316 (Thread-1): Finished running node model.sample_project.lineitem
2020-06-30 02:16:44.454521 (Thread-1): Began running node model.sample_project.nation
2020-06-30 02:16:44.455011 (Thread-1): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 02:16:44.455147 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.lineitem).
2020-06-30 02:16:44.455267 (Thread-1): Compiling model.sample_project.nation
2020-06-30 02:16:44.464335 (Thread-1): Writing injected SQL for node "model.sample_project.nation"
2020-06-30 02:16:44.464697 (Thread-1): finished collecting timing info
2020-06-30 02:16:44.465158 (Thread-1): Finished running node model.sample_project.nation
2020-06-30 02:16:44.465322 (Thread-1): Began running node model.sample_project.orders
2020-06-30 02:16:44.465615 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 02:16:44.465733 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.nation).
2020-06-30 02:16:44.465845 (Thread-1): Compiling model.sample_project.orders
2020-06-30 02:16:44.475086 (Thread-1): Writing injected SQL for node "model.sample_project.orders"
2020-06-30 02:16:44.475687 (Thread-1): finished collecting timing info
2020-06-30 02:16:44.476316 (Thread-1): Finished running node model.sample_project.orders
2020-06-30 02:16:44.476484 (Thread-1): Began running node model.sample_project.customer_nation
2020-06-30 02:16:44.476885 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 02:16:44.477164 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders).
2020-06-30 02:16:44.477306 (Thread-1): Compiling model.sample_project.customer_nation
2020-06-30 02:16:44.489367 (Thread-1): Writing injected SQL for node "model.sample_project.customer_nation"
2020-06-30 02:16:44.489732 (Thread-1): finished collecting timing info
2020-06-30 02:16:44.490140 (Thread-1): Finished running node model.sample_project.customer_nation
2020-06-30 02:16:44.490280 (Thread-1): Began running node model.sample_project.orders_lineitem
2020-06-30 02:16:44.490530 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 02:16:44.490629 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer_nation).
2020-06-30 02:16:44.490723 (Thread-1): Compiling model.sample_project.orders_lineitem
2020-06-30 02:16:44.502966 (Thread-1): Writing injected SQL for node "model.sample_project.orders_lineitem"
2020-06-30 02:16:44.503424 (Thread-1): finished collecting timing info
2020-06-30 02:16:44.503924 (Thread-1): Finished running node model.sample_project.orders_lineitem
2020-06-30 02:16:44.504073 (Thread-1): Began running node model.sample_project.customers_per_nation
2020-06-30 02:16:44.505077 (Thread-1): 21:16:44 | 1 of 2 START table model TEST.customers_per_nation................... [RUN]
2020-06-30 02:16:44.505450 (Thread-1): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 02:16:44.505561 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders_lineitem).
2020-06-30 02:16:44.505776 (Thread-1): Compiling model.sample_project.customers_per_nation
2020-06-30 02:16:44.514846 (Thread-1): Writing injected SQL for node "model.sample_project.customers_per_nation"
2020-06-30 02:16:44.515217 (Thread-1): finished collecting timing info
2020-06-30 02:16:44.551092 (Thread-1): Writing runtime SQL for node "model.sample_project.customers_per_nation"
2020-06-30 02:16:44.553622 (Thread-1): Using snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 02:16:44.553774 (Thread-1): On model.sample_project.customers_per_nation: BEGIN
2020-06-30 02:16:44.760881 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2020-06-30 02:16:44.761090 (Thread-1): Using snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 02:16:44.761209 (Thread-1): On model.sample_project.customers_per_nation: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "model.sample_project.customers_per_nation"} */


      create or replace transient table JAVEN_TESTING.TEST.customers_per_nation  as
      (with __dbt__CTE__customer as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  c_custkey as custkey,
        c_nationkey as nationkey,
        c_name as name
from snowflake_sample_data.tpch_sf1.customer
),  __dbt__CTE__nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  n_nationkey as nationkey,
        n_name as name
from snowflake_sample_data.tpch_sf1.nation
),  __dbt__CTE__customer_nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  c.custkey,
        c.nationkey,
        c.name as customer_name,
        n.name as nation_name
from __dbt__CTE__customer as c
JOIN __dbt__CTE__nation as n
ON c.nationkey=n.nationkey
)/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  count(customer_name) as customer_count,
        nation_name
from __dbt__CTE__customer_nation
group by nation_name
order by nation_name
      );
2020-06-30 02:16:46.152573 (Thread-1): SQL status: SUCCESS 1 in 1.39 seconds
2020-06-30 02:16:46.154057 (Thread-1): On model.sample_project.customers_per_nation: COMMIT
2020-06-30 02:16:46.154266 (Thread-1): Using snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 02:16:46.154405 (Thread-1): On model.sample_project.customers_per_nation: COMMIT
2020-06-30 02:16:46.339946 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2020-06-30 02:16:46.351350 (Thread-1): finished collecting timing info
2020-06-30 02:16:46.352112 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c62755b-ce46-48af-b51e-b216299fc8c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124fbf50>]}
2020-06-30 02:16:46.353444 (Thread-1): 21:16:46 | 1 of 2 OK created table model TEST.customers_per_nation.............. [SUCCESS 1 in 1.85s]
2020-06-30 02:16:46.353615 (Thread-1): Finished running node model.sample_project.customers_per_nation
2020-06-30 02:16:46.353786 (Thread-1): Began running node model.sample_project.average_price_per_order
2020-06-30 02:16:46.355073 (Thread-1): 21:16:46 | 2 of 2 START table model TEST.average_price_per_order................ [RUN]
2020-06-30 02:16:46.355454 (Thread-1): Acquiring new snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 02:16:46.355566 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customers_per_nation).
2020-06-30 02:16:46.355677 (Thread-1): Compiling model.sample_project.average_price_per_order
2020-06-30 02:16:46.369730 (Thread-1): Writing injected SQL for node "model.sample_project.average_price_per_order"
2020-06-30 02:16:46.370881 (Thread-1): finished collecting timing info
2020-06-30 02:16:46.377764 (Thread-1): Writing runtime SQL for node "model.sample_project.average_price_per_order"
2020-06-30 02:16:46.380692 (Thread-1): Using snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 02:16:46.380826 (Thread-1): On model.sample_project.average_price_per_order: BEGIN
2020-06-30 02:16:46.621563 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2020-06-30 02:16:46.621768 (Thread-1): Using snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 02:16:46.621901 (Thread-1): On model.sample_project.average_price_per_order: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "model.sample_project.average_price_per_order"} */


      create or replace transient table JAVEN_TESTING.TEST.average_price_per_order  as
      (with __dbt__CTE__orders as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  o_orderkey as orderkey,
        o_custkey as custkey,
        o_totalprice as totalprice,
        o_orderdate as orderdate
from snowflake_sample_data.tpch_sf1.orders
),  __dbt__CTE__lineitem as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  l_orderkey as orderkey,
        l_extendedprice as extendedprice,
        l_discount as discount,
        l_tax as tax,
        l_quantity as quantity
from snowflake_sample_data.tpch_sf1.lineitem
),  __dbt__CTE__orders_lineitem as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  o.orderkey,
        o.custkey,
        o.totalprice,
        o.orderdate,
        l.extendedprice,
        l.discount,
        l.tax,
        l.quantity
from __dbt__CTE__orders as o
JOIN __dbt__CTE__lineitem as l
ON o.orderkey=l.orderkey
)/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  avg(totalprice) as average_price,
        orderdate
from __dbt__CTE__orders_lineitem
group by orderdate
      );
2020-06-30 02:16:48.970313 (Thread-1): SQL status: SUCCESS 1 in 2.35 seconds
2020-06-30 02:16:48.971533 (Thread-1): On model.sample_project.average_price_per_order: COMMIT
2020-06-30 02:16:48.971716 (Thread-1): Using snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 02:16:48.971831 (Thread-1): On model.sample_project.average_price_per_order: COMMIT
2020-06-30 02:16:49.670439 (Thread-1): SQL status: SUCCESS 1 in 0.70 seconds
2020-06-30 02:16:49.673035 (Thread-1): finished collecting timing info
2020-06-30 02:16:49.673772 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c62755b-ce46-48af-b51e-b216299fc8c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100d1c90>]}
2020-06-30 02:16:49.675069 (Thread-1): 21:16:49 | 2 of 2 OK created table model TEST.average_price_per_order........... [SUCCESS 1 in 3.32s]
2020-06-30 02:16:49.675246 (Thread-1): Finished running node model.sample_project.average_price_per_order
2020-06-30 02:16:49.675403 (Thread-1): Began running node model.sample_project.cust_list_ord_nat
2020-06-30 02:16:49.675700 (Thread-1): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 02:16:49.675820 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.average_price_per_order).
2020-06-30 02:16:49.675930 (Thread-1): Compiling model.sample_project.cust_list_ord_nat
2020-06-30 02:16:49.697733 (Thread-1): Writing injected SQL for node "model.sample_project.cust_list_ord_nat"
2020-06-30 02:16:49.698327 (Thread-1): finished collecting timing info
2020-06-30 02:16:49.698877 (Thread-1): Finished running node model.sample_project.cust_list_ord_nat
2020-06-30 02:16:49.767314 (MainThread): Using snowflake connection "master".
2020-06-30 02:16:49.767492 (MainThread): On master: BEGIN
2020-06-30 02:16:50.300663 (MainThread): SQL status: SUCCESS 1 in 0.53 seconds
2020-06-30 02:16:50.300865 (MainThread): On master: COMMIT
2020-06-30 02:16:50.301029 (MainThread): Using snowflake connection "master".
2020-06-30 02:16:50.301144 (MainThread): On master: COMMIT
2020-06-30 02:16:50.568000 (MainThread): SQL status: SUCCESS 1 in 0.27 seconds
2020-06-30 02:16:50.568426 (MainThread): 21:16:50 | 
2020-06-30 02:16:50.568583 (MainThread): 21:16:50 | Finished running 2 table models in 17.65s.
2020-06-30 02:16:50.568755 (MainThread): Connection 'master' was left open.
2020-06-30 02:16:50.568902 (MainThread): On master: Close
2020-06-30 02:16:50.889537 (MainThread): Connection 'model.sample_project.cust_list_ord_nat' was left open.
2020-06-30 02:16:50.889717 (MainThread): On model.sample_project.cust_list_ord_nat: Close
2020-06-30 02:16:51.291593 (MainThread): 
2020-06-30 02:16:51.291768 (MainThread): Completed successfully
2020-06-30 02:16:51.291902 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2020-06-30 02:16:51.292081 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112407ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11014a9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124fb050>]}
2020-06-30 02:16:51.292281 (MainThread): Flushing usage events
2020-06-30 02:32:47.731502 (MainThread): Running with dbt=0.17.0
2020-06-30 02:32:48.224848 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-06-30 02:32:48.226411 (MainThread): Tracking: tracking
2020-06-30 02:32:48.226743 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11213aed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11213a050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112108510>]}
2020-06-30 02:32:48.249031 (MainThread): Partial parsing not enabled
2020-06-30 02:32:48.251082 (MainThread): Parsing macros/core.sql
2020-06-30 02:32:48.258152 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-30 02:32:48.267279 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-30 02:32:48.269626 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-30 02:32:48.291370 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-30 02:32:48.327095 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-30 02:32:48.350311 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-30 02:32:48.352642 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-30 02:32:48.360352 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-30 02:32:48.379744 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-30 02:32:48.388051 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-30 02:32:48.396538 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-30 02:32:48.404457 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-30 02:32:48.406062 (MainThread): Parsing macros/etc/query.sql
2020-06-30 02:32:48.407459 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-30 02:32:48.409566 (MainThread): Parsing macros/etc/datetime.sql
2020-06-30 02:32:48.419573 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-30 02:32:48.421853 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-30 02:32:48.423782 (MainThread): Parsing macros/adapters/common.sql
2020-06-30 02:32:48.479698 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-30 02:32:48.481185 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-30 02:32:48.482504 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-30 02:32:48.483990 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-30 02:32:48.487060 (MainThread): Parsing macros/catalog.sql
2020-06-30 02:32:48.489537 (MainThread): Parsing macros/adapters.sql
2020-06-30 02:32:48.513930 (MainThread): Parsing macros/materializations/merge.sql
2020-06-30 02:32:48.516398 (MainThread): Parsing macros/materializations/view.sql
2020-06-30 02:32:48.517985 (MainThread): Parsing macros/materializations/table.sql
2020-06-30 02:32:48.522526 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-30 02:32:48.550979 (MainThread): Partial parsing not enabled
2020-06-30 02:32:48.588786 (MainThread): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 02:32:48.588919 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:32:48.618927 (MainThread): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 02:32:48.619062 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:32:48.631163 (MainThread): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 02:32:48.631253 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:32:48.642681 (MainThread): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 02:32:48.642778 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:32:48.654305 (MainThread): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 02:32:48.654395 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:32:48.667055 (MainThread): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 02:32:48.667146 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:32:48.680391 (MainThread): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 02:32:48.680540 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:32:48.694135 (MainThread): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 02:32:48.694261 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:32:48.706087 (MainThread): Acquiring new snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 02:32:48.706178 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:32:49.027918 (MainThread): Found 9 models, 8 tests, 0 snapshots, 0 analyses, 136 macros, 0 operations, 0 seed files, 4 sources
2020-06-30 02:32:49.029313 (MainThread): 
2020-06-30 02:32:49.029571 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 02:32:49.029654 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:32:49.032177 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_JAVEN_TESTING".
2020-06-30 02:32:49.032277 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-06-30 02:32:49.051099 (ThreadPoolExecutor-0_0): Using snowflake connection "list_JAVEN_TESTING".
2020-06-30 02:32:49.051399 (ThreadPoolExecutor-0_0): On list_JAVEN_TESTING: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING"} */

    show terse schemas in database JAVEN_TESTING
    limit 10000
2020-06-30 02:32:50.090495 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/certifi/cacert.pem'>
2020-06-30 02:32:55.968859 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 6.92 seconds
2020-06-30 02:32:56.000290 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 02:32:56.000401 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_JAVEN_TESTING).
2020-06-30 02:32:56.007470 (ThreadPoolExecutor-1_0): Using snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 02:32:56.007584 (ThreadPoolExecutor-1_0): On list_JAVEN_TESTING_TEST: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING_TEST"} */

    show terse objects in JAVEN_TESTING.TEST
2020-06-30 02:32:56.264460 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 0.26 seconds
2020-06-30 02:32:56.275538 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 02:32:56.275680 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:32:56.275884 (MainThread): Using snowflake connection "master".
2020-06-30 02:32:56.275998 (MainThread): On master: BEGIN
2020-06-30 02:33:04.071461 (MainThread): SQL status: SUCCESS 1 in 7.80 seconds
2020-06-30 02:33:04.071756 (MainThread): On master: COMMIT
2020-06-30 02:33:04.071957 (MainThread): Using snowflake connection "master".
2020-06-30 02:33:04.072091 (MainThread): On master: COMMIT
2020-06-30 02:33:04.522089 (MainThread): SQL status: SUCCESS 1 in 0.45 seconds
2020-06-30 02:33:04.522667 (MainThread): 21:33:04 | Concurrency: 1 threads (target='dev')
2020-06-30 02:33:04.522865 (MainThread): 21:33:04 | 
2020-06-30 02:33:04.523852 (Thread-1): Began running node model.sample_project.customer
2020-06-30 02:33:04.524276 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 02:33:04.524426 (Thread-1): Re-using an available connection from the pool (formerly list_JAVEN_TESTING_TEST).
2020-06-30 02:33:04.524576 (Thread-1): Compiling model.sample_project.customer
2020-06-30 02:33:04.551928 (Thread-1): Writing injected SQL for node "model.sample_project.customer"
2020-06-30 02:33:04.552814 (Thread-1): finished collecting timing info
2020-06-30 02:33:04.553610 (Thread-1): Finished running node model.sample_project.customer
2020-06-30 02:33:04.553838 (Thread-1): Began running node model.sample_project.lineitem
2020-06-30 02:33:04.554229 (Thread-1): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 02:33:04.554354 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer).
2020-06-30 02:33:04.554478 (Thread-1): Compiling model.sample_project.lineitem
2020-06-30 02:33:04.565456 (Thread-1): Writing injected SQL for node "model.sample_project.lineitem"
2020-06-30 02:33:04.566025 (Thread-1): finished collecting timing info
2020-06-30 02:33:04.566657 (Thread-1): Finished running node model.sample_project.lineitem
2020-06-30 02:33:04.566854 (Thread-1): Began running node model.sample_project.nation
2020-06-30 02:33:04.567209 (Thread-1): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 02:33:04.567335 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.lineitem).
2020-06-30 02:33:04.567457 (Thread-1): Compiling model.sample_project.nation
2020-06-30 02:33:04.579001 (Thread-1): Writing injected SQL for node "model.sample_project.nation"
2020-06-30 02:33:04.579460 (Thread-1): finished collecting timing info
2020-06-30 02:33:04.579948 (Thread-1): Finished running node model.sample_project.nation
2020-06-30 02:33:04.580112 (Thread-1): Began running node model.sample_project.orders
2020-06-30 02:33:04.580411 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 02:33:04.580528 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.nation).
2020-06-30 02:33:04.580639 (Thread-1): Compiling model.sample_project.orders
2020-06-30 02:33:04.589901 (Thread-1): Writing injected SQL for node "model.sample_project.orders"
2020-06-30 02:33:04.590248 (Thread-1): finished collecting timing info
2020-06-30 02:33:04.590703 (Thread-1): Finished running node model.sample_project.orders
2020-06-30 02:33:04.590863 (Thread-1): Began running node model.sample_project.customer_nation
2020-06-30 02:33:04.591169 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 02:33:04.591280 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders).
2020-06-30 02:33:04.591386 (Thread-1): Compiling model.sample_project.customer_nation
2020-06-30 02:33:04.603245 (Thread-1): Writing injected SQL for node "model.sample_project.customer_nation"
2020-06-30 02:33:04.604404 (Thread-1): finished collecting timing info
2020-06-30 02:33:04.604943 (Thread-1): Finished running node model.sample_project.customer_nation
2020-06-30 02:33:04.605097 (Thread-1): Began running node model.sample_project.orders_lineitem
2020-06-30 02:33:04.605360 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 02:33:04.605461 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer_nation).
2020-06-30 02:33:04.605558 (Thread-1): Compiling model.sample_project.orders_lineitem
2020-06-30 02:33:04.618106 (Thread-1): Writing injected SQL for node "model.sample_project.orders_lineitem"
2020-06-30 02:33:04.618575 (Thread-1): finished collecting timing info
2020-06-30 02:33:04.619003 (Thread-1): Finished running node model.sample_project.orders_lineitem
2020-06-30 02:33:04.619145 (Thread-1): Began running node model.sample_project.customers_per_nation
2020-06-30 02:33:04.620147 (Thread-1): 21:33:04 | 1 of 2 START table model TEST.customers_per_nation................... [RUN]
2020-06-30 02:33:04.620603 (Thread-1): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 02:33:04.620711 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders_lineitem).
2020-06-30 02:33:04.620809 (Thread-1): Compiling model.sample_project.customers_per_nation
2020-06-30 02:33:04.629838 (Thread-1): Writing injected SQL for node "model.sample_project.customers_per_nation"
2020-06-30 02:33:04.630231 (Thread-1): finished collecting timing info
2020-06-30 02:33:04.663593 (Thread-1): Writing runtime SQL for node "model.sample_project.customers_per_nation"
2020-06-30 02:33:04.665742 (Thread-1): Using snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 02:33:04.665847 (Thread-1): On model.sample_project.customers_per_nation: BEGIN
2020-06-30 02:33:05.995762 (Thread-1): SQL status: SUCCESS 1 in 1.33 seconds
2020-06-30 02:33:05.996027 (Thread-1): Using snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 02:33:05.996196 (Thread-1): On model.sample_project.customers_per_nation: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "model.sample_project.customers_per_nation"} */


      create or replace transient table JAVEN_TESTING.TEST.customers_per_nation  as
      (with __dbt__CTE__customer as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  c_custkey as custkey,
        c_nationkey as nationkey,
        c_name as name
from snowflake_sample_data.tpch_sf1.customer
),  __dbt__CTE__nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  n_nationkey as nationkey,
        n_name as name
from snowflake_sample_data.tpch_sf1.nation
),  __dbt__CTE__customer_nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  c.custkey,
        c.nationkey,
        c.name as customer_name,
        n.name as nation_name
from __dbt__CTE__customer as c
JOIN __dbt__CTE__nation as n
ON c.nationkey=n.nationkey
)/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  count(customer_name) as customer_count,
        nation_name
from __dbt__CTE__customer_nation
group by nation_name
order by nation_name
      );
2020-06-30 02:33:08.723831 (Thread-1): SQL status: SUCCESS 1 in 2.73 seconds
2020-06-30 02:33:08.725546 (Thread-1): On model.sample_project.customers_per_nation: COMMIT
2020-06-30 02:33:08.725786 (Thread-1): Using snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 02:33:08.725918 (Thread-1): On model.sample_project.customers_per_nation: COMMIT
2020-06-30 02:33:09.002106 (Thread-1): SQL status: SUCCESS 1 in 0.28 seconds
2020-06-30 02:33:09.014376 (Thread-1): finished collecting timing info
2020-06-30 02:33:09.015113 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82121255-5212-4ff4-9838-4e9e237f5837', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11077cd50>]}
2020-06-30 02:33:09.016409 (Thread-1): 21:33:09 | 1 of 2 OK created table model TEST.customers_per_nation.............. [SUCCESS 1 in 4.39s]
2020-06-30 02:33:09.016574 (Thread-1): Finished running node model.sample_project.customers_per_nation
2020-06-30 02:33:09.016736 (Thread-1): Began running node model.sample_project.average_price_per_order
2020-06-30 02:33:09.019070 (Thread-1): 21:33:09 | 2 of 2 START table model TEST.average_price_per_order................ [RUN]
2020-06-30 02:33:09.019484 (Thread-1): Acquiring new snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 02:33:09.019610 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customers_per_nation).
2020-06-30 02:33:09.019725 (Thread-1): Compiling model.sample_project.average_price_per_order
2020-06-30 02:33:09.027552 (Thread-1): finished collecting timing info
2020-06-30 02:33:09.027956 (Thread-1): Compilation Error in model average_price_per_order (models/reports/average_price_per_order.sql)
  'dbt_utils' is undefined
Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 449, in catch_jinja
    yield
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 481, in render_template
    return template.render(ctx)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 18, in top-level template code
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/sandbox.py", line 407, in getattr
    value = getattr(obj, attribute)
jinja2.exceptions.UndefinedError: 'dbt_utils' is undefined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 165, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 340, in compile
    return compile_node(self.adapter, self.config, self.node, manifest, {})
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/compilation.py", line 255, in compile_node
    node = compiler.compile_node(node, manifest, extra_context)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/compilation.py", line 179, in compile_node
    node)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 530, in get_rendered
    return render_template(template, ctx, node)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 481, in render_template
    return template.render(ctx)
  File "/usr/local/opt/python/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 454, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in model average_price_per_order (models/reports/average_price_per_order.sql)
  'dbt_utils' is undefined
2020-06-30 02:33:09.033032 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82121255-5212-4ff4-9838-4e9e237f5837', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114dee590>]}
2020-06-30 02:33:09.034171 (Thread-1): 21:33:09 | 2 of 2 ERROR creating table model TEST.average_price_per_order....... [ERROR in 0.01s]
2020-06-30 02:33:09.034320 (Thread-1): Finished running node model.sample_project.average_price_per_order
2020-06-30 02:33:09.034456 (Thread-1): Began running node model.sample_project.cust_list_ord_nat
2020-06-30 02:33:09.034719 (Thread-1): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 02:33:09.034911 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.average_price_per_order).
2020-06-30 02:33:09.035029 (Thread-1): Compiling model.sample_project.cust_list_ord_nat
2020-06-30 02:33:09.055701 (Thread-1): Writing injected SQL for node "model.sample_project.cust_list_ord_nat"
2020-06-30 02:33:09.056888 (Thread-1): finished collecting timing info
2020-06-30 02:33:09.057434 (Thread-1): Finished running node model.sample_project.cust_list_ord_nat
2020-06-30 02:33:09.134726 (MainThread): Using snowflake connection "master".
2020-06-30 02:33:09.134912 (MainThread): On master: BEGIN
2020-06-30 02:33:09.365252 (MainThread): SQL status: SUCCESS 1 in 0.23 seconds
2020-06-30 02:33:09.365529 (MainThread): On master: COMMIT
2020-06-30 02:33:09.365765 (MainThread): Using snowflake connection "master".
2020-06-30 02:33:09.365928 (MainThread): On master: COMMIT
2020-06-30 02:33:09.650968 (MainThread): SQL status: SUCCESS 1 in 0.28 seconds
2020-06-30 02:33:09.651472 (MainThread): 21:33:09 | 
2020-06-30 02:33:09.651667 (MainThread): 21:33:09 | Finished running 2 table models in 20.62s.
2020-06-30 02:33:09.651829 (MainThread): Connection 'master' was left open.
2020-06-30 02:33:09.651956 (MainThread): On master: Close
2020-06-30 02:33:10.034015 (MainThread): Connection 'model.sample_project.cust_list_ord_nat' was left open.
2020-06-30 02:33:10.034223 (MainThread): On model.sample_project.cust_list_ord_nat: Close
2020-06-30 02:33:10.455072 (MainThread): 
2020-06-30 02:33:10.455271 (MainThread): Completed with 1 error and 0 warnings:
2020-06-30 02:33:10.455411 (MainThread): 
2020-06-30 02:33:10.455540 (MainThread): Compilation Error in model average_price_per_order (models/reports/average_price_per_order.sql)
2020-06-30 02:33:10.455658 (MainThread):   'dbt_utils' is undefined
2020-06-30 02:33:10.455776 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
2020-06-30 02:33:10.455958 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129f4b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129dc450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120f1790>]}
2020-06-30 02:33:10.456161 (MainThread): Flushing usage events
2020-06-30 02:34:13.000573 (MainThread): Running with dbt=0.17.0
2020-06-30 02:34:13.292080 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='deps', single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='deps', write_json=True)
2020-06-30 02:34:13.292357 (MainThread): Tracking: tracking
2020-06-30 02:34:13.292477 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108db93d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a75e910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a75ee10>]}
2020-06-30 02:34:13.292672 (MainThread): Warning: No packages were found in packages.yml
2020-06-30 02:34:13.292796 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dc18d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d92710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a766850>]}
2020-06-30 02:34:13.292927 (MainThread): Flushing usage events
2020-06-30 02:34:24.706768 (MainThread): Running with dbt=0.17.0
2020-06-30 02:34:25.025289 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='deps', single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='deps', write_json=True)
2020-06-30 02:34:25.025572 (MainThread): Tracking: tracking
2020-06-30 02:34:25.025695 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106026610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040959d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104095d90>]}
2020-06-30 02:34:25.027024 (MainThread): Set downloads directory='/var/folders/5x/fg3q44_x4y373r2024plj4fc0000gp/T/dbt-downloads-t8m5es46'
2020-06-30 02:34:25.027822 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/index.json
2020-06-30 02:34:26.068138 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/index.json 200
2020-06-30 02:34:26.068450 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils.json
2020-06-30 02:34:27.651203 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils.json 200
2020-06-30 02:34:27.665678 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils/0.4.0.json
2020-06-30 02:34:28.030690 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils/0.4.0.json 200
2020-06-30 02:34:28.036415 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils.json
2020-06-30 02:34:28.438288 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils.json 200
2020-06-30 02:34:28.452460 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils/0.4.0.json
2020-06-30 02:34:28.747445 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils/0.4.0.json 200
2020-06-30 02:34:28.748664 (MainThread): Installing fishtown-analytics/dbt_utils@0.4.0
2020-06-30 02:34:29.345385 (MainThread):   Installed from version 0.4.0

2020-06-30 02:34:29.345610 (MainThread): Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e7e2926c-ee03-462d-9e3f-1006197b0471', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10607e790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106019d50>]}
2020-06-30 02:34:29.346263 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10603ced0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10409ad50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106019d50>]}
2020-06-30 02:34:29.346440 (MainThread): Flushing usage events
2020-06-30 02:34:36.449696 (MainThread): Running with dbt=0.17.0
2020-06-30 02:34:36.798732 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-06-30 02:34:36.799587 (MainThread): Tracking: tracking
2020-06-30 02:34:36.799896 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110809890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110825a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110825950>]}
2020-06-30 02:34:36.821021 (MainThread): Partial parsing not enabled
2020-06-30 02:34:36.822840 (MainThread): Parsing macros/core.sql
2020-06-30 02:34:36.827838 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-30 02:34:36.839753 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-30 02:34:36.842351 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-30 02:34:36.863277 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-30 02:34:36.900511 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-30 02:34:36.924139 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-30 02:34:36.926701 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-30 02:34:36.933835 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-30 02:34:36.949015 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-30 02:34:36.956632 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-30 02:34:36.964216 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-30 02:34:36.969965 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-30 02:34:36.971018 (MainThread): Parsing macros/etc/query.sql
2020-06-30 02:34:36.972222 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-30 02:34:36.974243 (MainThread): Parsing macros/etc/datetime.sql
2020-06-30 02:34:36.991593 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-30 02:34:36.994832 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-30 02:34:36.997638 (MainThread): Parsing macros/adapters/common.sql
2020-06-30 02:34:37.059825 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-30 02:34:37.061041 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-30 02:34:37.062080 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-30 02:34:37.063511 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-30 02:34:37.065839 (MainThread): Parsing macros/catalog.sql
2020-06-30 02:34:37.067738 (MainThread): Parsing macros/adapters.sql
2020-06-30 02:34:37.092462 (MainThread): Parsing macros/materializations/merge.sql
2020-06-30 02:34:37.094647 (MainThread): Parsing macros/materializations/view.sql
2020-06-30 02:34:37.095942 (MainThread): Parsing macros/materializations/table.sql
2020-06-30 02:34:37.100167 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-30 02:34:37.139682 (MainThread): Partial parsing not enabled
2020-06-30 02:34:37.141442 (MainThread): Parsing macros/cross_db_utils/except.sql
2020-06-30 02:34:37.142565 (MainThread): Parsing macros/cross_db_utils/replace.sql
2020-06-30 02:34:37.143909 (MainThread): Parsing macros/cross_db_utils/concat.sql
2020-06-30 02:34:37.146280 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2020-06-30 02:34:37.152739 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2020-06-30 02:34:37.154161 (MainThread): Parsing macros/cross_db_utils/length.sql
2020-06-30 02:34:37.155555 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2020-06-30 02:34:37.158279 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2020-06-30 02:34:37.159397 (MainThread): Parsing macros/cross_db_utils/right.sql
2020-06-30 02:34:37.161877 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2020-06-30 02:34:37.173059 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2020-06-30 02:34:37.175087 (MainThread): Parsing macros/cross_db_utils/hash.sql
2020-06-30 02:34:37.176564 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2020-06-30 02:34:37.178319 (MainThread): Parsing macros/cross_db_utils/position.sql
2020-06-30 02:34:37.180163 (MainThread): Parsing macros/cross_db_utils/literal.sql
2020-06-30 02:34:37.181125 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2020-06-30 02:34:37.184406 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2020-06-30 02:34:37.190582 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2020-06-30 02:34:37.193597 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2020-06-30 02:34:37.195658 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2020-06-30 02:34:37.197397 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2020-06-30 02:34:37.222719 (MainThread): Parsing macros/logger/pretty_log_format.sql
2020-06-30 02:34:37.223496 (MainThread): Parsing macros/logger/pretty_time.sql
2020-06-30 02:34:37.224365 (MainThread): Parsing macros/logger/log_info.sql
2020-06-30 02:34:37.225106 (MainThread): Parsing macros/datetime/date_spine.sql
2020-06-30 02:34:37.228643 (MainThread): Parsing macros/web/get_url_host.sql
2020-06-30 02:34:37.230092 (MainThread): Parsing macros/web/get_url_path.sql
2020-06-30 02:34:37.232376 (MainThread): Parsing macros/web/get_url_parameter.sql
2020-06-30 02:34:37.233545 (MainThread): Parsing macros/geo/haversine_distance.sql
2020-06-30 02:34:37.234554 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2020-06-30 02:34:37.235905 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2020-06-30 02:34:37.238399 (MainThread): Parsing macros/schema_tests/recency.sql
2020-06-30 02:34:37.239814 (MainThread): Parsing macros/schema_tests/not_constant.sql
2020-06-30 02:34:37.241049 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2020-06-30 02:34:37.242089 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2020-06-30 02:34:37.243334 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2020-06-30 02:34:37.244881 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2020-06-30 02:34:37.246021 (MainThread): Parsing macros/schema_tests/equality.sql
2020-06-30 02:34:37.249226 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2020-06-30 02:34:37.254980 (MainThread): Parsing macros/sql/nullcheck_table.sql
2020-06-30 02:34:37.256140 (MainThread): Parsing macros/sql/generate_series.sql
2020-06-30 02:34:37.259758 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2020-06-30 02:34:37.264003 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2020-06-30 02:34:37.266747 (MainThread): Parsing macros/sql/star.sql
2020-06-30 02:34:37.269596 (MainThread): Parsing macros/sql/unpivot.sql
2020-06-30 02:34:37.276048 (MainThread): Parsing macros/sql/union.sql
2020-06-30 02:34:37.285775 (MainThread): Parsing macros/sql/groupby.sql
2020-06-30 02:34:37.286718 (MainThread): Parsing macros/sql/surrogate_key.sql
2020-06-30 02:34:37.289390 (MainThread): Parsing macros/sql/safe_add.sql
2020-06-30 02:34:37.290605 (MainThread): Parsing macros/sql/nullcheck.sql
2020-06-30 02:34:37.291857 (MainThread): Parsing macros/sql/get_column_values.sql
2020-06-30 02:34:37.296064 (MainThread): Parsing macros/sql/pivot.sql
2020-06-30 02:34:37.298738 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2020-06-30 02:34:37.344009 (MainThread): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 02:34:37.344310 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:34:37.384846 (MainThread): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 02:34:37.384966 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:34:37.398828 (MainThread): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 02:34:37.398935 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:34:37.410490 (MainThread): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 02:34:37.410590 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:34:37.422515 (MainThread): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 02:34:37.422607 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:34:37.435117 (MainThread): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 02:34:37.435208 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:34:37.447851 (MainThread): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 02:34:37.447944 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:34:37.460544 (MainThread): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 02:34:37.460636 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:34:37.472966 (MainThread): Acquiring new snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 02:34:37.473058 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:34:37.935530 (MainThread): Found 9 models, 8 tests, 0 snapshots, 0 analyses, 263 macros, 0 operations, 0 seed files, 4 sources
2020-06-30 02:34:37.936830 (MainThread): 
2020-06-30 02:34:37.937174 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 02:34:37.937258 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:34:37.940079 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_JAVEN_TESTING".
2020-06-30 02:34:37.940180 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-06-30 02:34:37.957304 (ThreadPoolExecutor-0_0): Using snowflake connection "list_JAVEN_TESTING".
2020-06-30 02:34:37.957499 (ThreadPoolExecutor-0_0): On list_JAVEN_TESTING: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING"} */

    show terse schemas in database JAVEN_TESTING
    limit 10000
2020-06-30 02:34:38.533604 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/certifi/cacert.pem'>
2020-06-30 02:34:46.151471 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 8.19 seconds
2020-06-30 02:34:46.186655 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 02:34:46.186863 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_JAVEN_TESTING).
2020-06-30 02:34:46.193786 (ThreadPoolExecutor-1_0): Using snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 02:34:46.193894 (ThreadPoolExecutor-1_0): On list_JAVEN_TESTING_TEST: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING_TEST"} */

    show terse objects in JAVEN_TESTING.TEST
2020-06-30 02:34:46.481200 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 0.29 seconds
2020-06-30 02:34:46.491790 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 02:34:46.491937 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:34:46.492149 (MainThread): Using snowflake connection "master".
2020-06-30 02:34:46.492259 (MainThread): On master: BEGIN
2020-06-30 02:34:52.839138 (MainThread): SQL status: SUCCESS 1 in 6.35 seconds
2020-06-30 02:34:52.839425 (MainThread): On master: COMMIT
2020-06-30 02:34:52.839665 (MainThread): Using snowflake connection "master".
2020-06-30 02:34:52.839831 (MainThread): On master: COMMIT
2020-06-30 02:34:53.591322 (MainThread): SQL status: SUCCESS 1 in 0.75 seconds
2020-06-30 02:34:53.591925 (MainThread): 21:34:53 | Concurrency: 1 threads (target='dev')
2020-06-30 02:34:53.592171 (MainThread): 21:34:53 | 
2020-06-30 02:34:53.593329 (Thread-1): Began running node model.sample_project.customer
2020-06-30 02:34:53.593769 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 02:34:53.593922 (Thread-1): Re-using an available connection from the pool (formerly list_JAVEN_TESTING_TEST).
2020-06-30 02:34:53.594071 (Thread-1): Compiling model.sample_project.customer
2020-06-30 02:34:53.616780 (Thread-1): Writing injected SQL for node "model.sample_project.customer"
2020-06-30 02:34:53.617213 (Thread-1): finished collecting timing info
2020-06-30 02:34:53.617697 (Thread-1): Finished running node model.sample_project.customer
2020-06-30 02:34:53.617855 (Thread-1): Began running node model.sample_project.lineitem
2020-06-30 02:34:53.618138 (Thread-1): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 02:34:53.618242 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer).
2020-06-30 02:34:53.618453 (Thread-1): Compiling model.sample_project.lineitem
2020-06-30 02:34:53.630846 (Thread-1): Writing injected SQL for node "model.sample_project.lineitem"
2020-06-30 02:34:53.631454 (Thread-1): finished collecting timing info
2020-06-30 02:34:53.632174 (Thread-1): Finished running node model.sample_project.lineitem
2020-06-30 02:34:53.632394 (Thread-1): Began running node model.sample_project.nation
2020-06-30 02:34:53.632778 (Thread-1): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 02:34:53.633024 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.lineitem).
2020-06-30 02:34:53.633171 (Thread-1): Compiling model.sample_project.nation
2020-06-30 02:34:53.646641 (Thread-1): Writing injected SQL for node "model.sample_project.nation"
2020-06-30 02:34:53.647179 (Thread-1): finished collecting timing info
2020-06-30 02:34:53.647745 (Thread-1): Finished running node model.sample_project.nation
2020-06-30 02:34:53.647925 (Thread-1): Began running node model.sample_project.orders
2020-06-30 02:34:53.648236 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 02:34:53.648357 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.nation).
2020-06-30 02:34:53.648474 (Thread-1): Compiling model.sample_project.orders
2020-06-30 02:34:53.658551 (Thread-1): Writing injected SQL for node "model.sample_project.orders"
2020-06-30 02:34:53.659076 (Thread-1): finished collecting timing info
2020-06-30 02:34:53.659583 (Thread-1): Finished running node model.sample_project.orders
2020-06-30 02:34:53.659754 (Thread-1): Began running node model.sample_project.customer_nation
2020-06-30 02:34:53.660063 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 02:34:53.660189 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders).
2020-06-30 02:34:53.660303 (Thread-1): Compiling model.sample_project.customer_nation
2020-06-30 02:34:53.673930 (Thread-1): Writing injected SQL for node "model.sample_project.customer_nation"
2020-06-30 02:34:53.674284 (Thread-1): finished collecting timing info
2020-06-30 02:34:53.674683 (Thread-1): Finished running node model.sample_project.customer_nation
2020-06-30 02:34:53.674895 (Thread-1): Began running node model.sample_project.orders_lineitem
2020-06-30 02:34:53.675185 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 02:34:53.675287 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer_nation).
2020-06-30 02:34:53.675382 (Thread-1): Compiling model.sample_project.orders_lineitem
2020-06-30 02:34:53.688160 (Thread-1): Writing injected SQL for node "model.sample_project.orders_lineitem"
2020-06-30 02:34:53.688494 (Thread-1): finished collecting timing info
2020-06-30 02:34:53.688895 (Thread-1): Finished running node model.sample_project.orders_lineitem
2020-06-30 02:34:53.689032 (Thread-1): Began running node model.sample_project.customers_per_nation
2020-06-30 02:34:53.690011 (Thread-1): 21:34:53 | 1 of 2 START table model TEST.customers_per_nation................... [RUN]
2020-06-30 02:34:53.690282 (Thread-1): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 02:34:53.690379 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders_lineitem).
2020-06-30 02:34:53.690472 (Thread-1): Compiling model.sample_project.customers_per_nation
2020-06-30 02:34:53.699398 (Thread-1): Writing injected SQL for node "model.sample_project.customers_per_nation"
2020-06-30 02:34:53.699774 (Thread-1): finished collecting timing info
2020-06-30 02:34:53.736578 (Thread-1): Writing runtime SQL for node "model.sample_project.customers_per_nation"
2020-06-30 02:34:53.738800 (Thread-1): Using snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 02:34:53.738904 (Thread-1): On model.sample_project.customers_per_nation: BEGIN
2020-06-30 02:34:54.006025 (Thread-1): SQL status: SUCCESS 1 in 0.27 seconds
2020-06-30 02:34:54.006287 (Thread-1): Using snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 02:34:54.006452 (Thread-1): On model.sample_project.customers_per_nation: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "model.sample_project.customers_per_nation"} */


      create or replace transient table JAVEN_TESTING.TEST.customers_per_nation  as
      (with __dbt__CTE__customer as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  c_custkey as custkey,
        c_nationkey as nationkey,
        c_name as name
from snowflake_sample_data.tpch_sf1.customer
),  __dbt__CTE__nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  n_nationkey as nationkey,
        n_name as name
from snowflake_sample_data.tpch_sf1.nation
),  __dbt__CTE__customer_nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  c.custkey,
        c.nationkey,
        c.name as customer_name,
        n.name as nation_name
from __dbt__CTE__customer as c
JOIN __dbt__CTE__nation as n
ON c.nationkey=n.nationkey
)/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  count(customer_name) as customer_count,
        nation_name
from __dbt__CTE__customer_nation
group by nation_name
order by nation_name
      );
2020-06-30 02:34:55.765261 (Thread-1): SQL status: SUCCESS 1 in 1.76 seconds
2020-06-30 02:34:55.766714 (Thread-1): On model.sample_project.customers_per_nation: COMMIT
2020-06-30 02:34:55.766919 (Thread-1): Using snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 02:34:55.767052 (Thread-1): On model.sample_project.customers_per_nation: COMMIT
2020-06-30 02:34:55.933974 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2020-06-30 02:34:55.945502 (Thread-1): finished collecting timing info
2020-06-30 02:34:55.946238 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1786429a-124a-4781-ace6-5aa8f154c418', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11309b190>]}
2020-06-30 02:34:55.947352 (Thread-1): 21:34:55 | 1 of 2 OK created table model TEST.customers_per_nation.............. [SUCCESS 1 in 2.26s]
2020-06-30 02:34:55.947492 (Thread-1): Finished running node model.sample_project.customers_per_nation
2020-06-30 02:34:55.947640 (Thread-1): Began running node model.sample_project.average_price_per_order
2020-06-30 02:34:55.948771 (Thread-1): 21:34:55 | 2 of 2 START table model TEST.average_price_per_order................ [RUN]
2020-06-30 02:34:55.949058 (Thread-1): Acquiring new snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 02:34:55.949153 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customers_per_nation).
2020-06-30 02:34:55.949248 (Thread-1): Compiling model.sample_project.average_price_per_order
2020-06-30 02:34:55.962208 (Thread-1): Writing injected SQL for node "model.sample_project.average_price_per_order"
2020-06-30 02:34:55.963457 (Thread-1): finished collecting timing info
2020-06-30 02:34:55.969342 (Thread-1): Writing runtime SQL for node "model.sample_project.average_price_per_order"
2020-06-30 02:34:55.972010 (Thread-1): Using snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 02:34:55.972136 (Thread-1): On model.sample_project.average_price_per_order: BEGIN
2020-06-30 02:34:56.301667 (Thread-1): SQL status: SUCCESS 1 in 0.33 seconds
2020-06-30 02:34:56.301931 (Thread-1): Using snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 02:34:56.302100 (Thread-1): On model.sample_project.average_price_per_order: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "model.sample_project.average_price_per_order"} */


      create or replace transient table JAVEN_TESTING.TEST.average_price_per_order  as
      (with __dbt__CTE__orders as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  o_orderkey as orderkey,
        o_custkey as custkey,
        o_totalprice as totalprice,
        o_orderdate as orderdate
from snowflake_sample_data.tpch_sf1.orders
),  __dbt__CTE__lineitem as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  l_orderkey as orderkey,
        l_extendedprice as extendedprice,
        l_discount as discount,
        l_tax as tax,
        l_quantity as quantity
from snowflake_sample_data.tpch_sf1.lineitem
),  __dbt__CTE__orders_lineitem as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  o.orderkey,
        o.custkey,
        o.totalprice,
        o.orderdate,
        l.extendedprice,
        l.discount,
        l.tax,
        l.quantity
from __dbt__CTE__orders as o
JOIN __dbt__CTE__lineitem as l
ON o.orderkey=l.orderkey
)/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  avg(totalprice) as average_order_price,
        
  
    width_bucket(, 0, 999999, 10 )

 as price_histogram,
        orderdate
from __dbt__CTE__orders_lineitem
group by orderdate
      );
2020-06-30 02:34:56.495350 (Thread-1): Snowflake query id: 01953e7a-0244-85a5-0000-2aed011cd276
2020-06-30 02:34:56.495588 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 96 at position 17 unexpected ','.
syntax error line 96 at position 16 unexpected '('.
2020-06-30 02:34:56.495772 (Thread-1): On model.sample_project.average_price_per_order: ROLLBACK
2020-06-30 02:34:56.495917 (Thread-1): initiating rollback
2020-06-30 02:34:56.995285 (Thread-1): finished collecting timing info
2020-06-30 02:34:56.996338 (Thread-1): Database Error in model average_price_per_order (models/reports/average_price_per_order.sql)
  001003 (42000): SQL compilation error:
  syntax error line 96 at position 17 unexpected ','.
  syntax error line 96 at position 16 unexpected '('.
  compiled SQL at target/run/sample_project/models/reports/average_price_per_order.sql
Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 158, in exception_handler
    yield
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/cursor.py", line 597, in execute
    errvalue)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/errors.py", line 97, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, errorclass, errorvalue)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/errors.py", line 73, in default_errorhandler
    done_format_msg=errorvalue.get(u'done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 96 at position 17 unexpected ','.
syntax error line 96 at position 16 unexpected '('.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 119, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 306, in add_query
    abridge_sql_log=abridge_sql_log
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/usr/local/opt/python/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 177, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model average_price_per_order (models/reports/average_price_per_order.sql)
  001003 (42000): SQL compilation error:
  syntax error line 96 at position 17 unexpected ','.
  syntax error line 96 at position 16 unexpected '('.
  compiled SQL at target/run/sample_project/models/reports/average_price_per_order.sql
2020-06-30 02:34:57.006713 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1786429a-124a-4781-ace6-5aa8f154c418', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11302f790>]}
2020-06-30 02:34:57.008540 (Thread-1): 21:34:57 | 2 of 2 ERROR creating table model TEST.average_price_per_order....... [ERROR in 1.06s]
2020-06-30 02:34:57.008742 (Thread-1): Finished running node model.sample_project.average_price_per_order
2020-06-30 02:34:57.008940 (Thread-1): Began running node model.sample_project.cust_list_ord_nat
2020-06-30 02:34:57.009320 (Thread-1): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 02:34:57.009435 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.average_price_per_order).
2020-06-30 02:34:57.009674 (Thread-1): Compiling model.sample_project.cust_list_ord_nat
2020-06-30 02:34:57.029355 (Thread-1): Writing injected SQL for node "model.sample_project.cust_list_ord_nat"
2020-06-30 02:34:57.030194 (Thread-1): finished collecting timing info
2020-06-30 02:34:57.030851 (Thread-1): Finished running node model.sample_project.cust_list_ord_nat
2020-06-30 02:34:57.076647 (MainThread): Using snowflake connection "master".
2020-06-30 02:34:57.076838 (MainThread): On master: BEGIN
2020-06-30 02:34:57.264521 (MainThread): SQL status: SUCCESS 1 in 0.19 seconds
2020-06-30 02:34:57.264745 (MainThread): On master: COMMIT
2020-06-30 02:34:57.264938 (MainThread): Using snowflake connection "master".
2020-06-30 02:34:57.265066 (MainThread): On master: COMMIT
2020-06-30 02:34:57.541320 (MainThread): SQL status: SUCCESS 1 in 0.28 seconds
2020-06-30 02:34:57.541849 (MainThread): 21:34:57 | 
2020-06-30 02:34:57.542084 (MainThread): 21:34:57 | Finished running 2 table models in 19.60s.
2020-06-30 02:34:57.542309 (MainThread): Connection 'master' was left open.
2020-06-30 02:34:57.542531 (MainThread): On master: Close
2020-06-30 02:34:57.849268 (MainThread): Connection 'model.sample_project.cust_list_ord_nat' was left open.
2020-06-30 02:34:57.849471 (MainThread): On model.sample_project.cust_list_ord_nat: Close
2020-06-30 02:34:58.171115 (MainThread): 
2020-06-30 02:34:58.171304 (MainThread): Completed with 1 error and 0 warnings:
2020-06-30 02:34:58.171443 (MainThread): 
2020-06-30 02:34:58.171575 (MainThread): Database Error in model average_price_per_order (models/reports/average_price_per_order.sql)
2020-06-30 02:34:58.171696 (MainThread):   001003 (42000): SQL compilation error:
2020-06-30 02:34:58.171807 (MainThread):   syntax error line 96 at position 17 unexpected ','.
2020-06-30 02:34:58.171915 (MainThread):   syntax error line 96 at position 16 unexpected '('.
2020-06-30 02:34:58.172021 (MainThread):   compiled SQL at target/run/sample_project/models/reports/average_price_per_order.sql
2020-06-30 02:34:58.172137 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
2020-06-30 02:34:58.172319 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110dc6550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113026b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f996d0>]}
2020-06-30 02:34:58.172529 (MainThread): Flushing usage events
2020-06-30 02:38:20.709010 (MainThread): Running with dbt=0.17.0
2020-06-30 02:38:21.213385 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-06-30 02:38:21.214763 (MainThread): Tracking: tracking
2020-06-30 02:38:21.215154 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107648850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076373d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107665790>]}
2020-06-30 02:38:21.241459 (MainThread): Partial parsing not enabled
2020-06-30 02:38:21.243852 (MainThread): Parsing macros/core.sql
2020-06-30 02:38:21.249875 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-30 02:38:21.259711 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-30 02:38:21.262212 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-30 02:38:21.282427 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-30 02:38:21.314133 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-30 02:38:21.337480 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-30 02:38:21.339708 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-30 02:38:21.347053 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-30 02:38:21.362722 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-30 02:38:21.370467 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-30 02:38:21.379451 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-30 02:38:21.385628 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-30 02:38:21.386867 (MainThread): Parsing macros/etc/query.sql
2020-06-30 02:38:21.388367 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-30 02:38:21.390287 (MainThread): Parsing macros/etc/datetime.sql
2020-06-30 02:38:21.399997 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-30 02:38:21.402209 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-30 02:38:21.404374 (MainThread): Parsing macros/adapters/common.sql
2020-06-30 02:38:21.457795 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-30 02:38:21.459727 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-30 02:38:21.461063 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-30 02:38:21.462428 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-30 02:38:21.465216 (MainThread): Parsing macros/catalog.sql
2020-06-30 02:38:21.467638 (MainThread): Parsing macros/adapters.sql
2020-06-30 02:38:21.493563 (MainThread): Parsing macros/materializations/merge.sql
2020-06-30 02:38:21.496056 (MainThread): Parsing macros/materializations/view.sql
2020-06-30 02:38:21.497661 (MainThread): Parsing macros/materializations/table.sql
2020-06-30 02:38:21.502029 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-30 02:38:21.541110 (MainThread): Partial parsing not enabled
2020-06-30 02:38:21.543391 (MainThread): Parsing macros/cross_db_utils/except.sql
2020-06-30 02:38:21.545129 (MainThread): Parsing macros/cross_db_utils/replace.sql
2020-06-30 02:38:21.546894 (MainThread): Parsing macros/cross_db_utils/concat.sql
2020-06-30 02:38:21.549687 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2020-06-30 02:38:21.556357 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2020-06-30 02:38:21.557955 (MainThread): Parsing macros/cross_db_utils/length.sql
2020-06-30 02:38:21.559564 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2020-06-30 02:38:21.562937 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2020-06-30 02:38:21.564402 (MainThread): Parsing macros/cross_db_utils/right.sql
2020-06-30 02:38:21.567237 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2020-06-30 02:38:21.581485 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2020-06-30 02:38:21.584066 (MainThread): Parsing macros/cross_db_utils/hash.sql
2020-06-30 02:38:21.586063 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2020-06-30 02:38:21.588021 (MainThread): Parsing macros/cross_db_utils/position.sql
2020-06-30 02:38:21.590153 (MainThread): Parsing macros/cross_db_utils/literal.sql
2020-06-30 02:38:21.591454 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2020-06-30 02:38:21.595405 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2020-06-30 02:38:21.601465 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2020-06-30 02:38:21.604723 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2020-06-30 02:38:21.606839 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2020-06-30 02:38:21.608867 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2020-06-30 02:38:21.634524 (MainThread): Parsing macros/logger/pretty_log_format.sql
2020-06-30 02:38:21.635591 (MainThread): Parsing macros/logger/pretty_time.sql
2020-06-30 02:38:21.636750 (MainThread): Parsing macros/logger/log_info.sql
2020-06-30 02:38:21.637824 (MainThread): Parsing macros/datetime/date_spine.sql
2020-06-30 02:38:21.642127 (MainThread): Parsing macros/web/get_url_host.sql
2020-06-30 02:38:21.644119 (MainThread): Parsing macros/web/get_url_path.sql
2020-06-30 02:38:21.646956 (MainThread): Parsing macros/web/get_url_parameter.sql
2020-06-30 02:38:21.648464 (MainThread): Parsing macros/geo/haversine_distance.sql
2020-06-30 02:38:21.649722 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2020-06-30 02:38:21.651512 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2020-06-30 02:38:21.653829 (MainThread): Parsing macros/schema_tests/recency.sql
2020-06-30 02:38:21.655875 (MainThread): Parsing macros/schema_tests/not_constant.sql
2020-06-30 02:38:21.657091 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2020-06-30 02:38:21.658298 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2020-06-30 02:38:21.659753 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2020-06-30 02:38:21.661563 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2020-06-30 02:38:21.662927 (MainThread): Parsing macros/schema_tests/equality.sql
2020-06-30 02:38:21.666296 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2020-06-30 02:38:21.672396 (MainThread): Parsing macros/sql/nullcheck_table.sql
2020-06-30 02:38:21.673647 (MainThread): Parsing macros/sql/generate_series.sql
2020-06-30 02:38:21.678373 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2020-06-30 02:38:21.682920 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2020-06-30 02:38:21.685753 (MainThread): Parsing macros/sql/star.sql
2020-06-30 02:38:21.688972 (MainThread): Parsing macros/sql/unpivot.sql
2020-06-30 02:38:21.695500 (MainThread): Parsing macros/sql/union.sql
2020-06-30 02:38:21.708781 (MainThread): Parsing macros/sql/groupby.sql
2020-06-30 02:38:21.710158 (MainThread): Parsing macros/sql/surrogate_key.sql
2020-06-30 02:38:21.713566 (MainThread): Parsing macros/sql/safe_add.sql
2020-06-30 02:38:21.714963 (MainThread): Parsing macros/sql/nullcheck.sql
2020-06-30 02:38:21.716693 (MainThread): Parsing macros/sql/get_column_values.sql
2020-06-30 02:38:21.721859 (MainThread): Parsing macros/sql/pivot.sql
2020-06-30 02:38:21.725073 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2020-06-30 02:38:21.775402 (MainThread): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 02:38:21.775549 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:38:21.806953 (MainThread): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 02:38:21.807087 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:38:21.820319 (MainThread): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 02:38:21.820428 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:38:21.833457 (MainThread): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 02:38:21.833561 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:38:21.845077 (MainThread): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 02:38:21.845168 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:38:21.858222 (MainThread): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 02:38:21.858323 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:38:21.870637 (MainThread): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 02:38:21.870729 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:38:21.884253 (MainThread): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 02:38:21.884389 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:38:21.896955 (MainThread): Acquiring new snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 02:38:21.897057 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:38:22.344762 (MainThread): Found 9 models, 8 tests, 0 snapshots, 0 analyses, 263 macros, 0 operations, 0 seed files, 4 sources
2020-06-30 02:38:22.346134 (MainThread): 
2020-06-30 02:38:22.346393 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 02:38:22.346477 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:38:22.349397 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_JAVEN_TESTING".
2020-06-30 02:38:22.349502 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-06-30 02:38:22.365992 (ThreadPoolExecutor-0_0): Using snowflake connection "list_JAVEN_TESTING".
2020-06-30 02:38:22.366161 (ThreadPoolExecutor-0_0): On list_JAVEN_TESTING: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING"} */

    show terse schemas in database JAVEN_TESTING
    limit 10000
2020-06-30 02:38:23.420104 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/certifi/cacert.pem'>
2020-06-30 02:38:31.246446 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 8.88 seconds
2020-06-30 02:38:31.280024 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 02:38:31.280163 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_JAVEN_TESTING).
2020-06-30 02:38:31.287256 (ThreadPoolExecutor-1_0): Using snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 02:38:31.287369 (ThreadPoolExecutor-1_0): On list_JAVEN_TESTING_TEST: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING_TEST"} */

    show terse objects in JAVEN_TESTING.TEST
2020-06-30 02:38:31.577192 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 0.29 seconds
2020-06-30 02:38:31.587969 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 02:38:31.588101 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:38:31.588304 (MainThread): Using snowflake connection "master".
2020-06-30 02:38:31.588416 (MainThread): On master: BEGIN
2020-06-30 02:38:37.739178 (MainThread): SQL status: SUCCESS 1 in 6.15 seconds
2020-06-30 02:38:37.739502 (MainThread): On master: COMMIT
2020-06-30 02:38:37.739742 (MainThread): Using snowflake connection "master".
2020-06-30 02:38:37.739879 (MainThread): On master: COMMIT
2020-06-30 02:38:38.023002 (MainThread): SQL status: SUCCESS 1 in 0.28 seconds
2020-06-30 02:38:38.023582 (MainThread): 21:38:38 | Concurrency: 1 threads (target='dev')
2020-06-30 02:38:38.023829 (MainThread): 21:38:38 | 
2020-06-30 02:38:38.025002 (Thread-1): Began running node model.sample_project.customer
2020-06-30 02:38:38.025439 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 02:38:38.025597 (Thread-1): Re-using an available connection from the pool (formerly list_JAVEN_TESTING_TEST).
2020-06-30 02:38:38.025750 (Thread-1): Compiling model.sample_project.customer
2020-06-30 02:38:38.053447 (Thread-1): Writing injected SQL for node "model.sample_project.customer"
2020-06-30 02:38:38.054274 (Thread-1): finished collecting timing info
2020-06-30 02:38:38.055001 (Thread-1): Finished running node model.sample_project.customer
2020-06-30 02:38:38.055202 (Thread-1): Began running node model.sample_project.lineitem
2020-06-30 02:38:38.055537 (Thread-1): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 02:38:38.055662 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer).
2020-06-30 02:38:38.055789 (Thread-1): Compiling model.sample_project.lineitem
2020-06-30 02:38:38.067119 (Thread-1): Writing injected SQL for node "model.sample_project.lineitem"
2020-06-30 02:38:38.067650 (Thread-1): finished collecting timing info
2020-06-30 02:38:38.068214 (Thread-1): Finished running node model.sample_project.lineitem
2020-06-30 02:38:38.068425 (Thread-1): Began running node model.sample_project.nation
2020-06-30 02:38:38.068835 (Thread-1): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 02:38:38.069095 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.lineitem).
2020-06-30 02:38:38.069251 (Thread-1): Compiling model.sample_project.nation
2020-06-30 02:38:38.081165 (Thread-1): Writing injected SQL for node "model.sample_project.nation"
2020-06-30 02:38:38.081630 (Thread-1): finished collecting timing info
2020-06-30 02:38:38.082138 (Thread-1): Finished running node model.sample_project.nation
2020-06-30 02:38:38.082317 (Thread-1): Began running node model.sample_project.orders
2020-06-30 02:38:38.082622 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 02:38:38.082746 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.nation).
2020-06-30 02:38:38.082864 (Thread-1): Compiling model.sample_project.orders
2020-06-30 02:38:38.092433 (Thread-1): Writing injected SQL for node "model.sample_project.orders"
2020-06-30 02:38:38.092957 (Thread-1): finished collecting timing info
2020-06-30 02:38:38.093482 (Thread-1): Finished running node model.sample_project.orders
2020-06-30 02:38:38.093647 (Thread-1): Began running node model.sample_project.customer_nation
2020-06-30 02:38:38.093938 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 02:38:38.094056 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders).
2020-06-30 02:38:38.094166 (Thread-1): Compiling model.sample_project.customer_nation
2020-06-30 02:38:38.106665 (Thread-1): Writing injected SQL for node "model.sample_project.customer_nation"
2020-06-30 02:38:38.107058 (Thread-1): finished collecting timing info
2020-06-30 02:38:38.107448 (Thread-1): Finished running node model.sample_project.customer_nation
2020-06-30 02:38:38.107588 (Thread-1): Began running node model.sample_project.orders_lineitem
2020-06-30 02:38:38.107833 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 02:38:38.107932 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer_nation).
2020-06-30 02:38:38.108026 (Thread-1): Compiling model.sample_project.orders_lineitem
2020-06-30 02:38:38.120464 (Thread-1): Writing injected SQL for node "model.sample_project.orders_lineitem"
2020-06-30 02:38:38.120840 (Thread-1): finished collecting timing info
2020-06-30 02:38:38.121224 (Thread-1): Finished running node model.sample_project.orders_lineitem
2020-06-30 02:38:38.121361 (Thread-1): Began running node model.sample_project.customers_per_nation
2020-06-30 02:38:38.122471 (Thread-1): 21:38:38 | 1 of 2 START table model TEST.customers_per_nation................... [RUN]
2020-06-30 02:38:38.122781 (Thread-1): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 02:38:38.122887 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders_lineitem).
2020-06-30 02:38:38.122990 (Thread-1): Compiling model.sample_project.customers_per_nation
2020-06-30 02:38:38.132110 (Thread-1): Writing injected SQL for node "model.sample_project.customers_per_nation"
2020-06-30 02:38:38.132404 (Thread-1): finished collecting timing info
2020-06-30 02:38:38.165997 (Thread-1): Writing runtime SQL for node "model.sample_project.customers_per_nation"
2020-06-30 02:38:38.168123 (Thread-1): Using snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 02:38:38.168229 (Thread-1): On model.sample_project.customers_per_nation: BEGIN
2020-06-30 02:38:38.423968 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2020-06-30 02:38:38.424228 (Thread-1): Using snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 02:38:38.424392 (Thread-1): On model.sample_project.customers_per_nation: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "model.sample_project.customers_per_nation"} */


      create or replace transient table JAVEN_TESTING.TEST.customers_per_nation  as
      (with __dbt__CTE__customer as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  c_custkey as custkey,
        c_nationkey as nationkey,
        c_name as name
from snowflake_sample_data.tpch_sf1.customer
),  __dbt__CTE__nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  n_nationkey as nationkey,
        n_name as name
from snowflake_sample_data.tpch_sf1.nation
),  __dbt__CTE__customer_nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  c.custkey,
        c.nationkey,
        c.name as customer_name,
        n.name as nation_name
from __dbt__CTE__customer as c
JOIN __dbt__CTE__nation as n
ON c.nationkey=n.nationkey
)/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  count(customer_name) as customer_count,
        nation_name
from __dbt__CTE__customer_nation
group by nation_name
order by nation_name
      );
2020-06-30 02:38:40.638797 (Thread-1): SQL status: SUCCESS 1 in 2.21 seconds
2020-06-30 02:38:40.640283 (Thread-1): On model.sample_project.customers_per_nation: COMMIT
2020-06-30 02:38:40.640490 (Thread-1): Using snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 02:38:40.640628 (Thread-1): On model.sample_project.customers_per_nation: COMMIT
2020-06-30 02:38:40.836192 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2020-06-30 02:38:40.848284 (Thread-1): finished collecting timing info
2020-06-30 02:38:40.849043 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5da936b0-b4e1-4cdb-b0cd-68de17b92de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e10a10>]}
2020-06-30 02:38:40.850380 (Thread-1): 21:38:40 | 1 of 2 OK created table model TEST.customers_per_nation.............. [SUCCESS 1 in 2.73s]
2020-06-30 02:38:40.850557 (Thread-1): Finished running node model.sample_project.customers_per_nation
2020-06-30 02:38:40.850732 (Thread-1): Began running node model.sample_project.average_price_per_order
2020-06-30 02:38:40.851938 (Thread-1): 21:38:40 | 2 of 2 START table model TEST.average_price_per_order................ [RUN]
2020-06-30 02:38:40.852381 (Thread-1): Acquiring new snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 02:38:40.852506 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customers_per_nation).
2020-06-30 02:38:40.852620 (Thread-1): Compiling model.sample_project.average_price_per_order
2020-06-30 02:38:40.866598 (Thread-1): Writing injected SQL for node "model.sample_project.average_price_per_order"
2020-06-30 02:38:40.867016 (Thread-1): finished collecting timing info
2020-06-30 02:38:40.871935 (Thread-1): Writing runtime SQL for node "model.sample_project.average_price_per_order"
2020-06-30 02:38:40.874841 (Thread-1): Using snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 02:38:40.875609 (Thread-1): On model.sample_project.average_price_per_order: BEGIN
2020-06-30 02:38:41.115393 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2020-06-30 02:38:41.115651 (Thread-1): Using snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 02:38:41.115818 (Thread-1): On model.sample_project.average_price_per_order: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "model.sample_project.average_price_per_order"} */


      create or replace transient table JAVEN_TESTING.TEST.average_price_per_order  as
      (with __dbt__CTE__orders as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  o_orderkey as orderkey,
        o_custkey as custkey,
        o_totalprice as totalprice,
        o_orderdate as orderdate
from snowflake_sample_data.tpch_sf1.orders
),  __dbt__CTE__lineitem as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  l_orderkey as orderkey,
        l_extendedprice as extendedprice,
        l_discount as discount,
        l_tax as tax,
        l_quantity as quantity
from snowflake_sample_data.tpch_sf1.lineitem
),  __dbt__CTE__orders_lineitem as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  o.orderkey,
        o.custkey,
        o.totalprice,
        o.orderdate,
        l.extendedprice,
        l.discount,
        l.tax,
        l.quantity
from __dbt__CTE__orders as o
JOIN __dbt__CTE__lineitem as l
ON o.orderkey=l.orderkey
)/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  avg(totalprice) as average_order_price,
        
  
    width_bucket(, 0, 999999, 10 )

 as price_histogram,
        orderdate
from __dbt__CTE__orders_lineitem
group by orderdate
      );
2020-06-30 02:38:41.369605 (Thread-1): Snowflake query id: 01953e7e-02c2-380e-0000-2aed011ce2c6
2020-06-30 02:38:41.369851 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 96 at position 17 unexpected ','.
syntax error line 96 at position 16 unexpected '('.
2020-06-30 02:38:41.370052 (Thread-1): On model.sample_project.average_price_per_order: ROLLBACK
2020-06-30 02:38:41.370205 (Thread-1): initiating rollback
2020-06-30 02:38:41.868842 (Thread-1): finished collecting timing info
2020-06-30 02:38:41.869590 (Thread-1): Database Error in model average_price_per_order (models/reports/average_price_per_order.sql)
  001003 (42000): SQL compilation error:
  syntax error line 96 at position 17 unexpected ','.
  syntax error line 96 at position 16 unexpected '('.
  compiled SQL at target/run/sample_project/models/reports/average_price_per_order.sql
Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 158, in exception_handler
    yield
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/cursor.py", line 597, in execute
    errvalue)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/errors.py", line 97, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, errorclass, errorvalue)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/errors.py", line 73, in default_errorhandler
    done_format_msg=errorvalue.get(u'done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 96 at position 17 unexpected ','.
syntax error line 96 at position 16 unexpected '('.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 119, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 306, in add_query
    abridge_sql_log=abridge_sql_log
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/usr/local/opt/python/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 177, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model average_price_per_order (models/reports/average_price_per_order.sql)
  001003 (42000): SQL compilation error:
  syntax error line 96 at position 17 unexpected ','.
  syntax error line 96 at position 16 unexpected '('.
  compiled SQL at target/run/sample_project/models/reports/average_price_per_order.sql
2020-06-30 02:38:41.881965 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5da936b0-b4e1-4cdb-b0cd-68de17b92de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e4d610>]}
2020-06-30 02:38:41.883534 (Thread-1): 21:38:41 | 2 of 2 ERROR creating table model TEST.average_price_per_order....... [ERROR in 1.03s]
2020-06-30 02:38:41.883731 (Thread-1): Finished running node model.sample_project.average_price_per_order
2020-06-30 02:38:41.883907 (Thread-1): Began running node model.sample_project.cust_list_ord_nat
2020-06-30 02:38:41.884264 (Thread-1): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 02:38:41.884391 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.average_price_per_order).
2020-06-30 02:38:41.884512 (Thread-1): Compiling model.sample_project.cust_list_ord_nat
2020-06-30 02:38:41.904651 (Thread-1): Writing injected SQL for node "model.sample_project.cust_list_ord_nat"
2020-06-30 02:38:41.905254 (Thread-1): finished collecting timing info
2020-06-30 02:38:41.906230 (Thread-1): Finished running node model.sample_project.cust_list_ord_nat
2020-06-30 02:38:41.924257 (MainThread): Using snowflake connection "master".
2020-06-30 02:38:41.924611 (MainThread): On master: BEGIN
2020-06-30 02:38:42.227468 (MainThread): SQL status: SUCCESS 1 in 0.30 seconds
2020-06-30 02:38:42.227755 (MainThread): On master: COMMIT
2020-06-30 02:38:42.227999 (MainThread): Using snowflake connection "master".
2020-06-30 02:38:42.228246 (MainThread): On master: COMMIT
2020-06-30 02:38:42.672392 (MainThread): SQL status: SUCCESS 1 in 0.44 seconds
2020-06-30 02:38:42.672999 (MainThread): 21:38:42 | 
2020-06-30 02:38:42.673249 (MainThread): 21:38:42 | Finished running 2 table models in 20.33s.
2020-06-30 02:38:42.673455 (MainThread): Connection 'master' was left open.
2020-06-30 02:38:42.673616 (MainThread): On master: Close
2020-06-30 02:38:43.343556 (MainThread): Connection 'model.sample_project.cust_list_ord_nat' was left open.
2020-06-30 02:38:43.343759 (MainThread): On model.sample_project.cust_list_ord_nat: Close
2020-06-30 02:38:43.720314 (MainThread): 
2020-06-30 02:38:43.720946 (MainThread): Completed with 1 error and 0 warnings:
2020-06-30 02:38:43.721300 (MainThread): 
2020-06-30 02:38:43.721563 (MainThread): Database Error in model average_price_per_order (models/reports/average_price_per_order.sql)
2020-06-30 02:38:43.721740 (MainThread):   001003 (42000): SQL compilation error:
2020-06-30 02:38:43.721885 (MainThread):   syntax error line 96 at position 17 unexpected ','.
2020-06-30 02:38:43.722015 (MainThread):   syntax error line 96 at position 16 unexpected '('.
2020-06-30 02:38:43.722146 (MainThread):   compiled SQL at target/run/sample_project/models/reports/average_price_per_order.sql
2020-06-30 02:38:43.722295 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
2020-06-30 02:38:43.722627 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e8a790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e35250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ac49d0>]}
2020-06-30 02:38:43.722960 (MainThread): Flushing usage events
2020-06-30 02:39:22.903459 (MainThread): Running with dbt=0.17.0
2020-06-30 02:39:23.405397 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-06-30 02:39:23.406174 (MainThread): Tracking: tracking
2020-06-30 02:39:23.406463 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eac4bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eac4b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110472810>]}
2020-06-30 02:39:23.433422 (MainThread): Partial parsing not enabled
2020-06-30 02:39:23.436887 (MainThread): Parsing macros/core.sql
2020-06-30 02:39:23.444133 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-30 02:39:23.453734 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-30 02:39:23.456046 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-30 02:39:23.475179 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-30 02:39:23.508246 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-30 02:39:23.531396 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-30 02:39:23.533616 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-30 02:39:23.540875 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-30 02:39:23.556539 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-30 02:39:23.564669 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-30 02:39:23.572033 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-30 02:39:23.578581 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-30 02:39:23.579961 (MainThread): Parsing macros/etc/query.sql
2020-06-30 02:39:23.581298 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-30 02:39:23.583273 (MainThread): Parsing macros/etc/datetime.sql
2020-06-30 02:39:23.593113 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-30 02:39:23.595364 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-30 02:39:23.597957 (MainThread): Parsing macros/adapters/common.sql
2020-06-30 02:39:23.651636 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-30 02:39:23.653416 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-30 02:39:23.654767 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-30 02:39:23.656257 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-30 02:39:23.658966 (MainThread): Parsing macros/catalog.sql
2020-06-30 02:39:23.661315 (MainThread): Parsing macros/adapters.sql
2020-06-30 02:39:23.685583 (MainThread): Parsing macros/materializations/merge.sql
2020-06-30 02:39:23.688260 (MainThread): Parsing macros/materializations/view.sql
2020-06-30 02:39:23.689745 (MainThread): Parsing macros/materializations/table.sql
2020-06-30 02:39:23.694259 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-30 02:39:23.733763 (MainThread): Partial parsing not enabled
2020-06-30 02:39:23.736114 (MainThread): Parsing macros/cross_db_utils/except.sql
2020-06-30 02:39:23.737889 (MainThread): Parsing macros/cross_db_utils/replace.sql
2020-06-30 02:39:23.739616 (MainThread): Parsing macros/cross_db_utils/concat.sql
2020-06-30 02:39:23.742097 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2020-06-30 02:39:23.748181 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2020-06-30 02:39:23.749936 (MainThread): Parsing macros/cross_db_utils/length.sql
2020-06-30 02:39:23.751522 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2020-06-30 02:39:23.754667 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2020-06-30 02:39:23.755956 (MainThread): Parsing macros/cross_db_utils/right.sql
2020-06-30 02:39:23.758566 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2020-06-30 02:39:23.769000 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2020-06-30 02:39:23.771135 (MainThread): Parsing macros/cross_db_utils/hash.sql
2020-06-30 02:39:23.772888 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2020-06-30 02:39:23.774792 (MainThread): Parsing macros/cross_db_utils/position.sql
2020-06-30 02:39:23.776630 (MainThread): Parsing macros/cross_db_utils/literal.sql
2020-06-30 02:39:23.778079 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2020-06-30 02:39:23.781820 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2020-06-30 02:39:23.792573 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2020-06-30 02:39:23.796433 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2020-06-30 02:39:23.798563 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2020-06-30 02:39:23.800594 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2020-06-30 02:39:23.826238 (MainThread): Parsing macros/logger/pretty_log_format.sql
2020-06-30 02:39:23.828242 (MainThread): Parsing macros/logger/pretty_time.sql
2020-06-30 02:39:23.829619 (MainThread): Parsing macros/logger/log_info.sql
2020-06-30 02:39:23.831096 (MainThread): Parsing macros/datetime/date_spine.sql
2020-06-30 02:39:23.836726 (MainThread): Parsing macros/web/get_url_host.sql
2020-06-30 02:39:23.838799 (MainThread): Parsing macros/web/get_url_path.sql
2020-06-30 02:39:23.841720 (MainThread): Parsing macros/web/get_url_parameter.sql
2020-06-30 02:39:23.843295 (MainThread): Parsing macros/geo/haversine_distance.sql
2020-06-30 02:39:23.844641 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2020-06-30 02:39:23.846404 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2020-06-30 02:39:23.849092 (MainThread): Parsing macros/schema_tests/recency.sql
2020-06-30 02:39:23.850763 (MainThread): Parsing macros/schema_tests/not_constant.sql
2020-06-30 02:39:23.852170 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2020-06-30 02:39:23.853527 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2020-06-30 02:39:23.855171 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2020-06-30 02:39:23.857162 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2020-06-30 02:39:23.858610 (MainThread): Parsing macros/schema_tests/equality.sql
2020-06-30 02:39:23.862257 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2020-06-30 02:39:23.869523 (MainThread): Parsing macros/sql/nullcheck_table.sql
2020-06-30 02:39:23.871112 (MainThread): Parsing macros/sql/generate_series.sql
2020-06-30 02:39:23.876104 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2020-06-30 02:39:23.880919 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2020-06-30 02:39:23.884299 (MainThread): Parsing macros/sql/star.sql
2020-06-30 02:39:23.887814 (MainThread): Parsing macros/sql/unpivot.sql
2020-06-30 02:39:23.895249 (MainThread): Parsing macros/sql/union.sql
2020-06-30 02:39:23.908490 (MainThread): Parsing macros/sql/groupby.sql
2020-06-30 02:39:23.910528 (MainThread): Parsing macros/sql/surrogate_key.sql
2020-06-30 02:39:23.915238 (MainThread): Parsing macros/sql/safe_add.sql
2020-06-30 02:39:23.916955 (MainThread): Parsing macros/sql/nullcheck.sql
2020-06-30 02:39:23.918984 (MainThread): Parsing macros/sql/get_column_values.sql
2020-06-30 02:39:23.924441 (MainThread): Parsing macros/sql/pivot.sql
2020-06-30 02:39:23.927863 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2020-06-30 02:39:23.978745 (MainThread): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 02:39:23.978870 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:39:24.008451 (MainThread): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 02:39:24.008569 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:39:24.020213 (MainThread): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 02:39:24.020303 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:39:24.031908 (MainThread): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 02:39:24.032001 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:39:24.043246 (MainThread): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 02:39:24.043340 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:39:24.056198 (MainThread): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 02:39:24.056289 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:39:24.068483 (MainThread): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 02:39:24.068579 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:39:24.081218 (MainThread): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 02:39:24.081308 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:39:24.092743 (MainThread): Acquiring new snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 02:39:24.092842 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:39:24.533887 (MainThread): Found 9 models, 8 tests, 0 snapshots, 0 analyses, 263 macros, 0 operations, 0 seed files, 4 sources
2020-06-30 02:39:24.535506 (MainThread): 
2020-06-30 02:39:24.535983 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 02:39:24.536084 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:39:24.538662 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_JAVEN_TESTING".
2020-06-30 02:39:24.538760 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-06-30 02:39:24.560660 (ThreadPoolExecutor-0_0): Using snowflake connection "list_JAVEN_TESTING".
2020-06-30 02:39:24.560967 (ThreadPoolExecutor-0_0): On list_JAVEN_TESTING: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING"} */

    show terse schemas in database JAVEN_TESTING
    limit 10000
2020-06-30 02:39:25.136824 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/certifi/cacert.pem'>
2020-06-30 02:39:31.097815 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 6.54 seconds
2020-06-30 02:39:31.130151 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 02:39:31.130340 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_JAVEN_TESTING).
2020-06-30 02:39:31.137302 (ThreadPoolExecutor-1_0): Using snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 02:39:31.137410 (ThreadPoolExecutor-1_0): On list_JAVEN_TESTING_TEST: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING_TEST"} */

    show terse objects in JAVEN_TESTING.TEST
2020-06-30 02:39:31.633920 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 0.50 seconds
2020-06-30 02:39:31.645084 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 02:39:31.645222 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:39:31.645424 (MainThread): Using snowflake connection "master".
2020-06-30 02:39:31.645540 (MainThread): On master: BEGIN
2020-06-30 02:39:36.249322 (MainThread): SQL status: SUCCESS 1 in 4.60 seconds
2020-06-30 02:39:36.249611 (MainThread): On master: COMMIT
2020-06-30 02:39:36.249799 (MainThread): Using snowflake connection "master".
2020-06-30 02:39:36.249929 (MainThread): On master: COMMIT
2020-06-30 02:39:36.563091 (MainThread): SQL status: SUCCESS 1 in 0.31 seconds
2020-06-30 02:39:36.563672 (MainThread): 21:39:36 | Concurrency: 1 threads (target='dev')
2020-06-30 02:39:36.563866 (MainThread): 21:39:36 | 
2020-06-30 02:39:36.564822 (Thread-1): Began running node model.sample_project.customer
2020-06-30 02:39:36.565240 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 02:39:36.565387 (Thread-1): Re-using an available connection from the pool (formerly list_JAVEN_TESTING_TEST).
2020-06-30 02:39:36.565531 (Thread-1): Compiling model.sample_project.customer
2020-06-30 02:39:36.592882 (Thread-1): Writing injected SQL for node "model.sample_project.customer"
2020-06-30 02:39:36.593386 (Thread-1): finished collecting timing info
2020-06-30 02:39:36.594203 (Thread-1): Finished running node model.sample_project.customer
2020-06-30 02:39:36.594426 (Thread-1): Began running node model.sample_project.lineitem
2020-06-30 02:39:36.595084 (Thread-1): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 02:39:36.595308 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer).
2020-06-30 02:39:36.595445 (Thread-1): Compiling model.sample_project.lineitem
2020-06-30 02:39:36.606974 (Thread-1): Writing injected SQL for node "model.sample_project.lineitem"
2020-06-30 02:39:36.607444 (Thread-1): finished collecting timing info
2020-06-30 02:39:36.607938 (Thread-1): Finished running node model.sample_project.lineitem
2020-06-30 02:39:36.608106 (Thread-1): Began running node model.sample_project.nation
2020-06-30 02:39:36.608407 (Thread-1): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 02:39:36.608525 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.lineitem).
2020-06-30 02:39:36.608638 (Thread-1): Compiling model.sample_project.nation
2020-06-30 02:39:36.618096 (Thread-1): Writing injected SQL for node "model.sample_project.nation"
2020-06-30 02:39:36.618451 (Thread-1): finished collecting timing info
2020-06-30 02:39:36.618880 (Thread-1): Finished running node model.sample_project.nation
2020-06-30 02:39:36.619037 (Thread-1): Began running node model.sample_project.orders
2020-06-30 02:39:36.619308 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 02:39:36.619418 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.nation).
2020-06-30 02:39:36.619521 (Thread-1): Compiling model.sample_project.orders
2020-06-30 02:39:36.627721 (Thread-1): Writing injected SQL for node "model.sample_project.orders"
2020-06-30 02:39:36.628113 (Thread-1): finished collecting timing info
2020-06-30 02:39:36.628499 (Thread-1): Finished running node model.sample_project.orders
2020-06-30 02:39:36.628633 (Thread-1): Began running node model.sample_project.customer_nation
2020-06-30 02:39:36.628874 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 02:39:36.628970 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders).
2020-06-30 02:39:36.629060 (Thread-1): Compiling model.sample_project.customer_nation
2020-06-30 02:39:36.640624 (Thread-1): Writing injected SQL for node "model.sample_project.customer_nation"
2020-06-30 02:39:36.640951 (Thread-1): finished collecting timing info
2020-06-30 02:39:36.641336 (Thread-1): Finished running node model.sample_project.customer_nation
2020-06-30 02:39:36.641473 (Thread-1): Began running node model.sample_project.orders_lineitem
2020-06-30 02:39:36.641719 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 02:39:36.641818 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer_nation).
2020-06-30 02:39:36.641910 (Thread-1): Compiling model.sample_project.orders_lineitem
2020-06-30 02:39:36.653719 (Thread-1): Writing injected SQL for node "model.sample_project.orders_lineitem"
2020-06-30 02:39:36.653988 (Thread-1): finished collecting timing info
2020-06-30 02:39:36.654308 (Thread-1): Finished running node model.sample_project.orders_lineitem
2020-06-30 02:39:36.654420 (Thread-1): Began running node model.sample_project.customers_per_nation
2020-06-30 02:39:36.655276 (Thread-1): 21:39:36 | 1 of 2 START table model TEST.customers_per_nation................... [RUN]
2020-06-30 02:39:36.655617 (Thread-1): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 02:39:36.655706 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders_lineitem).
2020-06-30 02:39:36.655786 (Thread-1): Compiling model.sample_project.customers_per_nation
2020-06-30 02:39:36.664417 (Thread-1): Writing injected SQL for node "model.sample_project.customers_per_nation"
2020-06-30 02:39:36.665200 (Thread-1): finished collecting timing info
2020-06-30 02:39:36.703879 (Thread-1): Writing runtime SQL for node "model.sample_project.customers_per_nation"
2020-06-30 02:39:36.706179 (Thread-1): Using snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 02:39:36.706289 (Thread-1): On model.sample_project.customers_per_nation: BEGIN
2020-06-30 02:39:36.923352 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2020-06-30 02:39:36.923525 (Thread-1): Using snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 02:39:36.923633 (Thread-1): On model.sample_project.customers_per_nation: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "model.sample_project.customers_per_nation"} */


      create or replace transient table JAVEN_TESTING.TEST.customers_per_nation  as
      (with __dbt__CTE__customer as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  c_custkey as custkey,
        c_nationkey as nationkey,
        c_name as name
from snowflake_sample_data.tpch_sf1.customer
),  __dbt__CTE__nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  n_nationkey as nationkey,
        n_name as name
from snowflake_sample_data.tpch_sf1.nation
),  __dbt__CTE__customer_nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  c.custkey,
        c.nationkey,
        c.name as customer_name,
        n.name as nation_name
from __dbt__CTE__customer as c
JOIN __dbt__CTE__nation as n
ON c.nationkey=n.nationkey
)/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  count(customer_name) as customer_count,
        nation_name
from __dbt__CTE__customer_nation
group by nation_name
order by nation_name
      );
2020-06-30 02:39:38.427164 (Thread-1): SQL status: SUCCESS 1 in 1.50 seconds
2020-06-30 02:39:38.428873 (Thread-1): On model.sample_project.customers_per_nation: COMMIT
2020-06-30 02:39:38.429077 (Thread-1): Using snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 02:39:38.429205 (Thread-1): On model.sample_project.customers_per_nation: COMMIT
2020-06-30 02:39:38.647182 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2020-06-30 02:39:38.659389 (Thread-1): finished collecting timing info
2020-06-30 02:39:38.660124 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b9f05fc-dd4a-49c1-be4a-539cd1866396', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132c6590>]}
2020-06-30 02:39:38.661411 (Thread-1): 21:39:38 | 1 of 2 OK created table model TEST.customers_per_nation.............. [SUCCESS 1 in 2.00s]
2020-06-30 02:39:38.661570 (Thread-1): Finished running node model.sample_project.customers_per_nation
2020-06-30 02:39:38.661729 (Thread-1): Began running node model.sample_project.average_price_per_order
2020-06-30 02:39:38.662890 (Thread-1): 21:39:38 | 2 of 2 START table model TEST.average_price_per_order................ [RUN]
2020-06-30 02:39:38.663196 (Thread-1): Acquiring new snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 02:39:38.663307 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customers_per_nation).
2020-06-30 02:39:38.663417 (Thread-1): Compiling model.sample_project.average_price_per_order
2020-06-30 02:39:38.677446 (Thread-1): Writing injected SQL for node "model.sample_project.average_price_per_order"
2020-06-30 02:39:38.678995 (Thread-1): finished collecting timing info
2020-06-30 02:39:38.686186 (Thread-1): Writing runtime SQL for node "model.sample_project.average_price_per_order"
2020-06-30 02:39:38.689351 (Thread-1): Using snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 02:39:38.689675 (Thread-1): On model.sample_project.average_price_per_order: BEGIN
2020-06-30 02:39:38.951511 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2020-06-30 02:39:38.951763 (Thread-1): Using snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 02:39:38.951922 (Thread-1): On model.sample_project.average_price_per_order: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "model.sample_project.average_price_per_order"} */


      create or replace transient table JAVEN_TESTING.TEST.average_price_per_order  as
      (with __dbt__CTE__orders as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  o_orderkey as orderkey,
        o_custkey as custkey,
        o_totalprice as totalprice,
        o_orderdate as orderdate
from snowflake_sample_data.tpch_sf1.orders
),  __dbt__CTE__lineitem as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  l_orderkey as orderkey,
        l_extendedprice as extendedprice,
        l_discount as discount,
        l_tax as tax,
        l_quantity as quantity
from snowflake_sample_data.tpch_sf1.lineitem
),  __dbt__CTE__orders_lineitem as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  o.orderkey,
        o.custkey,
        o.totalprice,
        o.orderdate,
        l.extendedprice,
        l.discount,
        l.tax,
        l.quantity
from __dbt__CTE__orders as o
JOIN __dbt__CTE__lineitem as l
ON o.orderkey=l.orderkey
)/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  avg(totalprice) as average_order_price,
        
  
    width_bucket(totalprice, 0, 999999, 10 )

 as price_histogram,
        orderdate
from __dbt__CTE__orders_lineitem
group by orderdate
      );
2020-06-30 02:39:39.349977 (Thread-1): Snowflake query id: 01953e7f-0264-0d62-0000-2aed011cd2da
2020-06-30 02:39:39.350205 (Thread-1): Snowflake error: 001104 (42601): SQL compilation error: error line 96 at position 17
'__DBT__CTE__ORDERS_LINEITEM.TOTALPRICE' in select clause is neither an aggregate nor in the group by clause.
2020-06-30 02:39:39.350382 (Thread-1): On model.sample_project.average_price_per_order: ROLLBACK
2020-06-30 02:39:39.350520 (Thread-1): initiating rollback
2020-06-30 02:39:39.783060 (Thread-1): finished collecting timing info
2020-06-30 02:39:39.783597 (Thread-1): Database Error in model average_price_per_order (models/reports/average_price_per_order.sql)
  001104 (42601): SQL compilation error: error line 96 at position 17
  '__DBT__CTE__ORDERS_LINEITEM.TOTALPRICE' in select clause is neither an aggregate nor in the group by clause.
  compiled SQL at target/run/sample_project/models/reports/average_price_per_order.sql
Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 158, in exception_handler
    yield
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/cursor.py", line 597, in execute
    errvalue)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/errors.py", line 97, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, errorclass, errorvalue)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/errors.py", line 73, in default_errorhandler
    done_format_msg=errorvalue.get(u'done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001104 (42601): SQL compilation error: error line 96 at position 17
'__DBT__CTE__ORDERS_LINEITEM.TOTALPRICE' in select clause is neither an aggregate nor in the group by clause.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 119, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 306, in add_query
    abridge_sql_log=abridge_sql_log
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/usr/local/opt/python/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 177, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model average_price_per_order (models/reports/average_price_per_order.sql)
  001104 (42601): SQL compilation error: error line 96 at position 17
  '__DBT__CTE__ORDERS_LINEITEM.TOTALPRICE' in select clause is neither an aggregate nor in the group by clause.
  compiled SQL at target/run/sample_project/models/reports/average_price_per_order.sql
2020-06-30 02:39:39.791258 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b9f05fc-dd4a-49c1-be4a-539cd1866396', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113313c50>]}
2020-06-30 02:39:39.792438 (Thread-1): 21:39:39 | 2 of 2 ERROR creating table model TEST.average_price_per_order....... [ERROR in 1.13s]
2020-06-30 02:39:39.792577 (Thread-1): Finished running node model.sample_project.average_price_per_order
2020-06-30 02:39:39.792730 (Thread-1): Began running node model.sample_project.cust_list_ord_nat
2020-06-30 02:39:39.792984 (Thread-1): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 02:39:39.793080 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.average_price_per_order).
2020-06-30 02:39:39.793173 (Thread-1): Compiling model.sample_project.cust_list_ord_nat
2020-06-30 02:39:39.807954 (Thread-1): Writing injected SQL for node "model.sample_project.cust_list_ord_nat"
2020-06-30 02:39:39.808493 (Thread-1): finished collecting timing info
2020-06-30 02:39:39.809058 (Thread-1): Finished running node model.sample_project.cust_list_ord_nat
2020-06-30 02:39:39.837741 (MainThread): Using snowflake connection "master".
2020-06-30 02:39:39.837999 (MainThread): On master: BEGIN
2020-06-30 02:39:40.642947 (MainThread): SQL status: SUCCESS 1 in 0.80 seconds
2020-06-30 02:39:40.643221 (MainThread): On master: COMMIT
2020-06-30 02:39:40.643454 (MainThread): Using snowflake connection "master".
2020-06-30 02:39:40.643613 (MainThread): On master: COMMIT
2020-06-30 02:39:41.054496 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2020-06-30 02:39:41.055114 (MainThread): 21:39:41 | 
2020-06-30 02:39:41.055352 (MainThread): 21:39:41 | Finished running 2 table models in 16.52s.
2020-06-30 02:39:41.055556 (MainThread): Connection 'master' was left open.
2020-06-30 02:39:41.055715 (MainThread): On master: Close
2020-06-30 02:39:41.494462 (MainThread): Connection 'model.sample_project.cust_list_ord_nat' was left open.
2020-06-30 02:39:41.494699 (MainThread): On model.sample_project.cust_list_ord_nat: Close
2020-06-30 02:39:42.193937 (MainThread): 
2020-06-30 02:39:42.194105 (MainThread): Completed with 1 error and 0 warnings:
2020-06-30 02:39:42.194221 (MainThread): 
2020-06-30 02:39:42.194334 (MainThread): Database Error in model average_price_per_order (models/reports/average_price_per_order.sql)
2020-06-30 02:39:42.194438 (MainThread):   001104 (42601): SQL compilation error: error line 96 at position 17
2020-06-30 02:39:42.194533 (MainThread):   '__DBT__CTE__ORDERS_LINEITEM.TOTALPRICE' in select clause is neither an aggregate nor in the group by clause.
2020-06-30 02:39:42.194626 (MainThread):   compiled SQL at target/run/sample_project/models/reports/average_price_per_order.sql
2020-06-30 02:39:42.194725 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
2020-06-30 02:39:42.194888 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113203b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133136d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133139d0>]}
2020-06-30 02:39:42.195073 (MainThread): Flushing usage events
2020-06-30 02:41:14.497638 (MainThread): Running with dbt=0.17.0
2020-06-30 02:41:15.004820 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-06-30 02:41:15.005443 (MainThread): Tracking: tracking
2020-06-30 02:41:15.005762 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aebad10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aecea90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aece9d0>]}
2020-06-30 02:41:15.029247 (MainThread): Partial parsing not enabled
2020-06-30 02:41:15.031160 (MainThread): Parsing macros/core.sql
2020-06-30 02:41:15.036184 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-30 02:41:15.045689 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-30 02:41:15.047783 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-30 02:41:15.067343 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-30 02:41:15.099339 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-30 02:41:15.121853 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-30 02:41:15.123777 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-30 02:41:15.130751 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-30 02:41:15.145451 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-30 02:41:15.157854 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-30 02:41:15.172038 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-30 02:41:15.181279 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-30 02:41:15.182415 (MainThread): Parsing macros/etc/query.sql
2020-06-30 02:41:15.183676 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-30 02:41:15.185655 (MainThread): Parsing macros/etc/datetime.sql
2020-06-30 02:41:15.196138 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-30 02:41:15.198519 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-30 02:41:15.200558 (MainThread): Parsing macros/adapters/common.sql
2020-06-30 02:41:15.255790 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-30 02:41:15.257058 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-30 02:41:15.258051 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-30 02:41:15.259290 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-30 02:41:15.261859 (MainThread): Parsing macros/catalog.sql
2020-06-30 02:41:15.263867 (MainThread): Parsing macros/adapters.sql
2020-06-30 02:41:15.288920 (MainThread): Parsing macros/materializations/merge.sql
2020-06-30 02:41:15.291175 (MainThread): Parsing macros/materializations/view.sql
2020-06-30 02:41:15.292820 (MainThread): Parsing macros/materializations/table.sql
2020-06-30 02:41:15.296751 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-30 02:41:15.335912 (MainThread): Partial parsing not enabled
2020-06-30 02:41:15.337576 (MainThread): Parsing macros/cross_db_utils/except.sql
2020-06-30 02:41:15.338645 (MainThread): Parsing macros/cross_db_utils/replace.sql
2020-06-30 02:41:15.339936 (MainThread): Parsing macros/cross_db_utils/concat.sql
2020-06-30 02:41:15.342274 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2020-06-30 02:41:15.348434 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2020-06-30 02:41:15.349831 (MainThread): Parsing macros/cross_db_utils/length.sql
2020-06-30 02:41:15.351173 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2020-06-30 02:41:15.354185 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2020-06-30 02:41:15.355253 (MainThread): Parsing macros/cross_db_utils/right.sql
2020-06-30 02:41:15.357737 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2020-06-30 02:41:15.368789 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2020-06-30 02:41:15.370753 (MainThread): Parsing macros/cross_db_utils/hash.sql
2020-06-30 02:41:15.372215 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2020-06-30 02:41:15.373971 (MainThread): Parsing macros/cross_db_utils/position.sql
2020-06-30 02:41:15.375578 (MainThread): Parsing macros/cross_db_utils/literal.sql
2020-06-30 02:41:15.376532 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2020-06-30 02:41:15.379767 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2020-06-30 02:41:15.385596 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2020-06-30 02:41:15.388596 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2020-06-30 02:41:15.390520 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2020-06-30 02:41:15.392091 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2020-06-30 02:41:15.418154 (MainThread): Parsing macros/logger/pretty_log_format.sql
2020-06-30 02:41:15.418870 (MainThread): Parsing macros/logger/pretty_time.sql
2020-06-30 02:41:15.419661 (MainThread): Parsing macros/logger/log_info.sql
2020-06-30 02:41:15.420383 (MainThread): Parsing macros/datetime/date_spine.sql
2020-06-30 02:41:15.424107 (MainThread): Parsing macros/web/get_url_host.sql
2020-06-30 02:41:15.425546 (MainThread): Parsing macros/web/get_url_path.sql
2020-06-30 02:41:15.427809 (MainThread): Parsing macros/web/get_url_parameter.sql
2020-06-30 02:41:15.428968 (MainThread): Parsing macros/geo/haversine_distance.sql
2020-06-30 02:41:15.429924 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2020-06-30 02:41:15.431262 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2020-06-30 02:41:15.433677 (MainThread): Parsing macros/schema_tests/recency.sql
2020-06-30 02:41:15.434968 (MainThread): Parsing macros/schema_tests/not_constant.sql
2020-06-30 02:41:15.436000 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2020-06-30 02:41:15.437020 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2020-06-30 02:41:15.438498 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2020-06-30 02:41:15.440322 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2020-06-30 02:41:15.441447 (MainThread): Parsing macros/schema_tests/equality.sql
2020-06-30 02:41:15.444569 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2020-06-30 02:41:15.450604 (MainThread): Parsing macros/sql/nullcheck_table.sql
2020-06-30 02:41:15.451661 (MainThread): Parsing macros/sql/generate_series.sql
2020-06-30 02:41:15.455254 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2020-06-30 02:41:15.459026 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2020-06-30 02:41:15.461784 (MainThread): Parsing macros/sql/star.sql
2020-06-30 02:41:15.464610 (MainThread): Parsing macros/sql/unpivot.sql
2020-06-30 02:41:15.471030 (MainThread): Parsing macros/sql/union.sql
2020-06-30 02:41:15.481062 (MainThread): Parsing macros/sql/groupby.sql
2020-06-30 02:41:15.482000 (MainThread): Parsing macros/sql/surrogate_key.sql
2020-06-30 02:41:15.484829 (MainThread): Parsing macros/sql/safe_add.sql
2020-06-30 02:41:15.485947 (MainThread): Parsing macros/sql/nullcheck.sql
2020-06-30 02:41:15.487199 (MainThread): Parsing macros/sql/get_column_values.sql
2020-06-30 02:41:15.491506 (MainThread): Parsing macros/sql/pivot.sql
2020-06-30 02:41:15.494119 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2020-06-30 02:41:15.537435 (MainThread): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 02:41:15.537550 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:41:15.571954 (MainThread): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 02:41:15.572072 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:41:15.584359 (MainThread): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 02:41:15.584452 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:41:15.596833 (MainThread): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 02:41:15.596923 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:41:15.608796 (MainThread): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 02:41:15.608884 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:41:15.620575 (MainThread): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 02:41:15.620661 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:41:15.632264 (MainThread): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 02:41:15.632349 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:41:15.644482 (MainThread): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 02:41:15.644568 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:41:15.656023 (MainThread): Acquiring new snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 02:41:15.656109 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:41:16.097786 (MainThread): Found 9 models, 8 tests, 0 snapshots, 0 analyses, 263 macros, 0 operations, 0 seed files, 4 sources
2020-06-30 02:41:16.099362 (MainThread): 
2020-06-30 02:41:16.099621 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 02:41:16.099700 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:41:16.102264 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_JAVEN_TESTING".
2020-06-30 02:41:16.102566 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-06-30 02:41:16.118889 (ThreadPoolExecutor-0_0): Using snowflake connection "list_JAVEN_TESTING".
2020-06-30 02:41:16.119138 (ThreadPoolExecutor-0_0): On list_JAVEN_TESTING: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING"} */

    show terse schemas in database JAVEN_TESTING
    limit 10000
2020-06-30 02:41:16.647378 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/certifi/cacert.pem'>
2020-06-30 02:41:22.069218 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 5.95 seconds
2020-06-30 02:41:22.101074 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 02:41:22.101190 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_JAVEN_TESTING).
2020-06-30 02:41:22.108287 (ThreadPoolExecutor-1_0): Using snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 02:41:22.108402 (ThreadPoolExecutor-1_0): On list_JAVEN_TESTING_TEST: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING_TEST"} */

    show terse objects in JAVEN_TESTING.TEST
2020-06-30 02:41:22.311001 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 0.20 seconds
2020-06-30 02:41:22.322091 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 02:41:22.322222 (MainThread): Opening a new connection, currently in state init
2020-06-30 02:41:22.322418 (MainThread): Using snowflake connection "master".
2020-06-30 02:41:22.322529 (MainThread): On master: BEGIN
2020-06-30 02:41:28.207414 (MainThread): SQL status: SUCCESS 1 in 5.88 seconds
2020-06-30 02:41:28.207707 (MainThread): On master: COMMIT
2020-06-30 02:41:28.207957 (MainThread): Using snowflake connection "master".
2020-06-30 02:41:28.208122 (MainThread): On master: COMMIT
2020-06-30 02:41:28.488916 (MainThread): SQL status: SUCCESS 1 in 0.28 seconds
2020-06-30 02:41:28.489497 (MainThread): 21:41:28 | Concurrency: 1 threads (target='dev')
2020-06-30 02:41:28.489696 (MainThread): 21:41:28 | 
2020-06-30 02:41:28.490732 (Thread-1): Began running node model.sample_project.customer
2020-06-30 02:41:28.491151 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 02:41:28.491299 (Thread-1): Re-using an available connection from the pool (formerly list_JAVEN_TESTING_TEST).
2020-06-30 02:41:28.491447 (Thread-1): Compiling model.sample_project.customer
2020-06-30 02:41:28.519848 (Thread-1): Writing injected SQL for node "model.sample_project.customer"
2020-06-30 02:41:28.520803 (Thread-1): finished collecting timing info
2020-06-30 02:41:28.521454 (Thread-1): Finished running node model.sample_project.customer
2020-06-30 02:41:28.521649 (Thread-1): Began running node model.sample_project.lineitem
2020-06-30 02:41:28.521996 (Thread-1): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 02:41:28.522121 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer).
2020-06-30 02:41:28.522247 (Thread-1): Compiling model.sample_project.lineitem
2020-06-30 02:41:28.534560 (Thread-1): Writing injected SQL for node "model.sample_project.lineitem"
2020-06-30 02:41:28.535049 (Thread-1): finished collecting timing info
2020-06-30 02:41:28.535557 (Thread-1): Finished running node model.sample_project.lineitem
2020-06-30 02:41:28.535732 (Thread-1): Began running node model.sample_project.nation
2020-06-30 02:41:28.536035 (Thread-1): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 02:41:28.536246 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.lineitem).
2020-06-30 02:41:28.536390 (Thread-1): Compiling model.sample_project.nation
2020-06-30 02:41:28.545978 (Thread-1): Writing injected SQL for node "model.sample_project.nation"
2020-06-30 02:41:28.546338 (Thread-1): finished collecting timing info
2020-06-30 02:41:28.546795 (Thread-1): Finished running node model.sample_project.nation
2020-06-30 02:41:28.546968 (Thread-1): Began running node model.sample_project.orders
2020-06-30 02:41:28.547249 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 02:41:28.547360 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.nation).
2020-06-30 02:41:28.547464 (Thread-1): Compiling model.sample_project.orders
2020-06-30 02:41:28.555733 (Thread-1): Writing injected SQL for node "model.sample_project.orders"
2020-06-30 02:41:28.556122 (Thread-1): finished collecting timing info
2020-06-30 02:41:28.556521 (Thread-1): Finished running node model.sample_project.orders
2020-06-30 02:41:28.556656 (Thread-1): Began running node model.sample_project.customer_nation
2020-06-30 02:41:28.556899 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 02:41:28.556995 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders).
2020-06-30 02:41:28.557086 (Thread-1): Compiling model.sample_project.customer_nation
2020-06-30 02:41:28.568588 (Thread-1): Writing injected SQL for node "model.sample_project.customer_nation"
2020-06-30 02:41:28.568971 (Thread-1): finished collecting timing info
2020-06-30 02:41:28.569397 (Thread-1): Finished running node model.sample_project.customer_nation
2020-06-30 02:41:28.569537 (Thread-1): Began running node model.sample_project.orders_lineitem
2020-06-30 02:41:28.569784 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 02:41:28.569883 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer_nation).
2020-06-30 02:41:28.569976 (Thread-1): Compiling model.sample_project.orders_lineitem
2020-06-30 02:41:28.582085 (Thread-1): Writing injected SQL for node "model.sample_project.orders_lineitem"
2020-06-30 02:41:28.582415 (Thread-1): finished collecting timing info
2020-06-30 02:41:28.582746 (Thread-1): Finished running node model.sample_project.orders_lineitem
2020-06-30 02:41:28.582859 (Thread-1): Began running node model.sample_project.customers_per_nation
2020-06-30 02:41:28.583682 (Thread-1): 21:41:28 | 1 of 2 START table model TEST.customers_per_nation................... [RUN]
2020-06-30 02:41:28.584046 (Thread-1): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 02:41:28.584330 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders_lineitem).
2020-06-30 02:41:28.584419 (Thread-1): Compiling model.sample_project.customers_per_nation
2020-06-30 02:41:28.592727 (Thread-1): Writing injected SQL for node "model.sample_project.customers_per_nation"
2020-06-30 02:41:28.594908 (Thread-1): finished collecting timing info
2020-06-30 02:41:28.628787 (Thread-1): Writing runtime SQL for node "model.sample_project.customers_per_nation"
2020-06-30 02:41:28.630905 (Thread-1): Using snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 02:41:28.631013 (Thread-1): On model.sample_project.customers_per_nation: BEGIN
2020-06-30 02:41:28.854187 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2020-06-30 02:41:28.854435 (Thread-1): Using snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 02:41:28.855108 (Thread-1): On model.sample_project.customers_per_nation: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "model.sample_project.customers_per_nation"} */


      create or replace transient table JAVEN_TESTING.TEST.customers_per_nation  as
      (with __dbt__CTE__customer as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  c_custkey as custkey,
        c_nationkey as nationkey,
        c_name as name
from snowflake_sample_data.tpch_sf1.customer
),  __dbt__CTE__nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  n_nationkey as nationkey,
        n_name as name
from snowflake_sample_data.tpch_sf1.nation
),  __dbt__CTE__customer_nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  c.custkey,
        c.nationkey,
        c.name as customer_name,
        n.name as nation_name
from __dbt__CTE__customer as c
JOIN __dbt__CTE__nation as n
ON c.nationkey=n.nationkey
)/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  count(customer_name) as customer_count,
        nation_name
from __dbt__CTE__customer_nation
group by nation_name
order by nation_name
      );
2020-06-30 02:41:31.240090 (Thread-1): SQL status: SUCCESS 1 in 2.38 seconds
2020-06-30 02:41:31.241520 (Thread-1): On model.sample_project.customers_per_nation: COMMIT
2020-06-30 02:41:31.241728 (Thread-1): Using snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 02:41:31.241861 (Thread-1): On model.sample_project.customers_per_nation: COMMIT
2020-06-30 02:41:31.435611 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2020-06-30 02:41:31.448015 (Thread-1): finished collecting timing info
2020-06-30 02:41:31.448805 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fed4845-aec8-48bd-8d2a-07d42e324497', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd0acd0>]}
2020-06-30 02:41:31.450163 (Thread-1): 21:41:31 | 1 of 2 OK created table model TEST.customers_per_nation.............. [SUCCESS 1 in 2.86s]
2020-06-30 02:41:31.450333 (Thread-1): Finished running node model.sample_project.customers_per_nation
2020-06-30 02:41:31.450501 (Thread-1): Began running node model.sample_project.average_price_per_order
2020-06-30 02:41:31.451684 (Thread-1): 21:41:31 | 2 of 2 START table model TEST.average_price_per_order................ [RUN]
2020-06-30 02:41:31.452016 (Thread-1): Acquiring new snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 02:41:31.452140 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customers_per_nation).
2020-06-30 02:41:31.452256 (Thread-1): Compiling model.sample_project.average_price_per_order
2020-06-30 02:41:31.471239 (Thread-1): Writing injected SQL for node "model.sample_project.average_price_per_order"
2020-06-30 02:41:31.471819 (Thread-1): finished collecting timing info
2020-06-30 02:41:31.477645 (Thread-1): Writing runtime SQL for node "model.sample_project.average_price_per_order"
2020-06-30 02:41:31.481495 (Thread-1): Using snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 02:41:31.482176 (Thread-1): On model.sample_project.average_price_per_order: BEGIN
2020-06-30 02:41:31.739734 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2020-06-30 02:41:31.740079 (Thread-1): Using snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 02:41:31.740291 (Thread-1): On model.sample_project.average_price_per_order: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "model.sample_project.average_price_per_order"} */


      create or replace transient table JAVEN_TESTING.TEST.average_price_per_order  as
      (with __dbt__CTE__orders as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  o_orderkey as orderkey,
        o_custkey as custkey,
        o_totalprice as totalprice,
        o_orderdate as orderdate
from snowflake_sample_data.tpch_sf1.orders
),  __dbt__CTE__lineitem as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  l_orderkey as orderkey,
        l_extendedprice as extendedprice,
        l_discount as discount,
        l_tax as tax,
        l_quantity as quantity
from snowflake_sample_data.tpch_sf1.lineitem
),  __dbt__CTE__orders_lineitem as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  o.orderkey,
        o.custkey,
        o.totalprice,
        o.orderdate,
        l.extendedprice,
        l.discount,
        l.tax,
        l.quantity
from __dbt__CTE__orders as o
JOIN __dbt__CTE__lineitem as l
ON o.orderkey=l.orderkey
)/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  avg(totalprice) as average_order_price,
        
  
    width_bucket(average_order_price, 0, 999999, 10 )

 as price_histogram,
        orderdate
from __dbt__CTE__orders_lineitem
group by orderdate
      );
2020-06-30 02:41:33.981242 (Thread-1): SQL status: SUCCESS 1 in 2.24 seconds
2020-06-30 02:41:33.982479 (Thread-1): On model.sample_project.average_price_per_order: COMMIT
2020-06-30 02:41:33.982653 (Thread-1): Using snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 02:41:33.982768 (Thread-1): On model.sample_project.average_price_per_order: COMMIT
2020-06-30 02:41:34.177814 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2020-06-30 02:41:34.181369 (Thread-1): finished collecting timing info
2020-06-30 02:41:34.182263 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fed4845-aec8-48bd-8d2a-07d42e324497', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dcd6050>]}
2020-06-30 02:41:34.183690 (Thread-1): 21:41:34 | 2 of 2 OK created table model TEST.average_price_per_order........... [SUCCESS 1 in 2.73s]
2020-06-30 02:41:34.183856 (Thread-1): Finished running node model.sample_project.average_price_per_order
2020-06-30 02:41:34.184027 (Thread-1): Began running node model.sample_project.cust_list_ord_nat
2020-06-30 02:41:34.184330 (Thread-1): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 02:41:34.184450 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.average_price_per_order).
2020-06-30 02:41:34.184565 (Thread-1): Compiling model.sample_project.cust_list_ord_nat
2020-06-30 02:41:34.201467 (Thread-1): Writing injected SQL for node "model.sample_project.cust_list_ord_nat"
2020-06-30 02:41:34.201918 (Thread-1): finished collecting timing info
2020-06-30 02:41:34.202317 (Thread-1): Finished running node model.sample_project.cust_list_ord_nat
2020-06-30 02:41:34.204076 (MainThread): Using snowflake connection "master".
2020-06-30 02:41:34.204192 (MainThread): On master: BEGIN
2020-06-30 02:41:34.473071 (MainThread): SQL status: SUCCESS 1 in 0.27 seconds
2020-06-30 02:41:34.473356 (MainThread): On master: COMMIT
2020-06-30 02:41:34.473593 (MainThread): Using snowflake connection "master".
2020-06-30 02:41:34.473753 (MainThread): On master: COMMIT
2020-06-30 02:41:34.923596 (MainThread): SQL status: SUCCESS 1 in 0.45 seconds
2020-06-30 02:41:34.924208 (MainThread): 21:41:34 | 
2020-06-30 02:41:34.924448 (MainThread): 21:41:34 | Finished running 2 table models in 18.82s.
2020-06-30 02:41:34.924646 (MainThread): Connection 'master' was left open.
2020-06-30 02:41:34.924804 (MainThread): On master: Close
2020-06-30 02:41:35.186875 (MainThread): Connection 'model.sample_project.cust_list_ord_nat' was left open.
2020-06-30 02:41:35.187082 (MainThread): On model.sample_project.cust_list_ord_nat: Close
2020-06-30 02:41:35.432697 (MainThread): 
2020-06-30 02:41:35.432918 (MainThread): Completed successfully
2020-06-30 02:41:35.433070 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2020-06-30 02:41:35.433278 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd00e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd08890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb3c710>]}
2020-06-30 02:41:35.433502 (MainThread): Flushing usage events
2020-06-30 03:05:11.488179 (MainThread): Running with dbt=0.17.0
2020-06-30 03:05:12.002007 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-06-30 03:05:12.003065 (MainThread): Tracking: tracking
2020-06-30 03:05:12.003478 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113009990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113025a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113025950>]}
2020-06-30 03:05:12.031780 (MainThread): Partial parsing not enabled
2020-06-30 03:05:12.034575 (MainThread): Parsing macros/core.sql
2020-06-30 03:05:12.040583 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-30 03:05:12.050852 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-30 03:05:12.053169 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-30 03:05:12.073861 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-30 03:05:12.105775 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-30 03:05:12.131477 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-30 03:05:12.133780 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-30 03:05:12.147901 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-30 03:05:12.166782 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-30 03:05:12.174752 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-30 03:05:12.182434 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-30 03:05:12.188172 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-30 03:05:12.189422 (MainThread): Parsing macros/etc/query.sql
2020-06-30 03:05:12.190820 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-30 03:05:12.193311 (MainThread): Parsing macros/etc/datetime.sql
2020-06-30 03:05:12.205012 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-30 03:05:12.207643 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-30 03:05:12.209780 (MainThread): Parsing macros/adapters/common.sql
2020-06-30 03:05:12.274944 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-30 03:05:12.276388 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-30 03:05:12.277735 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-30 03:05:12.279153 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-30 03:05:12.282016 (MainThread): Parsing macros/catalog.sql
2020-06-30 03:05:12.284219 (MainThread): Parsing macros/adapters.sql
2020-06-30 03:05:12.309322 (MainThread): Parsing macros/materializations/merge.sql
2020-06-30 03:05:12.312212 (MainThread): Parsing macros/materializations/view.sql
2020-06-30 03:05:12.313730 (MainThread): Parsing macros/materializations/table.sql
2020-06-30 03:05:12.319283 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-30 03:05:12.362070 (MainThread): Partial parsing not enabled
2020-06-30 03:05:12.366376 (MainThread): Parsing macros/cross_db_utils/except.sql
2020-06-30 03:05:12.368260 (MainThread): Parsing macros/cross_db_utils/replace.sql
2020-06-30 03:05:12.370103 (MainThread): Parsing macros/cross_db_utils/concat.sql
2020-06-30 03:05:12.373206 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2020-06-30 03:05:12.380525 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2020-06-30 03:05:12.382271 (MainThread): Parsing macros/cross_db_utils/length.sql
2020-06-30 03:05:12.384113 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2020-06-30 03:05:12.387653 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2020-06-30 03:05:12.389137 (MainThread): Parsing macros/cross_db_utils/right.sql
2020-06-30 03:05:12.392203 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2020-06-30 03:05:12.404518 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2020-06-30 03:05:12.406916 (MainThread): Parsing macros/cross_db_utils/hash.sql
2020-06-30 03:05:12.408887 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2020-06-30 03:05:12.410935 (MainThread): Parsing macros/cross_db_utils/position.sql
2020-06-30 03:05:12.413122 (MainThread): Parsing macros/cross_db_utils/literal.sql
2020-06-30 03:05:12.414351 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2020-06-30 03:05:12.418025 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2020-06-30 03:05:12.424573 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2020-06-30 03:05:12.428175 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2020-06-30 03:05:12.430652 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2020-06-30 03:05:12.432613 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2020-06-30 03:05:12.459279 (MainThread): Parsing macros/logger/pretty_log_format.sql
2020-06-30 03:05:12.460842 (MainThread): Parsing macros/logger/pretty_time.sql
2020-06-30 03:05:12.462300 (MainThread): Parsing macros/logger/log_info.sql
2020-06-30 03:05:12.463415 (MainThread): Parsing macros/datetime/date_spine.sql
2020-06-30 03:05:12.469141 (MainThread): Parsing macros/web/get_url_host.sql
2020-06-30 03:05:12.471340 (MainThread): Parsing macros/web/get_url_path.sql
2020-06-30 03:05:12.474210 (MainThread): Parsing macros/web/get_url_parameter.sql
2020-06-30 03:05:12.475782 (MainThread): Parsing macros/geo/haversine_distance.sql
2020-06-30 03:05:12.477085 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2020-06-30 03:05:12.478911 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2020-06-30 03:05:12.481696 (MainThread): Parsing macros/schema_tests/recency.sql
2020-06-30 03:05:12.483496 (MainThread): Parsing macros/schema_tests/not_constant.sql
2020-06-30 03:05:12.484994 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2020-06-30 03:05:12.486433 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2020-06-30 03:05:12.488106 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2020-06-30 03:05:12.490127 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2020-06-30 03:05:12.491565 (MainThread): Parsing macros/schema_tests/equality.sql
2020-06-30 03:05:12.495348 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2020-06-30 03:05:12.502664 (MainThread): Parsing macros/sql/nullcheck_table.sql
2020-06-30 03:05:12.504038 (MainThread): Parsing macros/sql/generate_series.sql
2020-06-30 03:05:12.508443 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2020-06-30 03:05:12.513724 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2020-06-30 03:05:12.517247 (MainThread): Parsing macros/sql/star.sql
2020-06-30 03:05:12.520833 (MainThread): Parsing macros/sql/unpivot.sql
2020-06-30 03:05:12.530681 (MainThread): Parsing macros/sql/union.sql
2020-06-30 03:05:12.542696 (MainThread): Parsing macros/sql/groupby.sql
2020-06-30 03:05:12.544053 (MainThread): Parsing macros/sql/surrogate_key.sql
2020-06-30 03:05:12.547729 (MainThread): Parsing macros/sql/safe_add.sql
2020-06-30 03:05:12.549281 (MainThread): Parsing macros/sql/nullcheck.sql
2020-06-30 03:05:12.551098 (MainThread): Parsing macros/sql/get_column_values.sql
2020-06-30 03:05:12.556537 (MainThread): Parsing macros/sql/pivot.sql
2020-06-30 03:05:12.559777 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2020-06-30 03:05:12.610167 (MainThread): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 03:05:12.610313 (MainThread): Opening a new connection, currently in state init
2020-06-30 03:05:12.643293 (MainThread): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 03:05:12.643471 (MainThread): Opening a new connection, currently in state init
2020-06-30 03:05:12.655918 (MainThread): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 03:05:12.656014 (MainThread): Opening a new connection, currently in state init
2020-06-30 03:05:12.668106 (MainThread): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 03:05:12.668209 (MainThread): Opening a new connection, currently in state init
2020-06-30 03:05:12.681560 (MainThread): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 03:05:12.681681 (MainThread): Opening a new connection, currently in state init
2020-06-30 03:05:12.699340 (MainThread): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 03:05:12.699456 (MainThread): Opening a new connection, currently in state init
2020-06-30 03:05:12.713871 (MainThread): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 03:05:12.714011 (MainThread): Opening a new connection, currently in state init
2020-06-30 03:05:12.728821 (MainThread): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 03:05:12.728969 (MainThread): Opening a new connection, currently in state init
2020-06-30 03:05:12.742706 (MainThread): Acquiring new snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 03:05:12.742820 (MainThread): Opening a new connection, currently in state init
2020-06-30 03:05:13.220742 (MainThread): Found 9 models, 8 tests, 0 snapshots, 0 analyses, 263 macros, 0 operations, 0 seed files, 4 sources
2020-06-30 03:05:13.222897 (MainThread): 
2020-06-30 03:05:13.223278 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 03:05:13.223368 (MainThread): Opening a new connection, currently in state init
2020-06-30 03:05:13.226620 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_JAVEN_TESTING".
2020-06-30 03:05:13.227070 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-06-30 03:05:13.245583 (ThreadPoolExecutor-0_0): Using snowflake connection "list_JAVEN_TESTING".
2020-06-30 03:05:13.245749 (ThreadPoolExecutor-0_0): On list_JAVEN_TESTING: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING"} */

    show terse schemas in database JAVEN_TESTING
    limit 10000
2020-06-30 03:05:14.818478 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/certifi/cacert.pem'>
2020-06-30 03:05:21.185397 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 7.94 seconds
2020-06-30 03:05:21.216172 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 03:05:21.216365 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_JAVEN_TESTING).
2020-06-30 03:05:21.223503 (ThreadPoolExecutor-1_0): Using snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 03:05:21.223614 (ThreadPoolExecutor-1_0): On list_JAVEN_TESTING_TEST: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING_TEST"} */

    show terse objects in JAVEN_TESTING.TEST
2020-06-30 03:05:21.427478 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 0.20 seconds
2020-06-30 03:05:21.440769 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 03:05:21.440943 (MainThread): Opening a new connection, currently in state init
2020-06-30 03:05:21.441139 (MainThread): Using snowflake connection "master".
2020-06-30 03:05:21.441246 (MainThread): On master: BEGIN
2020-06-30 03:05:26.536007 (MainThread): SQL status: SUCCESS 1 in 5.09 seconds
2020-06-30 03:05:26.536229 (MainThread): On master: COMMIT
2020-06-30 03:05:26.536407 (MainThread): Using snowflake connection "master".
2020-06-30 03:05:26.536525 (MainThread): On master: COMMIT
2020-06-30 03:05:26.820408 (MainThread): SQL status: SUCCESS 1 in 0.28 seconds
2020-06-30 03:05:26.820818 (MainThread): 22:05:26 | Concurrency: 1 threads (target='dev')
2020-06-30 03:05:26.820977 (MainThread): 22:05:26 | 
2020-06-30 03:05:26.821805 (Thread-1): Began running node model.sample_project.customer
2020-06-30 03:05:26.822158 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 03:05:26.822283 (Thread-1): Re-using an available connection from the pool (formerly list_JAVEN_TESTING_TEST).
2020-06-30 03:05:26.822412 (Thread-1): Compiling model.sample_project.customer
2020-06-30 03:05:26.850075 (Thread-1): Writing injected SQL for node "model.sample_project.customer"
2020-06-30 03:05:26.851738 (Thread-1): finished collecting timing info
2020-06-30 03:05:26.852606 (Thread-1): Finished running node model.sample_project.customer
2020-06-30 03:05:26.852816 (Thread-1): Began running node model.sample_project.lineitem
2020-06-30 03:05:26.853256 (Thread-1): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 03:05:26.853746 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer).
2020-06-30 03:05:26.854051 (Thread-1): Compiling model.sample_project.lineitem
2020-06-30 03:05:26.865483 (Thread-1): Writing injected SQL for node "model.sample_project.lineitem"
2020-06-30 03:05:26.866460 (Thread-1): finished collecting timing info
2020-06-30 03:05:26.867028 (Thread-1): Finished running node model.sample_project.lineitem
2020-06-30 03:05:26.867202 (Thread-1): Began running node model.sample_project.nation
2020-06-30 03:05:26.867507 (Thread-1): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 03:05:26.867626 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.lineitem).
2020-06-30 03:05:26.867741 (Thread-1): Compiling model.sample_project.nation
2020-06-30 03:05:26.877802 (Thread-1): Writing injected SQL for node "model.sample_project.nation"
2020-06-30 03:05:26.878202 (Thread-1): finished collecting timing info
2020-06-30 03:05:26.878707 (Thread-1): Finished running node model.sample_project.nation
2020-06-30 03:05:26.878884 (Thread-1): Began running node model.sample_project.orders
2020-06-30 03:05:26.879185 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 03:05:26.879305 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.nation).
2020-06-30 03:05:26.879418 (Thread-1): Compiling model.sample_project.orders
2020-06-30 03:05:26.888684 (Thread-1): Writing injected SQL for node "model.sample_project.orders"
2020-06-30 03:05:26.889016 (Thread-1): finished collecting timing info
2020-06-30 03:05:26.889409 (Thread-1): Finished running node model.sample_project.orders
2020-06-30 03:05:26.889547 (Thread-1): Began running node model.sample_project.customer_nation
2020-06-30 03:05:26.889796 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 03:05:26.889896 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders).
2020-06-30 03:05:26.889990 (Thread-1): Compiling model.sample_project.customer_nation
2020-06-30 03:05:26.901765 (Thread-1): Writing injected SQL for node "model.sample_project.customer_nation"
2020-06-30 03:05:26.902284 (Thread-1): finished collecting timing info
2020-06-30 03:05:26.902719 (Thread-1): Finished running node model.sample_project.customer_nation
2020-06-30 03:05:26.902859 (Thread-1): Began running node model.sample_project.orders_lineitem
2020-06-30 03:05:26.903112 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 03:05:26.903210 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer_nation).
2020-06-30 03:05:26.903305 (Thread-1): Compiling model.sample_project.orders_lineitem
2020-06-30 03:05:26.915995 (Thread-1): Writing injected SQL for node "model.sample_project.orders_lineitem"
2020-06-30 03:05:26.916388 (Thread-1): finished collecting timing info
2020-06-30 03:05:26.916787 (Thread-1): Finished running node model.sample_project.orders_lineitem
2020-06-30 03:05:26.916918 (Thread-1): Began running node model.sample_project.customers_per_nation
2020-06-30 03:05:26.917885 (Thread-1): 22:05:26 | 1 of 2 START table model TEST.customers_per_nation................... [RUN]
2020-06-30 03:05:26.918301 (Thread-1): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 03:05:26.918403 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders_lineitem).
2020-06-30 03:05:26.918497 (Thread-1): Compiling model.sample_project.customers_per_nation
2020-06-30 03:05:26.927640 (Thread-1): Writing injected SQL for node "model.sample_project.customers_per_nation"
2020-06-30 03:05:26.927988 (Thread-1): finished collecting timing info
2020-06-30 03:05:26.962989 (Thread-1): Writing runtime SQL for node "model.sample_project.customers_per_nation"
2020-06-30 03:05:26.965823 (Thread-1): Using snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 03:05:26.966266 (Thread-1): On model.sample_project.customers_per_nation: BEGIN
2020-06-30 03:05:27.206555 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2020-06-30 03:05:27.206783 (Thread-1): Using snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 03:05:27.206909 (Thread-1): On model.sample_project.customers_per_nation: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "model.sample_project.customers_per_nation"} */


      create or replace transient table JAVEN_TESTING.TEST.customers_per_nation  as
      (with __dbt__CTE__customer as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  c_custkey as custkey,
        c_nationkey as nationkey,
        c_name as name
from snowflake_sample_data.tpch_sf1.customer
),  __dbt__CTE__nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  n_nationkey as nationkey,
        n_name as name
from snowflake_sample_data.tpch_sf1.nation
),  __dbt__CTE__customer_nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  c.custkey,
        c.nationkey,
        c.name as customer_name,
        n.name as nation_name
from __dbt__CTE__customer as c
JOIN __dbt__CTE__nation as n
ON c.nationkey=n.nationkey
)/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  count(customer_name) as customer_count,
        nation_name
from __dbt__CTE__customer_nation
group by nation_name
order by nation_name
      );
2020-06-30 03:05:29.330427 (Thread-1): SQL status: SUCCESS 1 in 2.12 seconds
2020-06-30 03:05:29.331712 (Thread-1): On model.sample_project.customers_per_nation: COMMIT
2020-06-30 03:05:29.331900 (Thread-1): Using snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 03:05:29.332013 (Thread-1): On model.sample_project.customers_per_nation: COMMIT
2020-06-30 03:05:29.591535 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2020-06-30 03:05:29.603731 (Thread-1): finished collecting timing info
2020-06-30 03:05:29.604532 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '071042b3-66e0-4689-b194-c16f76e3cbe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115828a50>]}
2020-06-30 03:05:29.605854 (Thread-1): 22:05:29 | 1 of 2 OK created table model TEST.customers_per_nation.............. [SUCCESS 1 in 2.69s]
2020-06-30 03:05:29.606019 (Thread-1): Finished running node model.sample_project.customers_per_nation
2020-06-30 03:05:29.606183 (Thread-1): Began running node model.sample_project.average_price_per_order
2020-06-30 03:05:29.607392 (Thread-1): 22:05:29 | 2 of 2 START table model TEST.average_price_per_order................ [RUN]
2020-06-30 03:05:29.607810 (Thread-1): Acquiring new snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 03:05:29.607953 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customers_per_nation).
2020-06-30 03:05:29.608068 (Thread-1): Compiling model.sample_project.average_price_per_order
2020-06-30 03:05:29.622895 (Thread-1): Writing injected SQL for node "model.sample_project.average_price_per_order"
2020-06-30 03:05:29.624167 (Thread-1): finished collecting timing info
2020-06-30 03:05:29.632113 (Thread-1): Writing runtime SQL for node "model.sample_project.average_price_per_order"
2020-06-30 03:05:29.635583 (Thread-1): Using snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 03:05:29.635765 (Thread-1): On model.sample_project.average_price_per_order: BEGIN
2020-06-30 03:05:29.828373 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2020-06-30 03:05:29.828550 (Thread-1): Using snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 03:05:29.828664 (Thread-1): On model.sample_project.average_price_per_order: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "model.sample_project.average_price_per_order"} */


      create or replace transient table JAVEN_TESTING.TEST.average_price_per_order  as
      (with __dbt__CTE__orders as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  o_orderkey as orderkey,
        o_custkey as custkey,
        o_totalprice as totalprice,
        o_orderdate as orderdate
from snowflake_sample_data.tpch_sf1.orders
),  __dbt__CTE__lineitem as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  l_orderkey as orderkey,
        l_extendedprice as extendedprice,
        l_discount as discount,
        l_tax as tax,
        l_quantity as quantity
from snowflake_sample_data.tpch_sf1.lineitem
),  __dbt__CTE__orders_lineitem as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  o.orderkey,
        o.custkey,
        o.totalprice,
        o.orderdate,
        l.extendedprice,
        l.discount,
        l.tax,
        l.quantity
from __dbt__CTE__orders as o
JOIN __dbt__CTE__lineitem as l
ON o.orderkey=l.orderkey
)/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  avg(totalprice) as average_order_price,
        
  
    width_bucket(average_order_price, 184000, 200000, 10 )

 as price_histogram,
        orderdate
from __dbt__CTE__orders_lineitem
group by orderdate
      );
2020-06-30 03:05:32.442241 (Thread-1): SQL status: SUCCESS 1 in 2.61 seconds
2020-06-30 03:05:32.443593 (Thread-1): On model.sample_project.average_price_per_order: COMMIT
2020-06-30 03:05:32.443801 (Thread-1): Using snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 03:05:32.443938 (Thread-1): On model.sample_project.average_price_per_order: COMMIT
2020-06-30 03:05:32.678101 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2020-06-30 03:05:32.680875 (Thread-1): finished collecting timing info
2020-06-30 03:05:32.681639 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '071042b3-66e0-4689-b194-c16f76e3cbe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115860310>]}
2020-06-30 03:05:32.682978 (Thread-1): 22:05:32 | 2 of 2 OK created table model TEST.average_price_per_order........... [SUCCESS 1 in 3.07s]
2020-06-30 03:05:32.683149 (Thread-1): Finished running node model.sample_project.average_price_per_order
2020-06-30 03:05:32.683315 (Thread-1): Began running node model.sample_project.cust_list_ord_nat
2020-06-30 03:05:32.683712 (Thread-1): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 03:05:32.683842 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.average_price_per_order).
2020-06-30 03:05:32.683958 (Thread-1): Compiling model.sample_project.cust_list_ord_nat
2020-06-30 03:05:32.707979 (Thread-1): Writing injected SQL for node "model.sample_project.cust_list_ord_nat"
2020-06-30 03:05:32.710610 (Thread-1): finished collecting timing info
2020-06-30 03:05:32.711363 (Thread-1): Finished running node model.sample_project.cust_list_ord_nat
2020-06-30 03:05:32.810259 (MainThread): Using snowflake connection "master".
2020-06-30 03:05:32.810421 (MainThread): On master: BEGIN
2020-06-30 03:05:33.095561 (MainThread): SQL status: SUCCESS 1 in 0.29 seconds
2020-06-30 03:05:33.095826 (MainThread): On master: COMMIT
2020-06-30 03:05:33.096013 (MainThread): Using snowflake connection "master".
2020-06-30 03:05:33.096139 (MainThread): On master: COMMIT
2020-06-30 03:05:33.362049 (MainThread): SQL status: SUCCESS 1 in 0.27 seconds
2020-06-30 03:05:33.362494 (MainThread): 22:05:33 | 
2020-06-30 03:05:33.362656 (MainThread): 22:05:33 | Finished running 2 table models in 20.14s.
2020-06-30 03:05:33.362794 (MainThread): Connection 'master' was left open.
2020-06-30 03:05:33.362901 (MainThread): On master: Close
2020-06-30 03:05:33.713384 (MainThread): Connection 'model.sample_project.cust_list_ord_nat' was left open.
2020-06-30 03:05:33.713564 (MainThread): On model.sample_project.cust_list_ord_nat: Close
2020-06-30 03:05:33.971593 (MainThread): 
2020-06-30 03:05:33.971788 (MainThread): Completed successfully
2020-06-30 03:05:33.971935 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2020-06-30 03:05:33.972136 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1159db750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11585c210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113470fd0>]}
2020-06-30 03:05:33.972356 (MainThread): Flushing usage events
2020-06-30 03:11:20.101021 (MainThread): Running with dbt=0.17.0
2020-06-30 03:11:20.601404 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-06-30 03:11:20.602101 (MainThread): Tracking: tracking
2020-06-30 03:11:20.602395 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e57890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e74a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e74950>]}
2020-06-30 03:11:20.625761 (MainThread): Partial parsing not enabled
2020-06-30 03:11:20.628101 (MainThread): Parsing macros/core.sql
2020-06-30 03:11:20.636358 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-30 03:11:20.646452 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-30 03:11:20.648861 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-30 03:11:20.670168 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-30 03:11:20.706264 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-30 03:11:20.731455 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-30 03:11:20.734186 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-30 03:11:20.742663 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-30 03:11:20.758340 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-30 03:11:20.765813 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-30 03:11:20.772870 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-30 03:11:20.779280 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-30 03:11:20.780479 (MainThread): Parsing macros/etc/query.sql
2020-06-30 03:11:20.781867 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-30 03:11:20.784104 (MainThread): Parsing macros/etc/datetime.sql
2020-06-30 03:11:20.795677 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-30 03:11:20.799432 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-30 03:11:20.801620 (MainThread): Parsing macros/adapters/common.sql
2020-06-30 03:11:20.865656 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-30 03:11:20.867529 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-30 03:11:20.868845 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-30 03:11:20.870146 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-30 03:11:20.873029 (MainThread): Parsing macros/catalog.sql
2020-06-30 03:11:20.875391 (MainThread): Parsing macros/adapters.sql
2020-06-30 03:11:20.900753 (MainThread): Parsing macros/materializations/merge.sql
2020-06-30 03:11:20.903278 (MainThread): Parsing macros/materializations/view.sql
2020-06-30 03:11:20.904822 (MainThread): Parsing macros/materializations/table.sql
2020-06-30 03:11:20.909485 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-30 03:11:20.952002 (MainThread): Partial parsing not enabled
2020-06-30 03:11:20.954306 (MainThread): Parsing macros/cross_db_utils/except.sql
2020-06-30 03:11:20.956395 (MainThread): Parsing macros/cross_db_utils/replace.sql
2020-06-30 03:11:20.958110 (MainThread): Parsing macros/cross_db_utils/concat.sql
2020-06-30 03:11:20.960814 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2020-06-30 03:11:20.967379 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2020-06-30 03:11:20.968993 (MainThread): Parsing macros/cross_db_utils/length.sql
2020-06-30 03:11:20.970688 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2020-06-30 03:11:20.974032 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2020-06-30 03:11:20.975590 (MainThread): Parsing macros/cross_db_utils/right.sql
2020-06-30 03:11:20.978443 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2020-06-30 03:11:20.989491 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2020-06-30 03:11:20.991680 (MainThread): Parsing macros/cross_db_utils/hash.sql
2020-06-30 03:11:20.993802 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2020-06-30 03:11:20.995557 (MainThread): Parsing macros/cross_db_utils/position.sql
2020-06-30 03:11:20.997463 (MainThread): Parsing macros/cross_db_utils/literal.sql
2020-06-30 03:11:20.998809 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2020-06-30 03:11:21.002830 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2020-06-30 03:11:21.009658 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2020-06-30 03:11:21.013287 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2020-06-30 03:11:21.015963 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2020-06-30 03:11:21.018097 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2020-06-30 03:11:21.045783 (MainThread): Parsing macros/logger/pretty_log_format.sql
2020-06-30 03:11:21.046757 (MainThread): Parsing macros/logger/pretty_time.sql
2020-06-30 03:11:21.047807 (MainThread): Parsing macros/logger/log_info.sql
2020-06-30 03:11:21.048743 (MainThread): Parsing macros/datetime/date_spine.sql
2020-06-30 03:11:21.052866 (MainThread): Parsing macros/web/get_url_host.sql
2020-06-30 03:11:21.055293 (MainThread): Parsing macros/web/get_url_path.sql
2020-06-30 03:11:21.058299 (MainThread): Parsing macros/web/get_url_parameter.sql
2020-06-30 03:11:21.059910 (MainThread): Parsing macros/geo/haversine_distance.sql
2020-06-30 03:11:21.061293 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2020-06-30 03:11:21.063119 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2020-06-30 03:11:21.065854 (MainThread): Parsing macros/schema_tests/recency.sql
2020-06-30 03:11:21.067625 (MainThread): Parsing macros/schema_tests/not_constant.sql
2020-06-30 03:11:21.069089 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2020-06-30 03:11:21.070463 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2020-06-30 03:11:21.071991 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2020-06-30 03:11:21.073870 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2020-06-30 03:11:21.075421 (MainThread): Parsing macros/schema_tests/equality.sql
2020-06-30 03:11:21.079212 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2020-06-30 03:11:21.086288 (MainThread): Parsing macros/sql/nullcheck_table.sql
2020-06-30 03:11:21.087858 (MainThread): Parsing macros/sql/generate_series.sql
2020-06-30 03:11:21.091585 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2020-06-30 03:11:21.095934 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2020-06-30 03:11:21.098982 (MainThread): Parsing macros/sql/star.sql
2020-06-30 03:11:21.102117 (MainThread): Parsing macros/sql/unpivot.sql
2020-06-30 03:11:21.109461 (MainThread): Parsing macros/sql/union.sql
2020-06-30 03:11:21.119413 (MainThread): Parsing macros/sql/groupby.sql
2020-06-30 03:11:21.120787 (MainThread): Parsing macros/sql/surrogate_key.sql
2020-06-30 03:11:21.124216 (MainThread): Parsing macros/sql/safe_add.sql
2020-06-30 03:11:21.125750 (MainThread): Parsing macros/sql/nullcheck.sql
2020-06-30 03:11:21.127338 (MainThread): Parsing macros/sql/get_column_values.sql
2020-06-30 03:11:21.132947 (MainThread): Parsing macros/sql/pivot.sql
2020-06-30 03:11:21.135995 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2020-06-30 03:11:21.190332 (MainThread): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 03:11:21.190519 (MainThread): Opening a new connection, currently in state init
2020-06-30 03:11:21.224154 (MainThread): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 03:11:21.224285 (MainThread): Opening a new connection, currently in state init
2020-06-30 03:11:21.236923 (MainThread): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 03:11:21.237049 (MainThread): Opening a new connection, currently in state init
2020-06-30 03:11:21.249292 (MainThread): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 03:11:21.249425 (MainThread): Opening a new connection, currently in state init
2020-06-30 03:11:21.262942 (MainThread): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 03:11:21.263073 (MainThread): Opening a new connection, currently in state init
2020-06-30 03:11:21.277895 (MainThread): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 03:11:21.278011 (MainThread): Opening a new connection, currently in state init
2020-06-30 03:11:21.291003 (MainThread): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 03:11:21.291116 (MainThread): Opening a new connection, currently in state init
2020-06-30 03:11:21.305020 (MainThread): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 03:11:21.305155 (MainThread): Opening a new connection, currently in state init
2020-06-30 03:11:21.317766 (MainThread): Acquiring new snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 03:11:21.317871 (MainThread): Opening a new connection, currently in state init
2020-06-30 03:11:21.811206 (MainThread): Found 9 models, 8 tests, 0 snapshots, 0 analyses, 263 macros, 0 operations, 0 seed files, 4 sources
2020-06-30 03:11:21.812789 (MainThread): 
2020-06-30 03:11:21.813077 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 03:11:21.813165 (MainThread): Opening a new connection, currently in state init
2020-06-30 03:11:21.815844 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_JAVEN_TESTING".
2020-06-30 03:11:21.815953 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-06-30 03:11:21.835789 (ThreadPoolExecutor-0_0): Using snowflake connection "list_JAVEN_TESTING".
2020-06-30 03:11:21.835986 (ThreadPoolExecutor-0_0): On list_JAVEN_TESTING: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING"} */

    show terse schemas in database JAVEN_TESTING
    limit 10000
2020-06-30 03:11:22.391037 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/certifi/cacert.pem'>
2020-06-30 03:11:27.842540 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 6.01 seconds
2020-06-30 03:11:27.875369 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 03:11:27.875565 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_JAVEN_TESTING).
2020-06-30 03:11:27.882618 (ThreadPoolExecutor-1_0): Using snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 03:11:27.882728 (ThreadPoolExecutor-1_0): On list_JAVEN_TESTING_TEST: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING_TEST"} */

    show terse objects in JAVEN_TESTING.TEST
2020-06-30 03:11:28.086075 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 0.20 seconds
2020-06-30 03:11:28.097235 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 03:11:28.097375 (MainThread): Opening a new connection, currently in state init
2020-06-30 03:11:28.097574 (MainThread): Using snowflake connection "master".
2020-06-30 03:11:28.097684 (MainThread): On master: BEGIN
2020-06-30 03:11:33.125495 (MainThread): SQL status: SUCCESS 1 in 5.03 seconds
2020-06-30 03:11:33.125712 (MainThread): On master: COMMIT
2020-06-30 03:11:33.125879 (MainThread): Using snowflake connection "master".
2020-06-30 03:11:33.125991 (MainThread): On master: COMMIT
2020-06-30 03:11:33.395288 (MainThread): SQL status: SUCCESS 1 in 0.27 seconds
2020-06-30 03:11:33.395696 (MainThread): 22:11:33 | Concurrency: 1 threads (target='dev')
2020-06-30 03:11:33.395862 (MainThread): 22:11:33 | 
2020-06-30 03:11:33.397579 (Thread-1): Began running node model.sample_project.customer
2020-06-30 03:11:33.398289 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 03:11:33.398455 (Thread-1): Re-using an available connection from the pool (formerly list_JAVEN_TESTING_TEST).
2020-06-30 03:11:33.398588 (Thread-1): Compiling model.sample_project.customer
2020-06-30 03:11:33.426639 (Thread-1): Writing injected SQL for node "model.sample_project.customer"
2020-06-30 03:11:33.427284 (Thread-1): finished collecting timing info
2020-06-30 03:11:33.428796 (Thread-1): Finished running node model.sample_project.customer
2020-06-30 03:11:33.429272 (Thread-1): Began running node model.sample_project.lineitem
2020-06-30 03:11:33.430372 (Thread-1): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 03:11:33.430816 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer).
2020-06-30 03:11:33.431018 (Thread-1): Compiling model.sample_project.lineitem
2020-06-30 03:11:33.441377 (Thread-1): Writing injected SQL for node "model.sample_project.lineitem"
2020-06-30 03:11:33.441850 (Thread-1): finished collecting timing info
2020-06-30 03:11:33.442369 (Thread-1): Finished running node model.sample_project.lineitem
2020-06-30 03:11:33.442540 (Thread-1): Began running node model.sample_project.nation
2020-06-30 03:11:33.442949 (Thread-1): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 03:11:33.443082 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.lineitem).
2020-06-30 03:11:33.443198 (Thread-1): Compiling model.sample_project.nation
2020-06-30 03:11:33.453015 (Thread-1): Writing injected SQL for node "model.sample_project.nation"
2020-06-30 03:11:33.453420 (Thread-1): finished collecting timing info
2020-06-30 03:11:33.453881 (Thread-1): Finished running node model.sample_project.nation
2020-06-30 03:11:33.454038 (Thread-1): Began running node model.sample_project.orders
2020-06-30 03:11:33.454510 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 03:11:33.454643 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.nation).
2020-06-30 03:11:33.454751 (Thread-1): Compiling model.sample_project.orders
2020-06-30 03:11:33.463478 (Thread-1): Writing injected SQL for node "model.sample_project.orders"
2020-06-30 03:11:33.463827 (Thread-1): finished collecting timing info
2020-06-30 03:11:33.464232 (Thread-1): Finished running node model.sample_project.orders
2020-06-30 03:11:33.464377 (Thread-1): Began running node model.sample_project.customer_nation
2020-06-30 03:11:33.464629 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 03:11:33.464729 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders).
2020-06-30 03:11:33.464823 (Thread-1): Compiling model.sample_project.customer_nation
2020-06-30 03:11:33.476743 (Thread-1): Writing injected SQL for node "model.sample_project.customer_nation"
2020-06-30 03:11:33.477119 (Thread-1): finished collecting timing info
2020-06-30 03:11:33.477531 (Thread-1): Finished running node model.sample_project.customer_nation
2020-06-30 03:11:33.477670 (Thread-1): Began running node model.sample_project.orders_lineitem
2020-06-30 03:11:33.477920 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 03:11:33.478017 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer_nation).
2020-06-30 03:11:33.478109 (Thread-1): Compiling model.sample_project.orders_lineitem
2020-06-30 03:11:33.490924 (Thread-1): Writing injected SQL for node "model.sample_project.orders_lineitem"
2020-06-30 03:11:33.491319 (Thread-1): finished collecting timing info
2020-06-30 03:11:33.491748 (Thread-1): Finished running node model.sample_project.orders_lineitem
2020-06-30 03:11:33.491892 (Thread-1): Began running node model.sample_project.customers_per_nation
2020-06-30 03:11:33.492893 (Thread-1): 22:11:33 | 1 of 2 START table model TEST.customers_per_nation................... [RUN]
2020-06-30 03:11:33.493351 (Thread-1): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 03:11:33.493489 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders_lineitem).
2020-06-30 03:11:33.493606 (Thread-1): Compiling model.sample_project.customers_per_nation
2020-06-30 03:11:33.506084 (Thread-1): Writing injected SQL for node "model.sample_project.customers_per_nation"
2020-06-30 03:11:33.506872 (Thread-1): finished collecting timing info
2020-06-30 03:11:33.543339 (Thread-1): Writing runtime SQL for node "model.sample_project.customers_per_nation"
2020-06-30 03:11:33.545450 (Thread-1): Using snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 03:11:33.545562 (Thread-1): On model.sample_project.customers_per_nation: BEGIN
2020-06-30 03:11:33.765972 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2020-06-30 03:11:33.766168 (Thread-1): Using snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 03:11:33.766286 (Thread-1): On model.sample_project.customers_per_nation: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "model.sample_project.customers_per_nation"} */


      create or replace transient table JAVEN_TESTING.TEST.customers_per_nation  as
      (with __dbt__CTE__customer as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  c_custkey as custkey,
        c_nationkey as nationkey,
        c_name as name
from snowflake_sample_data.tpch_sf1.customer
),  __dbt__CTE__nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  n_nationkey as nationkey,
        n_name as name
from snowflake_sample_data.tpch_sf1.nation
),  __dbt__CTE__customer_nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  c.custkey,
        c.nationkey,
        c.name as customer_name,
        n.name as nation_name
from __dbt__CTE__customer as c
JOIN __dbt__CTE__nation as n
ON c.nationkey=n.nationkey
)/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  count(customer_name) as customer_count,
        nation_name
from __dbt__CTE__customer_nation
group by nation_name
order by nation_name
      );
2020-06-30 03:11:36.372471 (Thread-1): SQL status: SUCCESS 1 in 2.61 seconds
2020-06-30 03:11:36.373887 (Thread-1): On model.sample_project.customers_per_nation: COMMIT
2020-06-30 03:11:36.374089 (Thread-1): Using snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 03:11:36.374221 (Thread-1): On model.sample_project.customers_per_nation: COMMIT
2020-06-30 03:11:36.562761 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2020-06-30 03:11:36.573918 (Thread-1): finished collecting timing info
2020-06-30 03:11:36.574671 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '139f68c5-efac-4f1c-9ab1-4221ea8d86d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a5c850>]}
2020-06-30 03:11:36.575891 (Thread-1): 22:11:36 | 1 of 2 OK created table model TEST.customers_per_nation.............. [SUCCESS 1 in 3.08s]
2020-06-30 03:11:36.576072 (Thread-1): Finished running node model.sample_project.customers_per_nation
2020-06-30 03:11:36.576235 (Thread-1): Began running node model.sample_project.average_price_per_order
2020-06-30 03:11:36.577381 (Thread-1): 22:11:36 | 2 of 2 START table model TEST.average_price_per_order................ [RUN]
2020-06-30 03:11:36.577849 (Thread-1): Acquiring new snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 03:11:36.577973 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customers_per_nation).
2020-06-30 03:11:36.578087 (Thread-1): Compiling model.sample_project.average_price_per_order
2020-06-30 03:11:36.594583 (Thread-1): Writing injected SQL for node "model.sample_project.average_price_per_order"
2020-06-30 03:11:36.595456 (Thread-1): finished collecting timing info
2020-06-30 03:11:36.600877 (Thread-1): Writing runtime SQL for node "model.sample_project.average_price_per_order"
2020-06-30 03:11:36.604065 (Thread-1): Using snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 03:11:36.605015 (Thread-1): On model.sample_project.average_price_per_order: BEGIN
2020-06-30 03:11:36.851748 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2020-06-30 03:11:36.851985 (Thread-1): Using snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 03:11:36.852121 (Thread-1): On model.sample_project.average_price_per_order: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "model.sample_project.average_price_per_order"} */


      create or replace transient table JAVEN_TESTING.TEST.average_price_per_order  as
      (with __dbt__CTE__orders as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  o_orderkey as orderkey,
        o_custkey as custkey,
        o_totalprice as totalprice,
        o_orderdate as orderdate
from snowflake_sample_data.tpch_sf1.orders
),  __dbt__CTE__lineitem as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  l_orderkey as orderkey,
        l_extendedprice as extendedprice,
        l_discount as discount,
        l_tax as tax,
        l_quantity as quantity
from snowflake_sample_data.tpch_sf1.lineitem
),  __dbt__CTE__orders_lineitem as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  o.orderkey,
        o.custkey,
        o.totalprice,
        o.orderdate,
        l.extendedprice,
        l.discount,
        l.tax,
        l.quantity
from __dbt__CTE__orders as o
JOIN __dbt__CTE__lineitem as l
ON o.orderkey=l.orderkey
)/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  avg(totalprice) as average_order_price,
        sum(quantity) as total_quantity_per_order,
        listagg(quantity) as quantities_per_order,
        count(quantity) as items_per_order,
        
  
    width_bucket(average_order_price, 184000, 200000, 10 )

 as price_histogram,
        orderdate
from __dbt__CTE__orders_lineitem
group by orderdate
      );
2020-06-30 03:11:39.395007 (Thread-1): SQL status: SUCCESS 1 in 2.54 seconds
2020-06-30 03:11:39.396337 (Thread-1): On model.sample_project.average_price_per_order: COMMIT
2020-06-30 03:11:39.396544 (Thread-1): Using snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 03:11:39.396682 (Thread-1): On model.sample_project.average_price_per_order: COMMIT
2020-06-30 03:11:39.580390 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2020-06-30 03:11:39.582870 (Thread-1): finished collecting timing info
2020-06-30 03:11:39.583632 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '139f68c5-efac-4f1c-9ab1-4221ea8d86d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a75090>]}
2020-06-30 03:11:39.584951 (Thread-1): 22:11:39 | 2 of 2 OK created table model TEST.average_price_per_order........... [SUCCESS 1 in 3.01s]
2020-06-30 03:11:39.585120 (Thread-1): Finished running node model.sample_project.average_price_per_order
2020-06-30 03:11:39.585290 (Thread-1): Began running node model.sample_project.cust_list_ord_nat
2020-06-30 03:11:39.585604 (Thread-1): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 03:11:39.585726 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.average_price_per_order).
2020-06-30 03:11:39.585843 (Thread-1): Compiling model.sample_project.cust_list_ord_nat
2020-06-30 03:11:39.605281 (Thread-1): Writing injected SQL for node "model.sample_project.cust_list_ord_nat"
2020-06-30 03:11:39.606384 (Thread-1): finished collecting timing info
2020-06-30 03:11:39.607181 (Thread-1): Finished running node model.sample_project.cust_list_ord_nat
2020-06-30 03:11:39.670218 (MainThread): Using snowflake connection "master".
2020-06-30 03:11:39.670455 (MainThread): On master: BEGIN
2020-06-30 03:11:39.911511 (MainThread): SQL status: SUCCESS 1 in 0.24 seconds
2020-06-30 03:11:39.911810 (MainThread): On master: COMMIT
2020-06-30 03:11:39.911998 (MainThread): Using snowflake connection "master".
2020-06-30 03:11:39.912124 (MainThread): On master: COMMIT
2020-06-30 03:11:40.265462 (MainThread): SQL status: SUCCESS 1 in 0.35 seconds
2020-06-30 03:11:40.265977 (MainThread): 22:11:40 | 
2020-06-30 03:11:40.266165 (MainThread): 22:11:40 | Finished running 2 table models in 18.45s.
2020-06-30 03:11:40.266324 (MainThread): Connection 'master' was left open.
2020-06-30 03:11:40.266449 (MainThread): On master: Close
2020-06-30 03:11:40.500095 (MainThread): Connection 'model.sample_project.cust_list_ord_nat' was left open.
2020-06-30 03:11:40.500251 (MainThread): On model.sample_project.cust_list_ord_nat: Close
2020-06-30 03:11:40.772126 (MainThread): 
2020-06-30 03:11:40.772298 (MainThread): Completed successfully
2020-06-30 03:11:40.772416 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2020-06-30 03:11:40.772586 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109940e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b246d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10972f250>]}
2020-06-30 03:11:40.772769 (MainThread): Flushing usage events
2020-06-30 03:13:48.436218 (MainThread): Running with dbt=0.17.0
2020-06-30 03:13:48.905433 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-06-30 03:13:48.906491 (MainThread): Tracking: tracking
2020-06-30 03:13:48.906874 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d048b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0488d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d06c050>]}
2020-06-30 03:13:48.931039 (MainThread): Partial parsing not enabled
2020-06-30 03:13:48.933390 (MainThread): Parsing macros/core.sql
2020-06-30 03:13:48.940056 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-30 03:13:48.949627 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-30 03:13:48.951717 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-30 03:13:48.977127 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-30 03:13:49.013698 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-30 03:13:49.040801 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-30 03:13:49.043070 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-30 03:13:49.051284 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-30 03:13:49.068231 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-30 03:13:49.077224 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-30 03:13:49.086678 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-30 03:13:49.093098 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-30 03:13:49.094469 (MainThread): Parsing macros/etc/query.sql
2020-06-30 03:13:49.095787 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-30 03:13:49.097782 (MainThread): Parsing macros/etc/datetime.sql
2020-06-30 03:13:49.110265 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-30 03:13:49.112687 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-30 03:13:49.115546 (MainThread): Parsing macros/adapters/common.sql
2020-06-30 03:13:49.183176 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-30 03:13:49.186055 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-30 03:13:49.188684 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-30 03:13:49.191267 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-30 03:13:49.195946 (MainThread): Parsing macros/catalog.sql
2020-06-30 03:13:49.198510 (MainThread): Parsing macros/adapters.sql
2020-06-30 03:13:49.227435 (MainThread): Parsing macros/materializations/merge.sql
2020-06-30 03:13:49.230192 (MainThread): Parsing macros/materializations/view.sql
2020-06-30 03:13:49.231878 (MainThread): Parsing macros/materializations/table.sql
2020-06-30 03:13:49.237067 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-30 03:13:49.286308 (MainThread): Partial parsing not enabled
2020-06-30 03:13:49.288840 (MainThread): Parsing macros/cross_db_utils/except.sql
2020-06-30 03:13:49.290562 (MainThread): Parsing macros/cross_db_utils/replace.sql
2020-06-30 03:13:49.292328 (MainThread): Parsing macros/cross_db_utils/concat.sql
2020-06-30 03:13:49.295279 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2020-06-30 03:13:49.303100 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2020-06-30 03:13:49.304938 (MainThread): Parsing macros/cross_db_utils/length.sql
2020-06-30 03:13:49.307194 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2020-06-30 03:13:49.310507 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2020-06-30 03:13:49.312006 (MainThread): Parsing macros/cross_db_utils/right.sql
2020-06-30 03:13:49.315008 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2020-06-30 03:13:49.327795 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2020-06-30 03:13:49.330123 (MainThread): Parsing macros/cross_db_utils/hash.sql
2020-06-30 03:13:49.331887 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2020-06-30 03:13:49.333706 (MainThread): Parsing macros/cross_db_utils/position.sql
2020-06-30 03:13:49.336052 (MainThread): Parsing macros/cross_db_utils/literal.sql
2020-06-30 03:13:49.337312 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2020-06-30 03:13:49.342412 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2020-06-30 03:13:49.348501 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2020-06-30 03:13:49.353925 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2020-06-30 03:13:49.356740 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2020-06-30 03:13:49.359008 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2020-06-30 03:13:49.393114 (MainThread): Parsing macros/logger/pretty_log_format.sql
2020-06-30 03:13:49.394158 (MainThread): Parsing macros/logger/pretty_time.sql
2020-06-30 03:13:49.395507 (MainThread): Parsing macros/logger/log_info.sql
2020-06-30 03:13:49.396514 (MainThread): Parsing macros/datetime/date_spine.sql
2020-06-30 03:13:49.400914 (MainThread): Parsing macros/web/get_url_host.sql
2020-06-30 03:13:49.403784 (MainThread): Parsing macros/web/get_url_path.sql
2020-06-30 03:13:49.407119 (MainThread): Parsing macros/web/get_url_parameter.sql
2020-06-30 03:13:49.408878 (MainThread): Parsing macros/geo/haversine_distance.sql
2020-06-30 03:13:49.410043 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2020-06-30 03:13:49.411633 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2020-06-30 03:13:49.414202 (MainThread): Parsing macros/schema_tests/recency.sql
2020-06-30 03:13:49.415720 (MainThread): Parsing macros/schema_tests/not_constant.sql
2020-06-30 03:13:49.417344 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2020-06-30 03:13:49.419351 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2020-06-30 03:13:49.421342 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2020-06-30 03:13:49.423527 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2020-06-30 03:13:49.425142 (MainThread): Parsing macros/schema_tests/equality.sql
2020-06-30 03:13:49.428646 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2020-06-30 03:13:49.435708 (MainThread): Parsing macros/sql/nullcheck_table.sql
2020-06-30 03:13:49.437396 (MainThread): Parsing macros/sql/generate_series.sql
2020-06-30 03:13:49.442753 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2020-06-30 03:13:49.447275 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2020-06-30 03:13:49.450835 (MainThread): Parsing macros/sql/star.sql
2020-06-30 03:13:49.454938 (MainThread): Parsing macros/sql/unpivot.sql
2020-06-30 03:13:49.463428 (MainThread): Parsing macros/sql/union.sql
2020-06-30 03:13:49.477047 (MainThread): Parsing macros/sql/groupby.sql
2020-06-30 03:13:49.480134 (MainThread): Parsing macros/sql/surrogate_key.sql
2020-06-30 03:13:49.484033 (MainThread): Parsing macros/sql/safe_add.sql
2020-06-30 03:13:49.485771 (MainThread): Parsing macros/sql/nullcheck.sql
2020-06-30 03:13:49.487801 (MainThread): Parsing macros/sql/get_column_values.sql
2020-06-30 03:13:49.493696 (MainThread): Parsing macros/sql/pivot.sql
2020-06-30 03:13:49.497158 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2020-06-30 03:13:49.549509 (MainThread): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 03:13:49.549660 (MainThread): Opening a new connection, currently in state init
2020-06-30 03:13:49.586836 (MainThread): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 03:13:49.586985 (MainThread): Opening a new connection, currently in state init
2020-06-30 03:13:49.601211 (MainThread): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 03:13:49.601347 (MainThread): Opening a new connection, currently in state init
2020-06-30 03:13:49.615749 (MainThread): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 03:13:49.615897 (MainThread): Opening a new connection, currently in state init
2020-06-30 03:13:49.630774 (MainThread): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 03:13:49.631005 (MainThread): Opening a new connection, currently in state init
2020-06-30 03:13:49.648144 (MainThread): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 03:13:49.648288 (MainThread): Opening a new connection, currently in state init
2020-06-30 03:13:49.663515 (MainThread): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 03:13:49.663653 (MainThread): Opening a new connection, currently in state init
2020-06-30 03:13:49.679150 (MainThread): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 03:13:49.679281 (MainThread): Opening a new connection, currently in state init
2020-06-30 03:13:49.693339 (MainThread): Acquiring new snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 03:13:49.693473 (MainThread): Opening a new connection, currently in state init
2020-06-30 03:13:50.177533 (MainThread): Found 9 models, 8 tests, 0 snapshots, 0 analyses, 263 macros, 0 operations, 0 seed files, 4 sources
2020-06-30 03:13:50.178852 (MainThread): 
2020-06-30 03:13:50.179117 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 03:13:50.179200 (MainThread): Opening a new connection, currently in state init
2020-06-30 03:13:50.182183 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_JAVEN_TESTING".
2020-06-30 03:13:50.182286 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-06-30 03:13:50.195512 (ThreadPoolExecutor-0_0): Using snowflake connection "list_JAVEN_TESTING".
2020-06-30 03:13:50.195659 (ThreadPoolExecutor-0_0): On list_JAVEN_TESTING: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING"} */

    show terse schemas in database JAVEN_TESTING
    limit 10000
2020-06-30 03:13:52.323349 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/certifi/cacert.pem'>
2020-06-30 03:14:04.473737 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 14.28 seconds
2020-06-30 03:14:04.507195 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 03:14:04.507428 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_JAVEN_TESTING).
2020-06-30 03:14:04.514493 (ThreadPoolExecutor-1_0): Using snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 03:14:04.514605 (ThreadPoolExecutor-1_0): On list_JAVEN_TESTING_TEST: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING_TEST"} */

    show terse objects in JAVEN_TESTING.TEST
2020-06-30 03:14:04.714763 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 0.20 seconds
2020-06-30 03:14:04.725079 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 03:14:04.725252 (MainThread): Opening a new connection, currently in state init
2020-06-30 03:14:04.725449 (MainThread): Using snowflake connection "master".
2020-06-30 03:14:04.725557 (MainThread): On master: BEGIN
2020-06-30 03:14:09.943622 (MainThread): SQL status: SUCCESS 1 in 5.22 seconds
2020-06-30 03:14:09.943812 (MainThread): On master: COMMIT
2020-06-30 03:14:09.943954 (MainThread): Using snowflake connection "master".
2020-06-30 03:14:09.944056 (MainThread): On master: COMMIT
2020-06-30 03:14:10.384319 (MainThread): SQL status: SUCCESS 1 in 0.44 seconds
2020-06-30 03:14:10.384768 (MainThread): 22:14:10 | Concurrency: 1 threads (target='dev')
2020-06-30 03:14:10.384978 (MainThread): 22:14:10 | 
2020-06-30 03:14:10.386105 (Thread-1): Began running node model.sample_project.customer
2020-06-30 03:14:10.386509 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 03:14:10.386652 (Thread-1): Re-using an available connection from the pool (formerly list_JAVEN_TESTING_TEST).
2020-06-30 03:14:10.386782 (Thread-1): Compiling model.sample_project.customer
2020-06-30 03:14:10.411481 (Thread-1): Writing injected SQL for node "model.sample_project.customer"
2020-06-30 03:14:10.412054 (Thread-1): finished collecting timing info
2020-06-30 03:14:10.412710 (Thread-1): Finished running node model.sample_project.customer
2020-06-30 03:14:10.412934 (Thread-1): Began running node model.sample_project.lineitem
2020-06-30 03:14:10.413514 (Thread-1): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 03:14:10.413661 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer).
2020-06-30 03:14:10.413785 (Thread-1): Compiling model.sample_project.lineitem
2020-06-30 03:14:10.425233 (Thread-1): Writing injected SQL for node "model.sample_project.lineitem"
2020-06-30 03:14:10.425732 (Thread-1): finished collecting timing info
2020-06-30 03:14:10.426309 (Thread-1): Finished running node model.sample_project.lineitem
2020-06-30 03:14:10.426494 (Thread-1): Began running node model.sample_project.nation
2020-06-30 03:14:10.426920 (Thread-1): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 03:14:10.427056 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.lineitem).
2020-06-30 03:14:10.427172 (Thread-1): Compiling model.sample_project.nation
2020-06-30 03:14:10.437644 (Thread-1): Writing injected SQL for node "model.sample_project.nation"
2020-06-30 03:14:10.439020 (Thread-1): finished collecting timing info
2020-06-30 03:14:10.439994 (Thread-1): Finished running node model.sample_project.nation
2020-06-30 03:14:10.440377 (Thread-1): Began running node model.sample_project.orders
2020-06-30 03:14:10.441128 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 03:14:10.441538 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.nation).
2020-06-30 03:14:10.441713 (Thread-1): Compiling model.sample_project.orders
2020-06-30 03:14:10.451590 (Thread-1): Writing injected SQL for node "model.sample_project.orders"
2020-06-30 03:14:10.452038 (Thread-1): finished collecting timing info
2020-06-30 03:14:10.452543 (Thread-1): Finished running node model.sample_project.orders
2020-06-30 03:14:10.452714 (Thread-1): Began running node model.sample_project.customer_nation
2020-06-30 03:14:10.453020 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 03:14:10.453141 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders).
2020-06-30 03:14:10.453252 (Thread-1): Compiling model.sample_project.customer_nation
2020-06-30 03:14:10.466264 (Thread-1): Writing injected SQL for node "model.sample_project.customer_nation"
2020-06-30 03:14:10.466674 (Thread-1): finished collecting timing info
2020-06-30 03:14:10.467088 (Thread-1): Finished running node model.sample_project.customer_nation
2020-06-30 03:14:10.467230 (Thread-1): Began running node model.sample_project.orders_lineitem
2020-06-30 03:14:10.467486 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 03:14:10.467588 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer_nation).
2020-06-30 03:14:10.467684 (Thread-1): Compiling model.sample_project.orders_lineitem
2020-06-30 03:14:10.480815 (Thread-1): Writing injected SQL for node "model.sample_project.orders_lineitem"
2020-06-30 03:14:10.481221 (Thread-1): finished collecting timing info
2020-06-30 03:14:10.481643 (Thread-1): Finished running node model.sample_project.orders_lineitem
2020-06-30 03:14:10.481782 (Thread-1): Began running node model.sample_project.customers_per_nation
2020-06-30 03:14:10.482763 (Thread-1): 22:14:10 | 1 of 2 START table model TEST.customers_per_nation................... [RUN]
2020-06-30 03:14:10.483215 (Thread-1): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 03:14:10.483334 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders_lineitem).
2020-06-30 03:14:10.483434 (Thread-1): Compiling model.sample_project.customers_per_nation
2020-06-30 03:14:10.492681 (Thread-1): Writing injected SQL for node "model.sample_project.customers_per_nation"
2020-06-30 03:14:10.493017 (Thread-1): finished collecting timing info
2020-06-30 03:14:10.534139 (Thread-1): Writing runtime SQL for node "model.sample_project.customers_per_nation"
2020-06-30 03:14:10.536772 (Thread-1): Using snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 03:14:10.536920 (Thread-1): On model.sample_project.customers_per_nation: BEGIN
2020-06-30 03:14:10.728433 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2020-06-30 03:14:10.728597 (Thread-1): Using snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 03:14:10.728691 (Thread-1): On model.sample_project.customers_per_nation: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "model.sample_project.customers_per_nation"} */


      create or replace transient table JAVEN_TESTING.TEST.customers_per_nation  as
      (with __dbt__CTE__customer as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  c_custkey as custkey,
        c_nationkey as nationkey,
        c_name as name
from snowflake_sample_data.tpch_sf1.customer
),  __dbt__CTE__nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  n_nationkey as nationkey,
        n_name as name
from snowflake_sample_data.tpch_sf1.nation
),  __dbt__CTE__customer_nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  c.custkey,
        c.nationkey,
        c.name as customer_name,
        n.name as nation_name
from __dbt__CTE__customer as c
JOIN __dbt__CTE__nation as n
ON c.nationkey=n.nationkey
)/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  count(customer_name) as customer_count,
        nation_name
from __dbt__CTE__customer_nation
group by nation_name
order by nation_name
      );
2020-06-30 03:14:12.811493 (Thread-1): SQL status: SUCCESS 1 in 2.08 seconds
2020-06-30 03:14:12.812667 (Thread-1): On model.sample_project.customers_per_nation: COMMIT
2020-06-30 03:14:12.812831 (Thread-1): Using snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 03:14:12.812936 (Thread-1): On model.sample_project.customers_per_nation: COMMIT
2020-06-30 03:14:12.972942 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2020-06-30 03:14:12.984460 (Thread-1): finished collecting timing info
2020-06-30 03:14:12.985229 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3531ff6b-faa2-42d4-8947-b0c155b82bfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f933510>]}
2020-06-30 03:14:12.986603 (Thread-1): 22:14:12 | 1 of 2 OK created table model TEST.customers_per_nation.............. [SUCCESS 1 in 2.50s]
2020-06-30 03:14:12.986767 (Thread-1): Finished running node model.sample_project.customers_per_nation
2020-06-30 03:14:12.986931 (Thread-1): Began running node model.sample_project.average_price_per_order
2020-06-30 03:14:12.988107 (Thread-1): 22:14:12 | 2 of 2 START table model TEST.average_price_per_order................ [RUN]
2020-06-30 03:14:12.988431 (Thread-1): Acquiring new snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 03:14:12.988546 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customers_per_nation).
2020-06-30 03:14:12.988658 (Thread-1): Compiling model.sample_project.average_price_per_order
2020-06-30 03:14:13.007571 (Thread-1): Writing injected SQL for node "model.sample_project.average_price_per_order"
2020-06-30 03:14:13.008099 (Thread-1): finished collecting timing info
2020-06-30 03:14:13.013832 (Thread-1): Writing runtime SQL for node "model.sample_project.average_price_per_order"
2020-06-30 03:14:13.016668 (Thread-1): Using snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 03:14:13.016784 (Thread-1): On model.sample_project.average_price_per_order: BEGIN
2020-06-30 03:14:13.220401 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2020-06-30 03:14:13.220568 (Thread-1): Using snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 03:14:13.220661 (Thread-1): On model.sample_project.average_price_per_order: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "model.sample_project.average_price_per_order"} */


      create or replace transient table JAVEN_TESTING.TEST.average_price_per_order  as
      (with __dbt__CTE__orders as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  o_orderkey as orderkey,
        o_custkey as custkey,
        o_totalprice as totalprice,
        o_orderdate as orderdate
from snowflake_sample_data.tpch_sf1.orders
),  __dbt__CTE__lineitem as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  l_orderkey as orderkey,
        l_extendedprice as extendedprice,
        l_discount as discount,
        l_tax as tax,
        l_quantity as quantity
from snowflake_sample_data.tpch_sf1.lineitem
),  __dbt__CTE__orders_lineitem as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  o.orderkey,
        o.custkey,
        o.totalprice,
        o.orderdate,
        l.extendedprice,
        l.discount,
        l.tax,
        l.quantity
from __dbt__CTE__orders as o
JOIN __dbt__CTE__lineitem as l
ON o.orderkey=l.orderkey
)/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  avg(totalprice) as average_order_price,
        sum(quantity) as total_quantity_per_order,
        listagg(quantity, '|~~|') as quantities_per_order,
        count(quantity) as items_per_order,
        
  
    width_bucket(average_order_price, 184000, 200000, 10 )

 as price_histogram,
        orderdate
from __dbt__CTE__orders_lineitem
group by orderdate
      );
2020-06-30 03:14:16.324646 (Thread-1): SQL status: SUCCESS 1 in 3.10 seconds
2020-06-30 03:14:16.325855 (Thread-1): On model.sample_project.average_price_per_order: COMMIT
2020-06-30 03:14:16.326041 (Thread-1): Using snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 03:14:16.326158 (Thread-1): On model.sample_project.average_price_per_order: COMMIT
2020-06-30 03:14:16.586961 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2020-06-30 03:14:16.589433 (Thread-1): finished collecting timing info
2020-06-30 03:14:16.590185 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3531ff6b-faa2-42d4-8947-b0c155b82bfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f947a10>]}
2020-06-30 03:14:16.591468 (Thread-1): 22:14:16 | 2 of 2 OK created table model TEST.average_price_per_order........... [SUCCESS 1 in 3.60s]
2020-06-30 03:14:16.591663 (Thread-1): Finished running node model.sample_project.average_price_per_order
2020-06-30 03:14:16.591819 (Thread-1): Began running node model.sample_project.cust_list_ord_nat
2020-06-30 03:14:16.592121 (Thread-1): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 03:14:16.592236 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.average_price_per_order).
2020-06-30 03:14:16.592344 (Thread-1): Compiling model.sample_project.cust_list_ord_nat
2020-06-30 03:14:16.611231 (Thread-1): Writing injected SQL for node "model.sample_project.cust_list_ord_nat"
2020-06-30 03:14:16.612136 (Thread-1): finished collecting timing info
2020-06-30 03:14:16.612898 (Thread-1): Finished running node model.sample_project.cust_list_ord_nat
2020-06-30 03:14:16.675627 (MainThread): Using snowflake connection "master".
2020-06-30 03:14:16.675816 (MainThread): On master: BEGIN
2020-06-30 03:14:16.860628 (MainThread): SQL status: SUCCESS 1 in 0.18 seconds
2020-06-30 03:14:16.860869 (MainThread): On master: COMMIT
2020-06-30 03:14:16.861063 (MainThread): Using snowflake connection "master".
2020-06-30 03:14:16.861191 (MainThread): On master: COMMIT
2020-06-30 03:14:17.293169 (MainThread): SQL status: SUCCESS 1 in 0.43 seconds
2020-06-30 03:14:17.293684 (MainThread): 22:14:17 | 
2020-06-30 03:14:17.293871 (MainThread): 22:14:17 | Finished running 2 table models in 27.11s.
2020-06-30 03:14:17.294024 (MainThread): Connection 'master' was left open.
2020-06-30 03:14:17.294147 (MainThread): On master: Close
2020-06-30 03:14:17.596166 (MainThread): Connection 'model.sample_project.cust_list_ord_nat' was left open.
2020-06-30 03:14:17.596344 (MainThread): On model.sample_project.cust_list_ord_nat: Close
2020-06-30 03:14:17.867655 (MainThread): 
2020-06-30 03:14:17.867831 (MainThread): Completed successfully
2020-06-30 03:14:17.867967 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2020-06-30 03:14:17.868148 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d790fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8f54d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8fa0d0>]}
2020-06-30 03:14:17.868340 (MainThread): Flushing usage events
2020-06-30 03:39:42.012153 (MainThread): Running with dbt=0.17.0
2020-06-30 03:39:42.503061 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-06-30 03:39:42.504025 (MainThread): Tracking: tracking
2020-06-30 03:39:42.504369 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11089d810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11089d890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eedf750>]}
2020-06-30 03:39:42.528499 (MainThread): Partial parsing not enabled
2020-06-30 03:39:42.530823 (MainThread): Parsing macros/core.sql
2020-06-30 03:39:42.536682 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-30 03:39:42.546971 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-30 03:39:42.551179 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-30 03:39:42.572743 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-30 03:39:42.607187 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-30 03:39:42.636857 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-30 03:39:42.639458 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-30 03:39:42.647227 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-30 03:39:42.665117 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-30 03:39:42.673424 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-30 03:39:42.680713 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-30 03:39:42.686191 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-30 03:39:42.687518 (MainThread): Parsing macros/etc/query.sql
2020-06-30 03:39:42.689254 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-30 03:39:42.691314 (MainThread): Parsing macros/etc/datetime.sql
2020-06-30 03:39:42.701489 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-30 03:39:42.703960 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-30 03:39:42.706090 (MainThread): Parsing macros/adapters/common.sql
2020-06-30 03:39:42.761488 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-30 03:39:42.762979 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-30 03:39:42.764488 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-30 03:39:42.765817 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-30 03:39:42.768454 (MainThread): Parsing macros/catalog.sql
2020-06-30 03:39:42.770765 (MainThread): Parsing macros/adapters.sql
2020-06-30 03:39:42.796018 (MainThread): Parsing macros/materializations/merge.sql
2020-06-30 03:39:42.798375 (MainThread): Parsing macros/materializations/view.sql
2020-06-30 03:39:42.799814 (MainThread): Parsing macros/materializations/table.sql
2020-06-30 03:39:42.805836 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-30 03:39:42.850289 (MainThread): Partial parsing not enabled
2020-06-30 03:39:42.852729 (MainThread): Parsing macros/cross_db_utils/except.sql
2020-06-30 03:39:42.854428 (MainThread): Parsing macros/cross_db_utils/replace.sql
2020-06-30 03:39:42.856082 (MainThread): Parsing macros/cross_db_utils/concat.sql
2020-06-30 03:39:42.858705 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2020-06-30 03:39:42.865786 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2020-06-30 03:39:42.868403 (MainThread): Parsing macros/cross_db_utils/length.sql
2020-06-30 03:39:42.870738 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2020-06-30 03:39:42.875594 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2020-06-30 03:39:42.877265 (MainThread): Parsing macros/cross_db_utils/right.sql
2020-06-30 03:39:42.880558 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2020-06-30 03:39:42.891678 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2020-06-30 03:39:42.894190 (MainThread): Parsing macros/cross_db_utils/hash.sql
2020-06-30 03:39:42.895970 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2020-06-30 03:39:42.897896 (MainThread): Parsing macros/cross_db_utils/position.sql
2020-06-30 03:39:42.900048 (MainThread): Parsing macros/cross_db_utils/literal.sql
2020-06-30 03:39:42.901357 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2020-06-30 03:39:42.905169 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2020-06-30 03:39:42.911738 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2020-06-30 03:39:42.916286 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2020-06-30 03:39:42.919385 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2020-06-30 03:39:42.921724 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2020-06-30 03:39:42.948859 (MainThread): Parsing macros/logger/pretty_log_format.sql
2020-06-30 03:39:42.949819 (MainThread): Parsing macros/logger/pretty_time.sql
2020-06-30 03:39:42.950823 (MainThread): Parsing macros/logger/log_info.sql
2020-06-30 03:39:42.951834 (MainThread): Parsing macros/datetime/date_spine.sql
2020-06-30 03:39:42.956436 (MainThread): Parsing macros/web/get_url_host.sql
2020-06-30 03:39:42.958180 (MainThread): Parsing macros/web/get_url_path.sql
2020-06-30 03:39:42.960912 (MainThread): Parsing macros/web/get_url_parameter.sql
2020-06-30 03:39:42.962300 (MainThread): Parsing macros/geo/haversine_distance.sql
2020-06-30 03:39:42.963584 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2020-06-30 03:39:42.966164 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2020-06-30 03:39:42.968757 (MainThread): Parsing macros/schema_tests/recency.sql
2020-06-30 03:39:42.970324 (MainThread): Parsing macros/schema_tests/not_constant.sql
2020-06-30 03:39:42.971638 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2020-06-30 03:39:42.973291 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2020-06-30 03:39:42.974856 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2020-06-30 03:39:42.977035 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2020-06-30 03:39:42.978400 (MainThread): Parsing macros/schema_tests/equality.sql
2020-06-30 03:39:42.981900 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2020-06-30 03:39:42.988684 (MainThread): Parsing macros/sql/nullcheck_table.sql
2020-06-30 03:39:42.990138 (MainThread): Parsing macros/sql/generate_series.sql
2020-06-30 03:39:42.994110 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2020-06-30 03:39:42.998374 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2020-06-30 03:39:43.001587 (MainThread): Parsing macros/sql/star.sql
2020-06-30 03:39:43.004789 (MainThread): Parsing macros/sql/unpivot.sql
2020-06-30 03:39:43.011888 (MainThread): Parsing macros/sql/union.sql
2020-06-30 03:39:43.023397 (MainThread): Parsing macros/sql/groupby.sql
2020-06-30 03:39:43.024778 (MainThread): Parsing macros/sql/surrogate_key.sql
2020-06-30 03:39:43.027825 (MainThread): Parsing macros/sql/safe_add.sql
2020-06-30 03:39:43.029545 (MainThread): Parsing macros/sql/nullcheck.sql
2020-06-30 03:39:43.031015 (MainThread): Parsing macros/sql/get_column_values.sql
2020-06-30 03:39:43.035618 (MainThread): Parsing macros/sql/pivot.sql
2020-06-30 03:39:43.038880 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2020-06-30 03:39:43.091258 (MainThread): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 03:39:43.091404 (MainThread): Opening a new connection, currently in state init
2020-06-30 03:39:43.126363 (MainThread): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 03:39:43.126506 (MainThread): Opening a new connection, currently in state init
2020-06-30 03:39:43.140825 (MainThread): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 03:39:43.140969 (MainThread): Opening a new connection, currently in state init
2020-06-30 03:39:43.154396 (MainThread): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 03:39:43.154519 (MainThread): Opening a new connection, currently in state init
2020-06-30 03:39:43.168704 (MainThread): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 03:39:43.168831 (MainThread): Opening a new connection, currently in state init
2020-06-30 03:39:43.182463 (MainThread): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 03:39:43.182566 (MainThread): Opening a new connection, currently in state init
2020-06-30 03:39:43.195864 (MainThread): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 03:39:43.195973 (MainThread): Opening a new connection, currently in state init
2020-06-30 03:39:43.210185 (MainThread): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 03:39:43.210308 (MainThread): Opening a new connection, currently in state init
2020-06-30 03:39:43.223832 (MainThread): Acquiring new snowflake connection "model.sample_project.sales_report_one".
2020-06-30 03:39:43.223946 (MainThread): Opening a new connection, currently in state init
2020-06-30 03:39:43.236417 (MainThread): Acquiring new snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 03:39:43.236554 (MainThread): Opening a new connection, currently in state init
2020-06-30 03:39:43.253862 (MainThread): Acquiring new snowflake connection "model.sample_project.sales_report_two".
2020-06-30 03:39:43.253982 (MainThread): Opening a new connection, currently in state init
2020-06-30 03:39:43.739029 (MainThread): Found 11 models, 8 tests, 0 snapshots, 0 analyses, 263 macros, 0 operations, 0 seed files, 4 sources
2020-06-30 03:39:43.740973 (MainThread): 
2020-06-30 03:39:43.741260 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 03:39:43.741383 (MainThread): Opening a new connection, currently in state init
2020-06-30 03:39:43.746900 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_JAVEN_TESTING".
2020-06-30 03:39:43.747006 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-06-30 03:39:43.765777 (ThreadPoolExecutor-0_0): Using snowflake connection "list_JAVEN_TESTING".
2020-06-30 03:39:43.765960 (ThreadPoolExecutor-0_0): On list_JAVEN_TESTING: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING"} */

    show terse schemas in database JAVEN_TESTING
    limit 10000
2020-06-30 03:39:44.304528 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/certifi/cacert.pem'>
2020-06-30 03:39:49.289511 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 5.52 seconds
2020-06-30 03:39:49.325454 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 03:39:49.325656 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_JAVEN_TESTING).
2020-06-30 03:39:49.332504 (ThreadPoolExecutor-1_0): Using snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 03:39:49.332615 (ThreadPoolExecutor-1_0): On list_JAVEN_TESTING_TEST: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING_TEST"} */

    show terse objects in JAVEN_TESTING.TEST
2020-06-30 03:39:49.546699 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 0.21 seconds
2020-06-30 03:39:49.557018 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 03:39:49.557166 (MainThread): Opening a new connection, currently in state init
2020-06-30 03:39:49.557363 (MainThread): Using snowflake connection "master".
2020-06-30 03:39:49.557473 (MainThread): On master: BEGIN
2020-06-30 03:39:54.943803 (MainThread): SQL status: SUCCESS 1 in 5.39 seconds
2020-06-30 03:39:54.944009 (MainThread): On master: COMMIT
2020-06-30 03:39:54.944166 (MainThread): Using snowflake connection "master".
2020-06-30 03:39:54.944273 (MainThread): On master: COMMIT
2020-06-30 03:39:55.218247 (MainThread): SQL status: SUCCESS 1 in 0.27 seconds
2020-06-30 03:39:55.218818 (MainThread): 22:39:55 | Concurrency: 1 threads (target='dev')
2020-06-30 03:39:55.219056 (MainThread): 22:39:55 | 
2020-06-30 03:39:55.220296 (Thread-1): Began running node model.sample_project.customer
2020-06-30 03:39:55.220723 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 03:39:55.220881 (Thread-1): Re-using an available connection from the pool (formerly list_JAVEN_TESTING_TEST).
2020-06-30 03:39:55.221028 (Thread-1): Compiling model.sample_project.customer
2020-06-30 03:39:55.249494 (Thread-1): Writing injected SQL for node "model.sample_project.customer"
2020-06-30 03:39:55.250157 (Thread-1): finished collecting timing info
2020-06-30 03:39:55.250793 (Thread-1): Finished running node model.sample_project.customer
2020-06-30 03:39:55.250971 (Thread-1): Began running node model.sample_project.lineitem
2020-06-30 03:39:55.251285 (Thread-1): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 03:39:55.251408 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer).
2020-06-30 03:39:55.251524 (Thread-1): Compiling model.sample_project.lineitem
2020-06-30 03:39:55.265707 (Thread-1): Writing injected SQL for node "model.sample_project.lineitem"
2020-06-30 03:39:55.267353 (Thread-1): finished collecting timing info
2020-06-30 03:39:55.267982 (Thread-1): Finished running node model.sample_project.lineitem
2020-06-30 03:39:55.268168 (Thread-1): Began running node model.sample_project.nation
2020-06-30 03:39:55.268482 (Thread-1): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 03:39:55.268605 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.lineitem).
2020-06-30 03:39:55.268723 (Thread-1): Compiling model.sample_project.nation
2020-06-30 03:39:55.279083 (Thread-1): Writing injected SQL for node "model.sample_project.nation"
2020-06-30 03:39:55.279478 (Thread-1): finished collecting timing info
2020-06-30 03:39:55.279936 (Thread-1): Finished running node model.sample_project.nation
2020-06-30 03:39:55.280100 (Thread-1): Began running node model.sample_project.orders
2020-06-30 03:39:55.280389 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 03:39:55.280504 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.nation).
2020-06-30 03:39:55.280614 (Thread-1): Compiling model.sample_project.orders
2020-06-30 03:39:55.290028 (Thread-1): Writing injected SQL for node "model.sample_project.orders"
2020-06-30 03:39:55.290609 (Thread-1): finished collecting timing info
2020-06-30 03:39:55.291068 (Thread-1): Finished running node model.sample_project.orders
2020-06-30 03:39:55.291227 (Thread-1): Began running node model.sample_project.sales_report_two
2020-06-30 03:39:55.292569 (Thread-1): 22:39:55 | 1 of 4 START table model TEST.sales_report_two....................... [RUN]
2020-06-30 03:39:55.292892 (Thread-1): Acquiring new snowflake connection "model.sample_project.sales_report_two".
2020-06-30 03:39:55.293094 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders).
2020-06-30 03:39:55.293227 (Thread-1): Compiling model.sample_project.sales_report_two
2020-06-30 03:39:55.299364 (Thread-1): Writing injected SQL for node "model.sample_project.sales_report_two"
2020-06-30 03:39:55.299775 (Thread-1): finished collecting timing info
2020-06-30 03:39:55.339963 (Thread-1): Writing runtime SQL for node "model.sample_project.sales_report_two"
2020-06-30 03:39:55.341063 (Thread-1): Using snowflake connection "model.sample_project.sales_report_two".
2020-06-30 03:39:55.341192 (Thread-1): On model.sample_project.sales_report_two: BEGIN
2020-06-30 03:39:55.548775 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2020-06-30 03:39:55.549037 (Thread-1): Using snowflake connection "model.sample_project.sales_report_two".
2020-06-30 03:39:55.549203 (Thread-1): On model.sample_project.sales_report_two: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "model.sample_project.sales_report_two"} */


      create or replace transient table JAVEN_TESTING.TEST.sales_report_two  as
      (/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/
      );
2020-06-30 03:39:55.724349 (Thread-1): Snowflake query id: 01953ebb-02fc-bcb7-0000-2aed011cd362
2020-06-30 03:39:55.724530 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 17 at position 6 unexpected ')'.
2020-06-30 03:39:55.724665 (Thread-1): On model.sample_project.sales_report_two: ROLLBACK
2020-06-30 03:39:55.724769 (Thread-1): initiating rollback
2020-06-30 03:39:56.021472 (Thread-1): finished collecting timing info
2020-06-30 03:39:56.022083 (Thread-1): Database Error in model sales_report_two (models/reports/sales_report_two.sql)
  001003 (42000): SQL compilation error:
  syntax error line 17 at position 6 unexpected ')'.
  compiled SQL at target/run/sample_project/models/reports/sales_report_two.sql
Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 158, in exception_handler
    yield
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/cursor.py", line 597, in execute
    errvalue)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/errors.py", line 97, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, errorclass, errorvalue)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/errors.py", line 73, in default_errorhandler
    done_format_msg=errorvalue.get(u'done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 17 at position 6 unexpected ')'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 119, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 306, in add_query
    abridge_sql_log=abridge_sql_log
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/usr/local/opt/python/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 177, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model sales_report_two (models/reports/sales_report_two.sql)
  001003 (42000): SQL compilation error:
  syntax error line 17 at position 6 unexpected ')'.
  compiled SQL at target/run/sample_project/models/reports/sales_report_two.sql
2020-06-30 03:39:56.031715 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a23363bf-f226-4418-b8d3-85bf1400bb7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111524d90>]}
2020-06-30 03:39:56.033078 (Thread-1): 22:39:56 | 1 of 4 ERROR creating table model TEST.sales_report_two.............. [ERROR in 0.74s]
2020-06-30 03:39:56.033241 (Thread-1): Finished running node model.sample_project.sales_report_two
2020-06-30 03:39:56.033407 (Thread-1): Began running node model.sample_project.customer_nation
2020-06-30 03:39:56.033720 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 03:39:56.033956 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.sales_report_two).
2020-06-30 03:39:56.034092 (Thread-1): Compiling model.sample_project.customer_nation
2020-06-30 03:39:56.049755 (Thread-1): Writing injected SQL for node "model.sample_project.customer_nation"
2020-06-30 03:39:56.050607 (Thread-1): finished collecting timing info
2020-06-30 03:39:56.051399 (Thread-1): Finished running node model.sample_project.customer_nation
2020-06-30 03:39:56.051599 (Thread-1): Began running node model.sample_project.orders_lineitem
2020-06-30 03:39:56.051888 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 03:39:56.051997 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer_nation).
2020-06-30 03:39:56.052106 (Thread-1): Compiling model.sample_project.orders_lineitem
2020-06-30 03:39:56.069021 (Thread-1): Writing injected SQL for node "model.sample_project.orders_lineitem"
2020-06-30 03:39:56.070201 (Thread-1): finished collecting timing info
2020-06-30 03:39:56.071420 (Thread-1): Finished running node model.sample_project.orders_lineitem
2020-06-30 03:39:56.071676 (Thread-1): Began running node model.sample_project.customers_per_nation
2020-06-30 03:39:56.073300 (Thread-1): 22:39:56 | 2 of 4 START table model TEST.customers_per_nation................... [RUN]
2020-06-30 03:39:56.073804 (Thread-1): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 03:39:56.073957 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders_lineitem).
2020-06-30 03:39:56.074106 (Thread-1): Compiling model.sample_project.customers_per_nation
2020-06-30 03:39:56.085729 (Thread-1): Writing injected SQL for node "model.sample_project.customers_per_nation"
2020-06-30 03:39:56.086203 (Thread-1): finished collecting timing info
2020-06-30 03:39:56.096748 (Thread-1): Writing runtime SQL for node "model.sample_project.customers_per_nation"
2020-06-30 03:39:56.099539 (Thread-1): Using snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 03:39:56.099687 (Thread-1): On model.sample_project.customers_per_nation: BEGIN
2020-06-30 03:39:56.305957 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2020-06-30 03:39:56.306178 (Thread-1): Using snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 03:39:56.306322 (Thread-1): On model.sample_project.customers_per_nation: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "model.sample_project.customers_per_nation"} */


      create or replace transient table JAVEN_TESTING.TEST.customers_per_nation  as
      (with __dbt__CTE__customer as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  c_custkey as custkey,
        c_nationkey as nationkey,
        c_name as name
from snowflake_sample_data.tpch_sf1.customer
),  __dbt__CTE__nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  n_nationkey as nationkey,
        n_name as name
from snowflake_sample_data.tpch_sf1.nation
),  __dbt__CTE__customer_nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  c.custkey,
        c.nationkey,
        c.name as customer_name,
        n.name as nation_name
from __dbt__CTE__customer as c
JOIN __dbt__CTE__nation as n
ON c.nationkey=n.nationkey
)/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  count(customer_name) as customer_count,
        nation_name
from __dbt__CTE__customer_nation
group by nation_name
order by nation_name
      );
2020-06-30 03:39:59.107187 (Thread-1): SQL status: SUCCESS 1 in 2.80 seconds
2020-06-30 03:39:59.108299 (Thread-1): On model.sample_project.customers_per_nation: COMMIT
2020-06-30 03:39:59.108452 (Thread-1): Using snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 03:39:59.108544 (Thread-1): On model.sample_project.customers_per_nation: COMMIT
2020-06-30 03:39:59.335861 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2020-06-30 03:39:59.347070 (Thread-1): finished collecting timing info
2020-06-30 03:39:59.347753 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a23363bf-f226-4418-b8d3-85bf1400bb7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113687f50>]}
2020-06-30 03:39:59.348952 (Thread-1): 22:39:59 | 2 of 4 OK created table model TEST.customers_per_nation.............. [SUCCESS 1 in 3.27s]
2020-06-30 03:39:59.349095 (Thread-1): Finished running node model.sample_project.customers_per_nation
2020-06-30 03:39:59.349237 (Thread-1): Began running node model.sample_project.cust_list_ord_nat
2020-06-30 03:39:59.349666 (Thread-1): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 03:39:59.349782 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customers_per_nation).
2020-06-30 03:39:59.349879 (Thread-1): Compiling model.sample_project.cust_list_ord_nat
2020-06-30 03:39:59.370736 (Thread-1): Writing injected SQL for node "model.sample_project.cust_list_ord_nat"
2020-06-30 03:39:59.372564 (Thread-1): finished collecting timing info
2020-06-30 03:39:59.373100 (Thread-1): Finished running node model.sample_project.cust_list_ord_nat
2020-06-30 03:39:59.373272 (Thread-1): Began running node model.sample_project.average_price_per_order
2020-06-30 03:39:59.374816 (Thread-1): 22:39:59 | 3 of 4 START table model TEST.average_price_per_order................ [RUN]
2020-06-30 03:39:59.375202 (Thread-1): Acquiring new snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 03:39:59.375315 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.cust_list_ord_nat).
2020-06-30 03:39:59.375424 (Thread-1): Compiling model.sample_project.average_price_per_order
2020-06-30 03:39:59.394521 (Thread-1): Writing injected SQL for node "model.sample_project.average_price_per_order"
2020-06-30 03:39:59.395027 (Thread-1): finished collecting timing info
2020-06-30 03:39:59.405722 (Thread-1): Writing runtime SQL for node "model.sample_project.average_price_per_order"
2020-06-30 03:39:59.409710 (Thread-1): Using snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 03:39:59.409872 (Thread-1): On model.sample_project.average_price_per_order: BEGIN
2020-06-30 03:39:59.576625 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2020-06-30 03:39:59.576841 (Thread-1): Using snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 03:39:59.576978 (Thread-1): On model.sample_project.average_price_per_order: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "model.sample_project.average_price_per_order"} */


      create or replace transient table JAVEN_TESTING.TEST.average_price_per_order  as
      (with __dbt__CTE__orders as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  o_orderkey as orderkey,
        o_custkey as custkey,
        o_totalprice as totalprice,
        o_orderdate as orderdate
from snowflake_sample_data.tpch_sf1.orders
),  __dbt__CTE__lineitem as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  l_orderkey as orderkey,
        l_extendedprice as extendedprice,
        l_discount as discount,
        l_tax as tax,
        l_quantity as quantity
from snowflake_sample_data.tpch_sf1.lineitem
),  __dbt__CTE__orders_lineitem as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  o.orderkey,
        o.custkey,
        o.totalprice,
        o.orderdate,
        l.extendedprice,
        l.discount,
        l.tax,
        l.quantity
from __dbt__CTE__orders as o
JOIN __dbt__CTE__lineitem as l
ON o.orderkey=l.orderkey
)/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  avg(totalprice) as average_order_price,
        sum(quantity) as total_quantity_per_order,
        listagg(quantity, '|~~|') as quantities_per_order,
        count(quantity) as items_per_order,
        
  
    width_bucket(average_order_price, 184000, 200000, 10 )

 as price_histogram,
        orderdate
from __dbt__CTE__orders_lineitem
group by orderdate
      );
2020-06-30 03:40:02.773243 (Thread-1): SQL status: SUCCESS 1 in 3.20 seconds
2020-06-30 03:40:02.774509 (Thread-1): On model.sample_project.average_price_per_order: COMMIT
2020-06-30 03:40:02.774686 (Thread-1): Using snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 03:40:02.774798 (Thread-1): On model.sample_project.average_price_per_order: COMMIT
2020-06-30 03:40:02.954079 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2020-06-30 03:40:02.957022 (Thread-1): finished collecting timing info
2020-06-30 03:40:02.957939 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a23363bf-f226-4418-b8d3-85bf1400bb7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136fe410>]}
2020-06-30 03:40:02.959327 (Thread-1): 22:40:02 | 3 of 4 OK created table model TEST.average_price_per_order........... [SUCCESS 1 in 3.58s]
2020-06-30 03:40:02.959497 (Thread-1): Finished running node model.sample_project.average_price_per_order
2020-06-30 03:40:02.959671 (Thread-1): Began running node model.sample_project.sales_report_one
2020-06-30 03:40:02.960884 (Thread-1): 22:40:02 | 4 of 4 START table model TEST.sales_report_one....................... [RUN]
2020-06-30 03:40:02.961210 (Thread-1): Acquiring new snowflake connection "model.sample_project.sales_report_one".
2020-06-30 03:40:02.961331 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.average_price_per_order).
2020-06-30 03:40:02.961451 (Thread-1): Compiling model.sample_project.sales_report_one
2020-06-30 03:40:02.973909 (Thread-1): Writing injected SQL for node "model.sample_project.sales_report_one"
2020-06-30 03:40:02.974462 (Thread-1): finished collecting timing info
2020-06-30 03:40:02.981308 (Thread-1): Writing runtime SQL for node "model.sample_project.sales_report_one"
2020-06-30 03:40:02.987155 (Thread-1): Using snowflake connection "model.sample_project.sales_report_one".
2020-06-30 03:40:02.987351 (Thread-1): On model.sample_project.sales_report_one: BEGIN
2020-06-30 03:40:03.254555 (Thread-1): SQL status: SUCCESS 1 in 0.27 seconds
2020-06-30 03:40:03.254751 (Thread-1): Using snowflake connection "model.sample_project.sales_report_one".
2020-06-30 03:40:03.254861 (Thread-1): On model.sample_project.sales_report_one: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "model.sample_project.sales_report_one"} */


      create or replace transient table JAVEN_TESTING.TEST.sales_report_one  as
      (with __dbt__CTE__customer as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  c_custkey as custkey,
        c_nationkey as nationkey,
        c_name as name
from snowflake_sample_data.tpch_sf1.customer
),  __dbt__CTE__nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  n_nationkey as nationkey,
        n_name as name
from snowflake_sample_data.tpch_sf1.nation
),  __dbt__CTE__customer_nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  c.custkey,
        c.nationkey,
        c.name as customer_name,
        n.name as nation_name
from __dbt__CTE__customer as c
JOIN __dbt__CTE__nation as n
ON c.nationkey=n.nationkey
),  __dbt__CTE__orders as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  o_orderkey as orderkey,
        o_custkey as custkey,
        o_totalprice as totalprice,
        o_orderdate as orderdate
from snowflake_sample_data.tpch_sf1.orders
),  __dbt__CTE__lineitem as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  l_orderkey as orderkey,
        l_extendedprice as extendedprice,
        l_discount as discount,
        l_tax as tax,
        l_quantity as quantity
from snowflake_sample_data.tpch_sf1.lineitem
),  __dbt__CTE__orders_lineitem as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  o.orderkey,
        o.custkey,
        o.totalprice,
        o.orderdate,
        l.extendedprice,
        l.discount,
        l.tax,
        l.quantity
from __dbt__CTE__orders as o
JOIN __dbt__CTE__lineitem as l
ON o.orderkey=l.orderkey
),  __dbt__CTE__cust_list_ord_nat as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  cn.custkey,
        cn.nationkey,
        cn.customer_name,
        cn.nation_name,
        ol.orderkey,
        ol.custkey,
        ol.totalprice,
        ol.orderdate,
        ol.extendedprice,
        ol.discount,
        ol.tax,
        ol.quantity
from __dbt__CTE__customer_nation as cn
JOIN __dbt__CTE__orders_lineitem as ol
ON cn.custkey=ol.custkey
)/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  extendedprice * (1.0-discount) * (1.0 + tax) as charge,
        *
from __dbt__CTE__cust_list_ord_nat
      );
2020-06-30 03:40:03.681932 (Thread-1): Snowflake query id: 01953ebc-02ff-6da7-0000-2aed011ce36e
2020-06-30 03:40:03.682110 (Thread-1): Snowflake error: 002025 (42S21): SQL compilation error:
duplicate column name 'CUSTKEY'
2020-06-30 03:40:03.682247 (Thread-1): On model.sample_project.sales_report_one: ROLLBACK
2020-06-30 03:40:03.682350 (Thread-1): initiating rollback
2020-06-30 03:40:03.946762 (Thread-1): finished collecting timing info
2020-06-30 03:40:03.947360 (Thread-1): Database Error in model sales_report_one (models/reports/sales_report_one.sql)
  002025 (42S21): SQL compilation error:
  duplicate column name 'CUSTKEY'
  compiled SQL at target/run/sample_project/models/reports/sales_report_one.sql
Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 158, in exception_handler
    yield
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/cursor.py", line 597, in execute
    errvalue)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/errors.py", line 97, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, errorclass, errorvalue)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/errors.py", line 73, in default_errorhandler
    done_format_msg=errorvalue.get(u'done_format_msg'))
snowflake.connector.errors.ProgrammingError: 002025 (42S21): SQL compilation error:
duplicate column name 'CUSTKEY'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 119, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 306, in add_query
    abridge_sql_log=abridge_sql_log
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/usr/local/opt/python/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 177, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model sales_report_one (models/reports/sales_report_one.sql)
  002025 (42S21): SQL compilation error:
  duplicate column name 'CUSTKEY'
  compiled SQL at target/run/sample_project/models/reports/sales_report_one.sql
2020-06-30 03:40:03.948298 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a23363bf-f226-4418-b8d3-85bf1400bb7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113773c50>]}
2020-06-30 03:40:03.949694 (Thread-1): 22:40:03 | 4 of 4 ERROR creating table model TEST.sales_report_one.............. [ERROR in 0.99s]
2020-06-30 03:40:03.949858 (Thread-1): Finished running node model.sample_project.sales_report_one
2020-06-30 03:40:04.019257 (MainThread): Using snowflake connection "master".
2020-06-30 03:40:04.019515 (MainThread): On master: BEGIN
2020-06-30 03:40:04.201864 (MainThread): SQL status: SUCCESS 1 in 0.18 seconds
2020-06-30 03:40:04.202153 (MainThread): On master: COMMIT
2020-06-30 03:40:04.202390 (MainThread): Using snowflake connection "master".
2020-06-30 03:40:04.202520 (MainThread): On master: COMMIT
2020-06-30 03:40:04.638321 (MainThread): SQL status: SUCCESS 1 in 0.44 seconds
2020-06-30 03:40:04.639054 (MainThread): 22:40:04 | 
2020-06-30 03:40:04.639270 (MainThread): 22:40:04 | Finished running 4 table models in 20.90s.
2020-06-30 03:40:04.639403 (MainThread): Connection 'master' was left open.
2020-06-30 03:40:04.639512 (MainThread): On master: Close
2020-06-30 03:40:04.952703 (MainThread): Connection 'model.sample_project.sales_report_one' was left open.
2020-06-30 03:40:04.952892 (MainThread): On model.sample_project.sales_report_one: Close
2020-06-30 03:40:05.252767 (MainThread): 
2020-06-30 03:40:05.252962 (MainThread): Completed with 2 errors and 0 warnings:
2020-06-30 03:40:05.253104 (MainThread): 
2020-06-30 03:40:05.253237 (MainThread): Database Error in model sales_report_two (models/reports/sales_report_two.sql)
2020-06-30 03:40:05.253357 (MainThread):   001003 (42000): SQL compilation error:
2020-06-30 03:40:05.253468 (MainThread):   syntax error line 17 at position 6 unexpected ')'.
2020-06-30 03:40:05.253576 (MainThread):   compiled SQL at target/run/sample_project/models/reports/sales_report_two.sql
2020-06-30 03:40:05.253691 (MainThread): 
2020-06-30 03:40:05.253812 (MainThread): Database Error in model sales_report_one (models/reports/sales_report_one.sql)
2020-06-30 03:40:05.253927 (MainThread):   002025 (42S21): SQL compilation error:
2020-06-30 03:40:05.254037 (MainThread):   duplicate column name 'CUSTKEY'
2020-06-30 03:40:05.254145 (MainThread):   compiled SQL at target/run/sample_project/models/reports/sales_report_one.sql
2020-06-30 03:40:05.254263 (MainThread): 
Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
2020-06-30 03:40:05.254464 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11374a9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11374ac50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11374aed0>]}
2020-06-30 03:40:05.254681 (MainThread): Flushing usage events
2020-06-30 03:40:49.471337 (MainThread): Running with dbt=0.17.0
2020-06-30 03:40:49.813430 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-06-30 03:40:49.814168 (MainThread): Tracking: tracking
2020-06-30 03:40:49.814498 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e516d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e51810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e51c10>]}
2020-06-30 03:40:49.838692 (MainThread): Partial parsing not enabled
2020-06-30 03:40:49.840591 (MainThread): Parsing macros/core.sql
2020-06-30 03:40:49.845597 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-30 03:40:49.854267 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-30 03:40:49.856325 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-30 03:40:49.876201 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-30 03:40:49.908315 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-30 03:40:49.932949 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-30 03:40:49.934899 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-30 03:40:49.942253 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-30 03:40:49.957046 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-30 03:40:49.964973 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-30 03:40:49.972886 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-30 03:40:49.978326 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-30 03:40:49.979299 (MainThread): Parsing macros/etc/query.sql
2020-06-30 03:40:49.980391 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-30 03:40:49.982100 (MainThread): Parsing macros/etc/datetime.sql
2020-06-30 03:40:49.992896 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-30 03:40:49.995209 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-30 03:40:49.996965 (MainThread): Parsing macros/adapters/common.sql
2020-06-30 03:40:50.056794 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-30 03:40:50.058295 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-30 03:40:50.059281 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-30 03:40:50.060402 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-30 03:40:50.062745 (MainThread): Parsing macros/catalog.sql
2020-06-30 03:40:50.064668 (MainThread): Parsing macros/adapters.sql
2020-06-30 03:40:50.088240 (MainThread): Parsing macros/materializations/merge.sql
2020-06-30 03:40:50.090734 (MainThread): Parsing macros/materializations/view.sql
2020-06-30 03:40:50.092111 (MainThread): Parsing macros/materializations/table.sql
2020-06-30 03:40:50.096216 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-30 03:40:50.135520 (MainThread): Partial parsing not enabled
2020-06-30 03:40:50.137394 (MainThread): Parsing macros/cross_db_utils/except.sql
2020-06-30 03:40:50.138654 (MainThread): Parsing macros/cross_db_utils/replace.sql
2020-06-30 03:40:50.139965 (MainThread): Parsing macros/cross_db_utils/concat.sql
2020-06-30 03:40:50.142307 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2020-06-30 03:40:50.148535 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2020-06-30 03:40:50.149848 (MainThread): Parsing macros/cross_db_utils/length.sql
2020-06-30 03:40:50.151211 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2020-06-30 03:40:50.153919 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2020-06-30 03:40:50.155392 (MainThread): Parsing macros/cross_db_utils/right.sql
2020-06-30 03:40:50.157778 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2020-06-30 03:40:50.173739 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2020-06-30 03:40:50.176743 (MainThread): Parsing macros/cross_db_utils/hash.sql
2020-06-30 03:40:50.178422 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2020-06-30 03:40:50.180034 (MainThread): Parsing macros/cross_db_utils/position.sql
2020-06-30 03:40:50.182293 (MainThread): Parsing macros/cross_db_utils/literal.sql
2020-06-30 03:40:50.183377 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2020-06-30 03:40:50.187039 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2020-06-30 03:40:50.192751 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2020-06-30 03:40:50.195869 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2020-06-30 03:40:50.197824 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2020-06-30 03:40:50.199412 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2020-06-30 03:40:50.226211 (MainThread): Parsing macros/logger/pretty_log_format.sql
2020-06-30 03:40:50.226986 (MainThread): Parsing macros/logger/pretty_time.sql
2020-06-30 03:40:50.227777 (MainThread): Parsing macros/logger/log_info.sql
2020-06-30 03:40:50.228492 (MainThread): Parsing macros/datetime/date_spine.sql
2020-06-30 03:40:50.232115 (MainThread): Parsing macros/web/get_url_host.sql
2020-06-30 03:40:50.233616 (MainThread): Parsing macros/web/get_url_path.sql
2020-06-30 03:40:50.235974 (MainThread): Parsing macros/web/get_url_parameter.sql
2020-06-30 03:40:50.237187 (MainThread): Parsing macros/geo/haversine_distance.sql
2020-06-30 03:40:50.238438 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2020-06-30 03:40:50.239887 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2020-06-30 03:40:50.242977 (MainThread): Parsing macros/schema_tests/recency.sql
2020-06-30 03:40:50.244384 (MainThread): Parsing macros/schema_tests/not_constant.sql
2020-06-30 03:40:50.245464 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2020-06-30 03:40:50.246532 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2020-06-30 03:40:50.247806 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2020-06-30 03:40:50.249408 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2020-06-30 03:40:50.250704 (MainThread): Parsing macros/schema_tests/equality.sql
2020-06-30 03:40:50.254214 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2020-06-30 03:40:50.260439 (MainThread): Parsing macros/sql/nullcheck_table.sql
2020-06-30 03:40:50.261555 (MainThread): Parsing macros/sql/generate_series.sql
2020-06-30 03:40:50.265225 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2020-06-30 03:40:50.269852 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2020-06-30 03:40:50.272869 (MainThread): Parsing macros/sql/star.sql
2020-06-30 03:40:50.275873 (MainThread): Parsing macros/sql/unpivot.sql
2020-06-30 03:40:50.282548 (MainThread): Parsing macros/sql/union.sql
2020-06-30 03:40:50.292954 (MainThread): Parsing macros/sql/groupby.sql
2020-06-30 03:40:50.294352 (MainThread): Parsing macros/sql/surrogate_key.sql
2020-06-30 03:40:50.297244 (MainThread): Parsing macros/sql/safe_add.sql
2020-06-30 03:40:50.298500 (MainThread): Parsing macros/sql/nullcheck.sql
2020-06-30 03:40:50.299946 (MainThread): Parsing macros/sql/get_column_values.sql
2020-06-30 03:40:50.305425 (MainThread): Parsing macros/sql/pivot.sql
2020-06-30 03:40:50.308679 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2020-06-30 03:40:50.354107 (MainThread): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 03:40:50.354226 (MainThread): Opening a new connection, currently in state init
2020-06-30 03:40:50.385041 (MainThread): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 03:40:50.385158 (MainThread): Opening a new connection, currently in state init
2020-06-30 03:40:50.397505 (MainThread): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 03:40:50.397614 (MainThread): Opening a new connection, currently in state init
2020-06-30 03:40:50.409089 (MainThread): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 03:40:50.409185 (MainThread): Opening a new connection, currently in state init
2020-06-30 03:40:50.421003 (MainThread): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 03:40:50.421339 (MainThread): Opening a new connection, currently in state init
2020-06-30 03:40:50.434231 (MainThread): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 03:40:50.434322 (MainThread): Opening a new connection, currently in state init
2020-06-30 03:40:50.447167 (MainThread): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 03:40:50.447262 (MainThread): Opening a new connection, currently in state init
2020-06-30 03:40:50.460184 (MainThread): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 03:40:50.460468 (MainThread): Opening a new connection, currently in state init
2020-06-30 03:40:50.473891 (MainThread): Acquiring new snowflake connection "model.sample_project.sales_report_one".
2020-06-30 03:40:50.474012 (MainThread): Opening a new connection, currently in state init
2020-06-30 03:40:50.485200 (MainThread): Acquiring new snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 03:40:50.485291 (MainThread): Opening a new connection, currently in state init
2020-06-30 03:40:50.500711 (MainThread): Acquiring new snowflake connection "model.sample_project.sales_report_two".
2020-06-30 03:40:50.500817 (MainThread): Opening a new connection, currently in state init
2020-06-30 03:40:50.979176 (MainThread): Found 11 models, 8 tests, 0 snapshots, 0 analyses, 263 macros, 0 operations, 0 seed files, 4 sources
2020-06-30 03:40:50.980814 (MainThread): 
2020-06-30 03:40:50.981079 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 03:40:50.981160 (MainThread): Opening a new connection, currently in state init
2020-06-30 03:40:50.986107 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_JAVEN_TESTING".
2020-06-30 03:40:50.986202 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-06-30 03:40:50.999818 (ThreadPoolExecutor-0_0): Using snowflake connection "list_JAVEN_TESTING".
2020-06-30 03:40:50.999924 (ThreadPoolExecutor-0_0): On list_JAVEN_TESTING: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING"} */

    show terse schemas in database JAVEN_TESTING
    limit 10000
2020-06-30 03:40:51.454723 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/certifi/cacert.pem'>
2020-06-30 03:40:56.671238 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 5.67 seconds
2020-06-30 03:40:56.706114 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 03:40:56.706339 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_JAVEN_TESTING).
2020-06-30 03:40:56.713250 (ThreadPoolExecutor-1_0): Using snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 03:40:56.713363 (ThreadPoolExecutor-1_0): On list_JAVEN_TESTING_TEST: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING_TEST"} */

    show terse objects in JAVEN_TESTING.TEST
2020-06-30 03:40:56.948261 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 0.23 seconds
2020-06-30 03:40:56.959286 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 03:40:56.959424 (MainThread): Opening a new connection, currently in state init
2020-06-30 03:40:56.959624 (MainThread): Using snowflake connection "master".
2020-06-30 03:40:56.959736 (MainThread): On master: BEGIN
2020-06-30 03:41:01.236789 (MainThread): SQL status: SUCCESS 1 in 4.28 seconds
2020-06-30 03:41:01.237011 (MainThread): On master: COMMIT
2020-06-30 03:41:01.237180 (MainThread): Using snowflake connection "master".
2020-06-30 03:41:01.237314 (MainThread): On master: COMMIT
2020-06-30 03:41:01.934908 (MainThread): SQL status: SUCCESS 1 in 0.70 seconds
2020-06-30 03:41:01.935315 (MainThread): 22:41:01 | Concurrency: 1 threads (target='dev')
2020-06-30 03:41:01.935479 (MainThread): 22:41:01 | 
2020-06-30 03:41:01.936416 (Thread-1): Began running node model.sample_project.customer
2020-06-30 03:41:01.936788 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 03:41:01.936911 (Thread-1): Re-using an available connection from the pool (formerly list_JAVEN_TESTING_TEST).
2020-06-30 03:41:01.937032 (Thread-1): Compiling model.sample_project.customer
2020-06-30 03:41:01.963051 (Thread-1): Writing injected SQL for node "model.sample_project.customer"
2020-06-30 03:41:01.963570 (Thread-1): finished collecting timing info
2020-06-30 03:41:01.964140 (Thread-1): Finished running node model.sample_project.customer
2020-06-30 03:41:01.964333 (Thread-1): Began running node model.sample_project.lineitem
2020-06-30 03:41:01.964735 (Thread-1): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 03:41:01.964859 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer).
2020-06-30 03:41:01.964977 (Thread-1): Compiling model.sample_project.lineitem
2020-06-30 03:41:01.977464 (Thread-1): Writing injected SQL for node "model.sample_project.lineitem"
2020-06-30 03:41:01.977967 (Thread-1): finished collecting timing info
2020-06-30 03:41:01.978510 (Thread-1): Finished running node model.sample_project.lineitem
2020-06-30 03:41:01.978684 (Thread-1): Began running node model.sample_project.nation
2020-06-30 03:41:01.979087 (Thread-1): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 03:41:01.979220 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.lineitem).
2020-06-30 03:41:01.979337 (Thread-1): Compiling model.sample_project.nation
2020-06-30 03:41:01.989379 (Thread-1): Writing injected SQL for node "model.sample_project.nation"
2020-06-30 03:41:01.989793 (Thread-1): finished collecting timing info
2020-06-30 03:41:01.990262 (Thread-1): Finished running node model.sample_project.nation
2020-06-30 03:41:01.990425 (Thread-1): Began running node model.sample_project.orders
2020-06-30 03:41:01.990709 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 03:41:01.990823 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.nation).
2020-06-30 03:41:01.990932 (Thread-1): Compiling model.sample_project.orders
2020-06-30 03:41:01.999704 (Thread-1): Writing injected SQL for node "model.sample_project.orders"
2020-06-30 03:41:02.000079 (Thread-1): finished collecting timing info
2020-06-30 03:41:02.000460 (Thread-1): Finished running node model.sample_project.orders
2020-06-30 03:41:02.000595 (Thread-1): Began running node model.sample_project.sales_report_two
2020-06-30 03:41:02.001574 (Thread-1): 22:41:02 | 1 of 4 START table model TEST.sales_report_two....................... [RUN]
2020-06-30 03:41:02.001960 (Thread-1): Acquiring new snowflake connection "model.sample_project.sales_report_two".
2020-06-30 03:41:02.002067 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders).
2020-06-30 03:41:02.002166 (Thread-1): Compiling model.sample_project.sales_report_two
2020-06-30 03:41:02.007352 (Thread-1): Writing injected SQL for node "model.sample_project.sales_report_two"
2020-06-30 03:41:02.007719 (Thread-1): finished collecting timing info
2020-06-30 03:41:02.049083 (Thread-1): Writing runtime SQL for node "model.sample_project.sales_report_two"
2020-06-30 03:41:02.050133 (Thread-1): Using snowflake connection "model.sample_project.sales_report_two".
2020-06-30 03:41:02.050271 (Thread-1): On model.sample_project.sales_report_two: BEGIN
2020-06-30 03:41:02.328317 (Thread-1): SQL status: SUCCESS 1 in 0.28 seconds
2020-06-30 03:41:02.328497 (Thread-1): Using snowflake connection "model.sample_project.sales_report_two".
2020-06-30 03:41:02.328613 (Thread-1): On model.sample_project.sales_report_two: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "model.sample_project.sales_report_two"} */


      create or replace transient table JAVEN_TESTING.TEST.sales_report_two  as
      (/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/
      );
2020-06-30 03:41:02.629161 (Thread-1): Snowflake query id: 01953ebd-0262-2f8d-0000-2aed011cd392
2020-06-30 03:41:02.629337 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 17 at position 6 unexpected ')'.
2020-06-30 03:41:02.629469 (Thread-1): On model.sample_project.sales_report_two: ROLLBACK
2020-06-30 03:41:02.629573 (Thread-1): initiating rollback
2020-06-30 03:41:03.204120 (Thread-1): finished collecting timing info
2020-06-30 03:41:03.204718 (Thread-1): Database Error in model sales_report_two (models/reports/sales_report_two.sql)
  001003 (42000): SQL compilation error:
  syntax error line 17 at position 6 unexpected ')'.
  compiled SQL at target/run/sample_project/models/reports/sales_report_two.sql
Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 158, in exception_handler
    yield
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/cursor.py", line 597, in execute
    errvalue)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/errors.py", line 97, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, errorclass, errorvalue)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/errors.py", line 73, in default_errorhandler
    done_format_msg=errorvalue.get(u'done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 17 at position 6 unexpected ')'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 119, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 306, in add_query
    abridge_sql_log=abridge_sql_log
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/usr/local/opt/python/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 177, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model sales_report_two (models/reports/sales_report_two.sql)
  001003 (42000): SQL compilation error:
  syntax error line 17 at position 6 unexpected ')'.
  compiled SQL at target/run/sample_project/models/reports/sales_report_two.sql
2020-06-30 03:41:03.207345 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebb75e64-8c0b-4617-99f6-0034b835b81d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6457d0>]}
2020-06-30 03:41:03.208728 (Thread-1): 22:41:03 | 1 of 4 ERROR creating table model TEST.sales_report_two.............. [ERROR in 1.21s]
2020-06-30 03:41:03.208897 (Thread-1): Finished running node model.sample_project.sales_report_two
2020-06-30 03:41:03.209068 (Thread-1): Began running node model.sample_project.customer_nation
2020-06-30 03:41:03.209381 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 03:41:03.209504 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.sales_report_two).
2020-06-30 03:41:03.209753 (Thread-1): Compiling model.sample_project.customer_nation
2020-06-30 03:41:03.230343 (Thread-1): Writing injected SQL for node "model.sample_project.customer_nation"
2020-06-30 03:41:03.230845 (Thread-1): finished collecting timing info
2020-06-30 03:41:03.231377 (Thread-1): Finished running node model.sample_project.customer_nation
2020-06-30 03:41:03.231551 (Thread-1): Began running node model.sample_project.orders_lineitem
2020-06-30 03:41:03.231859 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 03:41:03.231979 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer_nation).
2020-06-30 03:41:03.232095 (Thread-1): Compiling model.sample_project.orders_lineitem
2020-06-30 03:41:03.250681 (Thread-1): Writing injected SQL for node "model.sample_project.orders_lineitem"
2020-06-30 03:41:03.251152 (Thread-1): finished collecting timing info
2020-06-30 03:41:03.251690 (Thread-1): Finished running node model.sample_project.orders_lineitem
2020-06-30 03:41:03.251871 (Thread-1): Began running node model.sample_project.customers_per_nation
2020-06-30 03:41:03.253040 (Thread-1): 22:41:03 | 2 of 4 START table model TEST.customers_per_nation................... [RUN]
2020-06-30 03:41:03.253564 (Thread-1): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 03:41:03.253825 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders_lineitem).
2020-06-30 03:41:03.253976 (Thread-1): Compiling model.sample_project.customers_per_nation
2020-06-30 03:41:03.271396 (Thread-1): Writing injected SQL for node "model.sample_project.customers_per_nation"
2020-06-30 03:41:03.272161 (Thread-1): finished collecting timing info
2020-06-30 03:41:03.278722 (Thread-1): Writing runtime SQL for node "model.sample_project.customers_per_nation"
2020-06-30 03:41:03.282510 (Thread-1): Using snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 03:41:03.283219 (Thread-1): On model.sample_project.customers_per_nation: BEGIN
2020-06-30 03:41:03.509125 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2020-06-30 03:41:03.509320 (Thread-1): Using snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 03:41:03.509436 (Thread-1): On model.sample_project.customers_per_nation: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "model.sample_project.customers_per_nation"} */


      create or replace transient table JAVEN_TESTING.TEST.customers_per_nation  as
      (with __dbt__CTE__customer as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  c_custkey as custkey,
        c_nationkey as nationkey,
        c_name as name
from snowflake_sample_data.tpch_sf1.customer
),  __dbt__CTE__nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  n_nationkey as nationkey,
        n_name as name
from snowflake_sample_data.tpch_sf1.nation
),  __dbt__CTE__customer_nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  c.custkey,
        c.nationkey,
        c.name as customer_name,
        n.name as nation_name
from __dbt__CTE__customer as c
JOIN __dbt__CTE__nation as n
ON c.nationkey=n.nationkey
)/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  count(customer_name) as customer_count,
        nation_name
from __dbt__CTE__customer_nation
group by nation_name
order by nation_name
      );
2020-06-30 03:41:04.847251 (Thread-1): SQL status: SUCCESS 1 in 1.34 seconds
2020-06-30 03:41:04.848458 (Thread-1): On model.sample_project.customers_per_nation: COMMIT
2020-06-30 03:41:04.848630 (Thread-1): Using snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 03:41:04.848743 (Thread-1): On model.sample_project.customers_per_nation: COMMIT
2020-06-30 03:41:05.256322 (Thread-1): SQL status: SUCCESS 1 in 0.41 seconds
2020-06-30 03:41:05.267946 (Thread-1): finished collecting timing info
2020-06-30 03:41:05.268765 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebb75e64-8c0b-4617-99f6-0034b835b81d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b656810>]}
2020-06-30 03:41:05.270135 (Thread-1): 22:41:05 | 2 of 4 OK created table model TEST.customers_per_nation.............. [SUCCESS 1 in 2.02s]
2020-06-30 03:41:05.270299 (Thread-1): Finished running node model.sample_project.customers_per_nation
2020-06-30 03:41:05.270460 (Thread-1): Began running node model.sample_project.cust_list_ord_nat
2020-06-30 03:41:05.270880 (Thread-1): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 03:41:05.271015 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customers_per_nation).
2020-06-30 03:41:05.271179 (Thread-1): Compiling model.sample_project.cust_list_ord_nat
2020-06-30 03:41:05.287903 (Thread-1): Writing injected SQL for node "model.sample_project.cust_list_ord_nat"
2020-06-30 03:41:05.288378 (Thread-1): finished collecting timing info
2020-06-30 03:41:05.288840 (Thread-1): Finished running node model.sample_project.cust_list_ord_nat
2020-06-30 03:41:05.288987 (Thread-1): Began running node model.sample_project.average_price_per_order
2020-06-30 03:41:05.290007 (Thread-1): 22:41:05 | 3 of 4 START table model TEST.average_price_per_order................ [RUN]
2020-06-30 03:41:05.290498 (Thread-1): Acquiring new snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 03:41:05.290607 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.cust_list_ord_nat).
2020-06-30 03:41:05.290765 (Thread-1): Compiling model.sample_project.average_price_per_order
2020-06-30 03:41:05.308215 (Thread-1): Writing injected SQL for node "model.sample_project.average_price_per_order"
2020-06-30 03:41:05.308955 (Thread-1): finished collecting timing info
2020-06-30 03:41:05.316079 (Thread-1): Writing runtime SQL for node "model.sample_project.average_price_per_order"
2020-06-30 03:41:05.319257 (Thread-1): Using snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 03:41:05.319408 (Thread-1): On model.sample_project.average_price_per_order: BEGIN
2020-06-30 03:41:05.628853 (Thread-1): SQL status: SUCCESS 1 in 0.31 seconds
2020-06-30 03:41:05.629124 (Thread-1): Using snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 03:41:05.629258 (Thread-1): On model.sample_project.average_price_per_order: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "model.sample_project.average_price_per_order"} */


      create or replace transient table JAVEN_TESTING.TEST.average_price_per_order  as
      (with __dbt__CTE__orders as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  o_orderkey as orderkey,
        o_custkey as custkey,
        o_totalprice as totalprice,
        o_orderdate as orderdate
from snowflake_sample_data.tpch_sf1.orders
),  __dbt__CTE__lineitem as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  l_orderkey as orderkey,
        l_extendedprice as extendedprice,
        l_discount as discount,
        l_tax as tax,
        l_quantity as quantity
from snowflake_sample_data.tpch_sf1.lineitem
),  __dbt__CTE__orders_lineitem as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  o.orderkey,
        o.custkey,
        o.totalprice,
        o.orderdate,
        l.extendedprice,
        l.discount,
        l.tax,
        l.quantity
from __dbt__CTE__orders as o
JOIN __dbt__CTE__lineitem as l
ON o.orderkey=l.orderkey
)/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  avg(totalprice) as average_order_price,
        sum(quantity) as total_quantity_per_order,
        listagg(quantity, '|~~|') as quantities_per_order,
        count(quantity) as items_per_order,
        
  
    width_bucket(average_order_price, 184000, 200000, 10 )

 as price_histogram,
        orderdate
from __dbt__CTE__orders_lineitem
group by orderdate
      );
2020-06-30 03:41:07.920425 (Thread-1): SQL status: SUCCESS 1 in 2.29 seconds
2020-06-30 03:41:07.921667 (Thread-1): On model.sample_project.average_price_per_order: COMMIT
2020-06-30 03:41:07.921862 (Thread-1): Using snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 03:41:07.921983 (Thread-1): On model.sample_project.average_price_per_order: COMMIT
2020-06-30 03:41:08.330521 (Thread-1): SQL status: SUCCESS 1 in 0.41 seconds
2020-06-30 03:41:08.333606 (Thread-1): finished collecting timing info
2020-06-30 03:41:08.334368 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebb75e64-8c0b-4617-99f6-0034b835b81d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6a03d0>]}
2020-06-30 03:41:08.335683 (Thread-1): 22:41:08 | 3 of 4 OK created table model TEST.average_price_per_order........... [SUCCESS 1 in 3.04s]
2020-06-30 03:41:08.335852 (Thread-1): Finished running node model.sample_project.average_price_per_order
2020-06-30 03:41:08.336023 (Thread-1): Began running node model.sample_project.sales_report_one
2020-06-30 03:41:08.337524 (Thread-1): 22:41:08 | 4 of 4 START table model TEST.sales_report_one....................... [RUN]
2020-06-30 03:41:08.337888 (Thread-1): Acquiring new snowflake connection "model.sample_project.sales_report_one".
2020-06-30 03:41:08.338014 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.average_price_per_order).
2020-06-30 03:41:08.338140 (Thread-1): Compiling model.sample_project.sales_report_one
2020-06-30 03:41:08.354005 (Thread-1): Writing injected SQL for node "model.sample_project.sales_report_one"
2020-06-30 03:41:08.354637 (Thread-1): finished collecting timing info
2020-06-30 03:41:08.361404 (Thread-1): Writing runtime SQL for node "model.sample_project.sales_report_one"
2020-06-30 03:41:08.366171 (Thread-1): Using snowflake connection "model.sample_project.sales_report_one".
2020-06-30 03:41:08.366385 (Thread-1): On model.sample_project.sales_report_one: BEGIN
2020-06-30 03:41:08.545499 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2020-06-30 03:41:08.545765 (Thread-1): Using snowflake connection "model.sample_project.sales_report_one".
2020-06-30 03:41:08.545933 (Thread-1): On model.sample_project.sales_report_one: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "model.sample_project.sales_report_one"} */


      create or replace transient table JAVEN_TESTING.TEST.sales_report_one  as
      (with __dbt__CTE__customer as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  c_custkey as custkey,
        c_nationkey as nationkey,
        c_name as name
from snowflake_sample_data.tpch_sf1.customer
),  __dbt__CTE__nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  n_nationkey as nationkey,
        n_name as name
from snowflake_sample_data.tpch_sf1.nation
),  __dbt__CTE__customer_nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  c.custkey,
        c.nationkey,
        c.name as customer_name,
        n.name as nation_name
from __dbt__CTE__customer as c
JOIN __dbt__CTE__nation as n
ON c.nationkey=n.nationkey
),  __dbt__CTE__orders as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  o_orderkey as orderkey,
        o_custkey as custkey,
        o_totalprice as totalprice,
        o_orderdate as orderdate
from snowflake_sample_data.tpch_sf1.orders
),  __dbt__CTE__lineitem as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  l_orderkey as orderkey,
        l_extendedprice as extendedprice,
        l_discount as discount,
        l_tax as tax,
        l_quantity as quantity
from snowflake_sample_data.tpch_sf1.lineitem
),  __dbt__CTE__orders_lineitem as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  o.orderkey,
        o.custkey,
        o.totalprice,
        o.orderdate,
        l.extendedprice,
        l.discount,
        l.tax,
        l.quantity
from __dbt__CTE__orders as o
JOIN __dbt__CTE__lineitem as l
ON o.orderkey=l.orderkey
),  __dbt__CTE__cust_list_ord_nat as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  cn.custkey,
        cn.nationkey,
        cn.customer_name,
        cn.nation_name,
        ol.orderkey,
        ol.totalprice,
        ol.orderdate,
        ol.extendedprice,
        ol.discount,
        ol.tax,
        ol.quantity
from __dbt__CTE__customer_nation as cn
JOIN __dbt__CTE__orders_lineitem as ol
ON cn.custkey=ol.custkey
)/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  extendedprice * (1.0-discount) * (1.0 + tax) as charge,
        *
from __dbt__CTE__cust_list_ord_nat
      );
2020-06-30 03:41:16.925432 (Thread-1): SQL status: SUCCESS 1 in 8.38 seconds
2020-06-30 03:41:16.926592 (Thread-1): On model.sample_project.sales_report_one: COMMIT
2020-06-30 03:41:16.926773 (Thread-1): Using snowflake connection "model.sample_project.sales_report_one".
2020-06-30 03:41:16.926892 (Thread-1): On model.sample_project.sales_report_one: COMMIT
2020-06-30 03:41:17.077930 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2020-06-30 03:41:17.080671 (Thread-1): finished collecting timing info
2020-06-30 03:41:17.081432 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebb75e64-8c0b-4617-99f6-0034b835b81d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b708350>]}
2020-06-30 03:41:17.082719 (Thread-1): 22:41:17 | 4 of 4 OK created table model TEST.sales_report_one.................. [SUCCESS 1 in 8.74s]
2020-06-30 03:41:17.082883 (Thread-1): Finished running node model.sample_project.sales_report_one
2020-06-30 03:41:17.098039 (MainThread): Using snowflake connection "master".
2020-06-30 03:41:17.098454 (MainThread): On master: BEGIN
2020-06-30 03:41:17.295062 (MainThread): SQL status: SUCCESS 1 in 0.20 seconds
2020-06-30 03:41:17.295276 (MainThread): On master: COMMIT
2020-06-30 03:41:17.295442 (MainThread): Using snowflake connection "master".
2020-06-30 03:41:17.295551 (MainThread): On master: COMMIT
2020-06-30 03:41:17.655317 (MainThread): SQL status: SUCCESS 1 in 0.36 seconds
2020-06-30 03:41:17.655816 (MainThread): 22:41:17 | 
2020-06-30 03:41:17.656005 (MainThread): 22:41:17 | Finished running 4 table models in 26.67s.
2020-06-30 03:41:17.656163 (MainThread): Connection 'master' was left open.
2020-06-30 03:41:17.656290 (MainThread): On master: Close
2020-06-30 03:41:17.987728 (MainThread): Connection 'model.sample_project.sales_report_one' was left open.
2020-06-30 03:41:17.987913 (MainThread): On model.sample_project.sales_report_one: Close
2020-06-30 03:41:18.270402 (MainThread): 
2020-06-30 03:41:18.270575 (MainThread): Completed with 1 error and 0 warnings:
2020-06-30 03:41:18.270699 (MainThread): 
2020-06-30 03:41:18.270813 (MainThread): Database Error in model sales_report_two (models/reports/sales_report_two.sql)
2020-06-30 03:41:18.270918 (MainThread):   001003 (42000): SQL compilation error:
2020-06-30 03:41:18.271014 (MainThread):   syntax error line 17 at position 6 unexpected ')'.
2020-06-30 03:41:18.271108 (MainThread):   compiled SQL at target/run/sample_project/models/reports/sales_report_two.sql
2020-06-30 03:41:18.271211 (MainThread): 
Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
2020-06-30 03:41:18.271376 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109173790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10924ae90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10924ae10>]}
2020-06-30 03:41:18.271558 (MainThread): Flushing usage events
2020-06-30 14:33:32.642022 (MainThread): Running with dbt=0.17.0
2020-06-30 14:33:33.299583 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-06-30 14:33:33.301151 (MainThread): Tracking: tracking
2020-06-30 14:33:33.301476 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d24a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d3aa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d3a950>]}
2020-06-30 14:33:33.324677 (MainThread): Partial parsing not enabled
2020-06-30 14:33:33.328255 (MainThread): Parsing macros/core.sql
2020-06-30 14:33:33.334048 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-30 14:33:33.343724 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-30 14:33:33.346000 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-30 14:33:33.365909 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-30 14:33:33.400239 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-30 14:33:33.424503 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-30 14:33:33.426611 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-30 14:33:33.433641 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-30 14:33:33.448910 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-30 14:33:33.456708 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-30 14:33:33.464127 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-30 14:33:33.469660 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-30 14:33:33.471210 (MainThread): Parsing macros/etc/query.sql
2020-06-30 14:33:33.472485 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-30 14:33:33.474905 (MainThread): Parsing macros/etc/datetime.sql
2020-06-30 14:33:33.486297 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-30 14:33:33.489962 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-30 14:33:33.492336 (MainThread): Parsing macros/adapters/common.sql
2020-06-30 14:33:33.550397 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-30 14:33:33.551840 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-30 14:33:33.553446 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-30 14:33:33.555675 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-30 14:33:33.558958 (MainThread): Parsing macros/catalog.sql
2020-06-30 14:33:33.561584 (MainThread): Parsing macros/adapters.sql
2020-06-30 14:33:33.587335 (MainThread): Parsing macros/materializations/merge.sql
2020-06-30 14:33:33.589964 (MainThread): Parsing macros/materializations/view.sql
2020-06-30 14:33:33.591628 (MainThread): Parsing macros/materializations/table.sql
2020-06-30 14:33:33.595838 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-30 14:33:33.640428 (MainThread): Partial parsing not enabled
2020-06-30 14:33:33.644181 (MainThread): Parsing macros/cross_db_utils/except.sql
2020-06-30 14:33:33.645798 (MainThread): Parsing macros/cross_db_utils/replace.sql
2020-06-30 14:33:33.647507 (MainThread): Parsing macros/cross_db_utils/concat.sql
2020-06-30 14:33:33.650454 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2020-06-30 14:33:33.657968 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2020-06-30 14:33:33.659627 (MainThread): Parsing macros/cross_db_utils/length.sql
2020-06-30 14:33:33.661339 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2020-06-30 14:33:33.664744 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2020-06-30 14:33:33.666131 (MainThread): Parsing macros/cross_db_utils/right.sql
2020-06-30 14:33:33.668903 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2020-06-30 14:33:33.682962 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2020-06-30 14:33:33.687681 (MainThread): Parsing macros/cross_db_utils/hash.sql
2020-06-30 14:33:33.690031 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2020-06-30 14:33:33.691748 (MainThread): Parsing macros/cross_db_utils/position.sql
2020-06-30 14:33:33.693984 (MainThread): Parsing macros/cross_db_utils/literal.sql
2020-06-30 14:33:33.695073 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2020-06-30 14:33:33.698759 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2020-06-30 14:33:33.704691 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2020-06-30 14:33:33.709166 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2020-06-30 14:33:33.711427 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2020-06-30 14:33:33.713363 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2020-06-30 14:33:33.743696 (MainThread): Parsing macros/logger/pretty_log_format.sql
2020-06-30 14:33:33.744633 (MainThread): Parsing macros/logger/pretty_time.sql
2020-06-30 14:33:33.745607 (MainThread): Parsing macros/logger/log_info.sql
2020-06-30 14:33:33.746473 (MainThread): Parsing macros/datetime/date_spine.sql
2020-06-30 14:33:33.750584 (MainThread): Parsing macros/web/get_url_host.sql
2020-06-30 14:33:33.752495 (MainThread): Parsing macros/web/get_url_path.sql
2020-06-30 14:33:33.755128 (MainThread): Parsing macros/web/get_url_parameter.sql
2020-06-30 14:33:33.756519 (MainThread): Parsing macros/geo/haversine_distance.sql
2020-06-30 14:33:33.757656 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2020-06-30 14:33:33.759237 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2020-06-30 14:33:33.761723 (MainThread): Parsing macros/schema_tests/recency.sql
2020-06-30 14:33:33.763320 (MainThread): Parsing macros/schema_tests/not_constant.sql
2020-06-30 14:33:33.764522 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2020-06-30 14:33:33.765757 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2020-06-30 14:33:33.767276 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2020-06-30 14:33:33.769047 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2020-06-30 14:33:33.770356 (MainThread): Parsing macros/schema_tests/equality.sql
2020-06-30 14:33:33.773846 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2020-06-30 14:33:33.780296 (MainThread): Parsing macros/sql/nullcheck_table.sql
2020-06-30 14:33:33.781800 (MainThread): Parsing macros/sql/generate_series.sql
2020-06-30 14:33:33.786012 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2020-06-30 14:33:33.791721 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2020-06-30 14:33:33.799097 (MainThread): Parsing macros/sql/star.sql
2020-06-30 14:33:33.802860 (MainThread): Parsing macros/sql/unpivot.sql
2020-06-30 14:33:33.810680 (MainThread): Parsing macros/sql/union.sql
2020-06-30 14:33:33.822608 (MainThread): Parsing macros/sql/groupby.sql
2020-06-30 14:33:33.823799 (MainThread): Parsing macros/sql/surrogate_key.sql
2020-06-30 14:33:33.827354 (MainThread): Parsing macros/sql/safe_add.sql
2020-06-30 14:33:33.828747 (MainThread): Parsing macros/sql/nullcheck.sql
2020-06-30 14:33:33.830467 (MainThread): Parsing macros/sql/get_column_values.sql
2020-06-30 14:33:33.835830 (MainThread): Parsing macros/sql/pivot.sql
2020-06-30 14:33:33.839893 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2020-06-30 14:33:33.893121 (MainThread): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 14:33:33.893271 (MainThread): Opening a new connection, currently in state init
2020-06-30 14:33:33.925233 (MainThread): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 14:33:33.925344 (MainThread): Opening a new connection, currently in state init
2020-06-30 14:33:33.938433 (MainThread): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 14:33:33.938534 (MainThread): Opening a new connection, currently in state init
2020-06-30 14:33:33.952757 (MainThread): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 14:33:33.952924 (MainThread): Opening a new connection, currently in state init
2020-06-30 14:33:33.967173 (MainThread): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 14:33:33.967292 (MainThread): Opening a new connection, currently in state init
2020-06-30 14:33:33.981199 (MainThread): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 14:33:33.981303 (MainThread): Opening a new connection, currently in state init
2020-06-30 14:33:33.994992 (MainThread): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 14:33:33.995091 (MainThread): Opening a new connection, currently in state init
2020-06-30 14:33:34.008589 (MainThread): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 14:33:34.008691 (MainThread): Opening a new connection, currently in state init
2020-06-30 14:33:34.021737 (MainThread): Acquiring new snowflake connection "model.sample_project.sales_report_one".
2020-06-30 14:33:34.021833 (MainThread): Opening a new connection, currently in state init
2020-06-30 14:33:34.034862 (MainThread): Acquiring new snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 14:33:34.034964 (MainThread): Opening a new connection, currently in state init
2020-06-30 14:33:34.056939 (MainThread): Acquiring new snowflake connection "model.sample_project.sales_report_two".
2020-06-30 14:33:34.057103 (MainThread): Opening a new connection, currently in state init
2020-06-30 14:33:34.554205 (MainThread): Found 11 models, 8 tests, 0 snapshots, 0 analyses, 263 macros, 0 operations, 0 seed files, 4 sources
2020-06-30 14:33:34.556179 (MainThread): 
2020-06-30 14:33:34.556520 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 14:33:34.556668 (MainThread): Opening a new connection, currently in state init
2020-06-30 14:33:34.561588 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_JAVEN_TESTING".
2020-06-30 14:33:34.561819 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-06-30 14:33:34.574425 (ThreadPoolExecutor-0_0): Using snowflake connection "list_JAVEN_TESTING".
2020-06-30 14:33:34.574525 (ThreadPoolExecutor-0_0): On list_JAVEN_TESTING: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING"} */

    show terse schemas in database JAVEN_TESTING
    limit 10000
2020-06-30 14:33:36.086995 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/certifi/cacert.pem'>
2020-06-30 14:33:44.317332 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 9.74 seconds
2020-06-30 14:33:44.348932 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 14:33:44.349131 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_JAVEN_TESTING).
2020-06-30 14:33:44.356319 (ThreadPoolExecutor-1_0): Using snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 14:33:44.356481 (ThreadPoolExecutor-1_0): On list_JAVEN_TESTING_TEST: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING_TEST"} */

    show terse objects in JAVEN_TESTING.TEST
2020-06-30 14:33:44.581119 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 9 in 0.22 seconds
2020-06-30 14:33:44.590256 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 14:33:44.590369 (MainThread): Opening a new connection, currently in state init
2020-06-30 14:33:44.590532 (MainThread): Using snowflake connection "master".
2020-06-30 14:33:44.590622 (MainThread): On master: BEGIN
2020-06-30 14:33:48.995713 (MainThread): SQL status: SUCCESS 1 in 4.40 seconds
2020-06-30 14:33:48.995880 (MainThread): On master: COMMIT
2020-06-30 14:33:48.996008 (MainThread): Using snowflake connection "master".
2020-06-30 14:33:48.996105 (MainThread): On master: COMMIT
2020-06-30 14:33:49.326249 (MainThread): SQL status: SUCCESS 1 in 0.33 seconds
2020-06-30 14:33:49.326610 (MainThread): 09:33:49 | Concurrency: 1 threads (target='dev')
2020-06-30 14:33:49.326754 (MainThread): 09:33:49 | 
2020-06-30 14:33:49.327560 (Thread-1): Began running node model.sample_project.customer
2020-06-30 14:33:49.327887 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 14:33:49.327991 (Thread-1): Re-using an available connection from the pool (formerly list_JAVEN_TESTING_TEST).
2020-06-30 14:33:49.328098 (Thread-1): Compiling model.sample_project.customer
2020-06-30 14:33:49.347347 (Thread-1): Writing injected SQL for node "model.sample_project.customer"
2020-06-30 14:33:49.348206 (Thread-1): finished collecting timing info
2020-06-30 14:33:49.348621 (Thread-1): Finished running node model.sample_project.customer
2020-06-30 14:33:49.348782 (Thread-1): Began running node model.sample_project.lineitem
2020-06-30 14:33:49.349250 (Thread-1): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 14:33:49.349338 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer).
2020-06-30 14:33:49.349453 (Thread-1): Compiling model.sample_project.lineitem
2020-06-30 14:33:49.356111 (Thread-1): Writing injected SQL for node "model.sample_project.lineitem"
2020-06-30 14:33:49.356380 (Thread-1): finished collecting timing info
2020-06-30 14:33:49.356691 (Thread-1): Finished running node model.sample_project.lineitem
2020-06-30 14:33:49.356802 (Thread-1): Began running node model.sample_project.nation
2020-06-30 14:33:49.357062 (Thread-1): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 14:33:49.357151 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.lineitem).
2020-06-30 14:33:49.357229 (Thread-1): Compiling model.sample_project.nation
2020-06-30 14:33:49.365591 (Thread-1): Writing injected SQL for node "model.sample_project.nation"
2020-06-30 14:33:49.366227 (Thread-1): finished collecting timing info
2020-06-30 14:33:49.366692 (Thread-1): Finished running node model.sample_project.nation
2020-06-30 14:33:49.366883 (Thread-1): Began running node model.sample_project.orders
2020-06-30 14:33:49.367696 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 14:33:49.367966 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.nation).
2020-06-30 14:33:49.368060 (Thread-1): Compiling model.sample_project.orders
2020-06-30 14:33:49.375987 (Thread-1): Writing injected SQL for node "model.sample_project.orders"
2020-06-30 14:33:49.376259 (Thread-1): finished collecting timing info
2020-06-30 14:33:49.376580 (Thread-1): Finished running node model.sample_project.orders
2020-06-30 14:33:49.376693 (Thread-1): Began running node model.sample_project.customer_nation
2020-06-30 14:33:49.377349 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 14:33:49.377660 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders).
2020-06-30 14:33:49.377815 (Thread-1): Compiling model.sample_project.customer_nation
2020-06-30 14:33:49.392365 (Thread-1): Writing injected SQL for node "model.sample_project.customer_nation"
2020-06-30 14:33:49.393160 (Thread-1): finished collecting timing info
2020-06-30 14:33:49.393599 (Thread-1): Finished running node model.sample_project.customer_nation
2020-06-30 14:33:49.393736 (Thread-1): Began running node model.sample_project.orders_lineitem
2020-06-30 14:33:49.394097 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 14:33:49.394294 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer_nation).
2020-06-30 14:33:49.394409 (Thread-1): Compiling model.sample_project.orders_lineitem
2020-06-30 14:33:49.407367 (Thread-1): Writing injected SQL for node "model.sample_project.orders_lineitem"
2020-06-30 14:33:49.408136 (Thread-1): finished collecting timing info
2020-06-30 14:33:49.408542 (Thread-1): Finished running node model.sample_project.orders_lineitem
2020-06-30 14:33:49.408676 (Thread-1): Began running node model.sample_project.customers_per_nation
2020-06-30 14:33:49.409738 (Thread-1): 09:33:49 | 1 of 4 START table model TEST.customers_per_nation................... [RUN]
2020-06-30 14:33:49.410163 (Thread-1): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 14:33:49.410265 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders_lineitem).
2020-06-30 14:33:49.410356 (Thread-1): Compiling model.sample_project.customers_per_nation
2020-06-30 14:33:49.419552 (Thread-1): Writing injected SQL for node "model.sample_project.customers_per_nation"
2020-06-30 14:33:49.419904 (Thread-1): finished collecting timing info
2020-06-30 14:33:49.448277 (Thread-1): Writing runtime SQL for node "model.sample_project.customers_per_nation"
2020-06-30 14:33:49.450467 (Thread-1): Using snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 14:33:49.450561 (Thread-1): On model.sample_project.customers_per_nation: BEGIN
2020-06-30 14:33:49.936325 (Thread-1): SQL status: SUCCESS 1 in 0.49 seconds
2020-06-30 14:33:49.936480 (Thread-1): Using snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 14:33:49.936605 (Thread-1): On model.sample_project.customers_per_nation: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "model.sample_project.customers_per_nation"} */


      create or replace transient table JAVEN_TESTING.TEST.customers_per_nation  as
      (with __dbt__CTE__customer as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  c_custkey as custkey,
        c_nationkey as nationkey,
        c_name as name
from snowflake_sample_data.tpch_sf1.customer
),  __dbt__CTE__nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  n_nationkey as nationkey,
        n_name as name
from snowflake_sample_data.tpch_sf1.nation
),  __dbt__CTE__customer_nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  c.custkey,
        c.nationkey,
        c.name as customer_name,
        n.name as nation_name
from __dbt__CTE__customer as c
JOIN __dbt__CTE__nation as n
ON c.nationkey=n.nationkey
)/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  count(customer_name) as customer_count,
        nation_name
from __dbt__CTE__customer_nation
group by nation_name
order by nation_name
      );
2020-06-30 14:33:53.556882 (Thread-1): SQL status: SUCCESS 1 in 3.62 seconds
2020-06-30 14:33:53.558042 (Thread-1): On model.sample_project.customers_per_nation: COMMIT
2020-06-30 14:33:53.558206 (Thread-1): Using snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 14:33:53.558311 (Thread-1): On model.sample_project.customers_per_nation: COMMIT
2020-06-30 14:33:53.785948 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2020-06-30 14:33:53.795774 (Thread-1): finished collecting timing info
2020-06-30 14:33:53.796476 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '723fa91b-da08-4c68-a71a-526d0961961b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ac7e90>]}
2020-06-30 14:33:53.797756 (Thread-1): 09:33:53 | 1 of 4 OK created table model TEST.customers_per_nation.............. [SUCCESS 1 in 4.39s]
2020-06-30 14:33:53.797906 (Thread-1): Finished running node model.sample_project.customers_per_nation
2020-06-30 14:33:53.798032 (Thread-1): Began running node model.sample_project.cust_list_ord_nat
2020-06-30 14:33:53.798410 (Thread-1): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 14:33:53.798504 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customers_per_nation).
2020-06-30 14:33:53.798593 (Thread-1): Compiling model.sample_project.cust_list_ord_nat
2020-06-30 14:33:53.813297 (Thread-1): Writing injected SQL for node "model.sample_project.cust_list_ord_nat"
2020-06-30 14:33:53.813745 (Thread-1): finished collecting timing info
2020-06-30 14:33:53.814162 (Thread-1): Finished running node model.sample_project.cust_list_ord_nat
2020-06-30 14:33:53.814298 (Thread-1): Began running node model.sample_project.average_price_per_order
2020-06-30 14:33:53.815381 (Thread-1): 09:33:53 | 2 of 4 START table model TEST.average_price_per_order................ [RUN]
2020-06-30 14:33:53.815770 (Thread-1): Acquiring new snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 14:33:53.815885 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.cust_list_ord_nat).
2020-06-30 14:33:53.815987 (Thread-1): Compiling model.sample_project.average_price_per_order
2020-06-30 14:33:53.829448 (Thread-1): Writing injected SQL for node "model.sample_project.average_price_per_order"
2020-06-30 14:33:53.830335 (Thread-1): finished collecting timing info
2020-06-30 14:33:53.834905 (Thread-1): Writing runtime SQL for node "model.sample_project.average_price_per_order"
2020-06-30 14:33:53.837319 (Thread-1): Using snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 14:33:53.837419 (Thread-1): On model.sample_project.average_price_per_order: BEGIN
2020-06-30 14:33:54.033453 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2020-06-30 14:33:54.033586 (Thread-1): Using snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 14:33:54.033662 (Thread-1): On model.sample_project.average_price_per_order: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "model.sample_project.average_price_per_order"} */


      create or replace transient table JAVEN_TESTING.TEST.average_price_per_order  as
      (with __dbt__CTE__orders as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  o_orderkey as orderkey,
        o_custkey as custkey,
        o_totalprice as totalprice,
        o_orderdate as orderdate
from snowflake_sample_data.tpch_sf1.orders
),  __dbt__CTE__lineitem as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  l_orderkey as orderkey,
        l_extendedprice as extendedprice,
        l_discount as discount,
        l_tax as tax,
        l_quantity as quantity
from snowflake_sample_data.tpch_sf1.lineitem
),  __dbt__CTE__orders_lineitem as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  o.orderkey,
        o.custkey,
        o.totalprice,
        o.orderdate,
        l.extendedprice,
        l.discount,
        l.tax,
        l.quantity
from __dbt__CTE__orders as o
JOIN __dbt__CTE__lineitem as l
ON o.orderkey=l.orderkey
)/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  avg(totalprice) as average_order_price,
        sum(quantity) as total_quantity_per_order,
        listagg(quantity, '|~~|') as quantities_per_order,
        count(quantity) as items_per_order,
        
  
    width_bucket(average_order_price, 184000, 200000, 10 )

 as price_histogram,
        orderdate
from __dbt__CTE__orders_lineitem
group by orderdate
      );
2020-06-30 14:33:56.731750 (Thread-1): SQL status: SUCCESS 1 in 2.70 seconds
2020-06-30 14:33:56.732715 (Thread-1): On model.sample_project.average_price_per_order: COMMIT
2020-06-30 14:33:56.732868 (Thread-1): Using snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 14:33:56.732959 (Thread-1): On model.sample_project.average_price_per_order: COMMIT
2020-06-30 14:33:56.894093 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2020-06-30 14:33:56.896225 (Thread-1): finished collecting timing info
2020-06-30 14:33:56.896847 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '723fa91b-da08-4c68-a71a-526d0961961b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b189d0>]}
2020-06-30 14:33:56.897916 (Thread-1): 09:33:56 | 2 of 4 OK created table model TEST.average_price_per_order........... [SUCCESS 1 in 3.08s]
2020-06-30 14:33:56.898051 (Thread-1): Finished running node model.sample_project.average_price_per_order
2020-06-30 14:33:56.898185 (Thread-1): Began running node model.sample_project.sales_report_one
2020-06-30 14:33:56.899501 (Thread-1): 09:33:56 | 3 of 4 START table model TEST.sales_report_one....................... [RUN]
2020-06-30 14:33:56.899768 (Thread-1): Acquiring new snowflake connection "model.sample_project.sales_report_one".
2020-06-30 14:33:56.899859 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.average_price_per_order).
2020-06-30 14:33:56.899949 (Thread-1): Compiling model.sample_project.sales_report_one
2020-06-30 14:33:56.910769 (Thread-1): Writing injected SQL for node "model.sample_project.sales_report_one"
2020-06-30 14:33:56.911857 (Thread-1): finished collecting timing info
2020-06-30 14:33:56.916628 (Thread-1): Writing runtime SQL for node "model.sample_project.sales_report_one"
2020-06-30 14:33:56.920676 (Thread-1): Using snowflake connection "model.sample_project.sales_report_one".
2020-06-30 14:33:56.920779 (Thread-1): On model.sample_project.sales_report_one: BEGIN
2020-06-30 14:33:57.175507 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2020-06-30 14:33:57.175657 (Thread-1): Using snowflake connection "model.sample_project.sales_report_one".
2020-06-30 14:33:57.175748 (Thread-1): On model.sample_project.sales_report_one: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "model.sample_project.sales_report_one"} */


      create or replace transient table JAVEN_TESTING.TEST.sales_report_one  as
      (with __dbt__CTE__customer as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  c_custkey as custkey,
        c_nationkey as nationkey,
        c_name as name
from snowflake_sample_data.tpch_sf1.customer
),  __dbt__CTE__nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  n_nationkey as nationkey,
        n_name as name
from snowflake_sample_data.tpch_sf1.nation
),  __dbt__CTE__customer_nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  c.custkey,
        c.nationkey,
        c.name as customer_name,
        n.name as nation_name
from __dbt__CTE__customer as c
JOIN __dbt__CTE__nation as n
ON c.nationkey=n.nationkey
),  __dbt__CTE__orders as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  o_orderkey as orderkey,
        o_custkey as custkey,
        o_totalprice as totalprice,
        o_orderdate as orderdate
from snowflake_sample_data.tpch_sf1.orders
),  __dbt__CTE__lineitem as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  l_orderkey as orderkey,
        l_extendedprice as extendedprice,
        l_discount as discount,
        l_tax as tax,
        l_quantity as quantity
from snowflake_sample_data.tpch_sf1.lineitem
),  __dbt__CTE__orders_lineitem as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  o.orderkey,
        o.custkey,
        o.totalprice,
        o.orderdate,
        l.extendedprice,
        l.discount,
        l.tax,
        l.quantity
from __dbt__CTE__orders as o
JOIN __dbt__CTE__lineitem as l
ON o.orderkey=l.orderkey
),  __dbt__CTE__cust_list_ord_nat as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  cn.custkey,
        cn.nationkey,
        cn.customer_name,
        cn.nation_name,
        ol.orderkey,
        ol.totalprice,
        ol.orderdate,
        ol.extendedprice,
        ol.discount,
        ol.tax,
        ol.quantity
from __dbt__CTE__customer_nation as cn
JOIN __dbt__CTE__orders_lineitem as ol
ON cn.custkey=ol.custkey
)/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  extendedprice * (1.0-discount) as discounted_price_pre_tax,
        discounted_price_pre_tax * (1.0 + tax) as discounted_price,
        discounted_price_pre_tax * tax as tax_charged,
        *
from __dbt__CTE__cust_list_ord_nat
      );
2020-06-30 14:34:02.512624 (Thread-1): SQL status: SUCCESS 1 in 5.34 seconds
2020-06-30 14:34:02.513429 (Thread-1): On model.sample_project.sales_report_one: COMMIT
2020-06-30 14:34:02.513546 (Thread-1): Using snowflake connection "model.sample_project.sales_report_one".
2020-06-30 14:34:02.513619 (Thread-1): On model.sample_project.sales_report_one: COMMIT
2020-06-30 14:34:02.682542 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2020-06-30 14:34:02.685611 (Thread-1): finished collecting timing info
2020-06-30 14:34:02.686349 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '723fa91b-da08-4c68-a71a-526d0961961b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ac5850>]}
2020-06-30 14:34:02.687630 (Thread-1): 09:34:02 | 3 of 4 OK created table model TEST.sales_report_one.................. [SUCCESS 1 in 5.79s]
2020-06-30 14:34:02.687893 (Thread-1): Finished running node model.sample_project.sales_report_one
2020-06-30 14:34:02.688062 (Thread-1): Began running node model.sample_project.sales_report_two
2020-06-30 14:34:02.689342 (Thread-1): 09:34:02 | 4 of 4 START table model TEST.sales_report_two....................... [RUN]
2020-06-30 14:34:02.689672 (Thread-1): Acquiring new snowflake connection "model.sample_project.sales_report_two".
2020-06-30 14:34:02.689766 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.sales_report_one).
2020-06-30 14:34:02.689860 (Thread-1): Compiling model.sample_project.sales_report_two
2020-06-30 14:34:02.702046 (Thread-1): Writing injected SQL for node "model.sample_project.sales_report_two"
2020-06-30 14:34:02.703158 (Thread-1): finished collecting timing info
2020-06-30 14:34:02.707844 (Thread-1): Writing runtime SQL for node "model.sample_project.sales_report_two"
2020-06-30 14:34:02.711721 (Thread-1): Using snowflake connection "model.sample_project.sales_report_two".
2020-06-30 14:34:02.711823 (Thread-1): On model.sample_project.sales_report_two: BEGIN
2020-06-30 14:34:02.986050 (Thread-1): SQL status: SUCCESS 1 in 0.27 seconds
2020-06-30 14:34:02.986194 (Thread-1): Using snowflake connection "model.sample_project.sales_report_two".
2020-06-30 14:34:02.986282 (Thread-1): On model.sample_project.sales_report_two: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "model.sample_project.sales_report_two"} */


      create or replace transient table JAVEN_TESTING.TEST.sales_report_two  as
      (with __dbt__CTE__customer as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  c_custkey as custkey,
        c_nationkey as nationkey,
        c_name as name
from snowflake_sample_data.tpch_sf1.customer
),  __dbt__CTE__nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  n_nationkey as nationkey,
        n_name as name
from snowflake_sample_data.tpch_sf1.nation
),  __dbt__CTE__customer_nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  c.custkey,
        c.nationkey,
        c.name as customer_name,
        n.name as nation_name
from __dbt__CTE__customer as c
JOIN __dbt__CTE__nation as n
ON c.nationkey=n.nationkey
),  __dbt__CTE__orders as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  o_orderkey as orderkey,
        o_custkey as custkey,
        o_totalprice as totalprice,
        o_orderdate as orderdate
from snowflake_sample_data.tpch_sf1.orders
),  __dbt__CTE__lineitem as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  l_orderkey as orderkey,
        l_extendedprice as extendedprice,
        l_discount as discount,
        l_tax as tax,
        l_quantity as quantity
from snowflake_sample_data.tpch_sf1.lineitem
),  __dbt__CTE__orders_lineitem as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  o.orderkey,
        o.custkey,
        o.totalprice,
        o.orderdate,
        l.extendedprice,
        l.discount,
        l.tax,
        l.quantity
from __dbt__CTE__orders as o
JOIN __dbt__CTE__lineitem as l
ON o.orderkey=l.orderkey
),  __dbt__CTE__cust_list_ord_nat as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  cn.custkey,
        cn.nationkey,
        cn.customer_name,
        cn.nation_name,
        ol.orderkey,
        ol.totalprice,
        ol.orderdate,
        ol.extendedprice,
        ol.discount,
        ol.tax,
        ol.quantity
from __dbt__CTE__customer_nation as cn
JOIN __dbt__CTE__orders_lineitem as ol
ON cn.custkey=ol.custkey
)/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  listagg(discount, '|~~|') as discounts,
        avg(extendedprice * (1.0-discount) * tax) as average_tax,
        orderkey,
        custkey
from __dbt__CTE__cust_list_ord_nat
group by orderkey
and custkey
      );
2020-06-30 14:34:03.452703 (Thread-1): Snowflake query id: 0195414a-024a-ed8f-0000-2aed011d1312
2020-06-30 14:34:03.452853 (Thread-1): Snowflake error: 001104 (42601): SQL compilation error: error line 193 at position 8
'__DBT__CTE__CUST_LIST_ORD_NAT.ORDERKEY' in select clause is neither an aggregate nor in the group by clause.
2020-06-30 14:34:03.452939 (Thread-1): On model.sample_project.sales_report_two: ROLLBACK
2020-06-30 14:34:03.453003 (Thread-1): initiating rollback
2020-06-30 14:34:03.716404 (Thread-1): finished collecting timing info
2020-06-30 14:34:03.716944 (Thread-1): Database Error in model sales_report_two (models/reports/sales_report_two.sql)
  001104 (42601): SQL compilation error: error line 193 at position 8
  '__DBT__CTE__CUST_LIST_ORD_NAT.ORDERKEY' in select clause is neither an aggregate nor in the group by clause.
  compiled SQL at target/run/sample_project/models/reports/sales_report_two.sql
Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 158, in exception_handler
    yield
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/cursor.py", line 597, in execute
    errvalue)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/errors.py", line 97, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, errorclass, errorvalue)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/errors.py", line 73, in default_errorhandler
    done_format_msg=errorvalue.get(u'done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001104 (42601): SQL compilation error: error line 193 at position 8
'__DBT__CTE__CUST_LIST_ORD_NAT.ORDERKEY' in select clause is neither an aggregate nor in the group by clause.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 119, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 306, in add_query
    abridge_sql_log=abridge_sql_log
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/usr/local/opt/python/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 177, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model sales_report_two (models/reports/sales_report_two.sql)
  001104 (42601): SQL compilation error: error line 193 at position 8
  '__DBT__CTE__CUST_LIST_ORD_NAT.ORDERKEY' in select clause is neither an aggregate nor in the group by clause.
  compiled SQL at target/run/sample_project/models/reports/sales_report_two.sql
2020-06-30 14:34:03.725677 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '723fa91b-da08-4c68-a71a-526d0961961b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079c6d10>]}
2020-06-30 14:34:03.726936 (Thread-1): 09:34:03 | 4 of 4 ERROR creating table model TEST.sales_report_two.............. [ERROR in 1.04s]
2020-06-30 14:34:03.727123 (Thread-1): Finished running node model.sample_project.sales_report_two
2020-06-30 14:34:03.759861 (MainThread): Using snowflake connection "master".
2020-06-30 14:34:03.760009 (MainThread): On master: BEGIN
2020-06-30 14:34:03.995823 (MainThread): SQL status: SUCCESS 1 in 0.24 seconds
2020-06-30 14:34:03.995997 (MainThread): On master: COMMIT
2020-06-30 14:34:03.996138 (MainThread): Using snowflake connection "master".
2020-06-30 14:34:03.996227 (MainThread): On master: COMMIT
2020-06-30 14:34:04.339568 (MainThread): SQL status: SUCCESS 1 in 0.34 seconds
2020-06-30 14:34:04.339938 (MainThread): 09:34:04 | 
2020-06-30 14:34:04.340070 (MainThread): 09:34:04 | Finished running 4 table models in 29.78s.
2020-06-30 14:34:04.340173 (MainThread): Connection 'master' was left open.
2020-06-30 14:34:04.340256 (MainThread): On master: Close
2020-06-30 14:34:04.659972 (MainThread): Connection 'model.sample_project.sales_report_two' was left open.
2020-06-30 14:34:04.660122 (MainThread): On model.sample_project.sales_report_two: Close
2020-06-30 14:34:05.068048 (MainThread): 
2020-06-30 14:34:05.068193 (MainThread): Completed with 1 error and 0 warnings:
2020-06-30 14:34:05.068318 (MainThread): 
2020-06-30 14:34:05.068470 (MainThread): Database Error in model sales_report_two (models/reports/sales_report_two.sql)
2020-06-30 14:34:05.068585 (MainThread):   001104 (42601): SQL compilation error: error line 193 at position 8
2020-06-30 14:34:05.068744 (MainThread):   '__DBT__CTE__CUST_LIST_ORD_NAT.ORDERKEY' in select clause is neither an aggregate nor in the group by clause.
2020-06-30 14:34:05.068890 (MainThread):   compiled SQL at target/run/sample_project/models/reports/sales_report_two.sql
2020-06-30 14:34:05.069011 (MainThread): 
Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
2020-06-30 14:34:05.069358 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ac7490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079d0fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107674ad0>]}
2020-06-30 14:34:05.069625 (MainThread): Flushing usage events
2020-06-30 14:35:50.037427 (MainThread): Running with dbt=0.17.0
2020-06-30 14:35:50.379901 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-06-30 14:35:50.380702 (MainThread): Tracking: tracking
2020-06-30 14:35:50.381017 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ffbb6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ffbb910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ffbbb10>]}
2020-06-30 14:35:50.403469 (MainThread): Partial parsing not enabled
2020-06-30 14:35:50.405407 (MainThread): Parsing macros/core.sql
2020-06-30 14:35:50.411251 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-30 14:35:50.421279 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-30 14:35:50.424125 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-30 14:35:50.446223 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-30 14:35:50.478655 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-30 14:35:50.503853 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-30 14:35:50.506254 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-30 14:35:50.514400 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-30 14:35:50.530686 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-30 14:35:50.538845 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-30 14:35:50.545877 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-30 14:35:50.551324 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-30 14:35:50.552345 (MainThread): Parsing macros/etc/query.sql
2020-06-30 14:35:50.553479 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-30 14:35:50.555403 (MainThread): Parsing macros/etc/datetime.sql
2020-06-30 14:35:50.566367 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-30 14:35:50.568427 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-30 14:35:50.570526 (MainThread): Parsing macros/adapters/common.sql
2020-06-30 14:35:50.628163 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-30 14:35:50.629555 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-30 14:35:50.630517 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-30 14:35:50.631650 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-30 14:35:50.634870 (MainThread): Parsing macros/catalog.sql
2020-06-30 14:35:50.638369 (MainThread): Parsing macros/adapters.sql
2020-06-30 14:35:50.666797 (MainThread): Parsing macros/materializations/merge.sql
2020-06-30 14:35:50.669465 (MainThread): Parsing macros/materializations/view.sql
2020-06-30 14:35:50.670950 (MainThread): Parsing macros/materializations/table.sql
2020-06-30 14:35:50.675800 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-30 14:35:50.722686 (MainThread): Partial parsing not enabled
2020-06-30 14:35:50.724504 (MainThread): Parsing macros/cross_db_utils/except.sql
2020-06-30 14:35:50.725649 (MainThread): Parsing macros/cross_db_utils/replace.sql
2020-06-30 14:35:50.727052 (MainThread): Parsing macros/cross_db_utils/concat.sql
2020-06-30 14:35:50.729449 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2020-06-30 14:35:50.735920 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2020-06-30 14:35:50.738224 (MainThread): Parsing macros/cross_db_utils/length.sql
2020-06-30 14:35:50.740221 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2020-06-30 14:35:50.743490 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2020-06-30 14:35:50.744702 (MainThread): Parsing macros/cross_db_utils/right.sql
2020-06-30 14:35:50.747369 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2020-06-30 14:35:50.759329 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2020-06-30 14:35:50.761709 (MainThread): Parsing macros/cross_db_utils/hash.sql
2020-06-30 14:35:50.763420 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2020-06-30 14:35:50.765108 (MainThread): Parsing macros/cross_db_utils/position.sql
2020-06-30 14:35:50.766848 (MainThread): Parsing macros/cross_db_utils/literal.sql
2020-06-30 14:35:50.768096 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2020-06-30 14:35:50.771586 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2020-06-30 14:35:50.777425 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2020-06-30 14:35:50.780657 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2020-06-30 14:35:50.782694 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2020-06-30 14:35:50.784648 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2020-06-30 14:35:50.810889 (MainThread): Parsing macros/logger/pretty_log_format.sql
2020-06-30 14:35:50.811759 (MainThread): Parsing macros/logger/pretty_time.sql
2020-06-30 14:35:50.812600 (MainThread): Parsing macros/logger/log_info.sql
2020-06-30 14:35:50.813367 (MainThread): Parsing macros/datetime/date_spine.sql
2020-06-30 14:35:50.817321 (MainThread): Parsing macros/web/get_url_host.sql
2020-06-30 14:35:50.819753 (MainThread): Parsing macros/web/get_url_path.sql
2020-06-30 14:35:50.822933 (MainThread): Parsing macros/web/get_url_parameter.sql
2020-06-30 14:35:50.824408 (MainThread): Parsing macros/geo/haversine_distance.sql
2020-06-30 14:35:50.825558 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2020-06-30 14:35:50.827357 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2020-06-30 14:35:50.830273 (MainThread): Parsing macros/schema_tests/recency.sql
2020-06-30 14:35:50.831840 (MainThread): Parsing macros/schema_tests/not_constant.sql
2020-06-30 14:35:50.833081 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2020-06-30 14:35:50.834314 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2020-06-30 14:35:50.835797 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2020-06-30 14:35:50.837647 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2020-06-30 14:35:50.838999 (MainThread): Parsing macros/schema_tests/equality.sql
2020-06-30 14:35:50.842812 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2020-06-30 14:35:50.849225 (MainThread): Parsing macros/sql/nullcheck_table.sql
2020-06-30 14:35:50.850343 (MainThread): Parsing macros/sql/generate_series.sql
2020-06-30 14:35:50.854389 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2020-06-30 14:35:50.858431 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2020-06-30 14:35:50.861305 (MainThread): Parsing macros/sql/star.sql
2020-06-30 14:35:50.864177 (MainThread): Parsing macros/sql/unpivot.sql
2020-06-30 14:35:50.871261 (MainThread): Parsing macros/sql/union.sql
2020-06-30 14:35:50.881266 (MainThread): Parsing macros/sql/groupby.sql
2020-06-30 14:35:50.882274 (MainThread): Parsing macros/sql/surrogate_key.sql
2020-06-30 14:35:50.885143 (MainThread): Parsing macros/sql/safe_add.sql
2020-06-30 14:35:50.886228 (MainThread): Parsing macros/sql/nullcheck.sql
2020-06-30 14:35:50.887616 (MainThread): Parsing macros/sql/get_column_values.sql
2020-06-30 14:35:50.892952 (MainThread): Parsing macros/sql/pivot.sql
2020-06-30 14:35:50.895868 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2020-06-30 14:35:50.944909 (MainThread): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 14:35:50.945034 (MainThread): Opening a new connection, currently in state init
2020-06-30 14:35:50.980454 (MainThread): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 14:35:50.980785 (MainThread): Opening a new connection, currently in state init
2020-06-30 14:35:50.999997 (MainThread): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 14:35:51.000138 (MainThread): Opening a new connection, currently in state init
2020-06-30 14:35:51.013586 (MainThread): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 14:35:51.013706 (MainThread): Opening a new connection, currently in state init
2020-06-30 14:35:51.026028 (MainThread): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 14:35:51.026122 (MainThread): Opening a new connection, currently in state init
2020-06-30 14:35:51.038691 (MainThread): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 14:35:51.038782 (MainThread): Opening a new connection, currently in state init
2020-06-30 14:35:51.053436 (MainThread): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 14:35:51.053589 (MainThread): Opening a new connection, currently in state init
2020-06-30 14:35:51.068244 (MainThread): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 14:35:51.068371 (MainThread): Opening a new connection, currently in state init
2020-06-30 14:35:51.082012 (MainThread): Acquiring new snowflake connection "model.sample_project.sales_report_one".
2020-06-30 14:35:51.082117 (MainThread): Opening a new connection, currently in state init
2020-06-30 14:35:51.094775 (MainThread): Acquiring new snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 14:35:51.094880 (MainThread): Opening a new connection, currently in state init
2020-06-30 14:35:51.111253 (MainThread): Acquiring new snowflake connection "model.sample_project.sales_report_two".
2020-06-30 14:35:51.111353 (MainThread): Opening a new connection, currently in state init
2020-06-30 14:35:51.582328 (MainThread): Found 11 models, 8 tests, 0 snapshots, 0 analyses, 263 macros, 0 operations, 0 seed files, 4 sources
2020-06-30 14:35:51.584734 (MainThread): 
2020-06-30 14:35:51.585077 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 14:35:51.585160 (MainThread): Opening a new connection, currently in state init
2020-06-30 14:35:51.590725 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_JAVEN_TESTING".
2020-06-30 14:35:51.591155 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-06-30 14:35:51.607884 (ThreadPoolExecutor-0_0): Using snowflake connection "list_JAVEN_TESTING".
2020-06-30 14:35:51.608036 (ThreadPoolExecutor-0_0): On list_JAVEN_TESTING: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING"} */

    show terse schemas in database JAVEN_TESTING
    limit 10000
2020-06-30 14:35:53.080718 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/certifi/cacert.pem'>
2020-06-30 14:36:00.349916 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 8.74 seconds
2020-06-30 14:36:00.378817 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 14:36:00.379056 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_JAVEN_TESTING).
2020-06-30 14:36:00.386197 (ThreadPoolExecutor-1_0): Using snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 14:36:00.386290 (ThreadPoolExecutor-1_0): On list_JAVEN_TESTING_TEST: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING_TEST"} */

    show terse objects in JAVEN_TESTING.TEST
2020-06-30 14:36:00.601246 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 9 in 0.21 seconds
2020-06-30 14:36:00.610343 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 14:36:00.610450 (MainThread): Opening a new connection, currently in state init
2020-06-30 14:36:00.610600 (MainThread): Using snowflake connection "master".
2020-06-30 14:36:00.610698 (MainThread): On master: BEGIN
2020-06-30 14:36:06.365585 (MainThread): SQL status: SUCCESS 1 in 5.75 seconds
2020-06-30 14:36:06.365760 (MainThread): On master: COMMIT
2020-06-30 14:36:06.365893 (MainThread): Using snowflake connection "master".
2020-06-30 14:36:06.365981 (MainThread): On master: COMMIT
2020-06-30 14:36:06.630513 (MainThread): SQL status: SUCCESS 1 in 0.26 seconds
2020-06-30 14:36:06.630867 (MainThread): 09:36:06 | Concurrency: 1 threads (target='dev')
2020-06-30 14:36:06.631006 (MainThread): 09:36:06 | 
2020-06-30 14:36:06.631680 (Thread-1): Began running node model.sample_project.customer
2020-06-30 14:36:06.631993 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 14:36:06.632097 (Thread-1): Re-using an available connection from the pool (formerly list_JAVEN_TESTING_TEST).
2020-06-30 14:36:06.632202 (Thread-1): Compiling model.sample_project.customer
2020-06-30 14:36:06.652421 (Thread-1): Writing injected SQL for node "model.sample_project.customer"
2020-06-30 14:36:06.652827 (Thread-1): finished collecting timing info
2020-06-30 14:36:06.653259 (Thread-1): Finished running node model.sample_project.customer
2020-06-30 14:36:06.653401 (Thread-1): Began running node model.sample_project.lineitem
2020-06-30 14:36:06.653747 (Thread-1): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 14:36:06.653858 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer).
2020-06-30 14:36:06.653956 (Thread-1): Compiling model.sample_project.lineitem
2020-06-30 14:36:06.662037 (Thread-1): Writing injected SQL for node "model.sample_project.lineitem"
2020-06-30 14:36:06.662333 (Thread-1): finished collecting timing info
2020-06-30 14:36:06.662676 (Thread-1): Finished running node model.sample_project.lineitem
2020-06-30 14:36:06.662841 (Thread-1): Began running node model.sample_project.nation
2020-06-30 14:36:06.663137 (Thread-1): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 14:36:06.663219 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.lineitem).
2020-06-30 14:36:06.663294 (Thread-1): Compiling model.sample_project.nation
2020-06-30 14:36:06.670339 (Thread-1): Writing injected SQL for node "model.sample_project.nation"
2020-06-30 14:36:06.670596 (Thread-1): finished collecting timing info
2020-06-30 14:36:06.670915 (Thread-1): Finished running node model.sample_project.nation
2020-06-30 14:36:06.671030 (Thread-1): Began running node model.sample_project.orders
2020-06-30 14:36:06.671372 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 14:36:06.671465 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.nation).
2020-06-30 14:36:06.671544 (Thread-1): Compiling model.sample_project.orders
2020-06-30 14:36:06.681218 (Thread-1): Writing injected SQL for node "model.sample_project.orders"
2020-06-30 14:36:06.682416 (Thread-1): finished collecting timing info
2020-06-30 14:36:06.683391 (Thread-1): Finished running node model.sample_project.orders
2020-06-30 14:36:06.683539 (Thread-1): Began running node model.sample_project.customer_nation
2020-06-30 14:36:06.683932 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 14:36:06.684117 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders).
2020-06-30 14:36:06.684213 (Thread-1): Compiling model.sample_project.customer_nation
2020-06-30 14:36:06.696673 (Thread-1): Writing injected SQL for node "model.sample_project.customer_nation"
2020-06-30 14:36:06.697629 (Thread-1): finished collecting timing info
2020-06-30 14:36:06.698344 (Thread-1): Finished running node model.sample_project.customer_nation
2020-06-30 14:36:06.698496 (Thread-1): Began running node model.sample_project.orders_lineitem
2020-06-30 14:36:06.699047 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 14:36:06.699169 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer_nation).
2020-06-30 14:36:06.699271 (Thread-1): Compiling model.sample_project.orders_lineitem
2020-06-30 14:36:06.714950 (Thread-1): Writing injected SQL for node "model.sample_project.orders_lineitem"
2020-06-30 14:36:06.715388 (Thread-1): finished collecting timing info
2020-06-30 14:36:06.715859 (Thread-1): Finished running node model.sample_project.orders_lineitem
2020-06-30 14:36:06.716010 (Thread-1): Began running node model.sample_project.customers_per_nation
2020-06-30 14:36:06.717154 (Thread-1): 09:36:06 | 1 of 4 START table model TEST.customers_per_nation................... [RUN]
2020-06-30 14:36:06.717546 (Thread-1): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 14:36:06.717661 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders_lineitem).
2020-06-30 14:36:06.717757 (Thread-1): Compiling model.sample_project.customers_per_nation
2020-06-30 14:36:06.727063 (Thread-1): Writing injected SQL for node "model.sample_project.customers_per_nation"
2020-06-30 14:36:06.727478 (Thread-1): finished collecting timing info
2020-06-30 14:36:06.759524 (Thread-1): Writing runtime SQL for node "model.sample_project.customers_per_nation"
2020-06-30 14:36:06.761397 (Thread-1): Using snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 14:36:06.761489 (Thread-1): On model.sample_project.customers_per_nation: BEGIN
2020-06-30 14:36:06.993879 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2020-06-30 14:36:06.994049 (Thread-1): Using snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 14:36:06.994218 (Thread-1): On model.sample_project.customers_per_nation: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "model.sample_project.customers_per_nation"} */


      create or replace transient table JAVEN_TESTING.TEST.customers_per_nation  as
      (with __dbt__CTE__customer as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  c_custkey as custkey,
        c_nationkey as nationkey,
        c_name as name
from snowflake_sample_data.tpch_sf1.customer
),  __dbt__CTE__nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  n_nationkey as nationkey,
        n_name as name
from snowflake_sample_data.tpch_sf1.nation
),  __dbt__CTE__customer_nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  c.custkey,
        c.nationkey,
        c.name as customer_name,
        n.name as nation_name
from __dbt__CTE__customer as c
JOIN __dbt__CTE__nation as n
ON c.nationkey=n.nationkey
)/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  count(customer_name) as customer_count,
        nation_name
from __dbt__CTE__customer_nation
group by nation_name
order by nation_name
      );
2020-06-30 14:36:09.065434 (Thread-1): SQL status: SUCCESS 1 in 2.07 seconds
2020-06-30 14:36:09.066462 (Thread-1): On model.sample_project.customers_per_nation: COMMIT
2020-06-30 14:36:09.066607 (Thread-1): Using snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 14:36:09.066703 (Thread-1): On model.sample_project.customers_per_nation: COMMIT
2020-06-30 14:36:09.248729 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2020-06-30 14:36:09.257975 (Thread-1): finished collecting timing info
2020-06-30 14:36:09.258742 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79135081-0947-4262-997f-20467aeed581', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d9d590>]}
2020-06-30 14:36:09.259756 (Thread-1): 09:36:09 | 1 of 4 OK created table model TEST.customers_per_nation.............. [SUCCESS 1 in 2.54s]
2020-06-30 14:36:09.259876 (Thread-1): Finished running node model.sample_project.customers_per_nation
2020-06-30 14:36:09.259994 (Thread-1): Began running node model.sample_project.cust_list_ord_nat
2020-06-30 14:36:09.260228 (Thread-1): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 14:36:09.260564 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customers_per_nation).
2020-06-30 14:36:09.260734 (Thread-1): Compiling model.sample_project.cust_list_ord_nat
2020-06-30 14:36:09.275563 (Thread-1): Writing injected SQL for node "model.sample_project.cust_list_ord_nat"
2020-06-30 14:36:09.275950 (Thread-1): finished collecting timing info
2020-06-30 14:36:09.276294 (Thread-1): Finished running node model.sample_project.cust_list_ord_nat
2020-06-30 14:36:09.276410 (Thread-1): Began running node model.sample_project.average_price_per_order
2020-06-30 14:36:09.277434 (Thread-1): 09:36:09 | 2 of 4 START table model TEST.average_price_per_order................ [RUN]
2020-06-30 14:36:09.277817 (Thread-1): Acquiring new snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 14:36:09.277946 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.cust_list_ord_nat).
2020-06-30 14:36:09.278026 (Thread-1): Compiling model.sample_project.average_price_per_order
2020-06-30 14:36:09.296644 (Thread-1): Writing injected SQL for node "model.sample_project.average_price_per_order"
2020-06-30 14:36:09.297244 (Thread-1): finished collecting timing info
2020-06-30 14:36:09.301789 (Thread-1): Writing runtime SQL for node "model.sample_project.average_price_per_order"
2020-06-30 14:36:09.304188 (Thread-1): Using snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 14:36:09.304291 (Thread-1): On model.sample_project.average_price_per_order: BEGIN
2020-06-30 14:36:09.516587 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2020-06-30 14:36:09.516744 (Thread-1): Using snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 14:36:09.516840 (Thread-1): On model.sample_project.average_price_per_order: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "model.sample_project.average_price_per_order"} */


      create or replace transient table JAVEN_TESTING.TEST.average_price_per_order  as
      (with __dbt__CTE__orders as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  o_orderkey as orderkey,
        o_custkey as custkey,
        o_totalprice as totalprice,
        o_orderdate as orderdate
from snowflake_sample_data.tpch_sf1.orders
),  __dbt__CTE__lineitem as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  l_orderkey as orderkey,
        l_extendedprice as extendedprice,
        l_discount as discount,
        l_tax as tax,
        l_quantity as quantity
from snowflake_sample_data.tpch_sf1.lineitem
),  __dbt__CTE__orders_lineitem as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  o.orderkey,
        o.custkey,
        o.totalprice,
        o.orderdate,
        l.extendedprice,
        l.discount,
        l.tax,
        l.quantity
from __dbt__CTE__orders as o
JOIN __dbt__CTE__lineitem as l
ON o.orderkey=l.orderkey
)/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  avg(totalprice) as average_order_price,
        sum(quantity) as total_quantity_per_order,
        listagg(quantity, '|~~|') as quantities_per_order,
        count(quantity) as items_per_order,
        
  
    width_bucket(average_order_price, 184000, 200000, 10 )

 as price_histogram,
        orderdate
from __dbt__CTE__orders_lineitem
group by orderdate
      );
2020-06-30 14:36:13.392686 (Thread-1): SQL status: SUCCESS 1 in 3.88 seconds
2020-06-30 14:36:13.393625 (Thread-1): On model.sample_project.average_price_per_order: COMMIT
2020-06-30 14:36:13.393768 (Thread-1): Using snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 14:36:13.393860 (Thread-1): On model.sample_project.average_price_per_order: COMMIT
2020-06-30 14:36:13.596462 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2020-06-30 14:36:13.598585 (Thread-1): finished collecting timing info
2020-06-30 14:36:13.599211 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79135081-0947-4262-997f-20467aeed581', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112db6ad0>]}
2020-06-30 14:36:13.600297 (Thread-1): 09:36:13 | 2 of 4 OK created table model TEST.average_price_per_order........... [SUCCESS 1 in 4.32s]
2020-06-30 14:36:13.600436 (Thread-1): Finished running node model.sample_project.average_price_per_order
2020-06-30 14:36:13.600655 (Thread-1): Began running node model.sample_project.sales_report_one
2020-06-30 14:36:13.601972 (Thread-1): 09:36:13 | 3 of 4 START table model TEST.sales_report_one....................... [RUN]
2020-06-30 14:36:13.602279 (Thread-1): Acquiring new snowflake connection "model.sample_project.sales_report_one".
2020-06-30 14:36:13.602374 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.average_price_per_order).
2020-06-30 14:36:13.602465 (Thread-1): Compiling model.sample_project.sales_report_one
2020-06-30 14:36:13.613357 (Thread-1): Writing injected SQL for node "model.sample_project.sales_report_one"
2020-06-30 14:36:13.613794 (Thread-1): finished collecting timing info
2020-06-30 14:36:13.618616 (Thread-1): Writing runtime SQL for node "model.sample_project.sales_report_one"
2020-06-30 14:36:13.622557 (Thread-1): Using snowflake connection "model.sample_project.sales_report_one".
2020-06-30 14:36:13.622669 (Thread-1): On model.sample_project.sales_report_one: BEGIN
2020-06-30 14:36:13.810478 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2020-06-30 14:36:13.810666 (Thread-1): Using snowflake connection "model.sample_project.sales_report_one".
2020-06-30 14:36:13.810773 (Thread-1): On model.sample_project.sales_report_one: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "model.sample_project.sales_report_one"} */


      create or replace transient table JAVEN_TESTING.TEST.sales_report_one  as
      (with __dbt__CTE__customer as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  c_custkey as custkey,
        c_nationkey as nationkey,
        c_name as name
from snowflake_sample_data.tpch_sf1.customer
),  __dbt__CTE__nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  n_nationkey as nationkey,
        n_name as name
from snowflake_sample_data.tpch_sf1.nation
),  __dbt__CTE__customer_nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  c.custkey,
        c.nationkey,
        c.name as customer_name,
        n.name as nation_name
from __dbt__CTE__customer as c
JOIN __dbt__CTE__nation as n
ON c.nationkey=n.nationkey
),  __dbt__CTE__orders as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  o_orderkey as orderkey,
        o_custkey as custkey,
        o_totalprice as totalprice,
        o_orderdate as orderdate
from snowflake_sample_data.tpch_sf1.orders
),  __dbt__CTE__lineitem as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  l_orderkey as orderkey,
        l_extendedprice as extendedprice,
        l_discount as discount,
        l_tax as tax,
        l_quantity as quantity
from snowflake_sample_data.tpch_sf1.lineitem
),  __dbt__CTE__orders_lineitem as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  o.orderkey,
        o.custkey,
        o.totalprice,
        o.orderdate,
        l.extendedprice,
        l.discount,
        l.tax,
        l.quantity
from __dbt__CTE__orders as o
JOIN __dbt__CTE__lineitem as l
ON o.orderkey=l.orderkey
),  __dbt__CTE__cust_list_ord_nat as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  cn.custkey,
        cn.nationkey,
        cn.customer_name,
        cn.nation_name,
        ol.orderkey,
        ol.totalprice,
        ol.orderdate,
        ol.extendedprice,
        ol.discount,
        ol.tax,
        ol.quantity
from __dbt__CTE__customer_nation as cn
JOIN __dbt__CTE__orders_lineitem as ol
ON cn.custkey=ol.custkey
)/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  extendedprice * (1.0-discount) as discounted_price_pre_tax,
        discounted_price_pre_tax * (1.0 + tax) as discounted_price,
        discounted_price_pre_tax * tax as tax_charged,
        *
from __dbt__CTE__cust_list_ord_nat
      );
2020-06-30 14:36:19.738228 (Thread-1): SQL status: SUCCESS 1 in 5.93 seconds
2020-06-30 14:36:19.739351 (Thread-1): On model.sample_project.sales_report_one: COMMIT
2020-06-30 14:36:19.739554 (Thread-1): Using snowflake connection "model.sample_project.sales_report_one".
2020-06-30 14:36:19.739686 (Thread-1): On model.sample_project.sales_report_one: COMMIT
2020-06-30 14:36:19.888250 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2020-06-30 14:36:19.891319 (Thread-1): finished collecting timing info
2020-06-30 14:36:19.892030 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79135081-0947-4262-997f-20467aeed581', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c4fa50>]}
2020-06-30 14:36:19.893273 (Thread-1): 09:36:19 | 3 of 4 OK created table model TEST.sales_report_one.................. [SUCCESS 1 in 6.29s]
2020-06-30 14:36:19.893431 (Thread-1): Finished running node model.sample_project.sales_report_one
2020-06-30 14:36:19.893590 (Thread-1): Began running node model.sample_project.sales_report_two
2020-06-30 14:36:19.894729 (Thread-1): 09:36:19 | 4 of 4 START table model TEST.sales_report_two....................... [RUN]
2020-06-30 14:36:19.895140 (Thread-1): Acquiring new snowflake connection "model.sample_project.sales_report_two".
2020-06-30 14:36:19.895245 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.sales_report_one).
2020-06-30 14:36:19.895343 (Thread-1): Compiling model.sample_project.sales_report_two
2020-06-30 14:36:19.907897 (Thread-1): Writing injected SQL for node "model.sample_project.sales_report_two"
2020-06-30 14:36:19.908539 (Thread-1): finished collecting timing info
2020-06-30 14:36:19.913255 (Thread-1): Writing runtime SQL for node "model.sample_project.sales_report_two"
2020-06-30 14:36:19.917218 (Thread-1): Using snowflake connection "model.sample_project.sales_report_two".
2020-06-30 14:36:19.917332 (Thread-1): On model.sample_project.sales_report_two: BEGIN
2020-06-30 14:36:20.089368 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2020-06-30 14:36:20.089598 (Thread-1): Using snowflake connection "model.sample_project.sales_report_two".
2020-06-30 14:36:20.089734 (Thread-1): On model.sample_project.sales_report_two: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "model.sample_project.sales_report_two"} */


      create or replace transient table JAVEN_TESTING.TEST.sales_report_two  as
      (with __dbt__CTE__customer as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  c_custkey as custkey,
        c_nationkey as nationkey,
        c_name as name
from snowflake_sample_data.tpch_sf1.customer
),  __dbt__CTE__nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  n_nationkey as nationkey,
        n_name as name
from snowflake_sample_data.tpch_sf1.nation
),  __dbt__CTE__customer_nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  c.custkey,
        c.nationkey,
        c.name as customer_name,
        n.name as nation_name
from __dbt__CTE__customer as c
JOIN __dbt__CTE__nation as n
ON c.nationkey=n.nationkey
),  __dbt__CTE__orders as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  o_orderkey as orderkey,
        o_custkey as custkey,
        o_totalprice as totalprice,
        o_orderdate as orderdate
from snowflake_sample_data.tpch_sf1.orders
),  __dbt__CTE__lineitem as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  l_orderkey as orderkey,
        l_extendedprice as extendedprice,
        l_discount as discount,
        l_tax as tax,
        l_quantity as quantity
from snowflake_sample_data.tpch_sf1.lineitem
),  __dbt__CTE__orders_lineitem as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  o.orderkey,
        o.custkey,
        o.totalprice,
        o.orderdate,
        l.extendedprice,
        l.discount,
        l.tax,
        l.quantity
from __dbt__CTE__orders as o
JOIN __dbt__CTE__lineitem as l
ON o.orderkey=l.orderkey
),  __dbt__CTE__cust_list_ord_nat as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  cn.custkey,
        cn.nationkey,
        cn.customer_name,
        cn.nation_name,
        ol.orderkey,
        ol.totalprice,
        ol.orderdate,
        ol.extendedprice,
        ol.discount,
        ol.tax,
        ol.quantity
from __dbt__CTE__customer_nation as cn
JOIN __dbt__CTE__orders_lineitem as ol
ON cn.custkey=ol.custkey
)/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  listagg(discount, '|~~|') as discounts,
        avg(extendedprice * (1.0-discount) * tax) as average_tax,
        orderkey,
        custkey
from __dbt__CTE__cust_list_ord_nat
group by orderkey, custkey
      );
2020-06-30 14:36:23.341340 (Thread-1): SQL status: SUCCESS 1 in 3.25 seconds
2020-06-30 14:36:23.342895 (Thread-1): On model.sample_project.sales_report_two: COMMIT
2020-06-30 14:36:23.343101 (Thread-1): Using snowflake connection "model.sample_project.sales_report_two".
2020-06-30 14:36:23.343235 (Thread-1): On model.sample_project.sales_report_two: COMMIT
2020-06-30 14:36:23.576892 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2020-06-30 14:36:23.579521 (Thread-1): finished collecting timing info
2020-06-30 14:36:23.580286 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79135081-0947-4262-997f-20467aeed581', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d95590>]}
2020-06-30 14:36:23.581627 (Thread-1): 09:36:23 | 4 of 4 OK created table model TEST.sales_report_two.................. [SUCCESS 1 in 3.69s]
2020-06-30 14:36:23.581798 (Thread-1): Finished running node model.sample_project.sales_report_two
2020-06-30 14:36:23.648017 (MainThread): Using snowflake connection "master".
2020-06-30 14:36:23.648332 (MainThread): On master: BEGIN
2020-06-30 14:36:23.826426 (MainThread): SQL status: SUCCESS 1 in 0.18 seconds
2020-06-30 14:36:23.826650 (MainThread): On master: COMMIT
2020-06-30 14:36:23.826836 (MainThread): Using snowflake connection "master".
2020-06-30 14:36:23.826961 (MainThread): On master: COMMIT
2020-06-30 14:36:24.205197 (MainThread): SQL status: SUCCESS 1 in 0.38 seconds
2020-06-30 14:36:24.205851 (MainThread): 09:36:24 | 
2020-06-30 14:36:24.206052 (MainThread): 09:36:24 | Finished running 4 table models in 32.62s.
2020-06-30 14:36:24.206218 (MainThread): Connection 'master' was left open.
2020-06-30 14:36:24.206349 (MainThread): On master: Close
2020-06-30 14:36:24.480666 (MainThread): Connection 'model.sample_project.sales_report_two' was left open.
2020-06-30 14:36:24.480866 (MainThread): On model.sample_project.sales_report_two: Close
2020-06-30 14:36:24.847380 (MainThread): 
2020-06-30 14:36:24.847542 (MainThread): Completed successfully
2020-06-30 14:36:24.847659 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-06-30 14:36:24.847827 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c57190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d95610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112db6990>]}
2020-06-30 14:36:24.848010 (MainThread): Flushing usage events
2020-06-30 15:14:55.190328 (MainThread): Running with dbt=0.17.0
2020-06-30 15:14:55.571140 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2020-06-30 15:14:55.572196 (MainThread): Tracking: tracking
2020-06-30 15:14:55.572459 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7b7ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7d5b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7d5a50>]}
2020-06-30 15:14:55.594030 (MainThread): Partial parsing not enabled
2020-06-30 15:14:55.595957 (MainThread): Parsing macros/core.sql
2020-06-30 15:14:55.601667 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-30 15:14:55.611563 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-30 15:14:55.613510 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-30 15:14:55.632253 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-30 15:14:55.664901 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-30 15:14:55.688644 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-30 15:14:55.690848 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-30 15:14:55.698631 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-30 15:14:55.718481 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-30 15:14:55.727780 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-30 15:14:55.735325 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-30 15:14:55.740942 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-30 15:14:55.742114 (MainThread): Parsing macros/etc/query.sql
2020-06-30 15:14:55.743428 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-30 15:14:55.745278 (MainThread): Parsing macros/etc/datetime.sql
2020-06-30 15:14:55.755307 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-30 15:14:55.757788 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-30 15:14:55.759866 (MainThread): Parsing macros/adapters/common.sql
2020-06-30 15:14:55.814693 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-30 15:14:55.816107 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-30 15:14:55.817257 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-30 15:14:55.818567 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-30 15:14:55.821328 (MainThread): Parsing macros/catalog.sql
2020-06-30 15:14:55.823609 (MainThread): Parsing macros/adapters.sql
2020-06-30 15:14:55.849818 (MainThread): Parsing macros/materializations/merge.sql
2020-06-30 15:14:55.852259 (MainThread): Parsing macros/materializations/view.sql
2020-06-30 15:14:55.853708 (MainThread): Parsing macros/materializations/table.sql
2020-06-30 15:14:55.858240 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-30 15:14:55.898265 (MainThread): Partial parsing not enabled
2020-06-30 15:14:55.900888 (MainThread): Parsing macros/cross_db_utils/except.sql
2020-06-30 15:14:55.902512 (MainThread): Parsing macros/cross_db_utils/replace.sql
2020-06-30 15:14:55.904838 (MainThread): Parsing macros/cross_db_utils/concat.sql
2020-06-30 15:14:55.908067 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2020-06-30 15:14:55.915158 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2020-06-30 15:14:55.916743 (MainThread): Parsing macros/cross_db_utils/length.sql
2020-06-30 15:14:55.918334 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2020-06-30 15:14:55.921363 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2020-06-30 15:14:55.922617 (MainThread): Parsing macros/cross_db_utils/right.sql
2020-06-30 15:14:55.925339 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2020-06-30 15:14:55.935904 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2020-06-30 15:14:55.938067 (MainThread): Parsing macros/cross_db_utils/hash.sql
2020-06-30 15:14:55.939686 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2020-06-30 15:14:55.941404 (MainThread): Parsing macros/cross_db_utils/position.sql
2020-06-30 15:14:55.943238 (MainThread): Parsing macros/cross_db_utils/literal.sql
2020-06-30 15:14:55.944391 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2020-06-30 15:14:55.948044 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2020-06-30 15:14:55.954102 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2020-06-30 15:14:55.957293 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2020-06-30 15:14:55.959971 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2020-06-30 15:14:55.961801 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2020-06-30 15:14:55.987987 (MainThread): Parsing macros/logger/pretty_log_format.sql
2020-06-30 15:14:55.988900 (MainThread): Parsing macros/logger/pretty_time.sql
2020-06-30 15:14:55.989890 (MainThread): Parsing macros/logger/log_info.sql
2020-06-30 15:14:55.990772 (MainThread): Parsing macros/datetime/date_spine.sql
2020-06-30 15:14:55.994927 (MainThread): Parsing macros/web/get_url_host.sql
2020-06-30 15:14:55.996634 (MainThread): Parsing macros/web/get_url_path.sql
2020-06-30 15:14:55.999321 (MainThread): Parsing macros/web/get_url_parameter.sql
2020-06-30 15:14:56.000626 (MainThread): Parsing macros/geo/haversine_distance.sql
2020-06-30 15:14:56.001797 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2020-06-30 15:14:56.003347 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2020-06-30 15:14:56.005875 (MainThread): Parsing macros/schema_tests/recency.sql
2020-06-30 15:14:56.008329 (MainThread): Parsing macros/schema_tests/not_constant.sql
2020-06-30 15:14:56.010748 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2020-06-30 15:14:56.012621 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2020-06-30 15:14:56.015486 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2020-06-30 15:14:56.017527 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2020-06-30 15:14:56.019079 (MainThread): Parsing macros/schema_tests/equality.sql
2020-06-30 15:14:56.022639 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2020-06-30 15:14:56.028869 (MainThread): Parsing macros/sql/nullcheck_table.sql
2020-06-30 15:14:56.030050 (MainThread): Parsing macros/sql/generate_series.sql
2020-06-30 15:14:56.033951 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2020-06-30 15:14:56.038379 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2020-06-30 15:14:56.041614 (MainThread): Parsing macros/sql/star.sql
2020-06-30 15:14:56.044933 (MainThread): Parsing macros/sql/unpivot.sql
2020-06-30 15:14:56.052100 (MainThread): Parsing macros/sql/union.sql
2020-06-30 15:14:56.062667 (MainThread): Parsing macros/sql/groupby.sql
2020-06-30 15:14:56.063912 (MainThread): Parsing macros/sql/surrogate_key.sql
2020-06-30 15:14:56.066998 (MainThread): Parsing macros/sql/safe_add.sql
2020-06-30 15:14:56.068338 (MainThread): Parsing macros/sql/nullcheck.sql
2020-06-30 15:14:56.070056 (MainThread): Parsing macros/sql/get_column_values.sql
2020-06-30 15:14:56.075210 (MainThread): Parsing macros/sql/pivot.sql
2020-06-30 15:14:56.078482 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2020-06-30 15:14:56.125085 (MainThread): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 15:14:56.125209 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:14:56.161133 (MainThread): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 15:14:56.161250 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:14:56.173241 (MainThread): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 15:14:56.173334 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:14:56.185158 (MainThread): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 15:14:56.185254 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:14:56.198680 (MainThread): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 15:14:56.198829 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:14:56.213095 (MainThread): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 15:14:56.213201 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:14:56.227415 (MainThread): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 15:14:56.227523 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:14:56.241514 (MainThread): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 15:14:56.241619 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:14:56.256084 (MainThread): Acquiring new snowflake connection "model.sample_project.sales_report_one".
2020-06-30 15:14:56.256182 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:14:56.268801 (MainThread): Acquiring new snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 15:14:56.268901 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:14:56.285233 (MainThread): Acquiring new snowflake connection "model.sample_project.sales_report_two".
2020-06-30 15:14:56.285327 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:14:56.432947 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aea3a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b067a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0a7050>]}
2020-06-30 15:14:56.433168 (MainThread): Flushing usage events
2020-06-30 15:14:56.957735 (MainThread): Connection 'model.sample_project.sales_report_two' was properly closed.
2020-06-30 15:14:56.957902 (MainThread): Encountered an error:
2020-06-30 15:14:56.958022 (MainThread): Compilation Error
  dbt found two schema.yml entries for the same resource named orders. Resources and their associated columns may only be described a single time. To fix this, remove the resource entry for orders in one of these files:
   - models/reports/schema.yml
  models/source_reads/sources.yml
2020-06-30 15:14:56.961827 (MainThread): Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/main.py", line 81, in main
    results, succeeded = handle_and_check(args)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/main.py", line 159, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/main.py", line 212, in run_from_args
    results = task.run()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/task/runnable.py", line 389, in run
    self._runtime_initialize()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/task/runnable.py", line 103, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/task/runnable.py", line 71, in _runtime_initialize
    self.load_manifest()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/task/runnable.py", line 60, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/perf_utils.py", line 23, in get_full_manifest
    return load_manifest(config, internal, set_header)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/manifest.py", line 641, in load_manifest
    return ManifestLoader.load_all(config, internal_manifest, macro_hook)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/manifest.py", line 356, in load_all
    loader.load(internal_manifest=internal_manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/manifest.py", line 212, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/manifest.py", line 186, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/manifest.py", line 142, in parse_with_cache
    parser.parse_file(block)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/schemas.py", line 533, in parse_file
    for test_block in parser.parse():
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/schemas.py", line 679, in parse
    self.parse_patch(node_block, refs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/schemas.py", line 717, in parse_patch
    self.results.add_patch(self.yaml.file, result)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/results.py", line 153, in add_patch
    raise_duplicate_patch_name(patch, self.patches[patch.name])
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/exceptions.py", line 814, in raise_duplicate_patch_name
    f'dbt found two schema.yml entries for the same resource named '
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/exceptions.py", line 392, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error
  dbt found two schema.yml entries for the same resource named orders. Resources and their associated columns may only be described a single time. To fix this, remove the resource entry for orders in one of these files:
   - models/reports/schema.yml
  models/source_reads/sources.yml

2020-06-30 15:15:27.188734 (MainThread): Running with dbt=0.17.0
2020-06-30 15:15:27.498955 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2020-06-30 15:15:27.499866 (MainThread): Tracking: tracking
2020-06-30 15:15:27.500212 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108448b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108464bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108464b10>]}
2020-06-30 15:15:27.519922 (MainThread): Partial parsing not enabled
2020-06-30 15:15:27.521561 (MainThread): Parsing macros/core.sql
2020-06-30 15:15:27.526570 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-30 15:15:27.536572 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-30 15:15:27.538317 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-30 15:15:27.556950 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-30 15:15:27.587780 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-30 15:15:27.610845 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-30 15:15:27.612749 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-30 15:15:27.619889 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-30 15:15:27.634726 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-30 15:15:27.642304 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-30 15:15:27.648980 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-30 15:15:27.654677 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-30 15:15:27.655662 (MainThread): Parsing macros/etc/query.sql
2020-06-30 15:15:27.656774 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-30 15:15:27.658505 (MainThread): Parsing macros/etc/datetime.sql
2020-06-30 15:15:27.668088 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-30 15:15:27.670270 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-30 15:15:27.671944 (MainThread): Parsing macros/adapters/common.sql
2020-06-30 15:15:27.731217 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-30 15:15:27.732492 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-30 15:15:27.733472 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-30 15:15:27.734755 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-30 15:15:27.737799 (MainThread): Parsing macros/catalog.sql
2020-06-30 15:15:27.739884 (MainThread): Parsing macros/adapters.sql
2020-06-30 15:15:27.765038 (MainThread): Parsing macros/materializations/merge.sql
2020-06-30 15:15:27.767411 (MainThread): Parsing macros/materializations/view.sql
2020-06-30 15:15:27.768701 (MainThread): Parsing macros/materializations/table.sql
2020-06-30 15:15:27.773760 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-30 15:15:27.813907 (MainThread): Partial parsing not enabled
2020-06-30 15:15:27.815637 (MainThread): Parsing macros/cross_db_utils/except.sql
2020-06-30 15:15:27.816737 (MainThread): Parsing macros/cross_db_utils/replace.sql
2020-06-30 15:15:27.818055 (MainThread): Parsing macros/cross_db_utils/concat.sql
2020-06-30 15:15:27.820365 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2020-06-30 15:15:27.827062 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2020-06-30 15:15:27.828619 (MainThread): Parsing macros/cross_db_utils/length.sql
2020-06-30 15:15:27.829982 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2020-06-30 15:15:27.832684 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2020-06-30 15:15:27.833775 (MainThread): Parsing macros/cross_db_utils/right.sql
2020-06-30 15:15:27.836378 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2020-06-30 15:15:27.846913 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2020-06-30 15:15:27.848874 (MainThread): Parsing macros/cross_db_utils/hash.sql
2020-06-30 15:15:27.850340 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2020-06-30 15:15:27.851839 (MainThread): Parsing macros/cross_db_utils/position.sql
2020-06-30 15:15:27.853761 (MainThread): Parsing macros/cross_db_utils/literal.sql
2020-06-30 15:15:27.854716 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2020-06-30 15:15:27.858018 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2020-06-30 15:15:27.864978 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2020-06-30 15:15:27.868144 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2020-06-30 15:15:27.870318 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2020-06-30 15:15:27.872297 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2020-06-30 15:15:27.896882 (MainThread): Parsing macros/logger/pretty_log_format.sql
2020-06-30 15:15:27.897999 (MainThread): Parsing macros/logger/pretty_time.sql
2020-06-30 15:15:27.898787 (MainThread): Parsing macros/logger/log_info.sql
2020-06-30 15:15:27.899810 (MainThread): Parsing macros/datetime/date_spine.sql
2020-06-30 15:15:27.903716 (MainThread): Parsing macros/web/get_url_host.sql
2020-06-30 15:15:27.906037 (MainThread): Parsing macros/web/get_url_path.sql
2020-06-30 15:15:27.910497 (MainThread): Parsing macros/web/get_url_parameter.sql
2020-06-30 15:15:27.913259 (MainThread): Parsing macros/geo/haversine_distance.sql
2020-06-30 15:15:27.915437 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2020-06-30 15:15:27.916930 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2020-06-30 15:15:27.919784 (MainThread): Parsing macros/schema_tests/recency.sql
2020-06-30 15:15:27.921366 (MainThread): Parsing macros/schema_tests/not_constant.sql
2020-06-30 15:15:27.922684 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2020-06-30 15:15:27.923874 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2020-06-30 15:15:27.925871 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2020-06-30 15:15:27.928087 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2020-06-30 15:15:27.929211 (MainThread): Parsing macros/schema_tests/equality.sql
2020-06-30 15:15:27.932431 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2020-06-30 15:15:27.938940 (MainThread): Parsing macros/sql/nullcheck_table.sql
2020-06-30 15:15:27.941206 (MainThread): Parsing macros/sql/generate_series.sql
2020-06-30 15:15:27.945744 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2020-06-30 15:15:27.950361 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2020-06-30 15:15:27.953723 (MainThread): Parsing macros/sql/star.sql
2020-06-30 15:15:27.956960 (MainThread): Parsing macros/sql/unpivot.sql
2020-06-30 15:15:27.964454 (MainThread): Parsing macros/sql/union.sql
2020-06-30 15:15:27.975590 (MainThread): Parsing macros/sql/groupby.sql
2020-06-30 15:15:27.976682 (MainThread): Parsing macros/sql/surrogate_key.sql
2020-06-30 15:15:27.979611 (MainThread): Parsing macros/sql/safe_add.sql
2020-06-30 15:15:27.980785 (MainThread): Parsing macros/sql/nullcheck.sql
2020-06-30 15:15:27.982122 (MainThread): Parsing macros/sql/get_column_values.sql
2020-06-30 15:15:27.986642 (MainThread): Parsing macros/sql/pivot.sql
2020-06-30 15:15:27.989427 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2020-06-30 15:15:28.034100 (MainThread): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 15:15:28.034224 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:15:28.064865 (MainThread): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 15:15:28.064982 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:15:28.076989 (MainThread): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 15:15:28.077078 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:15:28.088291 (MainThread): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 15:15:28.088381 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:15:28.100546 (MainThread): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 15:15:28.100737 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:15:28.117080 (MainThread): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 15:15:28.117199 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:15:28.129477 (MainThread): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 15:15:28.129602 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:15:28.143157 (MainThread): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 15:15:28.143360 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:15:28.158138 (MainThread): Acquiring new snowflake connection "model.sample_project.sales_report_one".
2020-06-30 15:15:28.158228 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:15:28.169788 (MainThread): Acquiring new snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 15:15:28.169879 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:15:28.184582 (MainThread): Acquiring new snowflake connection "model.sample_project.sales_report_two".
2020-06-30 15:15:28.184673 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:15:28.663744 (MainThread): Found 11 models, 9 tests, 0 snapshots, 0 analyses, 263 macros, 0 operations, 0 seed files, 4 sources
2020-06-30 15:15:28.666104 (MainThread): 
2020-06-30 15:15:28.666459 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 15:15:28.666546 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:15:28.691592 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 15:15:28.691789 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-06-30 15:15:28.705662 (ThreadPoolExecutor-1_0): Using snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 15:15:28.705768 (ThreadPoolExecutor-1_0): On list_JAVEN_TESTING_TEST: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING_TEST"} */

    show terse objects in JAVEN_TESTING.TEST
2020-06-30 15:15:30.173851 (ThreadPoolExecutor-1_0): unclosed file <_io.BufferedReader name='/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/certifi/cacert.pem'>
2020-06-30 15:15:37.480097 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 10 in 8.77 seconds
2020-06-30 15:15:37.495165 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 15:15:37.495280 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:15:37.495514 (MainThread): 10:15:37 | Concurrency: 1 threads (target='dev')
2020-06-30 15:15:37.495645 (MainThread): 10:15:37 | 
2020-06-30 15:15:37.496478 (Thread-1): Began running node model.sample_project.customer
2020-06-30 15:15:37.496768 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 15:15:37.496872 (Thread-1): Re-using an available connection from the pool (formerly list_JAVEN_TESTING_TEST).
2020-06-30 15:15:37.496976 (Thread-1): Compiling model.sample_project.customer
2020-06-30 15:15:37.516218 (Thread-1): Writing injected SQL for node "model.sample_project.customer"
2020-06-30 15:15:37.516789 (Thread-1): finished collecting timing info
2020-06-30 15:15:37.517686 (Thread-1): Finished running node model.sample_project.customer
2020-06-30 15:15:37.517990 (Thread-1): Began running node model.sample_project.lineitem
2020-06-30 15:15:37.518668 (Thread-1): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 15:15:37.519030 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer).
2020-06-30 15:15:37.519273 (Thread-1): Compiling model.sample_project.lineitem
2020-06-30 15:15:37.527446 (Thread-1): Writing injected SQL for node "model.sample_project.lineitem"
2020-06-30 15:15:37.527768 (Thread-1): finished collecting timing info
2020-06-30 15:15:37.528095 (Thread-1): Finished running node model.sample_project.lineitem
2020-06-30 15:15:37.528213 (Thread-1): Began running node model.sample_project.nation
2020-06-30 15:15:37.528495 (Thread-1): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 15:15:37.528669 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.lineitem).
2020-06-30 15:15:37.528752 (Thread-1): Compiling model.sample_project.nation
2020-06-30 15:15:37.535844 (Thread-1): Writing injected SQL for node "model.sample_project.nation"
2020-06-30 15:15:37.536118 (Thread-1): finished collecting timing info
2020-06-30 15:15:37.536445 (Thread-1): Finished running node model.sample_project.nation
2020-06-30 15:15:37.536563 (Thread-1): Began running node model.sample_project.orders
2020-06-30 15:15:37.536770 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 15:15:37.536853 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.nation).
2020-06-30 15:15:37.536931 (Thread-1): Compiling model.sample_project.orders
2020-06-30 15:15:37.544370 (Thread-1): Writing injected SQL for node "model.sample_project.orders"
2020-06-30 15:15:37.544748 (Thread-1): finished collecting timing info
2020-06-30 15:15:37.545164 (Thread-1): Finished running node model.sample_project.orders
2020-06-30 15:15:37.545292 (Thread-1): Began running node test.sample_project.source_is_nonnegative_tpch_customer_c_custkey
2020-06-30 15:15:37.545410 (Thread-1): 10:15:37 | 1 of 9 START test source_is_nonnegative_tpch_customer_c_custkey...... [RUN]
2020-06-30 15:15:37.545836 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_nonnegative_tpch_customer_c_custkey".
2020-06-30 15:15:37.545927 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders).
2020-06-30 15:15:37.546011 (Thread-1): Compiling test.sample_project.source_is_nonnegative_tpch_customer_c_custkey
2020-06-30 15:15:37.560888 (Thread-1): finished collecting timing info
2020-06-30 15:15:37.561687 (Thread-1): Compilation Error in test source_is_nonnegative_tpch_customer_c_custkey (models/source_reads/sources.yml)
  'test_is_nonnegative' is undefined
Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 449, in catch_jinja
    yield
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 481, in render_template
    return template.render(ctx)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 1, in top-level template code
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
jinja2.exceptions.UndefinedError: 'test_is_nonnegative' is undefined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 165, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 340, in compile
    return compile_node(self.adapter, self.config, self.node, manifest, {})
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/compilation.py", line 255, in compile_node
    node = compiler.compile_node(node, manifest, extra_context)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/compilation.py", line 179, in compile_node
    node)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 530, in get_rendered
    return render_template(template, ctx, node)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 481, in render_template
    return template.render(ctx)
  File "/usr/local/opt/python/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 454, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in test source_is_nonnegative_tpch_customer_c_custkey (models/source_reads/sources.yml)
  'test_is_nonnegative' is undefined
2020-06-30 15:15:37.567544 (Thread-1): 10:15:37 | 1 of 9 ERROR source_is_nonnegative_tpch_customer_c_custkey........... [ERROR in 0.02s]
2020-06-30 15:15:37.567698 (Thread-1): Finished running node test.sample_project.source_is_nonnegative_tpch_customer_c_custkey
2020-06-30 15:15:37.567856 (Thread-1): Began running node test.sample_project.not_null_customer_id
2020-06-30 15:15:37.568125 (Thread-1): 10:15:37 | 2 of 9 START test not_null_customer_id............................... [RUN]
2020-06-30 15:15:37.568389 (Thread-1): Acquiring new snowflake connection "test.sample_project.not_null_customer_id".
2020-06-30 15:15:37.568470 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_nonnegative_tpch_customer_c_custkey).
2020-06-30 15:15:37.568549 (Thread-1): Compiling test.sample_project.not_null_customer_id
2020-06-30 15:15:37.578459 (Thread-1): Writing injected SQL for node "test.sample_project.not_null_customer_id"
2020-06-30 15:15:37.578830 (Thread-1): finished collecting timing info
2020-06-30 15:15:37.579516 (Thread-1): Using snowflake connection "test.sample_project.not_null_customer_id".
2020-06-30 15:15:37.579602 (Thread-1): On test.sample_project.not_null_customer_id: BEGIN
2020-06-30 15:15:37.803104 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2020-06-30 15:15:37.803360 (Thread-1): Using snowflake connection "test.sample_project.not_null_customer_id".
2020-06-30 15:15:37.803526 (Thread-1): On test.sample_project.not_null_customer_id: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "test.sample_project.not_null_customer_id"} */




with __dbt__CTE__customer as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  c_custkey as custkey,
        c_nationkey as nationkey,
        c_name as name
from snowflake_sample_data.tpch_sf1.customer
)select count(*) as validation_errors
from __dbt__CTE__customer
where id is null
2020-06-30 15:15:38.190775 (Thread-1): Snowflake query id: 01954173-02c0-6b31-0000-2aed011d240a
2020-06-30 15:15:38.191039 (Thread-1): Snowflake error: 000904 (42000): SQL compilation error: error line 25 at position 6
invalid identifier 'ID'
2020-06-30 15:15:38.191228 (Thread-1): On test.sample_project.not_null_customer_id: ROLLBACK
2020-06-30 15:15:38.191377 (Thread-1): initiating rollback
2020-06-30 15:15:38.704594 (Thread-1): finished collecting timing info
2020-06-30 15:15:38.705507 (Thread-1): Database Error in test not_null_customer_id (models/reports/schema.yml)
  000904 (42000): SQL compilation error: error line 25 at position 6
  invalid identifier 'ID'
  compiled SQL at target/compiled/sample_project/models/reports/schema.yml/schema_test/not_null_customer_id.sql
Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 158, in exception_handler
    yield
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/cursor.py", line 597, in execute
    errvalue)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/errors.py", line 97, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, errorclass, errorvalue)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/errors.py", line 73, in default_errorhandler
    done_format_msg=errorvalue.get(u'done_format_msg'))
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 25 at position 6
invalid identifier 'ID'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 607, in execute
    failed_rows = self.execute_schema_test(test)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 587, in execute_schema_test
    fetch=True,
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 119, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 306, in add_query
    abridge_sql_log=abridge_sql_log
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/usr/local/opt/python/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 177, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in test not_null_customer_id (models/reports/schema.yml)
  000904 (42000): SQL compilation error: error line 25 at position 6
  invalid identifier 'ID'
  compiled SQL at target/compiled/sample_project/models/reports/schema.yml/schema_test/not_null_customer_id.sql
2020-06-30 15:15:38.710248 (Thread-1): 10:15:38 | 2 of 9 ERROR not_null_customer_id.................................... [ERROR in 1.14s]
2020-06-30 15:15:38.710412 (Thread-1): Finished running node test.sample_project.not_null_customer_id
2020-06-30 15:15:38.710581 (Thread-1): Began running node test.sample_project.unique_customer_id
2020-06-30 15:15:38.710886 (Thread-1): 10:15:38 | 3 of 9 START test unique_customer_id................................. [RUN]
2020-06-30 15:15:38.711200 (Thread-1): Acquiring new snowflake connection "test.sample_project.unique_customer_id".
2020-06-30 15:15:38.711309 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.not_null_customer_id).
2020-06-30 15:15:38.711421 (Thread-1): Compiling test.sample_project.unique_customer_id
2020-06-30 15:15:38.726125 (Thread-1): Writing injected SQL for node "test.sample_project.unique_customer_id"
2020-06-30 15:15:38.726521 (Thread-1): finished collecting timing info
2020-06-30 15:15:38.727441 (Thread-1): Using snowflake connection "test.sample_project.unique_customer_id".
2020-06-30 15:15:38.727545 (Thread-1): On test.sample_project.unique_customer_id: BEGIN
2020-06-30 15:15:38.937999 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2020-06-30 15:15:38.938264 (Thread-1): Using snowflake connection "test.sample_project.unique_customer_id".
2020-06-30 15:15:38.938474 (Thread-1): On test.sample_project.unique_customer_id: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "test.sample_project.unique_customer_id"} */




with __dbt__CTE__customer as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  c_custkey as custkey,
        c_nationkey as nationkey,
        c_name as name
from snowflake_sample_data.tpch_sf1.customer
)select count(*) as validation_errors
from (

    select
        id

    from __dbt__CTE__customer
    where id is not null
    group by id
    having count(*) > 1

) validation_errors
2020-06-30 15:15:39.322146 (Thread-1): Snowflake query id: 01954173-024f-eedc-0000-2aed011d240e
2020-06-30 15:15:39.322375 (Thread-1): Snowflake error: 000904 (42000): SQL compilation error: error line 27 at position 8
invalid identifier 'ID'
2020-06-30 15:15:39.322554 (Thread-1): On test.sample_project.unique_customer_id: ROLLBACK
2020-06-30 15:15:39.322697 (Thread-1): initiating rollback
2020-06-30 15:15:39.727891 (Thread-1): finished collecting timing info
2020-06-30 15:15:39.728665 (Thread-1): Database Error in test unique_customer_id (models/reports/schema.yml)
  000904 (42000): SQL compilation error: error line 27 at position 8
  invalid identifier 'ID'
  compiled SQL at target/compiled/sample_project/models/reports/schema.yml/schema_test/unique_customer_id.sql
Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 158, in exception_handler
    yield
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/cursor.py", line 597, in execute
    errvalue)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/errors.py", line 97, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, errorclass, errorvalue)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/errors.py", line 73, in default_errorhandler
    done_format_msg=errorvalue.get(u'done_format_msg'))
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 27 at position 8
invalid identifier 'ID'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 607, in execute
    failed_rows = self.execute_schema_test(test)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 587, in execute_schema_test
    fetch=True,
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 119, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 306, in add_query
    abridge_sql_log=abridge_sql_log
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/usr/local/opt/python/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 177, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in test unique_customer_id (models/reports/schema.yml)
  000904 (42000): SQL compilation error: error line 27 at position 8
  invalid identifier 'ID'
  compiled SQL at target/compiled/sample_project/models/reports/schema.yml/schema_test/unique_customer_id.sql
2020-06-30 15:15:39.729460 (Thread-1): 10:15:39 | 3 of 9 ERROR unique_customer_id...................................... [ERROR in 1.02s]
2020-06-30 15:15:39.729705 (Thread-1): Finished running node test.sample_project.unique_customer_id
2020-06-30 15:15:39.729892 (Thread-1): Began running node test.sample_project.not_null_lineitem_id
2020-06-30 15:15:39.730073 (Thread-1): 10:15:39 | 4 of 9 START test not_null_lineitem_id............................... [RUN]
2020-06-30 15:15:39.730572 (Thread-1): Acquiring new snowflake connection "test.sample_project.not_null_lineitem_id".
2020-06-30 15:15:39.730715 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.unique_customer_id).
2020-06-30 15:15:39.730849 (Thread-1): Compiling test.sample_project.not_null_lineitem_id
2020-06-30 15:15:39.742851 (Thread-1): Writing injected SQL for node "test.sample_project.not_null_lineitem_id"
2020-06-30 15:15:39.743233 (Thread-1): finished collecting timing info
2020-06-30 15:15:39.744107 (Thread-1): Using snowflake connection "test.sample_project.not_null_lineitem_id".
2020-06-30 15:15:39.744204 (Thread-1): On test.sample_project.not_null_lineitem_id: BEGIN
2020-06-30 15:15:39.972541 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2020-06-30 15:15:39.972787 (Thread-1): Using snowflake connection "test.sample_project.not_null_lineitem_id".
2020-06-30 15:15:39.972946 (Thread-1): On test.sample_project.not_null_lineitem_id: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "test.sample_project.not_null_lineitem_id"} */




with __dbt__CTE__lineitem as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  l_orderkey as orderkey,
        l_extendedprice as extendedprice,
        l_discount as discount,
        l_tax as tax,
        l_quantity as quantity
from snowflake_sample_data.tpch_sf1.lineitem
)select count(*) as validation_errors
from __dbt__CTE__lineitem
where id is null
2020-06-30 15:15:40.341021 (Thread-1): Snowflake query id: 01954173-02df-1e00-0000-2aed011d13f6
2020-06-30 15:15:40.341254 (Thread-1): Snowflake error: 000904 (42000): SQL compilation error: error line 27 at position 6
invalid identifier 'ID'
2020-06-30 15:15:40.341448 (Thread-1): On test.sample_project.not_null_lineitem_id: ROLLBACK
2020-06-30 15:15:40.341593 (Thread-1): initiating rollback
2020-06-30 15:15:40.751554 (Thread-1): finished collecting timing info
2020-06-30 15:15:40.752194 (Thread-1): Database Error in test not_null_lineitem_id (models/reports/schema.yml)
  000904 (42000): SQL compilation error: error line 27 at position 6
  invalid identifier 'ID'
  compiled SQL at target/compiled/sample_project/models/reports/schema.yml/schema_test/not_null_lineitem_id.sql
Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 158, in exception_handler
    yield
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/cursor.py", line 597, in execute
    errvalue)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/errors.py", line 97, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, errorclass, errorvalue)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/errors.py", line 73, in default_errorhandler
    done_format_msg=errorvalue.get(u'done_format_msg'))
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 27 at position 6
invalid identifier 'ID'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 607, in execute
    failed_rows = self.execute_schema_test(test)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 587, in execute_schema_test
    fetch=True,
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 119, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 306, in add_query
    abridge_sql_log=abridge_sql_log
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/usr/local/opt/python/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 177, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in test not_null_lineitem_id (models/reports/schema.yml)
  000904 (42000): SQL compilation error: error line 27 at position 6
  invalid identifier 'ID'
  compiled SQL at target/compiled/sample_project/models/reports/schema.yml/schema_test/not_null_lineitem_id.sql
2020-06-30 15:15:40.752833 (Thread-1): 10:15:40 | 4 of 9 ERROR not_null_lineitem_id.................................... [ERROR in 1.02s]
2020-06-30 15:15:40.753013 (Thread-1): Finished running node test.sample_project.not_null_lineitem_id
2020-06-30 15:15:40.753202 (Thread-1): Began running node test.sample_project.unique_lineitem_id
2020-06-30 15:15:40.753549 (Thread-1): 10:15:40 | 5 of 9 START test unique_lineitem_id................................. [RUN]
2020-06-30 15:15:40.753922 (Thread-1): Acquiring new snowflake connection "test.sample_project.unique_lineitem_id".
2020-06-30 15:15:40.754052 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.not_null_lineitem_id).
2020-06-30 15:15:40.754180 (Thread-1): Compiling test.sample_project.unique_lineitem_id
2020-06-30 15:15:40.767237 (Thread-1): Writing injected SQL for node "test.sample_project.unique_lineitem_id"
2020-06-30 15:15:40.767634 (Thread-1): finished collecting timing info
2020-06-30 15:15:40.768612 (Thread-1): Using snowflake connection "test.sample_project.unique_lineitem_id".
2020-06-30 15:15:40.768709 (Thread-1): On test.sample_project.unique_lineitem_id: BEGIN
2020-06-30 15:15:40.973876 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2020-06-30 15:15:40.974123 (Thread-1): Using snowflake connection "test.sample_project.unique_lineitem_id".
2020-06-30 15:15:40.974287 (Thread-1): On test.sample_project.unique_lineitem_id: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "test.sample_project.unique_lineitem_id"} */




with __dbt__CTE__lineitem as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  l_orderkey as orderkey,
        l_extendedprice as extendedprice,
        l_discount as discount,
        l_tax as tax,
        l_quantity as quantity
from snowflake_sample_data.tpch_sf1.lineitem
)select count(*) as validation_errors
from (

    select
        id

    from __dbt__CTE__lineitem
    where id is not null
    group by id
    having count(*) > 1

) validation_errors
2020-06-30 15:15:41.247415 (Thread-1): Snowflake query id: 01954173-02f0-597d-0000-2aed011d2416
2020-06-30 15:15:41.247648 (Thread-1): Snowflake error: 000904 (42000): SQL compilation error: error line 29 at position 8
invalid identifier 'ID'
2020-06-30 15:15:41.247828 (Thread-1): On test.sample_project.unique_lineitem_id: ROLLBACK
2020-06-30 15:15:41.247970 (Thread-1): initiating rollback
2020-06-30 15:15:41.514167 (Thread-1): finished collecting timing info
2020-06-30 15:15:41.514941 (Thread-1): Database Error in test unique_lineitem_id (models/reports/schema.yml)
  000904 (42000): SQL compilation error: error line 29 at position 8
  invalid identifier 'ID'
  compiled SQL at target/compiled/sample_project/models/reports/schema.yml/schema_test/unique_lineitem_id.sql
Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 158, in exception_handler
    yield
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/cursor.py", line 597, in execute
    errvalue)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/errors.py", line 97, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, errorclass, errorvalue)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/errors.py", line 73, in default_errorhandler
    done_format_msg=errorvalue.get(u'done_format_msg'))
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 29 at position 8
invalid identifier 'ID'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 607, in execute
    failed_rows = self.execute_schema_test(test)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 587, in execute_schema_test
    fetch=True,
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 119, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 306, in add_query
    abridge_sql_log=abridge_sql_log
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/usr/local/opt/python/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 177, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in test unique_lineitem_id (models/reports/schema.yml)
  000904 (42000): SQL compilation error: error line 29 at position 8
  invalid identifier 'ID'
  compiled SQL at target/compiled/sample_project/models/reports/schema.yml/schema_test/unique_lineitem_id.sql
2020-06-30 15:15:41.515716 (Thread-1): 10:15:41 | 5 of 9 ERROR unique_lineitem_id...................................... [ERROR in 0.76s]
2020-06-30 15:15:41.515960 (Thread-1): Finished running node test.sample_project.unique_lineitem_id
2020-06-30 15:15:41.516150 (Thread-1): Began running node model.sample_project.customer_nation
2020-06-30 15:15:41.516652 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 15:15:41.516785 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.unique_lineitem_id).
2020-06-30 15:15:41.516910 (Thread-1): Compiling model.sample_project.customer_nation
2020-06-30 15:15:41.530785 (Thread-1): Writing injected SQL for node "model.sample_project.customer_nation"
2020-06-30 15:15:41.531192 (Thread-1): finished collecting timing info
2020-06-30 15:15:41.531582 (Thread-1): Finished running node model.sample_project.customer_nation
2020-06-30 15:15:41.531717 (Thread-1): Began running node test.sample_project.not_null_nation_id
2020-06-30 15:15:41.531845 (Thread-1): 10:15:41 | 6 of 9 START test not_null_nation_id................................. [RUN]
2020-06-30 15:15:41.532083 (Thread-1): Acquiring new snowflake connection "test.sample_project.not_null_nation_id".
2020-06-30 15:15:41.532172 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer_nation).
2020-06-30 15:15:41.532263 (Thread-1): Compiling test.sample_project.not_null_nation_id
2020-06-30 15:15:41.542816 (Thread-1): Writing injected SQL for node "test.sample_project.not_null_nation_id"
2020-06-30 15:15:41.543172 (Thread-1): finished collecting timing info
2020-06-30 15:15:41.543947 (Thread-1): Using snowflake connection "test.sample_project.not_null_nation_id".
2020-06-30 15:15:41.544046 (Thread-1): On test.sample_project.not_null_nation_id: BEGIN
2020-06-30 15:15:41.744064 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2020-06-30 15:15:41.744316 (Thread-1): Using snowflake connection "test.sample_project.not_null_nation_id".
2020-06-30 15:15:41.744479 (Thread-1): On test.sample_project.not_null_nation_id: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "test.sample_project.not_null_nation_id"} */




with __dbt__CTE__nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  n_nationkey as nationkey,
        n_name as name
from snowflake_sample_data.tpch_sf1.nation
)select count(*) as validation_errors
from __dbt__CTE__nation
where id is null
2020-06-30 15:15:42.030308 (Thread-1): Snowflake query id: 01954173-0245-755d-0000-2aed011d2422
2020-06-30 15:15:42.030488 (Thread-1): Snowflake error: 000904 (42000): SQL compilation error: error line 24 at position 6
invalid identifier 'ID'
2020-06-30 15:15:42.030635 (Thread-1): On test.sample_project.not_null_nation_id: ROLLBACK
2020-06-30 15:15:42.030757 (Thread-1): initiating rollback
2020-06-30 15:15:42.304723 (Thread-1): finished collecting timing info
2020-06-30 15:15:42.305498 (Thread-1): Database Error in test not_null_nation_id (models/reports/schema.yml)
  000904 (42000): SQL compilation error: error line 24 at position 6
  invalid identifier 'ID'
  compiled SQL at target/compiled/sample_project/models/reports/schema.yml/schema_test/not_null_nation_id.sql
Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 158, in exception_handler
    yield
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/cursor.py", line 597, in execute
    errvalue)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/errors.py", line 97, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, errorclass, errorvalue)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/errors.py", line 73, in default_errorhandler
    done_format_msg=errorvalue.get(u'done_format_msg'))
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 24 at position 6
invalid identifier 'ID'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 607, in execute
    failed_rows = self.execute_schema_test(test)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 587, in execute_schema_test
    fetch=True,
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 119, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 306, in add_query
    abridge_sql_log=abridge_sql_log
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/usr/local/opt/python/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 177, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in test not_null_nation_id (models/reports/schema.yml)
  000904 (42000): SQL compilation error: error line 24 at position 6
  invalid identifier 'ID'
  compiled SQL at target/compiled/sample_project/models/reports/schema.yml/schema_test/not_null_nation_id.sql
2020-06-30 15:15:42.306275 (Thread-1): 10:15:42 | 6 of 9 ERROR not_null_nation_id...................................... [ERROR in 0.77s]
2020-06-30 15:15:42.306519 (Thread-1): Finished running node test.sample_project.not_null_nation_id
2020-06-30 15:15:42.306707 (Thread-1): Began running node test.sample_project.unique_nation_id
2020-06-30 15:15:42.307036 (Thread-1): 10:15:42 | 7 of 9 START test unique_nation_id................................... [RUN]
2020-06-30 15:15:42.307413 (Thread-1): Acquiring new snowflake connection "test.sample_project.unique_nation_id".
2020-06-30 15:15:42.307546 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.not_null_nation_id).
2020-06-30 15:15:42.307675 (Thread-1): Compiling test.sample_project.unique_nation_id
2020-06-30 15:15:42.322721 (Thread-1): Writing injected SQL for node "test.sample_project.unique_nation_id"
2020-06-30 15:15:42.323159 (Thread-1): finished collecting timing info
2020-06-30 15:15:42.324184 (Thread-1): Using snowflake connection "test.sample_project.unique_nation_id".
2020-06-30 15:15:42.324302 (Thread-1): On test.sample_project.unique_nation_id: BEGIN
2020-06-30 15:15:42.550233 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2020-06-30 15:15:42.550487 (Thread-1): Using snowflake connection "test.sample_project.unique_nation_id".
2020-06-30 15:15:42.550657 (Thread-1): On test.sample_project.unique_nation_id: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "test.sample_project.unique_nation_id"} */




with __dbt__CTE__nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  n_nationkey as nationkey,
        n_name as name
from snowflake_sample_data.tpch_sf1.nation
)select count(*) as validation_errors
from (

    select
        id

    from __dbt__CTE__nation
    where id is not null
    group by id
    having count(*) > 1

) validation_errors
2020-06-30 15:15:42.771112 (Thread-1): Snowflake query id: 01954173-02cb-b8c9-0000-2aed011d1402
2020-06-30 15:15:42.771321 (Thread-1): Snowflake error: 000904 (42000): SQL compilation error: error line 26 at position 8
invalid identifier 'ID'
2020-06-30 15:15:42.771465 (Thread-1): On test.sample_project.unique_nation_id: ROLLBACK
2020-06-30 15:15:42.771579 (Thread-1): initiating rollback
2020-06-30 15:15:43.021509 (Thread-1): finished collecting timing info
2020-06-30 15:15:43.022045 (Thread-1): Database Error in test unique_nation_id (models/reports/schema.yml)
  000904 (42000): SQL compilation error: error line 26 at position 8
  invalid identifier 'ID'
  compiled SQL at target/compiled/sample_project/models/reports/schema.yml/schema_test/unique_nation_id.sql
Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 158, in exception_handler
    yield
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/cursor.py", line 597, in execute
    errvalue)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/errors.py", line 97, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, errorclass, errorvalue)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/errors.py", line 73, in default_errorhandler
    done_format_msg=errorvalue.get(u'done_format_msg'))
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 26 at position 8
invalid identifier 'ID'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 607, in execute
    failed_rows = self.execute_schema_test(test)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 587, in execute_schema_test
    fetch=True,
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 119, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 306, in add_query
    abridge_sql_log=abridge_sql_log
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/usr/local/opt/python/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 177, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in test unique_nation_id (models/reports/schema.yml)
  000904 (42000): SQL compilation error: error line 26 at position 8
  invalid identifier 'ID'
  compiled SQL at target/compiled/sample_project/models/reports/schema.yml/schema_test/unique_nation_id.sql
2020-06-30 15:15:43.022584 (Thread-1): 10:15:43 | 7 of 9 ERROR unique_nation_id........................................ [ERROR in 0.72s]
2020-06-30 15:15:43.022734 (Thread-1): Finished running node test.sample_project.unique_nation_id
2020-06-30 15:15:43.022889 (Thread-1): Began running node model.sample_project.orders_lineitem
2020-06-30 15:15:43.023345 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 15:15:43.023471 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.unique_nation_id).
2020-06-30 15:15:43.023582 (Thread-1): Compiling model.sample_project.orders_lineitem
2020-06-30 15:15:43.036882 (Thread-1): Writing injected SQL for node "model.sample_project.orders_lineitem"
2020-06-30 15:15:43.037272 (Thread-1): finished collecting timing info
2020-06-30 15:15:43.037672 (Thread-1): Finished running node model.sample_project.orders_lineitem
2020-06-30 15:15:43.037807 (Thread-1): Began running node test.sample_project.not_null_orders_id
2020-06-30 15:15:43.037939 (Thread-1): 10:15:43 | 8 of 9 START test not_null_orders_id................................. [RUN]
2020-06-30 15:15:43.038348 (Thread-1): Acquiring new snowflake connection "test.sample_project.not_null_orders_id".
2020-06-30 15:15:43.038453 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders_lineitem).
2020-06-30 15:15:43.038545 (Thread-1): Compiling test.sample_project.not_null_orders_id
2020-06-30 15:15:43.049665 (Thread-1): Writing injected SQL for node "test.sample_project.not_null_orders_id"
2020-06-30 15:15:43.050026 (Thread-1): finished collecting timing info
2020-06-30 15:15:43.050866 (Thread-1): Using snowflake connection "test.sample_project.not_null_orders_id".
2020-06-30 15:15:43.050965 (Thread-1): On test.sample_project.not_null_orders_id: BEGIN
2020-06-30 15:15:43.359780 (Thread-1): SQL status: SUCCESS 1 in 0.31 seconds
2020-06-30 15:15:43.360034 (Thread-1): Using snowflake connection "test.sample_project.not_null_orders_id".
2020-06-30 15:15:43.360202 (Thread-1): On test.sample_project.not_null_orders_id: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "test.sample_project.not_null_orders_id"} */




with __dbt__CTE__orders as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  o_orderkey as orderkey,
        o_custkey as custkey,
        o_totalprice as totalprice,
        o_orderdate as orderdate
from snowflake_sample_data.tpch_sf1.orders
)select count(*) as validation_errors
from __dbt__CTE__orders
where id is null
2020-06-30 15:15:43.631462 (Thread-1): Snowflake query id: 01954173-02be-c58b-0000-2aed011d2432
2020-06-30 15:15:43.631654 (Thread-1): Snowflake error: 000904 (42000): SQL compilation error: error line 26 at position 6
invalid identifier 'ID'
2020-06-30 15:15:43.631803 (Thread-1): On test.sample_project.not_null_orders_id: ROLLBACK
2020-06-30 15:15:43.631921 (Thread-1): initiating rollback
2020-06-30 15:15:44.022341 (Thread-1): finished collecting timing info
2020-06-30 15:15:44.023137 (Thread-1): Database Error in test not_null_orders_id (models/reports/schema.yml)
  000904 (42000): SQL compilation error: error line 26 at position 6
  invalid identifier 'ID'
  compiled SQL at target/compiled/sample_project/models/reports/schema.yml/schema_test/not_null_orders_id.sql
Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 158, in exception_handler
    yield
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/cursor.py", line 597, in execute
    errvalue)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/errors.py", line 97, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, errorclass, errorvalue)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/errors.py", line 73, in default_errorhandler
    done_format_msg=errorvalue.get(u'done_format_msg'))
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 26 at position 6
invalid identifier 'ID'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 607, in execute
    failed_rows = self.execute_schema_test(test)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 587, in execute_schema_test
    fetch=True,
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 119, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 306, in add_query
    abridge_sql_log=abridge_sql_log
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/usr/local/opt/python/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 177, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in test not_null_orders_id (models/reports/schema.yml)
  000904 (42000): SQL compilation error: error line 26 at position 6
  invalid identifier 'ID'
  compiled SQL at target/compiled/sample_project/models/reports/schema.yml/schema_test/not_null_orders_id.sql
2020-06-30 15:15:44.023950 (Thread-1): 10:15:44 | 8 of 9 ERROR not_null_orders_id...................................... [ERROR in 0.99s]
2020-06-30 15:15:44.024186 (Thread-1): Finished running node test.sample_project.not_null_orders_id
2020-06-30 15:15:44.024421 (Thread-1): Began running node test.sample_project.unique_orders_id
2020-06-30 15:15:44.024612 (Thread-1): 10:15:44 | 9 of 9 START test unique_orders_id................................... [RUN]
2020-06-30 15:15:44.025115 (Thread-1): Acquiring new snowflake connection "test.sample_project.unique_orders_id".
2020-06-30 15:15:44.025270 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.not_null_orders_id).
2020-06-30 15:15:44.025410 (Thread-1): Compiling test.sample_project.unique_orders_id
2020-06-30 15:15:44.038988 (Thread-1): Writing injected SQL for node "test.sample_project.unique_orders_id"
2020-06-30 15:15:44.039423 (Thread-1): finished collecting timing info
2020-06-30 15:15:44.040380 (Thread-1): Using snowflake connection "test.sample_project.unique_orders_id".
2020-06-30 15:15:44.040481 (Thread-1): On test.sample_project.unique_orders_id: BEGIN
2020-06-30 15:15:44.291396 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2020-06-30 15:15:44.291655 (Thread-1): Using snowflake connection "test.sample_project.unique_orders_id".
2020-06-30 15:15:44.291824 (Thread-1): On test.sample_project.unique_orders_id: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "test.sample_project.unique_orders_id"} */




with __dbt__CTE__orders as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  o_orderkey as orderkey,
        o_custkey as custkey,
        o_totalprice as totalprice,
        o_orderdate as orderdate
from snowflake_sample_data.tpch_sf1.orders
)select count(*) as validation_errors
from (

    select
        id

    from __dbt__CTE__orders
    where id is not null
    group by id
    having count(*) > 1

) validation_errors
2020-06-30 15:15:44.847730 (Thread-1): Snowflake query id: 01954173-0214-be16-0000-2aed011d1406
2020-06-30 15:15:44.847972 (Thread-1): Snowflake error: 000904 (42000): SQL compilation error: error line 28 at position 8
invalid identifier 'ID'
2020-06-30 15:15:44.848160 (Thread-1): On test.sample_project.unique_orders_id: ROLLBACK
2020-06-30 15:15:44.848314 (Thread-1): initiating rollback
2020-06-30 15:15:45.868718 (Thread-1): finished collecting timing info
2020-06-30 15:15:45.869500 (Thread-1): Database Error in test unique_orders_id (models/reports/schema.yml)
  000904 (42000): SQL compilation error: error line 28 at position 8
  invalid identifier 'ID'
  compiled SQL at target/compiled/sample_project/models/reports/schema.yml/schema_test/unique_orders_id.sql
Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 158, in exception_handler
    yield
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/cursor.py", line 597, in execute
    errvalue)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/errors.py", line 97, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, errorclass, errorvalue)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/errors.py", line 73, in default_errorhandler
    done_format_msg=errorvalue.get(u'done_format_msg'))
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 28 at position 8
invalid identifier 'ID'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 607, in execute
    failed_rows = self.execute_schema_test(test)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 587, in execute_schema_test
    fetch=True,
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 119, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 306, in add_query
    abridge_sql_log=abridge_sql_log
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/usr/local/opt/python/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 177, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in test unique_orders_id (models/reports/schema.yml)
  000904 (42000): SQL compilation error: error line 28 at position 8
  invalid identifier 'ID'
  compiled SQL at target/compiled/sample_project/models/reports/schema.yml/schema_test/unique_orders_id.sql
2020-06-30 15:15:45.870295 (Thread-1): 10:15:45 | 9 of 9 ERROR unique_orders_id........................................ [ERROR in 1.85s]
2020-06-30 15:15:45.870545 (Thread-1): Finished running node test.sample_project.unique_orders_id
2020-06-30 15:15:45.870741 (Thread-1): Began running node model.sample_project.cust_list_ord_nat
2020-06-30 15:15:45.871241 (Thread-1): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 15:15:45.871396 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.unique_orders_id).
2020-06-30 15:15:45.871535 (Thread-1): Compiling model.sample_project.cust_list_ord_nat
2020-06-30 15:15:45.887018 (Thread-1): Writing injected SQL for node "model.sample_project.cust_list_ord_nat"
2020-06-30 15:15:45.887493 (Thread-1): finished collecting timing info
2020-06-30 15:15:45.887921 (Thread-1): Finished running node model.sample_project.cust_list_ord_nat
2020-06-30 15:15:45.989693 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 15:15:45.990064 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:15:45.990525 (MainThread): 10:15:45 | 
2020-06-30 15:15:45.990755 (MainThread): 10:15:45 | Finished running 9 tests in 17.32s.
2020-06-30 15:15:45.990945 (MainThread): Connection 'master' was properly closed.
2020-06-30 15:15:45.991091 (MainThread): Connection 'model.sample_project.cust_list_ord_nat' was left open.
2020-06-30 15:15:45.991236 (MainThread): On model.sample_project.cust_list_ord_nat: Close
2020-06-30 15:15:46.310202 (MainThread): 
2020-06-30 15:15:46.310400 (MainThread): Completed with 9 errors and 0 warnings:
2020-06-30 15:15:46.310504 (MainThread): 
2020-06-30 15:15:46.310603 (MainThread): Compilation Error in test source_is_nonnegative_tpch_customer_c_custkey (models/source_reads/sources.yml)
2020-06-30 15:15:46.310695 (MainThread):   'test_is_nonnegative' is undefined
2020-06-30 15:15:46.310783 (MainThread): 
2020-06-30 15:15:46.310876 (MainThread): Database Error in test not_null_customer_id (models/reports/schema.yml)
2020-06-30 15:15:46.310964 (MainThread):   000904 (42000): SQL compilation error: error line 25 at position 6
2020-06-30 15:15:46.311046 (MainThread):   invalid identifier 'ID'
2020-06-30 15:15:46.311129 (MainThread):   compiled SQL at target/compiled/sample_project/models/reports/schema.yml/schema_test/not_null_customer_id.sql
2020-06-30 15:15:46.311216 (MainThread): 
2020-06-30 15:15:46.311308 (MainThread): Database Error in test unique_customer_id (models/reports/schema.yml)
2020-06-30 15:15:46.311394 (MainThread):   000904 (42000): SQL compilation error: error line 27 at position 8
2020-06-30 15:15:46.311473 (MainThread):   invalid identifier 'ID'
2020-06-30 15:15:46.311553 (MainThread):   compiled SQL at target/compiled/sample_project/models/reports/schema.yml/schema_test/unique_customer_id.sql
2020-06-30 15:15:46.311638 (MainThread): 
2020-06-30 15:15:46.311729 (MainThread): Database Error in test not_null_lineitem_id (models/reports/schema.yml)
2020-06-30 15:15:46.311814 (MainThread):   000904 (42000): SQL compilation error: error line 27 at position 6
2020-06-30 15:15:46.311892 (MainThread):   invalid identifier 'ID'
2020-06-30 15:15:46.311970 (MainThread):   compiled SQL at target/compiled/sample_project/models/reports/schema.yml/schema_test/not_null_lineitem_id.sql
2020-06-30 15:15:46.312054 (MainThread): 
2020-06-30 15:15:46.312145 (MainThread): Database Error in test unique_lineitem_id (models/reports/schema.yml)
2020-06-30 15:15:46.312228 (MainThread):   000904 (42000): SQL compilation error: error line 29 at position 8
2020-06-30 15:15:46.312307 (MainThread):   invalid identifier 'ID'
2020-06-30 15:15:46.312385 (MainThread):   compiled SQL at target/compiled/sample_project/models/reports/schema.yml/schema_test/unique_lineitem_id.sql
2020-06-30 15:15:46.312467 (MainThread): 
2020-06-30 15:15:46.312556 (MainThread): Database Error in test not_null_nation_id (models/reports/schema.yml)
2020-06-30 15:15:46.312639 (MainThread):   000904 (42000): SQL compilation error: error line 24 at position 6
2020-06-30 15:15:46.312717 (MainThread):   invalid identifier 'ID'
2020-06-30 15:15:46.312794 (MainThread):   compiled SQL at target/compiled/sample_project/models/reports/schema.yml/schema_test/not_null_nation_id.sql
2020-06-30 15:15:46.312880 (MainThread): 
2020-06-30 15:15:46.312970 (MainThread): Database Error in test unique_nation_id (models/reports/schema.yml)
2020-06-30 15:15:46.313055 (MainThread):   000904 (42000): SQL compilation error: error line 26 at position 8
2020-06-30 15:15:46.313223 (MainThread):   invalid identifier 'ID'
2020-06-30 15:15:46.313339 (MainThread):   compiled SQL at target/compiled/sample_project/models/reports/schema.yml/schema_test/unique_nation_id.sql
2020-06-30 15:15:46.313423 (MainThread): 
2020-06-30 15:15:46.313512 (MainThread): Database Error in test not_null_orders_id (models/reports/schema.yml)
2020-06-30 15:15:46.313595 (MainThread):   000904 (42000): SQL compilation error: error line 26 at position 6
2020-06-30 15:15:46.313675 (MainThread):   invalid identifier 'ID'
2020-06-30 15:15:46.313754 (MainThread):   compiled SQL at target/compiled/sample_project/models/reports/schema.yml/schema_test/not_null_orders_id.sql
2020-06-30 15:15:46.313904 (MainThread): 
2020-06-30 15:15:46.313993 (MainThread): Database Error in test unique_orders_id (models/reports/schema.yml)
2020-06-30 15:15:46.314077 (MainThread):   000904 (42000): SQL compilation error: error line 28 at position 8
2020-06-30 15:15:46.314156 (MainThread):   invalid identifier 'ID'
2020-06-30 15:15:46.314415 (MainThread):   compiled SQL at target/compiled/sample_project/models/reports/schema.yml/schema_test/unique_orders_id.sql
2020-06-30 15:15:46.314552 (MainThread): 
Done. PASS=0 WARN=0 ERROR=9 SKIP=0 TOTAL=9
2020-06-30 15:15:46.314883 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac79590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad5f890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad6ecd0>]}
2020-06-30 15:15:46.315069 (MainThread): Flushing usage events
2020-06-30 15:18:02.601577 (MainThread): Running with dbt=0.17.0
2020-06-30 15:18:02.925679 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2020-06-30 15:18:02.926788 (MainThread): Tracking: tracking
2020-06-30 15:18:02.927165 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ae0a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105af79d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105af7990>]}
2020-06-30 15:18:02.947685 (MainThread): Partial parsing not enabled
2020-06-30 15:18:02.949725 (MainThread): Parsing macros/core.sql
2020-06-30 15:18:02.956622 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-30 15:18:02.965618 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-30 15:18:02.968145 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-30 15:18:02.991085 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-30 15:18:03.026679 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-30 15:18:03.052525 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-30 15:18:03.054561 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-30 15:18:03.061834 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-30 15:18:03.077670 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-30 15:18:03.085520 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-30 15:18:03.095224 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-30 15:18:03.100749 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-30 15:18:03.101794 (MainThread): Parsing macros/etc/query.sql
2020-06-30 15:18:03.103208 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-30 15:18:03.105084 (MainThread): Parsing macros/etc/datetime.sql
2020-06-30 15:18:03.115168 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-30 15:18:03.117350 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-30 15:18:03.119163 (MainThread): Parsing macros/adapters/common.sql
2020-06-30 15:18:03.173636 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-30 15:18:03.174848 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-30 15:18:03.175805 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-30 15:18:03.176937 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-30 15:18:03.179344 (MainThread): Parsing macros/catalog.sql
2020-06-30 15:18:03.181286 (MainThread): Parsing macros/adapters.sql
2020-06-30 15:18:03.204865 (MainThread): Parsing macros/materializations/merge.sql
2020-06-30 15:18:03.207052 (MainThread): Parsing macros/materializations/view.sql
2020-06-30 15:18:03.208314 (MainThread): Parsing macros/materializations/table.sql
2020-06-30 15:18:03.212593 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-30 15:18:03.251498 (MainThread): Partial parsing not enabled
2020-06-30 15:18:03.253461 (MainThread): Parsing macros/cross_db_utils/except.sql
2020-06-30 15:18:03.254687 (MainThread): Parsing macros/cross_db_utils/replace.sql
2020-06-30 15:18:03.256048 (MainThread): Parsing macros/cross_db_utils/concat.sql
2020-06-30 15:18:03.258349 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2020-06-30 15:18:03.264468 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2020-06-30 15:18:03.265888 (MainThread): Parsing macros/cross_db_utils/length.sql
2020-06-30 15:18:03.267242 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2020-06-30 15:18:03.270075 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2020-06-30 15:18:03.271169 (MainThread): Parsing macros/cross_db_utils/right.sql
2020-06-30 15:18:03.274130 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2020-06-30 15:18:03.284420 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2020-06-30 15:18:03.286357 (MainThread): Parsing macros/cross_db_utils/hash.sql
2020-06-30 15:18:03.287803 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2020-06-30 15:18:03.289281 (MainThread): Parsing macros/cross_db_utils/position.sql
2020-06-30 15:18:03.290876 (MainThread): Parsing macros/cross_db_utils/literal.sql
2020-06-30 15:18:03.291815 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2020-06-30 15:18:03.297117 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2020-06-30 15:18:03.303681 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2020-06-30 15:18:03.306698 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2020-06-30 15:18:03.308925 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2020-06-30 15:18:03.310551 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2020-06-30 15:18:03.337685 (MainThread): Parsing macros/logger/pretty_log_format.sql
2020-06-30 15:18:03.338410 (MainThread): Parsing macros/logger/pretty_time.sql
2020-06-30 15:18:03.339453 (MainThread): Parsing macros/logger/log_info.sql
2020-06-30 15:18:03.340231 (MainThread): Parsing macros/datetime/date_spine.sql
2020-06-30 15:18:03.343753 (MainThread): Parsing macros/web/get_url_host.sql
2020-06-30 15:18:03.345198 (MainThread): Parsing macros/web/get_url_path.sql
2020-06-30 15:18:03.347569 (MainThread): Parsing macros/web/get_url_parameter.sql
2020-06-30 15:18:03.348736 (MainThread): Parsing macros/geo/haversine_distance.sql
2020-06-30 15:18:03.349706 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2020-06-30 15:18:03.351137 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2020-06-30 15:18:03.353712 (MainThread): Parsing macros/schema_tests/recency.sql
2020-06-30 15:18:03.355800 (MainThread): Parsing macros/schema_tests/not_constant.sql
2020-06-30 15:18:03.357277 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2020-06-30 15:18:03.358731 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2020-06-30 15:18:03.359970 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2020-06-30 15:18:03.361533 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2020-06-30 15:18:03.362646 (MainThread): Parsing macros/schema_tests/equality.sql
2020-06-30 15:18:03.368237 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2020-06-30 15:18:03.377531 (MainThread): Parsing macros/sql/nullcheck_table.sql
2020-06-30 15:18:03.378916 (MainThread): Parsing macros/sql/generate_series.sql
2020-06-30 15:18:03.383461 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2020-06-30 15:18:03.387696 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2020-06-30 15:18:03.390892 (MainThread): Parsing macros/sql/star.sql
2020-06-30 15:18:03.394489 (MainThread): Parsing macros/sql/unpivot.sql
2020-06-30 15:18:03.403764 (MainThread): Parsing macros/sql/union.sql
2020-06-30 15:18:03.415657 (MainThread): Parsing macros/sql/groupby.sql
2020-06-30 15:18:03.416655 (MainThread): Parsing macros/sql/surrogate_key.sql
2020-06-30 15:18:03.420307 (MainThread): Parsing macros/sql/safe_add.sql
2020-06-30 15:18:03.421425 (MainThread): Parsing macros/sql/nullcheck.sql
2020-06-30 15:18:03.422804 (MainThread): Parsing macros/sql/get_column_values.sql
2020-06-30 15:18:03.427649 (MainThread): Parsing macros/sql/pivot.sql
2020-06-30 15:18:03.430484 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2020-06-30 15:18:03.474095 (MainThread): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 15:18:03.474207 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:18:03.504599 (MainThread): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 15:18:03.504704 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:18:03.516179 (MainThread): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 15:18:03.516272 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:18:03.527801 (MainThread): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 15:18:03.527896 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:18:03.539351 (MainThread): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 15:18:03.539446 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:18:03.552007 (MainThread): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 15:18:03.552099 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:18:03.564350 (MainThread): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 15:18:03.564441 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:18:03.577218 (MainThread): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 15:18:03.577308 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:18:03.588916 (MainThread): Acquiring new snowflake connection "model.sample_project.sales_report_one".
2020-06-30 15:18:03.589001 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:18:03.600024 (MainThread): Acquiring new snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 15:18:03.600109 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:18:03.614972 (MainThread): Acquiring new snowflake connection "model.sample_project.sales_report_two".
2020-06-30 15:18:03.615102 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:18:03.968300 (MainThread): Found 11 models, 1 test, 0 snapshots, 0 analyses, 263 macros, 0 operations, 0 seed files, 4 sources
2020-06-30 15:18:03.969614 (MainThread): 
2020-06-30 15:18:03.969891 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 15:18:03.969981 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:18:03.986845 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 15:18:03.987100 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-06-30 15:18:04.000129 (ThreadPoolExecutor-1_0): Using snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 15:18:04.000237 (ThreadPoolExecutor-1_0): On list_JAVEN_TESTING_TEST: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING_TEST"} */

    show terse objects in JAVEN_TESTING.TEST
2020-06-30 15:18:04.473687 (ThreadPoolExecutor-1_0): unclosed file <_io.BufferedReader name='/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/certifi/cacert.pem'>
2020-06-30 15:18:14.614712 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 10 in 10.61 seconds
2020-06-30 15:18:14.629104 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 15:18:14.629221 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:18:14.629459 (MainThread): 10:18:14 | Concurrency: 1 threads (target='dev')
2020-06-30 15:18:14.629593 (MainThread): 10:18:14 | 
2020-06-30 15:18:14.630347 (Thread-1): Began running node model.sample_project.customer
2020-06-30 15:18:14.630630 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 15:18:14.630732 (Thread-1): Re-using an available connection from the pool (formerly list_JAVEN_TESTING_TEST).
2020-06-30 15:18:14.630834 (Thread-1): Compiling model.sample_project.customer
2020-06-30 15:18:14.647251 (Thread-1): Writing injected SQL for node "model.sample_project.customer"
2020-06-30 15:18:14.647582 (Thread-1): finished collecting timing info
2020-06-30 15:18:14.647934 (Thread-1): Finished running node model.sample_project.customer
2020-06-30 15:18:14.648054 (Thread-1): Began running node model.sample_project.lineitem
2020-06-30 15:18:14.648284 (Thread-1): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 15:18:14.648370 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer).
2020-06-30 15:18:14.648512 (Thread-1): Compiling model.sample_project.lineitem
2020-06-30 15:18:14.656629 (Thread-1): Writing injected SQL for node "model.sample_project.lineitem"
2020-06-30 15:18:14.656932 (Thread-1): finished collecting timing info
2020-06-30 15:18:14.657268 (Thread-1): Finished running node model.sample_project.lineitem
2020-06-30 15:18:14.657387 (Thread-1): Began running node model.sample_project.nation
2020-06-30 15:18:14.657813 (Thread-1): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 15:18:14.657913 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.lineitem).
2020-06-30 15:18:14.658055 (Thread-1): Compiling model.sample_project.nation
2020-06-30 15:18:14.664325 (Thread-1): Writing injected SQL for node "model.sample_project.nation"
2020-06-30 15:18:14.664698 (Thread-1): finished collecting timing info
2020-06-30 15:18:14.665370 (Thread-1): Finished running node model.sample_project.nation
2020-06-30 15:18:14.665596 (Thread-1): Began running node model.sample_project.orders
2020-06-30 15:18:14.666211 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 15:18:14.666619 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.nation).
2020-06-30 15:18:14.666815 (Thread-1): Compiling model.sample_project.orders
2020-06-30 15:18:14.677615 (Thread-1): Writing injected SQL for node "model.sample_project.orders"
2020-06-30 15:18:14.677951 (Thread-1): finished collecting timing info
2020-06-30 15:18:14.678309 (Thread-1): Finished running node model.sample_project.orders
2020-06-30 15:18:14.678432 (Thread-1): Began running node test.sample_project.source_is_nonnegative_tpch_customer_c_custkey
2020-06-30 15:18:14.678626 (Thread-1): 10:18:14 | 1 of 1 START test source_is_nonnegative_tpch_customer_c_custkey...... [RUN]
2020-06-30 15:18:14.678954 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_nonnegative_tpch_customer_c_custkey".
2020-06-30 15:18:14.679043 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders).
2020-06-30 15:18:14.679126 (Thread-1): Compiling test.sample_project.source_is_nonnegative_tpch_customer_c_custkey
2020-06-30 15:18:14.691786 (Thread-1): finished collecting timing info
2020-06-30 15:18:14.692106 (Thread-1): Compilation Error in test source_is_nonnegative_tpch_customer_c_custkey (models/source_reads/sources.yml)
  'test_is_nonnegative' is undefined
Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 449, in catch_jinja
    yield
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 481, in render_template
    return template.render(ctx)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 1, in top-level template code
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
jinja2.exceptions.UndefinedError: 'test_is_nonnegative' is undefined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 165, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 340, in compile
    return compile_node(self.adapter, self.config, self.node, manifest, {})
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/compilation.py", line 255, in compile_node
    node = compiler.compile_node(node, manifest, extra_context)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/compilation.py", line 179, in compile_node
    node)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 530, in get_rendered
    return render_template(template, ctx, node)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 481, in render_template
    return template.render(ctx)
  File "/usr/local/opt/python/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 454, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in test source_is_nonnegative_tpch_customer_c_custkey (models/source_reads/sources.yml)
  'test_is_nonnegative' is undefined
2020-06-30 15:18:14.693442 (Thread-1): 10:18:14 | 1 of 1 ERROR source_is_nonnegative_tpch_customer_c_custkey........... [ERROR in 0.01s]
2020-06-30 15:18:14.693550 (Thread-1): Finished running node test.sample_project.source_is_nonnegative_tpch_customer_c_custkey
2020-06-30 15:18:14.693662 (Thread-1): Began running node model.sample_project.customer_nation
2020-06-30 15:18:14.693876 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 15:18:14.693959 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_nonnegative_tpch_customer_c_custkey).
2020-06-30 15:18:14.694038 (Thread-1): Compiling model.sample_project.customer_nation
2020-06-30 15:18:14.705605 (Thread-1): Writing injected SQL for node "model.sample_project.customer_nation"
2020-06-30 15:18:14.705933 (Thread-1): finished collecting timing info
2020-06-30 15:18:14.706321 (Thread-1): Finished running node model.sample_project.customer_nation
2020-06-30 15:18:14.706437 (Thread-1): Began running node model.sample_project.orders_lineitem
2020-06-30 15:18:14.706760 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 15:18:14.706857 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer_nation).
2020-06-30 15:18:14.706939 (Thread-1): Compiling model.sample_project.orders_lineitem
2020-06-30 15:18:14.718899 (Thread-1): Writing injected SQL for node "model.sample_project.orders_lineitem"
2020-06-30 15:18:14.719176 (Thread-1): finished collecting timing info
2020-06-30 15:18:14.719723 (Thread-1): Finished running node model.sample_project.orders_lineitem
2020-06-30 15:18:14.719998 (Thread-1): Began running node model.sample_project.cust_list_ord_nat
2020-06-30 15:18:14.720234 (Thread-1): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 15:18:14.720318 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders_lineitem).
2020-06-30 15:18:14.720396 (Thread-1): Compiling model.sample_project.cust_list_ord_nat
2020-06-30 15:18:14.734667 (Thread-1): Writing injected SQL for node "model.sample_project.cust_list_ord_nat"
2020-06-30 15:18:14.734974 (Thread-1): finished collecting timing info
2020-06-30 15:18:14.735305 (Thread-1): Finished running node model.sample_project.cust_list_ord_nat
2020-06-30 15:18:14.840928 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 15:18:14.841296 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:18:14.841744 (MainThread): 10:18:14 | 
2020-06-30 15:18:14.841977 (MainThread): 10:18:14 | Finished running 1 test in 10.87s.
2020-06-30 15:18:14.842173 (MainThread): Connection 'master' was properly closed.
2020-06-30 15:18:14.842326 (MainThread): Connection 'model.sample_project.cust_list_ord_nat' was left open.
2020-06-30 15:18:14.842478 (MainThread): On model.sample_project.cust_list_ord_nat: Close
2020-06-30 15:18:15.155720 (MainThread): 
2020-06-30 15:18:15.155924 (MainThread): Completed with 1 error and 0 warnings:
2020-06-30 15:18:15.156065 (MainThread): 
2020-06-30 15:18:15.156198 (MainThread): Compilation Error in test source_is_nonnegative_tpch_customer_c_custkey (models/source_reads/sources.yml)
2020-06-30 15:18:15.156336 (MainThread):   'test_is_nonnegative' is undefined
2020-06-30 15:18:15.156458 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2020-06-30 15:18:15.156659 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10888d910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106475d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106475d10>]}
2020-06-30 15:18:15.156889 (MainThread): Flushing usage events
2020-06-30 15:18:47.257633 (MainThread): Running with dbt=0.17.0
2020-06-30 15:18:47.567409 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2020-06-30 15:18:47.568181 (MainThread): Tracking: tracking
2020-06-30 15:18:47.568508 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f839d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f99990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f998d0>]}
2020-06-30 15:18:47.590206 (MainThread): Partial parsing not enabled
2020-06-30 15:18:47.591963 (MainThread): Parsing macros/core.sql
2020-06-30 15:18:47.596475 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-30 15:18:47.604991 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-30 15:18:47.606720 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-30 15:18:47.625826 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-30 15:18:47.656142 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-30 15:18:47.679376 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-30 15:18:47.681297 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-30 15:18:47.688317 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-30 15:18:47.703365 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-30 15:18:47.711069 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-30 15:18:47.718059 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-30 15:18:47.724528 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-30 15:18:47.725620 (MainThread): Parsing macros/etc/query.sql
2020-06-30 15:18:47.726723 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-30 15:18:47.728695 (MainThread): Parsing macros/etc/datetime.sql
2020-06-30 15:18:47.738360 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-30 15:18:47.740669 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-30 15:18:47.742373 (MainThread): Parsing macros/adapters/common.sql
2020-06-30 15:18:47.796055 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-30 15:18:47.797258 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-30 15:18:47.798191 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-30 15:18:47.799300 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-30 15:18:47.801684 (MainThread): Parsing macros/catalog.sql
2020-06-30 15:18:47.803775 (MainThread): Parsing macros/adapters.sql
2020-06-30 15:18:47.827599 (MainThread): Parsing macros/materializations/merge.sql
2020-06-30 15:18:47.830327 (MainThread): Parsing macros/materializations/view.sql
2020-06-30 15:18:47.831564 (MainThread): Parsing macros/materializations/table.sql
2020-06-30 15:18:47.835489 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-30 15:18:47.875085 (MainThread): Partial parsing not enabled
2020-06-30 15:18:47.876771 (MainThread): Parsing macros/cross_db_utils/except.sql
2020-06-30 15:18:47.878666 (MainThread): Parsing macros/cross_db_utils/replace.sql
2020-06-30 15:18:47.880036 (MainThread): Parsing macros/cross_db_utils/concat.sql
2020-06-30 15:18:47.882475 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2020-06-30 15:18:47.888638 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2020-06-30 15:18:47.890370 (MainThread): Parsing macros/cross_db_utils/length.sql
2020-06-30 15:18:47.891692 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2020-06-30 15:18:47.894276 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2020-06-30 15:18:47.895479 (MainThread): Parsing macros/cross_db_utils/right.sql
2020-06-30 15:18:47.897953 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2020-06-30 15:18:47.908444 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2020-06-30 15:18:47.910788 (MainThread): Parsing macros/cross_db_utils/hash.sql
2020-06-30 15:18:47.912414 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2020-06-30 15:18:47.914422 (MainThread): Parsing macros/cross_db_utils/position.sql
2020-06-30 15:18:47.916438 (MainThread): Parsing macros/cross_db_utils/literal.sql
2020-06-30 15:18:47.917364 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2020-06-30 15:18:47.921021 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2020-06-30 15:18:47.927175 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2020-06-30 15:18:47.930340 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2020-06-30 15:18:47.932246 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2020-06-30 15:18:47.933920 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2020-06-30 15:18:47.959304 (MainThread): Parsing macros/logger/pretty_log_format.sql
2020-06-30 15:18:47.960385 (MainThread): Parsing macros/logger/pretty_time.sql
2020-06-30 15:18:47.961486 (MainThread): Parsing macros/logger/log_info.sql
2020-06-30 15:18:47.962188 (MainThread): Parsing macros/datetime/date_spine.sql
2020-06-30 15:18:47.966345 (MainThread): Parsing macros/web/get_url_host.sql
2020-06-30 15:18:47.968085 (MainThread): Parsing macros/web/get_url_path.sql
2020-06-30 15:18:47.970321 (MainThread): Parsing macros/web/get_url_parameter.sql
2020-06-30 15:18:47.971718 (MainThread): Parsing macros/geo/haversine_distance.sql
2020-06-30 15:18:47.972689 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2020-06-30 15:18:47.974293 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2020-06-30 15:18:47.976781 (MainThread): Parsing macros/schema_tests/recency.sql
2020-06-30 15:18:47.978070 (MainThread): Parsing macros/schema_tests/not_constant.sql
2020-06-30 15:18:47.979093 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2020-06-30 15:18:47.980197 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2020-06-30 15:18:47.981409 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2020-06-30 15:18:47.982935 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2020-06-30 15:18:47.984050 (MainThread): Parsing macros/schema_tests/equality.sql
2020-06-30 15:18:47.987326 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2020-06-30 15:18:47.993764 (MainThread): Parsing macros/sql/nullcheck_table.sql
2020-06-30 15:18:47.994821 (MainThread): Parsing macros/sql/generate_series.sql
2020-06-30 15:18:47.998244 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2020-06-30 15:18:48.002223 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2020-06-30 15:18:48.004957 (MainThread): Parsing macros/sql/star.sql
2020-06-30 15:18:48.008166 (MainThread): Parsing macros/sql/unpivot.sql
2020-06-30 15:18:48.014700 (MainThread): Parsing macros/sql/union.sql
2020-06-30 15:18:48.025155 (MainThread): Parsing macros/sql/groupby.sql
2020-06-30 15:18:48.026119 (MainThread): Parsing macros/sql/surrogate_key.sql
2020-06-30 15:18:48.028816 (MainThread): Parsing macros/sql/safe_add.sql
2020-06-30 15:18:48.029882 (MainThread): Parsing macros/sql/nullcheck.sql
2020-06-30 15:18:48.031149 (MainThread): Parsing macros/sql/get_column_values.sql
2020-06-30 15:18:48.035438 (MainThread): Parsing macros/sql/pivot.sql
2020-06-30 15:18:48.038143 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2020-06-30 15:18:48.081182 (MainThread): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 15:18:48.081323 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:18:48.112205 (MainThread): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 15:18:48.112305 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:18:48.123759 (MainThread): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 15:18:48.123851 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:18:48.135384 (MainThread): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 15:18:48.135474 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:18:48.147893 (MainThread): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 15:18:48.148151 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:18:48.161386 (MainThread): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 15:18:48.161473 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:18:48.174653 (MainThread): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 15:18:48.174746 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:18:48.186620 (MainThread): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 15:18:48.186713 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:18:48.198685 (MainThread): Acquiring new snowflake connection "model.sample_project.sales_report_one".
2020-06-30 15:18:48.198775 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:18:48.209883 (MainThread): Acquiring new snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 15:18:48.209973 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:18:48.226526 (MainThread): Acquiring new snowflake connection "model.sample_project.sales_report_two".
2020-06-30 15:18:48.226748 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:18:48.566831 (MainThread): Found 11 models, 1 test, 0 snapshots, 0 analyses, 263 macros, 0 operations, 0 seed files, 4 sources
2020-06-30 15:18:48.568553 (MainThread): 
2020-06-30 15:18:48.568973 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 15:18:48.569182 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:18:48.584633 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 15:18:48.584741 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-06-30 15:18:48.597612 (ThreadPoolExecutor-1_0): Using snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 15:18:48.597711 (ThreadPoolExecutor-1_0): On list_JAVEN_TESTING_TEST: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING_TEST"} */

    show terse objects in JAVEN_TESTING.TEST
2020-06-30 15:18:49.031284 (ThreadPoolExecutor-1_0): unclosed file <_io.BufferedReader name='/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/certifi/cacert.pem'>
2020-06-30 15:18:55.571401 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 10 in 6.97 seconds
2020-06-30 15:18:55.586186 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 15:18:55.586299 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:18:55.586536 (MainThread): 10:18:55 | Concurrency: 1 threads (target='dev')
2020-06-30 15:18:55.586668 (MainThread): 10:18:55 | 
2020-06-30 15:18:55.587539 (Thread-1): Began running node model.sample_project.customer
2020-06-30 15:18:55.587834 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 15:18:55.587939 (Thread-1): Re-using an available connection from the pool (formerly list_JAVEN_TESTING_TEST).
2020-06-30 15:18:55.588048 (Thread-1): Compiling model.sample_project.customer
2020-06-30 15:18:55.605290 (Thread-1): Writing injected SQL for node "model.sample_project.customer"
2020-06-30 15:18:55.605661 (Thread-1): finished collecting timing info
2020-06-30 15:18:55.606064 (Thread-1): Finished running node model.sample_project.customer
2020-06-30 15:18:55.606206 (Thread-1): Began running node model.sample_project.lineitem
2020-06-30 15:18:55.606546 (Thread-1): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 15:18:55.606657 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer).
2020-06-30 15:18:55.606756 (Thread-1): Compiling model.sample_project.lineitem
2020-06-30 15:18:55.614281 (Thread-1): Writing injected SQL for node "model.sample_project.lineitem"
2020-06-30 15:18:55.614624 (Thread-1): finished collecting timing info
2020-06-30 15:18:55.615014 (Thread-1): Finished running node model.sample_project.lineitem
2020-06-30 15:18:55.615152 (Thread-1): Began running node model.sample_project.nation
2020-06-30 15:18:55.615398 (Thread-1): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 15:18:55.615567 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.lineitem).
2020-06-30 15:18:55.615688 (Thread-1): Compiling model.sample_project.nation
2020-06-30 15:18:55.623128 (Thread-1): Writing injected SQL for node "model.sample_project.nation"
2020-06-30 15:18:55.623419 (Thread-1): finished collecting timing info
2020-06-30 15:18:55.623829 (Thread-1): Finished running node model.sample_project.nation
2020-06-30 15:18:55.623950 (Thread-1): Began running node model.sample_project.orders
2020-06-30 15:18:55.624301 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 15:18:55.624402 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.nation).
2020-06-30 15:18:55.624484 (Thread-1): Compiling model.sample_project.orders
2020-06-30 15:18:55.632246 (Thread-1): Writing injected SQL for node "model.sample_project.orders"
2020-06-30 15:18:55.632514 (Thread-1): finished collecting timing info
2020-06-30 15:18:55.632835 (Thread-1): Finished running node model.sample_project.orders
2020-06-30 15:18:55.632950 (Thread-1): Began running node test.sample_project.source_is_nonnegative_tpch_customer_c_custkey
2020-06-30 15:18:55.633065 (Thread-1): 10:18:55 | 1 of 1 START test source_is_nonnegative_tpch_customer_c_custkey...... [RUN]
2020-06-30 15:18:55.633268 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_nonnegative_tpch_customer_c_custkey".
2020-06-30 15:18:55.633346 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders).
2020-06-30 15:18:55.633422 (Thread-1): Compiling test.sample_project.source_is_nonnegative_tpch_customer_c_custkey
2020-06-30 15:18:55.646229 (Thread-1): finished collecting timing info
2020-06-30 15:18:55.646545 (Thread-1): Compilation Error in test source_is_nonnegative_tpch_customer_c_custkey (models/source_reads/sources.yml)
  'test_is_nonnegative' is undefined
Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 449, in catch_jinja
    yield
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 481, in render_template
    return template.render(ctx)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 1, in top-level template code
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
jinja2.exceptions.UndefinedError: 'test_is_nonnegative' is undefined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 165, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 340, in compile
    return compile_node(self.adapter, self.config, self.node, manifest, {})
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/compilation.py", line 255, in compile_node
    node = compiler.compile_node(node, manifest, extra_context)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/compilation.py", line 179, in compile_node
    node)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 530, in get_rendered
    return render_template(template, ctx, node)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 481, in render_template
    return template.render(ctx)
  File "/usr/local/opt/python/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 454, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in test source_is_nonnegative_tpch_customer_c_custkey (models/source_reads/sources.yml)
  'test_is_nonnegative' is undefined
2020-06-30 15:18:55.648023 (Thread-1): 10:18:55 | 1 of 1 ERROR source_is_nonnegative_tpch_customer_c_custkey........... [ERROR in 0.01s]
2020-06-30 15:18:55.648130 (Thread-1): Finished running node test.sample_project.source_is_nonnegative_tpch_customer_c_custkey
2020-06-30 15:18:55.648240 (Thread-1): Began running node model.sample_project.customer_nation
2020-06-30 15:18:55.648526 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 15:18:55.648616 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_nonnegative_tpch_customer_c_custkey).
2020-06-30 15:18:55.648697 (Thread-1): Compiling model.sample_project.customer_nation
2020-06-30 15:18:55.660739 (Thread-1): Writing injected SQL for node "model.sample_project.customer_nation"
2020-06-30 15:18:55.661263 (Thread-1): finished collecting timing info
2020-06-30 15:18:55.661611 (Thread-1): Finished running node model.sample_project.customer_nation
2020-06-30 15:18:55.661871 (Thread-1): Began running node model.sample_project.orders_lineitem
2020-06-30 15:18:55.662334 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 15:18:55.662428 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer_nation).
2020-06-30 15:18:55.662509 (Thread-1): Compiling model.sample_project.orders_lineitem
2020-06-30 15:18:55.674972 (Thread-1): Writing injected SQL for node "model.sample_project.orders_lineitem"
2020-06-30 15:18:55.675406 (Thread-1): finished collecting timing info
2020-06-30 15:18:55.675814 (Thread-1): Finished running node model.sample_project.orders_lineitem
2020-06-30 15:18:55.676075 (Thread-1): Began running node model.sample_project.cust_list_ord_nat
2020-06-30 15:18:55.676437 (Thread-1): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 15:18:55.676522 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders_lineitem).
2020-06-30 15:18:55.676600 (Thread-1): Compiling model.sample_project.cust_list_ord_nat
2020-06-30 15:18:55.693539 (Thread-1): Writing injected SQL for node "model.sample_project.cust_list_ord_nat"
2020-06-30 15:18:55.693963 (Thread-1): finished collecting timing info
2020-06-30 15:18:55.694417 (Thread-1): Finished running node model.sample_project.cust_list_ord_nat
2020-06-30 15:18:55.794785 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 15:18:55.795159 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:18:55.795594 (MainThread): 10:18:55 | 
2020-06-30 15:18:55.795823 (MainThread): 10:18:55 | Finished running 1 test in 7.23s.
2020-06-30 15:18:55.796015 (MainThread): Connection 'master' was properly closed.
2020-06-30 15:18:55.796162 (MainThread): Connection 'model.sample_project.cust_list_ord_nat' was left open.
2020-06-30 15:18:55.796311 (MainThread): On model.sample_project.cust_list_ord_nat: Close
2020-06-30 15:18:56.091170 (MainThread): 
2020-06-30 15:18:56.091361 (MainThread): Completed with 1 error and 0 warnings:
2020-06-30 15:18:56.091499 (MainThread): 
2020-06-30 15:18:56.091631 (MainThread): Compilation Error in test source_is_nonnegative_tpch_customer_c_custkey (models/source_reads/sources.yml)
2020-06-30 15:18:56.091753 (MainThread):   'test_is_nonnegative' is undefined
2020-06-30 15:18:56.091872 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2020-06-30 15:18:56.092058 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128ac8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111faffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114d26810>]}
2020-06-30 15:18:56.092271 (MainThread): Flushing usage events
2020-06-30 15:19:44.645624 (MainThread): Running with dbt=0.17.0
2020-06-30 15:19:45.060153 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2020-06-30 15:19:45.061156 (MainThread): Tracking: tracking
2020-06-30 15:19:45.061442 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca48850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca48390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca48a90>]}
2020-06-30 15:19:45.083950 (MainThread): Partial parsing not enabled
2020-06-30 15:19:45.085955 (MainThread): Parsing macros/core.sql
2020-06-30 15:19:45.091335 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-30 15:19:45.100024 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-30 15:19:45.102003 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-30 15:19:45.121283 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-30 15:19:45.155166 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-30 15:19:45.178347 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-30 15:19:45.180687 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-30 15:19:45.187837 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-30 15:19:45.205685 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-30 15:19:45.214115 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-30 15:19:45.221499 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-30 15:19:45.228020 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-30 15:19:45.229328 (MainThread): Parsing macros/etc/query.sql
2020-06-30 15:19:45.230629 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-30 15:19:45.232884 (MainThread): Parsing macros/etc/datetime.sql
2020-06-30 15:19:45.243131 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-30 15:19:45.245380 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-30 15:19:45.247285 (MainThread): Parsing macros/adapters/common.sql
2020-06-30 15:19:45.300505 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-30 15:19:45.301861 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-30 15:19:45.302934 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-30 15:19:45.304651 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-30 15:19:45.307208 (MainThread): Parsing macros/catalog.sql
2020-06-30 15:19:45.309232 (MainThread): Parsing macros/adapters.sql
2020-06-30 15:19:45.334329 (MainThread): Parsing macros/materializations/merge.sql
2020-06-30 15:19:45.336624 (MainThread): Parsing macros/materializations/view.sql
2020-06-30 15:19:45.338104 (MainThread): Parsing macros/materializations/table.sql
2020-06-30 15:19:45.342617 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-30 15:19:45.384606 (MainThread): Partial parsing not enabled
2020-06-30 15:19:45.387544 (MainThread): Parsing macros/cross_db_utils/except.sql
2020-06-30 15:19:45.389224 (MainThread): Parsing macros/cross_db_utils/replace.sql
2020-06-30 15:19:45.391286 (MainThread): Parsing macros/cross_db_utils/concat.sql
2020-06-30 15:19:45.394581 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2020-06-30 15:19:45.401503 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2020-06-30 15:19:45.402917 (MainThread): Parsing macros/cross_db_utils/length.sql
2020-06-30 15:19:45.404842 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2020-06-30 15:19:45.407866 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2020-06-30 15:19:45.409065 (MainThread): Parsing macros/cross_db_utils/right.sql
2020-06-30 15:19:45.412228 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2020-06-30 15:19:45.423454 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2020-06-30 15:19:45.425588 (MainThread): Parsing macros/cross_db_utils/hash.sql
2020-06-30 15:19:45.427288 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2020-06-30 15:19:45.428853 (MainThread): Parsing macros/cross_db_utils/position.sql
2020-06-30 15:19:45.430748 (MainThread): Parsing macros/cross_db_utils/literal.sql
2020-06-30 15:19:45.431858 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2020-06-30 15:19:45.435151 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2020-06-30 15:19:45.440963 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2020-06-30 15:19:45.444433 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2020-06-30 15:19:45.446936 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2020-06-30 15:19:45.448859 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2020-06-30 15:19:45.475226 (MainThread): Parsing macros/logger/pretty_log_format.sql
2020-06-30 15:19:45.476298 (MainThread): Parsing macros/logger/pretty_time.sql
2020-06-30 15:19:45.477454 (MainThread): Parsing macros/logger/log_info.sql
2020-06-30 15:19:45.478474 (MainThread): Parsing macros/datetime/date_spine.sql
2020-06-30 15:19:45.482582 (MainThread): Parsing macros/web/get_url_host.sql
2020-06-30 15:19:45.484141 (MainThread): Parsing macros/web/get_url_path.sql
2020-06-30 15:19:45.486582 (MainThread): Parsing macros/web/get_url_parameter.sql
2020-06-30 15:19:45.487869 (MainThread): Parsing macros/geo/haversine_distance.sql
2020-06-30 15:19:45.489038 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2020-06-30 15:19:45.490468 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2020-06-30 15:19:45.492899 (MainThread): Parsing macros/schema_tests/recency.sql
2020-06-30 15:19:45.495668 (MainThread): Parsing macros/schema_tests/not_constant.sql
2020-06-30 15:19:45.498003 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2020-06-30 15:19:45.499947 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2020-06-30 15:19:45.501496 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2020-06-30 15:19:45.503888 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2020-06-30 15:19:45.505277 (MainThread): Parsing macros/schema_tests/equality.sql
2020-06-30 15:19:45.509199 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2020-06-30 15:19:45.515666 (MainThread): Parsing macros/sql/nullcheck_table.sql
2020-06-30 15:19:45.517090 (MainThread): Parsing macros/sql/generate_series.sql
2020-06-30 15:19:45.521407 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2020-06-30 15:19:45.528985 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2020-06-30 15:19:45.534004 (MainThread): Parsing macros/sql/star.sql
2020-06-30 15:19:45.537943 (MainThread): Parsing macros/sql/unpivot.sql
2020-06-30 15:19:45.544946 (MainThread): Parsing macros/sql/union.sql
2020-06-30 15:19:45.556369 (MainThread): Parsing macros/sql/groupby.sql
2020-06-30 15:19:45.557549 (MainThread): Parsing macros/sql/surrogate_key.sql
2020-06-30 15:19:45.560552 (MainThread): Parsing macros/sql/safe_add.sql
2020-06-30 15:19:45.562083 (MainThread): Parsing macros/sql/nullcheck.sql
2020-06-30 15:19:45.563845 (MainThread): Parsing macros/sql/get_column_values.sql
2020-06-30 15:19:45.569730 (MainThread): Parsing macros/sql/pivot.sql
2020-06-30 15:19:45.572877 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2020-06-30 15:19:45.618050 (MainThread): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 15:19:45.618174 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:19:45.649067 (MainThread): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 15:19:45.649188 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:19:45.661571 (MainThread): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 15:19:45.661667 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:19:45.673879 (MainThread): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 15:19:45.673978 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:19:45.686601 (MainThread): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 15:19:45.686731 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:19:45.700732 (MainThread): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 15:19:45.700827 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:19:45.713688 (MainThread): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 15:19:45.713781 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:19:45.727603 (MainThread): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 15:19:45.727697 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:19:45.743816 (MainThread): Acquiring new snowflake connection "model.sample_project.sales_report_one".
2020-06-30 15:19:45.743925 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:19:45.756526 (MainThread): Acquiring new snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 15:19:45.756620 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:19:45.771939 (MainThread): Acquiring new snowflake connection "model.sample_project.sales_report_two".
2020-06-30 15:19:45.772035 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:19:46.133488 (MainThread): Found 11 models, 1 test, 0 snapshots, 0 analyses, 263 macros, 0 operations, 0 seed files, 4 sources
2020-06-30 15:19:46.134988 (MainThread): 
2020-06-30 15:19:46.135275 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 15:19:46.135360 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:19:46.152670 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 15:19:46.152852 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-06-30 15:19:46.168046 (ThreadPoolExecutor-1_0): Using snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 15:19:46.168145 (ThreadPoolExecutor-1_0): On list_JAVEN_TESTING_TEST: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING_TEST"} */

    show terse objects in JAVEN_TESTING.TEST
2020-06-30 15:19:46.662419 (ThreadPoolExecutor-1_0): unclosed file <_io.BufferedReader name='/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/certifi/cacert.pem'>
2020-06-30 15:19:52.369659 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 10 in 6.20 seconds
2020-06-30 15:19:52.382177 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 15:19:52.382278 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:19:52.382477 (MainThread): 10:19:52 | Concurrency: 1 threads (target='dev')
2020-06-30 15:19:52.382590 (MainThread): 10:19:52 | 
2020-06-30 15:19:52.383301 (Thread-1): Began running node model.sample_project.customer
2020-06-30 15:19:52.383556 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 15:19:52.383645 (Thread-1): Re-using an available connection from the pool (formerly list_JAVEN_TESTING_TEST).
2020-06-30 15:19:52.383733 (Thread-1): Compiling model.sample_project.customer
2020-06-30 15:19:52.399437 (Thread-1): Writing injected SQL for node "model.sample_project.customer"
2020-06-30 15:19:52.399739 (Thread-1): finished collecting timing info
2020-06-30 15:19:52.400077 (Thread-1): Finished running node model.sample_project.customer
2020-06-30 15:19:52.400193 (Thread-1): Began running node model.sample_project.lineitem
2020-06-30 15:19:52.400468 (Thread-1): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 15:19:52.400561 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer).
2020-06-30 15:19:52.400641 (Thread-1): Compiling model.sample_project.lineitem
2020-06-30 15:19:52.408124 (Thread-1): Writing injected SQL for node "model.sample_project.lineitem"
2020-06-30 15:19:52.408869 (Thread-1): finished collecting timing info
2020-06-30 15:19:52.409253 (Thread-1): Finished running node model.sample_project.lineitem
2020-06-30 15:19:52.409373 (Thread-1): Began running node model.sample_project.nation
2020-06-30 15:19:52.410003 (Thread-1): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 15:19:52.410106 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.lineitem).
2020-06-30 15:19:52.410186 (Thread-1): Compiling model.sample_project.nation
2020-06-30 15:19:52.417441 (Thread-1): Writing injected SQL for node "model.sample_project.nation"
2020-06-30 15:19:52.417739 (Thread-1): finished collecting timing info
2020-06-30 15:19:52.418078 (Thread-1): Finished running node model.sample_project.nation
2020-06-30 15:19:52.418195 (Thread-1): Began running node model.sample_project.orders
2020-06-30 15:19:52.418540 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 15:19:52.418639 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.nation).
2020-06-30 15:19:52.418719 (Thread-1): Compiling model.sample_project.orders
2020-06-30 15:19:52.425363 (Thread-1): Writing injected SQL for node "model.sample_project.orders"
2020-06-30 15:19:52.425720 (Thread-1): finished collecting timing info
2020-06-30 15:19:52.426090 (Thread-1): Finished running node model.sample_project.orders
2020-06-30 15:19:52.426207 (Thread-1): Began running node test.sample_project.source_is_nonnegative_tpch_customer_c_custkey
2020-06-30 15:19:52.426391 (Thread-1): 10:19:52 | 1 of 1 START test source_is_nonnegative_tpch_customer_c_custkey...... [RUN]
2020-06-30 15:19:52.426692 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_nonnegative_tpch_customer_c_custkey".
2020-06-30 15:19:52.426774 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders).
2020-06-30 15:19:52.426852 (Thread-1): Compiling test.sample_project.source_is_nonnegative_tpch_customer_c_custkey
2020-06-30 15:19:52.440537 (Thread-1): finished collecting timing info
2020-06-30 15:19:52.440873 (Thread-1): Compilation Error in test source_is_nonnegative_tpch_customer_c_custkey (models/source_reads/sources.yml)
  'test_is_nonnegative' is undefined
Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 449, in catch_jinja
    yield
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 481, in render_template
    return template.render(ctx)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 1, in top-level template code
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
jinja2.exceptions.UndefinedError: 'test_is_nonnegative' is undefined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 165, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 340, in compile
    return compile_node(self.adapter, self.config, self.node, manifest, {})
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/compilation.py", line 255, in compile_node
    node = compiler.compile_node(node, manifest, extra_context)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/compilation.py", line 179, in compile_node
    node)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 530, in get_rendered
    return render_template(template, ctx, node)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 481, in render_template
    return template.render(ctx)
  File "/usr/local/opt/python/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 454, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in test source_is_nonnegative_tpch_customer_c_custkey (models/source_reads/sources.yml)
  'test_is_nonnegative' is undefined
2020-06-30 15:19:52.445037 (Thread-1): 10:19:52 | 1 of 1 ERROR source_is_nonnegative_tpch_customer_c_custkey........... [ERROR in 0.02s]
2020-06-30 15:19:52.445150 (Thread-1): Finished running node test.sample_project.source_is_nonnegative_tpch_customer_c_custkey
2020-06-30 15:19:52.445264 (Thread-1): Began running node model.sample_project.customer_nation
2020-06-30 15:19:52.445573 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 15:19:52.445664 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_nonnegative_tpch_customer_c_custkey).
2020-06-30 15:19:52.445786 (Thread-1): Compiling model.sample_project.customer_nation
2020-06-30 15:19:52.456512 (Thread-1): Writing injected SQL for node "model.sample_project.customer_nation"
2020-06-30 15:19:52.456816 (Thread-1): finished collecting timing info
2020-06-30 15:19:52.457448 (Thread-1): Finished running node model.sample_project.customer_nation
2020-06-30 15:19:52.457636 (Thread-1): Began running node model.sample_project.orders_lineitem
2020-06-30 15:19:52.458162 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 15:19:52.458330 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer_nation).
2020-06-30 15:19:52.458469 (Thread-1): Compiling model.sample_project.orders_lineitem
2020-06-30 15:19:52.469746 (Thread-1): Writing injected SQL for node "model.sample_project.orders_lineitem"
2020-06-30 15:19:52.470035 (Thread-1): finished collecting timing info
2020-06-30 15:19:52.470368 (Thread-1): Finished running node model.sample_project.orders_lineitem
2020-06-30 15:19:52.470678 (Thread-1): Began running node model.sample_project.cust_list_ord_nat
2020-06-30 15:19:52.470910 (Thread-1): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 15:19:52.470993 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders_lineitem).
2020-06-30 15:19:52.471069 (Thread-1): Compiling model.sample_project.cust_list_ord_nat
2020-06-30 15:19:52.484988 (Thread-1): Writing injected SQL for node "model.sample_project.cust_list_ord_nat"
2020-06-30 15:19:52.485309 (Thread-1): finished collecting timing info
2020-06-30 15:19:52.485652 (Thread-1): Finished running node model.sample_project.cust_list_ord_nat
2020-06-30 15:19:52.487431 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 15:19:52.487550 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:19:52.487757 (MainThread): 10:19:52 | 
2020-06-30 15:19:52.487866 (MainThread): 10:19:52 | Finished running 1 test in 6.35s.
2020-06-30 15:19:52.487957 (MainThread): Connection 'master' was properly closed.
2020-06-30 15:19:52.488026 (MainThread): Connection 'model.sample_project.cust_list_ord_nat' was left open.
2020-06-30 15:19:52.488094 (MainThread): On model.sample_project.cust_list_ord_nat: Close
2020-06-30 15:19:52.920696 (MainThread): 
2020-06-30 15:19:52.920865 (MainThread): Completed with 1 error and 0 warnings:
2020-06-30 15:19:52.920981 (MainThread): 
2020-06-30 15:19:52.921089 (MainThread): Compilation Error in test source_is_nonnegative_tpch_customer_c_custkey (models/source_reads/sources.yml)
2020-06-30 15:19:52.921188 (MainThread):   'test_is_nonnegative' is undefined
2020-06-30 15:19:52.921286 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2020-06-30 15:19:52.921480 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa72cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ceb01d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1bfdd0>]}
2020-06-30 15:19:52.921660 (MainThread): Flushing usage events
2020-06-30 15:21:20.290019 (MainThread): Running with dbt=0.17.0
2020-06-30 15:21:20.595168 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.clean.CleanTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='clean', write_json=True)
2020-06-30 15:21:20.595858 (MainThread): Tracking: tracking
2020-06-30 15:21:20.596181 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c09f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c09710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c09d10>]}
2020-06-30 15:21:20.596511 (MainThread): Checking target/*
2020-06-30 15:21:20.604831 (MainThread):  Cleaned target/*
2020-06-30 15:21:20.604968 (MainThread): Checking dbt_modules/*
2020-06-30 15:21:20.629027 (MainThread):  Cleaned dbt_modules/*
2020-06-30 15:21:20.629325 (MainThread): Finished cleaning all paths.
2020-06-30 15:21:20.629551 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c09d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c09f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc27310>]}
2020-06-30 15:21:20.629969 (MainThread): Flushing usage events
2020-06-30 15:21:25.483398 (MainThread): Running with dbt=0.17.0
2020-06-30 15:21:25.797280 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='deps', single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='deps', write_json=True)
2020-06-30 15:21:25.797592 (MainThread): Tracking: tracking
2020-06-30 15:21:25.797722 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a553a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a54f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a54f210>]}
2020-06-30 15:21:25.798876 (MainThread): Set downloads directory='/var/folders/5x/fg3q44_x4y373r2024plj4fc0000gp/T/dbt-downloads-2x712m5e'
2020-06-30 15:21:25.799506 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/index.json
2020-06-30 15:21:26.219594 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/index.json 200
2020-06-30 15:21:26.219923 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils.json
2020-06-30 15:21:27.649032 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils.json 200
2020-06-30 15:21:27.660534 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils/0.4.0.json
2020-06-30 15:21:27.926607 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils/0.4.0.json 200
2020-06-30 15:21:27.932560 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils.json
2020-06-30 15:21:28.237025 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils.json 200
2020-06-30 15:21:28.250029 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils/0.4.0.json
2020-06-30 15:21:28.511627 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils/0.4.0.json 200
2020-06-30 15:21:28.512843 (MainThread): Installing fishtown-analytics/dbt_utils@0.4.0
2020-06-30 15:21:28.979908 (MainThread):   Installed from version 0.4.0

2020-06-30 15:21:28.980136 (MainThread): Sending event: {'category': 'dbt', 'action': 'package', 'label': '20eca2c7-6ec3-4528-b5bf-a735a7d5dae5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1357d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1355d0>]}
2020-06-30 15:21:28.981204 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c267b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1058d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a54f9d0>]}
2020-06-30 15:21:28.981461 (MainThread): Flushing usage events
2020-06-30 15:21:35.479623 (MainThread): Running with dbt=0.17.0
2020-06-30 15:21:35.818663 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2020-06-30 15:21:35.819626 (MainThread): Tracking: tracking
2020-06-30 15:21:35.819871 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d23f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d23b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d23c90>]}
2020-06-30 15:21:35.841169 (MainThread): Partial parsing not enabled
2020-06-30 15:21:35.843757 (MainThread): Parsing macros/core.sql
2020-06-30 15:21:35.849136 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-30 15:21:35.858260 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-30 15:21:35.861092 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-30 15:21:35.881554 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-30 15:21:35.913509 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-30 15:21:35.938115 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-30 15:21:35.940345 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-30 15:21:35.947713 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-30 15:21:35.964422 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-30 15:21:35.972208 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-30 15:21:35.979730 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-30 15:21:35.985468 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-30 15:21:35.986585 (MainThread): Parsing macros/etc/query.sql
2020-06-30 15:21:35.987854 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-30 15:21:35.989812 (MainThread): Parsing macros/etc/datetime.sql
2020-06-30 15:21:35.999997 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-30 15:21:36.002357 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-30 15:21:36.004455 (MainThread): Parsing macros/adapters/common.sql
2020-06-30 15:21:36.058922 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-30 15:21:36.060273 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-30 15:21:36.061418 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-30 15:21:36.062890 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-30 15:21:36.066453 (MainThread): Parsing macros/catalog.sql
2020-06-30 15:21:36.068888 (MainThread): Parsing macros/adapters.sql
2020-06-30 15:21:36.094798 (MainThread): Parsing macros/materializations/merge.sql
2020-06-30 15:21:36.097042 (MainThread): Parsing macros/materializations/view.sql
2020-06-30 15:21:36.098434 (MainThread): Parsing macros/materializations/table.sql
2020-06-30 15:21:36.102863 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-30 15:21:36.145193 (MainThread): Partial parsing not enabled
2020-06-30 15:21:36.147261 (MainThread): Parsing macros/cross_db_utils/except.sql
2020-06-30 15:21:36.148677 (MainThread): Parsing macros/cross_db_utils/replace.sql
2020-06-30 15:21:36.150515 (MainThread): Parsing macros/cross_db_utils/concat.sql
2020-06-30 15:21:36.153029 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2020-06-30 15:21:36.160056 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2020-06-30 15:21:36.161536 (MainThread): Parsing macros/cross_db_utils/length.sql
2020-06-30 15:21:36.163494 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2020-06-30 15:21:36.166475 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2020-06-30 15:21:36.167553 (MainThread): Parsing macros/cross_db_utils/right.sql
2020-06-30 15:21:36.170107 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2020-06-30 15:21:36.180591 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2020-06-30 15:21:36.182560 (MainThread): Parsing macros/cross_db_utils/hash.sql
2020-06-30 15:21:36.184027 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2020-06-30 15:21:36.185690 (MainThread): Parsing macros/cross_db_utils/position.sql
2020-06-30 15:21:36.187301 (MainThread): Parsing macros/cross_db_utils/literal.sql
2020-06-30 15:21:36.188248 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2020-06-30 15:21:36.191554 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2020-06-30 15:21:36.197456 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2020-06-30 15:21:36.200354 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2020-06-30 15:21:36.202487 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2020-06-30 15:21:36.204190 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2020-06-30 15:21:36.231295 (MainThread): Parsing macros/logger/pretty_log_format.sql
2020-06-30 15:21:36.232284 (MainThread): Parsing macros/logger/pretty_time.sql
2020-06-30 15:21:36.233103 (MainThread): Parsing macros/logger/log_info.sql
2020-06-30 15:21:36.233904 (MainThread): Parsing macros/datetime/date_spine.sql
2020-06-30 15:21:36.237534 (MainThread): Parsing macros/web/get_url_host.sql
2020-06-30 15:21:36.238963 (MainThread): Parsing macros/web/get_url_path.sql
2020-06-30 15:21:36.241352 (MainThread): Parsing macros/web/get_url_parameter.sql
2020-06-30 15:21:36.243249 (MainThread): Parsing macros/geo/haversine_distance.sql
2020-06-30 15:21:36.244243 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2020-06-30 15:21:36.245574 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2020-06-30 15:21:36.247765 (MainThread): Parsing macros/schema_tests/recency.sql
2020-06-30 15:21:36.249217 (MainThread): Parsing macros/schema_tests/not_constant.sql
2020-06-30 15:21:36.251133 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2020-06-30 15:21:36.252194 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2020-06-30 15:21:36.253408 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2020-06-30 15:21:36.255252 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2020-06-30 15:21:36.256440 (MainThread): Parsing macros/schema_tests/equality.sql
2020-06-30 15:21:36.260086 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2020-06-30 15:21:36.266485 (MainThread): Parsing macros/sql/nullcheck_table.sql
2020-06-30 15:21:36.267712 (MainThread): Parsing macros/sql/generate_series.sql
2020-06-30 15:21:36.271629 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2020-06-30 15:21:36.275634 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2020-06-30 15:21:36.278575 (MainThread): Parsing macros/sql/star.sql
2020-06-30 15:21:36.282140 (MainThread): Parsing macros/sql/unpivot.sql
2020-06-30 15:21:36.289846 (MainThread): Parsing macros/sql/union.sql
2020-06-30 15:21:36.300372 (MainThread): Parsing macros/sql/groupby.sql
2020-06-30 15:21:36.301476 (MainThread): Parsing macros/sql/surrogate_key.sql
2020-06-30 15:21:36.304377 (MainThread): Parsing macros/sql/safe_add.sql
2020-06-30 15:21:36.305508 (MainThread): Parsing macros/sql/nullcheck.sql
2020-06-30 15:21:36.306976 (MainThread): Parsing macros/sql/get_column_values.sql
2020-06-30 15:21:36.315073 (MainThread): Parsing macros/sql/pivot.sql
2020-06-30 15:21:36.319955 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2020-06-30 15:21:36.375348 (MainThread): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 15:21:36.375532 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:21:36.411289 (MainThread): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 15:21:36.420093 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:21:36.434806 (MainThread): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 15:21:36.434927 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:21:36.446890 (MainThread): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 15:21:36.447000 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:21:36.460940 (MainThread): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 15:21:36.461145 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:21:36.478471 (MainThread): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 15:21:36.478606 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:21:36.492916 (MainThread): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 15:21:36.493055 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:21:36.510235 (MainThread): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 15:21:36.510479 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:21:36.528776 (MainThread): Acquiring new snowflake connection "model.sample_project.sales_report_one".
2020-06-30 15:21:36.529094 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:21:36.542724 (MainThread): Acquiring new snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 15:21:36.542860 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:21:36.562816 (MainThread): Acquiring new snowflake connection "model.sample_project.sales_report_two".
2020-06-30 15:21:36.563056 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:21:36.974661 (MainThread): Found 11 models, 1 test, 0 snapshots, 0 analyses, 263 macros, 0 operations, 0 seed files, 4 sources
2020-06-30 15:21:36.976654 (MainThread): 
2020-06-30 15:21:36.977128 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 15:21:36.977271 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:21:36.995772 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 15:21:36.995966 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-06-30 15:21:37.012294 (ThreadPoolExecutor-1_0): Using snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 15:21:37.012468 (ThreadPoolExecutor-1_0): On list_JAVEN_TESTING_TEST: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING_TEST"} */

    show terse objects in JAVEN_TESTING.TEST
2020-06-30 15:21:37.526658 (ThreadPoolExecutor-1_0): unclosed file <_io.BufferedReader name='/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/certifi/cacert.pem'>
2020-06-30 15:21:42.885270 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 10 in 5.87 seconds
2020-06-30 15:21:42.899866 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 15:21:42.900000 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:21:42.900241 (MainThread): 10:21:42 | Concurrency: 1 threads (target='dev')
2020-06-30 15:21:42.900383 (MainThread): 10:21:42 | 
2020-06-30 15:21:42.901235 (Thread-1): Began running node model.sample_project.customer
2020-06-30 15:21:42.901533 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 15:21:42.901659 (Thread-1): Re-using an available connection from the pool (formerly list_JAVEN_TESTING_TEST).
2020-06-30 15:21:42.901787 (Thread-1): Compiling model.sample_project.customer
2020-06-30 15:21:42.920832 (Thread-1): Writing injected SQL for node "model.sample_project.customer"
2020-06-30 15:21:42.922013 (Thread-1): finished collecting timing info
2020-06-30 15:21:42.922755 (Thread-1): Finished running node model.sample_project.customer
2020-06-30 15:21:42.922971 (Thread-1): Began running node model.sample_project.lineitem
2020-06-30 15:21:42.923258 (Thread-1): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 15:21:42.923462 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer).
2020-06-30 15:21:42.923541 (Thread-1): Compiling model.sample_project.lineitem
2020-06-30 15:21:42.932509 (Thread-1): Writing injected SQL for node "model.sample_project.lineitem"
2020-06-30 15:21:42.932836 (Thread-1): finished collecting timing info
2020-06-30 15:21:42.933193 (Thread-1): Finished running node model.sample_project.lineitem
2020-06-30 15:21:42.933313 (Thread-1): Began running node model.sample_project.nation
2020-06-30 15:21:42.933832 (Thread-1): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 15:21:42.933920 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.lineitem).
2020-06-30 15:21:42.934000 (Thread-1): Compiling model.sample_project.nation
2020-06-30 15:21:42.941530 (Thread-1): Writing injected SQL for node "model.sample_project.nation"
2020-06-30 15:21:42.941826 (Thread-1): finished collecting timing info
2020-06-30 15:21:42.942160 (Thread-1): Finished running node model.sample_project.nation
2020-06-30 15:21:42.942279 (Thread-1): Began running node model.sample_project.orders
2020-06-30 15:21:42.942487 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 15:21:42.942568 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.nation).
2020-06-30 15:21:42.942646 (Thread-1): Compiling model.sample_project.orders
2020-06-30 15:21:42.949651 (Thread-1): Writing injected SQL for node "model.sample_project.orders"
2020-06-30 15:21:42.949941 (Thread-1): finished collecting timing info
2020-06-30 15:21:42.950382 (Thread-1): Finished running node model.sample_project.orders
2020-06-30 15:21:42.950679 (Thread-1): Began running node test.sample_project.source_is_nonnegative_tpch_customer_c_custkey
2020-06-30 15:21:42.951033 (Thread-1): 10:21:42 | 1 of 1 START test source_is_nonnegative_tpch_customer_c_custkey...... [RUN]
2020-06-30 15:21:42.951754 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_nonnegative_tpch_customer_c_custkey".
2020-06-30 15:21:42.951910 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders).
2020-06-30 15:21:42.951993 (Thread-1): Compiling test.sample_project.source_is_nonnegative_tpch_customer_c_custkey
2020-06-30 15:21:42.968076 (Thread-1): finished collecting timing info
2020-06-30 15:21:42.968439 (Thread-1): Compilation Error in test source_is_nonnegative_tpch_customer_c_custkey (models/source_reads/sources.yml)
  'test_is_nonnegative' is undefined
Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 449, in catch_jinja
    yield
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 481, in render_template
    return template.render(ctx)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 1, in top-level template code
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
jinja2.exceptions.UndefinedError: 'test_is_nonnegative' is undefined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 165, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 340, in compile
    return compile_node(self.adapter, self.config, self.node, manifest, {})
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/compilation.py", line 255, in compile_node
    node = compiler.compile_node(node, manifest, extra_context)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/compilation.py", line 179, in compile_node
    node)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 530, in get_rendered
    return render_template(template, ctx, node)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 481, in render_template
    return template.render(ctx)
  File "/usr/local/opt/python/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 454, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in test source_is_nonnegative_tpch_customer_c_custkey (models/source_reads/sources.yml)
  'test_is_nonnegative' is undefined
2020-06-30 15:21:42.974184 (Thread-1): 10:21:42 | 1 of 1 ERROR source_is_nonnegative_tpch_customer_c_custkey........... [ERROR in 0.02s]
2020-06-30 15:21:42.974315 (Thread-1): Finished running node test.sample_project.source_is_nonnegative_tpch_customer_c_custkey
2020-06-30 15:21:42.974443 (Thread-1): Began running node model.sample_project.customer_nation
2020-06-30 15:21:42.974799 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 15:21:42.974888 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_nonnegative_tpch_customer_c_custkey).
2020-06-30 15:21:42.974971 (Thread-1): Compiling model.sample_project.customer_nation
2020-06-30 15:21:42.986070 (Thread-1): Writing injected SQL for node "model.sample_project.customer_nation"
2020-06-30 15:21:42.986545 (Thread-1): finished collecting timing info
2020-06-30 15:21:42.986968 (Thread-1): Finished running node model.sample_project.customer_nation
2020-06-30 15:21:42.987106 (Thread-1): Began running node model.sample_project.orders_lineitem
2020-06-30 15:21:42.987336 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 15:21:42.987427 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer_nation).
2020-06-30 15:21:42.987511 (Thread-1): Compiling model.sample_project.orders_lineitem
2020-06-30 15:21:43.000462 (Thread-1): Writing injected SQL for node "model.sample_project.orders_lineitem"
2020-06-30 15:21:43.000823 (Thread-1): finished collecting timing info
2020-06-30 15:21:43.001209 (Thread-1): Finished running node model.sample_project.orders_lineitem
2020-06-30 15:21:43.001457 (Thread-1): Began running node model.sample_project.cust_list_ord_nat
2020-06-30 15:21:43.001683 (Thread-1): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 15:21:43.001768 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders_lineitem).
2020-06-30 15:21:43.001847 (Thread-1): Compiling model.sample_project.cust_list_ord_nat
2020-06-30 15:21:43.016611 (Thread-1): Writing injected SQL for node "model.sample_project.cust_list_ord_nat"
2020-06-30 15:21:43.016957 (Thread-1): finished collecting timing info
2020-06-30 15:21:43.017377 (Thread-1): Finished running node model.sample_project.cust_list_ord_nat
2020-06-30 15:21:43.116316 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 15:21:43.116512 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:21:43.116870 (MainThread): 10:21:43 | 
2020-06-30 15:21:43.117054 (MainThread): 10:21:43 | Finished running 1 test in 6.14s.
2020-06-30 15:21:43.117208 (MainThread): Connection 'master' was properly closed.
2020-06-30 15:21:43.117325 (MainThread): Connection 'model.sample_project.cust_list_ord_nat' was left open.
2020-06-30 15:21:43.117440 (MainThread): On model.sample_project.cust_list_ord_nat: Close
2020-06-30 15:21:43.545198 (MainThread): 
2020-06-30 15:21:43.545508 (MainThread): Completed with 1 error and 0 warnings:
2020-06-30 15:21:43.545690 (MainThread): 
2020-06-30 15:21:43.545829 (MainThread): Compilation Error in test source_is_nonnegative_tpch_customer_c_custkey (models/source_reads/sources.yml)
2020-06-30 15:21:43.545952 (MainThread):   'test_is_nonnegative' is undefined
2020-06-30 15:21:43.546079 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2020-06-30 15:21:43.546332 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108052390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108295050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108220950>]}
2020-06-30 15:21:43.546597 (MainThread): Flushing usage events
2020-06-30 15:28:09.695423 (MainThread): Running with dbt=0.17.0
2020-06-30 15:28:10.037198 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2020-06-30 15:28:10.037800 (MainThread): Tracking: tracking
2020-06-30 15:28:10.038081 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068a4a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068c2b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068c2a50>]}
2020-06-30 15:28:10.059000 (MainThread): Partial parsing not enabled
2020-06-30 15:28:10.061314 (MainThread): Parsing macros/core.sql
2020-06-30 15:28:10.066842 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-30 15:28:10.075381 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-30 15:28:10.077660 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-30 15:28:10.096621 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-30 15:28:10.129990 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-30 15:28:10.152641 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-30 15:28:10.156197 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-30 15:28:10.164241 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-30 15:28:10.179760 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-30 15:28:10.191743 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-30 15:28:10.201072 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-30 15:28:10.207318 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-30 15:28:10.208671 (MainThread): Parsing macros/etc/query.sql
2020-06-30 15:28:10.210173 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-30 15:28:10.212322 (MainThread): Parsing macros/etc/datetime.sql
2020-06-30 15:28:10.223241 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-30 15:28:10.225613 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-30 15:28:10.227962 (MainThread): Parsing macros/adapters/common.sql
2020-06-30 15:28:10.282842 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-30 15:28:10.284319 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-30 15:28:10.285732 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-30 15:28:10.287235 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-30 15:28:10.290078 (MainThread): Parsing macros/catalog.sql
2020-06-30 15:28:10.292525 (MainThread): Parsing macros/adapters.sql
2020-06-30 15:28:10.317806 (MainThread): Parsing macros/materializations/merge.sql
2020-06-30 15:28:10.320585 (MainThread): Parsing macros/materializations/view.sql
2020-06-30 15:28:10.321912 (MainThread): Parsing macros/materializations/table.sql
2020-06-30 15:28:10.326679 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-30 15:28:10.370859 (MainThread): Partial parsing not enabled
2020-06-30 15:28:10.371263 (MainThread): Parsing macros/test_is_even.sql
2020-06-30 15:28:10.373753 (MainThread): Parsing macros/cross_db_utils/except.sql
2020-06-30 15:28:10.374800 (MainThread): Parsing macros/cross_db_utils/replace.sql
2020-06-30 15:28:10.376196 (MainThread): Parsing macros/cross_db_utils/concat.sql
2020-06-30 15:28:10.378500 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2020-06-30 15:28:10.384664 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2020-06-30 15:28:10.385966 (MainThread): Parsing macros/cross_db_utils/length.sql
2020-06-30 15:28:10.387329 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2020-06-30 15:28:10.389960 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2020-06-30 15:28:10.391028 (MainThread): Parsing macros/cross_db_utils/right.sql
2020-06-30 15:28:10.393419 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2020-06-30 15:28:10.403604 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2020-06-30 15:28:10.405851 (MainThread): Parsing macros/cross_db_utils/hash.sql
2020-06-30 15:28:10.407330 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2020-06-30 15:28:10.408874 (MainThread): Parsing macros/cross_db_utils/position.sql
2020-06-30 15:28:10.410681 (MainThread): Parsing macros/cross_db_utils/literal.sql
2020-06-30 15:28:10.411634 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2020-06-30 15:28:10.415041 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2020-06-30 15:28:10.421190 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2020-06-30 15:28:10.424090 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2020-06-30 15:28:10.426074 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2020-06-30 15:28:10.427655 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2020-06-30 15:28:10.456613 (MainThread): Parsing macros/logger/pretty_log_format.sql
2020-06-30 15:28:10.457336 (MainThread): Parsing macros/logger/pretty_time.sql
2020-06-30 15:28:10.458236 (MainThread): Parsing macros/logger/log_info.sql
2020-06-30 15:28:10.459590 (MainThread): Parsing macros/datetime/date_spine.sql
2020-06-30 15:28:10.464116 (MainThread): Parsing macros/web/get_url_host.sql
2020-06-30 15:28:10.465567 (MainThread): Parsing macros/web/get_url_path.sql
2020-06-30 15:28:10.467840 (MainThread): Parsing macros/web/get_url_parameter.sql
2020-06-30 15:28:10.469007 (MainThread): Parsing macros/geo/haversine_distance.sql
2020-06-30 15:28:10.470086 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2020-06-30 15:28:10.471682 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2020-06-30 15:28:10.473810 (MainThread): Parsing macros/schema_tests/recency.sql
2020-06-30 15:28:10.475152 (MainThread): Parsing macros/schema_tests/not_constant.sql
2020-06-30 15:28:10.476228 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2020-06-30 15:28:10.477257 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2020-06-30 15:28:10.478484 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2020-06-30 15:28:10.480038 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2020-06-30 15:28:10.481176 (MainThread): Parsing macros/schema_tests/equality.sql
2020-06-30 15:28:10.484395 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2020-06-30 15:28:10.490191 (MainThread): Parsing macros/sql/nullcheck_table.sql
2020-06-30 15:28:10.491254 (MainThread): Parsing macros/sql/generate_series.sql
2020-06-30 15:28:10.494838 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2020-06-30 15:28:10.498637 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2020-06-30 15:28:10.501427 (MainThread): Parsing macros/sql/star.sql
2020-06-30 15:28:10.504262 (MainThread): Parsing macros/sql/unpivot.sql
2020-06-30 15:28:10.510730 (MainThread): Parsing macros/sql/union.sql
2020-06-30 15:28:10.520910 (MainThread): Parsing macros/sql/groupby.sql
2020-06-30 15:28:10.521909 (MainThread): Parsing macros/sql/surrogate_key.sql
2020-06-30 15:28:10.524696 (MainThread): Parsing macros/sql/safe_add.sql
2020-06-30 15:28:10.525781 (MainThread): Parsing macros/sql/nullcheck.sql
2020-06-30 15:28:10.527446 (MainThread): Parsing macros/sql/get_column_values.sql
2020-06-30 15:28:10.532605 (MainThread): Parsing macros/sql/pivot.sql
2020-06-30 15:28:10.535334 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2020-06-30 15:28:10.579687 (MainThread): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 15:28:10.579791 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:28:10.610668 (MainThread): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 15:28:10.610760 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:28:10.627483 (MainThread): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 15:28:10.627594 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:28:10.639909 (MainThread): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 15:28:10.640003 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:28:10.652481 (MainThread): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 15:28:10.652659 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:28:10.666306 (MainThread): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 15:28:10.666402 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:28:10.679180 (MainThread): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 15:28:10.679272 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:28:10.692153 (MainThread): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 15:28:10.692280 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:28:10.704510 (MainThread): Acquiring new snowflake connection "model.sample_project.sales_report_one".
2020-06-30 15:28:10.704605 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:28:10.717339 (MainThread): Acquiring new snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 15:28:10.717430 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:28:10.733942 (MainThread): Acquiring new snowflake connection "model.sample_project.sales_report_two".
2020-06-30 15:28:10.734130 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:28:11.105658 (MainThread): Found 11 models, 2 tests, 0 snapshots, 0 analyses, 264 macros, 0 operations, 0 seed files, 4 sources
2020-06-30 15:28:11.107000 (MainThread): 
2020-06-30 15:28:11.107274 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 15:28:11.107363 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:28:11.123227 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 15:28:11.123387 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-06-30 15:28:11.136843 (ThreadPoolExecutor-1_0): Using snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 15:28:11.136958 (ThreadPoolExecutor-1_0): On list_JAVEN_TESTING_TEST: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING_TEST"} */

    show terse objects in JAVEN_TESTING.TEST
2020-06-30 15:28:11.593773 (ThreadPoolExecutor-1_0): unclosed file <_io.BufferedReader name='/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/certifi/cacert.pem'>
2020-06-30 15:28:17.896587 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 10 in 6.76 seconds
2020-06-30 15:28:17.911597 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 15:28:17.911730 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:28:17.911971 (MainThread): 10:28:17 | Concurrency: 1 threads (target='dev')
2020-06-30 15:28:17.912107 (MainThread): 10:28:17 | 
2020-06-30 15:28:17.913585 (Thread-1): Began running node model.sample_project.customer
2020-06-30 15:28:17.913890 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 15:28:17.913993 (Thread-1): Re-using an available connection from the pool (formerly list_JAVEN_TESTING_TEST).
2020-06-30 15:28:17.914094 (Thread-1): Compiling model.sample_project.customer
2020-06-30 15:28:17.930616 (Thread-1): Writing injected SQL for node "model.sample_project.customer"
2020-06-30 15:28:17.930970 (Thread-1): finished collecting timing info
2020-06-30 15:28:17.931362 (Thread-1): Finished running node model.sample_project.customer
2020-06-30 15:28:17.931483 (Thread-1): Began running node model.sample_project.lineitem
2020-06-30 15:28:17.931800 (Thread-1): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 15:28:17.931891 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer).
2020-06-30 15:28:17.931972 (Thread-1): Compiling model.sample_project.lineitem
2020-06-30 15:28:17.938600 (Thread-1): Writing injected SQL for node "model.sample_project.lineitem"
2020-06-30 15:28:17.938881 (Thread-1): finished collecting timing info
2020-06-30 15:28:17.939202 (Thread-1): Finished running node model.sample_project.lineitem
2020-06-30 15:28:17.939319 (Thread-1): Began running node model.sample_project.nation
2020-06-30 15:28:17.939525 (Thread-1): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 15:28:17.939607 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.lineitem).
2020-06-30 15:28:17.939685 (Thread-1): Compiling model.sample_project.nation
2020-06-30 15:28:17.946195 (Thread-1): Writing injected SQL for node "model.sample_project.nation"
2020-06-30 15:28:17.946472 (Thread-1): finished collecting timing info
2020-06-30 15:28:17.946799 (Thread-1): Finished running node model.sample_project.nation
2020-06-30 15:28:17.946918 (Thread-1): Began running node model.sample_project.orders
2020-06-30 15:28:17.947128 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 15:28:17.947212 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.nation).
2020-06-30 15:28:17.947292 (Thread-1): Compiling model.sample_project.orders
2020-06-30 15:28:17.954385 (Thread-1): Writing injected SQL for node "model.sample_project.orders"
2020-06-30 15:28:17.954660 (Thread-1): finished collecting timing info
2020-06-30 15:28:17.954980 (Thread-1): Finished running node model.sample_project.orders
2020-06-30 15:28:17.955099 (Thread-1): Began running node test.sample_project.source_is_even_tpch_customer_c_custkey
2020-06-30 15:28:17.955283 (Thread-1): 10:28:17 | 1 of 2 START test source_is_even_tpch_customer_c_custkey............. [RUN]
2020-06-30 15:28:17.955755 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_even_tpch_customer_c_custkey".
2020-06-30 15:28:17.955990 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders).
2020-06-30 15:28:17.956088 (Thread-1): Compiling test.sample_project.source_is_even_tpch_customer_c_custkey
2020-06-30 15:28:17.971369 (Thread-1): Writing injected SQL for node "test.sample_project.source_is_even_tpch_customer_c_custkey"
2020-06-30 15:28:17.971812 (Thread-1): finished collecting timing info
2020-06-30 15:28:17.972371 (Thread-1): Using snowflake connection "test.sample_project.source_is_even_tpch_customer_c_custkey".
2020-06-30 15:28:17.972458 (Thread-1): On test.sample_project.source_is_even_tpch_customer_c_custkey: BEGIN
2020-06-30 15:28:18.161821 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2020-06-30 15:28:18.162092 (Thread-1): Using snowflake connection "test.sample_project.source_is_even_tpch_customer_c_custkey".
2020-06-30 15:28:18.162235 (Thread-1): On test.sample_project.source_is_even_tpch_customer_c_custkey: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "test.sample_project.source_is_even_tpch_customer_c_custkey"} */


with validation as (

    select
        c_custkey as even_field

    from snowflake_sample_data.tpch_sf1.customer

),

validation_errors as (

    select
        even_field

    from validation
    -- if this is true, then even_field is actually odd!
    where (even_field % 2) = 1

)

select count(*)
from validation_errors
2020-06-30 15:28:19.249562 (Thread-1): SQL status: SUCCESS 1 in 1.09 seconds
2020-06-30 15:28:19.250046 (Thread-1): finished collecting timing info
2020-06-30 15:28:19.250523 (Thread-1): On test.sample_project.source_is_even_tpch_customer_c_custkey: ROLLBACK
2020-06-30 15:28:19.250673 (Thread-1): initiating rollback
2020-06-30 15:28:19.523562 (Thread-1): 10:28:19 | 1 of 2 FAIL 75000 source_is_even_tpch_customer_c_custkey............. [FAIL 75000 in 1.57s]
2020-06-30 15:28:19.523861 (Thread-1): Finished running node test.sample_project.source_is_even_tpch_customer_c_custkey
2020-06-30 15:28:19.524122 (Thread-1): Began running node test.sample_project.source_is_nonnegative_tpch_customer_c_custkey
2020-06-30 15:28:19.524365 (Thread-1): 10:28:19 | 2 of 2 START test source_is_nonnegative_tpch_customer_c_custkey...... [RUN]
2020-06-30 15:28:19.524982 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_nonnegative_tpch_customer_c_custkey".
2020-06-30 15:28:19.525140 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_even_tpch_customer_c_custkey).
2020-06-30 15:28:19.525282 (Thread-1): Compiling test.sample_project.source_is_nonnegative_tpch_customer_c_custkey
2020-06-30 15:28:19.535774 (Thread-1): finished collecting timing info
2020-06-30 15:28:19.536221 (Thread-1): Compilation Error in test source_is_nonnegative_tpch_customer_c_custkey (models/source_reads/sources.yml)
  'test_is_nonnegative' is undefined
Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 449, in catch_jinja
    yield
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 481, in render_template
    return template.render(ctx)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 1, in top-level template code
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
jinja2.exceptions.UndefinedError: 'test_is_nonnegative' is undefined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 165, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 340, in compile
    return compile_node(self.adapter, self.config, self.node, manifest, {})
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/compilation.py", line 255, in compile_node
    node = compiler.compile_node(node, manifest, extra_context)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/compilation.py", line 179, in compile_node
    node)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 530, in get_rendered
    return render_template(template, ctx, node)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 481, in render_template
    return template.render(ctx)
  File "/usr/local/opt/python/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 454, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in test source_is_nonnegative_tpch_customer_c_custkey (models/source_reads/sources.yml)
  'test_is_nonnegative' is undefined
2020-06-30 15:28:19.537856 (Thread-1): 10:28:19 | 2 of 2 ERROR source_is_nonnegative_tpch_customer_c_custkey........... [ERROR in 0.01s]
2020-06-30 15:28:19.537995 (Thread-1): Finished running node test.sample_project.source_is_nonnegative_tpch_customer_c_custkey
2020-06-30 15:28:19.538139 (Thread-1): Began running node model.sample_project.customer_nation
2020-06-30 15:28:19.538527 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 15:28:19.538639 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_nonnegative_tpch_customer_c_custkey).
2020-06-30 15:28:19.538743 (Thread-1): Compiling model.sample_project.customer_nation
2020-06-30 15:28:19.550935 (Thread-1): Writing injected SQL for node "model.sample_project.customer_nation"
2020-06-30 15:28:19.551267 (Thread-1): finished collecting timing info
2020-06-30 15:28:19.551625 (Thread-1): Finished running node model.sample_project.customer_nation
2020-06-30 15:28:19.551742 (Thread-1): Began running node model.sample_project.orders_lineitem
2020-06-30 15:28:19.552010 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 15:28:19.552130 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer_nation).
2020-06-30 15:28:19.552325 (Thread-1): Compiling model.sample_project.orders_lineitem
2020-06-30 15:28:19.565093 (Thread-1): Writing injected SQL for node "model.sample_project.orders_lineitem"
2020-06-30 15:28:19.565419 (Thread-1): finished collecting timing info
2020-06-30 15:28:19.565779 (Thread-1): Finished running node model.sample_project.orders_lineitem
2020-06-30 15:28:19.566088 (Thread-1): Began running node model.sample_project.cust_list_ord_nat
2020-06-30 15:28:19.566332 (Thread-1): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 15:28:19.566501 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders_lineitem).
2020-06-30 15:28:19.566641 (Thread-1): Compiling model.sample_project.cust_list_ord_nat
2020-06-30 15:28:19.581265 (Thread-1): Writing injected SQL for node "model.sample_project.cust_list_ord_nat"
2020-06-30 15:28:19.581676 (Thread-1): finished collecting timing info
2020-06-30 15:28:19.582053 (Thread-1): Finished running node model.sample_project.cust_list_ord_nat
2020-06-30 15:28:19.666159 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 15:28:19.666520 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:28:19.666989 (MainThread): 10:28:19 | 
2020-06-30 15:28:19.667226 (MainThread): 10:28:19 | Finished running 2 tests in 8.56s.
2020-06-30 15:28:19.667424 (MainThread): Connection 'master' was properly closed.
2020-06-30 15:28:19.667575 (MainThread): Connection 'model.sample_project.cust_list_ord_nat' was left open.
2020-06-30 15:28:19.667727 (MainThread): On model.sample_project.cust_list_ord_nat: Close
2020-06-30 15:28:19.987354 (MainThread): 
2020-06-30 15:28:19.987525 (MainThread): Completed with 2 errors and 0 warnings:
2020-06-30 15:28:19.987645 (MainThread): 
2020-06-30 15:28:19.987760 (MainThread): Failure in test source_is_even_tpch_customer_c_custkey (models/source_reads/sources.yml)
2020-06-30 15:28:19.987892 (MainThread):   Got 75000 results, expected 0.
2020-06-30 15:28:19.987998 (MainThread): 
2020-06-30 15:28:19.988105 (MainThread):   compiled SQL at target/compiled/sample_project/models/source_reads/sources.yml/schema_test/source_is_even_tpch_customer_c_custkey.sql
2020-06-30 15:28:19.988210 (MainThread): 
2020-06-30 15:28:19.988315 (MainThread): Compilation Error in test source_is_nonnegative_tpch_customer_c_custkey (models/source_reads/sources.yml)
2020-06-30 15:28:19.988414 (MainThread):   'test_is_nonnegative' is undefined
2020-06-30 15:28:19.988513 (MainThread): 
Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
2020-06-30 15:28:19.988679 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075ef0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10305e290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071c5150>]}
2020-06-30 15:28:19.988863 (MainThread): Flushing usage events
2020-06-30 15:29:03.712383 (MainThread): Running with dbt=0.17.0
2020-06-30 15:29:04.035435 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2020-06-30 15:29:04.036561 (MainThread): Tracking: tracking
2020-06-30 15:29:04.036989 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af1fd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8cd990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8cdad0>]}
2020-06-30 15:29:04.057654 (MainThread): Partial parsing not enabled
2020-06-30 15:29:04.059625 (MainThread): Parsing macros/core.sql
2020-06-30 15:29:04.065268 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-30 15:29:04.076312 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-30 15:29:04.078586 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-30 15:29:04.099199 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-30 15:29:04.134438 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-30 15:29:04.162480 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-30 15:29:04.164776 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-30 15:29:04.175664 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-30 15:29:04.192274 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-30 15:29:04.199665 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-30 15:29:04.206520 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-30 15:29:04.212694 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-30 15:29:04.213745 (MainThread): Parsing macros/etc/query.sql
2020-06-30 15:29:04.215094 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-30 15:29:04.216891 (MainThread): Parsing macros/etc/datetime.sql
2020-06-30 15:29:04.226564 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-30 15:29:04.228672 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-30 15:29:04.230538 (MainThread): Parsing macros/adapters/common.sql
2020-06-30 15:29:04.282914 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-30 15:29:04.284139 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-30 15:29:04.285140 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-30 15:29:04.286255 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-30 15:29:04.288564 (MainThread): Parsing macros/catalog.sql
2020-06-30 15:29:04.290548 (MainThread): Parsing macros/adapters.sql
2020-06-30 15:29:04.312537 (MainThread): Parsing macros/materializations/merge.sql
2020-06-30 15:29:04.314576 (MainThread): Parsing macros/materializations/view.sql
2020-06-30 15:29:04.315797 (MainThread): Parsing macros/materializations/table.sql
2020-06-30 15:29:04.319812 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-30 15:29:04.359088 (MainThread): Partial parsing not enabled
2020-06-30 15:29:04.359470 (MainThread): Parsing macros/test_is_even.sql
2020-06-30 15:29:04.360242 (MainThread): Parsing macros/test_is_nonnegative.sql
2020-06-30 15:29:04.363004 (MainThread): Parsing macros/cross_db_utils/except.sql
2020-06-30 15:29:04.364315 (MainThread): Parsing macros/cross_db_utils/replace.sql
2020-06-30 15:29:04.365675 (MainThread): Parsing macros/cross_db_utils/concat.sql
2020-06-30 15:29:04.368024 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2020-06-30 15:29:04.374199 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2020-06-30 15:29:04.375685 (MainThread): Parsing macros/cross_db_utils/length.sql
2020-06-30 15:29:04.377216 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2020-06-30 15:29:04.379792 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2020-06-30 15:29:04.381149 (MainThread): Parsing macros/cross_db_utils/right.sql
2020-06-30 15:29:04.383552 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2020-06-30 15:29:04.393481 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2020-06-30 15:29:04.395421 (MainThread): Parsing macros/cross_db_utils/hash.sql
2020-06-30 15:29:04.396877 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2020-06-30 15:29:04.398344 (MainThread): Parsing macros/cross_db_utils/position.sql
2020-06-30 15:29:04.399935 (MainThread): Parsing macros/cross_db_utils/literal.sql
2020-06-30 15:29:04.400875 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2020-06-30 15:29:04.404079 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2020-06-30 15:29:04.409748 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2020-06-30 15:29:04.413031 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2020-06-30 15:29:04.414936 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2020-06-30 15:29:04.416651 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2020-06-30 15:29:04.442421 (MainThread): Parsing macros/logger/pretty_log_format.sql
2020-06-30 15:29:04.443614 (MainThread): Parsing macros/logger/pretty_time.sql
2020-06-30 15:29:04.444449 (MainThread): Parsing macros/logger/log_info.sql
2020-06-30 15:29:04.445181 (MainThread): Parsing macros/datetime/date_spine.sql
2020-06-30 15:29:04.448738 (MainThread): Parsing macros/web/get_url_host.sql
2020-06-30 15:29:04.450263 (MainThread): Parsing macros/web/get_url_path.sql
2020-06-30 15:29:04.452495 (MainThread): Parsing macros/web/get_url_parameter.sql
2020-06-30 15:29:04.454132 (MainThread): Parsing macros/geo/haversine_distance.sql
2020-06-30 15:29:04.455605 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2020-06-30 15:29:04.456941 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2020-06-30 15:29:04.459661 (MainThread): Parsing macros/schema_tests/recency.sql
2020-06-30 15:29:04.460958 (MainThread): Parsing macros/schema_tests/not_constant.sql
2020-06-30 15:29:04.462431 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2020-06-30 15:29:04.463490 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2020-06-30 15:29:04.464710 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2020-06-30 15:29:04.466252 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2020-06-30 15:29:04.467423 (MainThread): Parsing macros/schema_tests/equality.sql
2020-06-30 15:29:04.470618 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2020-06-30 15:29:04.476580 (MainThread): Parsing macros/sql/nullcheck_table.sql
2020-06-30 15:29:04.477634 (MainThread): Parsing macros/sql/generate_series.sql
2020-06-30 15:29:04.481336 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2020-06-30 15:29:04.485061 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2020-06-30 15:29:04.487741 (MainThread): Parsing macros/sql/star.sql
2020-06-30 15:29:04.490627 (MainThread): Parsing macros/sql/unpivot.sql
2020-06-30 15:29:04.496744 (MainThread): Parsing macros/sql/union.sql
2020-06-30 15:29:04.506522 (MainThread): Parsing macros/sql/groupby.sql
2020-06-30 15:29:04.507473 (MainThread): Parsing macros/sql/surrogate_key.sql
2020-06-30 15:29:04.510360 (MainThread): Parsing macros/sql/safe_add.sql
2020-06-30 15:29:04.511624 (MainThread): Parsing macros/sql/nullcheck.sql
2020-06-30 15:29:04.512970 (MainThread): Parsing macros/sql/get_column_values.sql
2020-06-30 15:29:04.517520 (MainThread): Parsing macros/sql/pivot.sql
2020-06-30 15:29:04.520298 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2020-06-30 15:29:04.565429 (MainThread): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 15:29:04.565546 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:29:04.594457 (MainThread): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 15:29:04.594550 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:29:04.606498 (MainThread): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 15:29:04.606586 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:29:04.618316 (MainThread): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 15:29:04.618401 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:29:04.629155 (MainThread): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 15:29:04.629240 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:29:04.641948 (MainThread): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 15:29:04.642036 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:29:04.654723 (MainThread): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 15:29:04.654809 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:29:04.667312 (MainThread): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 15:29:04.667401 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:29:04.680425 (MainThread): Acquiring new snowflake connection "model.sample_project.sales_report_one".
2020-06-30 15:29:04.680513 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:29:04.691161 (MainThread): Acquiring new snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 15:29:04.691245 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:29:04.705730 (MainThread): Acquiring new snowflake connection "model.sample_project.sales_report_two".
2020-06-30 15:29:04.705817 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:29:05.073499 (MainThread): Found 11 models, 2 tests, 0 snapshots, 0 analyses, 265 macros, 0 operations, 0 seed files, 4 sources
2020-06-30 15:29:05.074907 (MainThread): 
2020-06-30 15:29:05.075182 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 15:29:05.075271 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:29:05.091462 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 15:29:05.091640 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-06-30 15:29:05.104102 (ThreadPoolExecutor-1_0): Using snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 15:29:05.104205 (ThreadPoolExecutor-1_0): On list_JAVEN_TESTING_TEST: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING_TEST"} */

    show terse objects in JAVEN_TESTING.TEST
2020-06-30 15:29:05.526957 (ThreadPoolExecutor-1_0): unclosed file <_io.BufferedReader name='/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/certifi/cacert.pem'>
2020-06-30 15:29:12.505783 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 10 in 7.40 seconds
2020-06-30 15:29:12.518779 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 15:29:12.518900 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:29:12.519096 (MainThread): 10:29:12 | Concurrency: 1 threads (target='dev')
2020-06-30 15:29:12.519206 (MainThread): 10:29:12 | 
2020-06-30 15:29:12.519904 (Thread-1): Began running node model.sample_project.customer
2020-06-30 15:29:12.520158 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 15:29:12.520244 (Thread-1): Re-using an available connection from the pool (formerly list_JAVEN_TESTING_TEST).
2020-06-30 15:29:12.520331 (Thread-1): Compiling model.sample_project.customer
2020-06-30 15:29:12.536973 (Thread-1): Writing injected SQL for node "model.sample_project.customer"
2020-06-30 15:29:12.537694 (Thread-1): finished collecting timing info
2020-06-30 15:29:12.538379 (Thread-1): Finished running node model.sample_project.customer
2020-06-30 15:29:12.538505 (Thread-1): Began running node model.sample_project.lineitem
2020-06-30 15:29:12.538802 (Thread-1): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 15:29:12.538895 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer).
2020-06-30 15:29:12.538976 (Thread-1): Compiling model.sample_project.lineitem
2020-06-30 15:29:12.546008 (Thread-1): Writing injected SQL for node "model.sample_project.lineitem"
2020-06-30 15:29:12.546424 (Thread-1): finished collecting timing info
2020-06-30 15:29:12.547204 (Thread-1): Finished running node model.sample_project.lineitem
2020-06-30 15:29:12.547515 (Thread-1): Began running node model.sample_project.nation
2020-06-30 15:29:12.548110 (Thread-1): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 15:29:12.548202 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.lineitem).
2020-06-30 15:29:12.548284 (Thread-1): Compiling model.sample_project.nation
2020-06-30 15:29:12.555836 (Thread-1): Writing injected SQL for node "model.sample_project.nation"
2020-06-30 15:29:12.556153 (Thread-1): finished collecting timing info
2020-06-30 15:29:12.556492 (Thread-1): Finished running node model.sample_project.nation
2020-06-30 15:29:12.556610 (Thread-1): Began running node model.sample_project.orders
2020-06-30 15:29:12.556968 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 15:29:12.557060 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.nation).
2020-06-30 15:29:12.557140 (Thread-1): Compiling model.sample_project.orders
2020-06-30 15:29:12.564632 (Thread-1): Writing injected SQL for node "model.sample_project.orders"
2020-06-30 15:29:12.564921 (Thread-1): finished collecting timing info
2020-06-30 15:29:12.565245 (Thread-1): Finished running node model.sample_project.orders
2020-06-30 15:29:12.565360 (Thread-1): Began running node test.sample_project.source_is_even_tpch_customer_c_custkey
2020-06-30 15:29:12.565554 (Thread-1): 10:29:12 | 1 of 2 START test source_is_even_tpch_customer_c_custkey............. [RUN]
2020-06-30 15:29:12.565852 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_even_tpch_customer_c_custkey".
2020-06-30 15:29:12.565937 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders).
2020-06-30 15:29:12.566016 (Thread-1): Compiling test.sample_project.source_is_even_tpch_customer_c_custkey
2020-06-30 15:29:12.583112 (Thread-1): Writing injected SQL for node "test.sample_project.source_is_even_tpch_customer_c_custkey"
2020-06-30 15:29:12.583515 (Thread-1): finished collecting timing info
2020-06-30 15:29:12.584093 (Thread-1): Using snowflake connection "test.sample_project.source_is_even_tpch_customer_c_custkey".
2020-06-30 15:29:12.584180 (Thread-1): On test.sample_project.source_is_even_tpch_customer_c_custkey: BEGIN
2020-06-30 15:29:12.753440 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2020-06-30 15:29:12.753613 (Thread-1): Using snowflake connection "test.sample_project.source_is_even_tpch_customer_c_custkey".
2020-06-30 15:29:12.753693 (Thread-1): On test.sample_project.source_is_even_tpch_customer_c_custkey: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "test.sample_project.source_is_even_tpch_customer_c_custkey"} */


with validation as (

    select
        c_custkey as even_field

    from snowflake_sample_data.tpch_sf1.customer

),

validation_errors as (

    select
        even_field

    from validation
    -- if this is true, then even_field is actually odd!
    where (even_field % 2) = 1

)

select count(*)
from validation_errors
2020-06-30 15:29:12.998538 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2020-06-30 15:29:12.998854 (Thread-1): finished collecting timing info
2020-06-30 15:29:12.999085 (Thread-1): On test.sample_project.source_is_even_tpch_customer_c_custkey: ROLLBACK
2020-06-30 15:29:12.999162 (Thread-1): initiating rollback
2020-06-30 15:29:13.296788 (Thread-1): 10:29:13 | 1 of 2 FAIL 75000 source_is_even_tpch_customer_c_custkey............. [FAIL 75000 in 0.73s]
2020-06-30 15:29:13.296963 (Thread-1): Finished running node test.sample_project.source_is_even_tpch_customer_c_custkey
2020-06-30 15:29:13.297105 (Thread-1): Began running node test.sample_project.source_is_nonnegative_tpch_customer_c_custkey
2020-06-30 15:29:13.297240 (Thread-1): 10:29:13 | 2 of 2 START test source_is_nonnegative_tpch_customer_c_custkey...... [RUN]
2020-06-30 15:29:13.297680 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_nonnegative_tpch_customer_c_custkey".
2020-06-30 15:29:13.297853 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_even_tpch_customer_c_custkey).
2020-06-30 15:29:13.297976 (Thread-1): Compiling test.sample_project.source_is_nonnegative_tpch_customer_c_custkey
2020-06-30 15:29:13.308138 (Thread-1): Writing injected SQL for node "test.sample_project.source_is_nonnegative_tpch_customer_c_custkey"
2020-06-30 15:29:13.310287 (Thread-1): finished collecting timing info
2020-06-30 15:29:13.310968 (Thread-1): Using snowflake connection "test.sample_project.source_is_nonnegative_tpch_customer_c_custkey".
2020-06-30 15:29:13.311073 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_customer_c_custkey: BEGIN
2020-06-30 15:29:13.520199 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2020-06-30 15:29:13.520354 (Thread-1): Using snowflake connection "test.sample_project.source_is_nonnegative_tpch_customer_c_custkey".
2020-06-30 15:29:13.520452 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_customer_c_custkey: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "test.sample_project.source_is_nonnegative_tpch_customer_c_custkey"} */


with validation as (

    select
        c_custkey as negative

    from snowflake_sample_data.tpch_sf1.customer

),

validation_errors as (

    select
        negative

    from validation
    -- if this is true, then even_field is actually odd!
    where negative < 0

)

select count(*)
from validation_errors
2020-06-30 15:29:14.016065 (Thread-1): SQL status: SUCCESS 1 in 0.50 seconds
2020-06-30 15:29:14.016376 (Thread-1): finished collecting timing info
2020-06-30 15:29:14.016679 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_customer_c_custkey: ROLLBACK
2020-06-30 15:29:14.016795 (Thread-1): initiating rollback
2020-06-30 15:29:14.512602 (Thread-1): 10:29:14 | 2 of 2 PASS source_is_nonnegative_tpch_customer_c_custkey............ [PASS in 1.22s]
2020-06-30 15:29:14.512787 (Thread-1): Finished running node test.sample_project.source_is_nonnegative_tpch_customer_c_custkey
2020-06-30 15:29:14.512943 (Thread-1): Began running node model.sample_project.customer_nation
2020-06-30 15:29:14.513212 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 15:29:14.513394 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_nonnegative_tpch_customer_c_custkey).
2020-06-30 15:29:14.513526 (Thread-1): Compiling model.sample_project.customer_nation
2020-06-30 15:29:14.526382 (Thread-1): Writing injected SQL for node "model.sample_project.customer_nation"
2020-06-30 15:29:14.527542 (Thread-1): finished collecting timing info
2020-06-30 15:29:14.528031 (Thread-1): Finished running node model.sample_project.customer_nation
2020-06-30 15:29:14.528184 (Thread-1): Began running node model.sample_project.orders_lineitem
2020-06-30 15:29:14.528515 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 15:29:14.528620 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer_nation).
2020-06-30 15:29:14.528716 (Thread-1): Compiling model.sample_project.orders_lineitem
2020-06-30 15:29:14.543726 (Thread-1): Writing injected SQL for node "model.sample_project.orders_lineitem"
2020-06-30 15:29:14.544160 (Thread-1): finished collecting timing info
2020-06-30 15:29:14.544632 (Thread-1): Finished running node model.sample_project.orders_lineitem
2020-06-30 15:29:14.545063 (Thread-1): Began running node model.sample_project.cust_list_ord_nat
2020-06-30 15:29:14.545362 (Thread-1): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 15:29:14.545462 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders_lineitem).
2020-06-30 15:29:14.545557 (Thread-1): Compiling model.sample_project.cust_list_ord_nat
2020-06-30 15:29:14.560178 (Thread-1): Writing injected SQL for node "model.sample_project.cust_list_ord_nat"
2020-06-30 15:29:14.560909 (Thread-1): finished collecting timing info
2020-06-30 15:29:14.561649 (Thread-1): Finished running node model.sample_project.cust_list_ord_nat
2020-06-30 15:29:14.663768 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 15:29:14.663920 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:29:14.664192 (MainThread): 10:29:14 | 
2020-06-30 15:29:14.664322 (MainThread): 10:29:14 | Finished running 2 tests in 9.59s.
2020-06-30 15:29:14.664428 (MainThread): Connection 'master' was properly closed.
2020-06-30 15:29:14.664511 (MainThread): Connection 'model.sample_project.cust_list_ord_nat' was left open.
2020-06-30 15:29:14.664593 (MainThread): On model.sample_project.cust_list_ord_nat: Close
2020-06-30 15:29:15.040269 (MainThread): 
2020-06-30 15:29:15.040460 (MainThread): Completed with 1 error and 0 warnings:
2020-06-30 15:29:15.040567 (MainThread): 
2020-06-30 15:29:15.040671 (MainThread): Failure in test source_is_even_tpch_customer_c_custkey (models/source_reads/sources.yml)
2020-06-30 15:29:15.040788 (MainThread):   Got 75000 results, expected 0.
2020-06-30 15:29:15.040880 (MainThread): 
2020-06-30 15:29:15.040973 (MainThread):   compiled SQL at target/compiled/sample_project/models/source_reads/sources.yml/schema_test/source_is_even_tpch_customer_c_custkey.sql
2020-06-30 15:29:15.041068 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
2020-06-30 15:29:15.041215 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5cff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4bcd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0206d0>]}
2020-06-30 15:29:15.041379 (MainThread): Flushing usage events
2020-06-30 15:36:21.570670 (MainThread): Running with dbt=0.17.0
2020-06-30 15:36:21.898536 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2020-06-30 15:36:21.900116 (MainThread): Tracking: tracking
2020-06-30 15:36:21.900692 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072b5e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c64890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c64c10>]}
2020-06-30 15:36:21.925229 (MainThread): Partial parsing not enabled
2020-06-30 15:36:21.927043 (MainThread): Parsing macros/core.sql
2020-06-30 15:36:21.932641 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-30 15:36:21.942490 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-30 15:36:21.944446 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-30 15:36:21.963847 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-30 15:36:21.994445 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-30 15:36:22.017086 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-30 15:36:22.019167 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-30 15:36:22.026597 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-30 15:36:22.041899 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-30 15:36:22.049555 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-30 15:36:22.056929 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-30 15:36:22.062266 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-30 15:36:22.063289 (MainThread): Parsing macros/etc/query.sql
2020-06-30 15:36:22.064440 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-30 15:36:22.066235 (MainThread): Parsing macros/etc/datetime.sql
2020-06-30 15:36:22.076306 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-30 15:36:22.078630 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-30 15:36:22.080670 (MainThread): Parsing macros/adapters/common.sql
2020-06-30 15:36:22.135517 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-30 15:36:22.136723 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-30 15:36:22.137670 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-30 15:36:22.138799 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-30 15:36:22.141299 (MainThread): Parsing macros/catalog.sql
2020-06-30 15:36:22.143222 (MainThread): Parsing macros/adapters.sql
2020-06-30 15:36:22.168885 (MainThread): Parsing macros/materializations/merge.sql
2020-06-30 15:36:22.171078 (MainThread): Parsing macros/materializations/view.sql
2020-06-30 15:36:22.172502 (MainThread): Parsing macros/materializations/table.sql
2020-06-30 15:36:22.177734 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-30 15:36:22.217441 (MainThread): Partial parsing not enabled
2020-06-30 15:36:22.217807 (MainThread): Parsing macros/test_is_even.sql
2020-06-30 15:36:22.218575 (MainThread): Parsing macros/test_is_nonnegative.sql
2020-06-30 15:36:22.221009 (MainThread): Parsing macros/cross_db_utils/except.sql
2020-06-30 15:36:22.222071 (MainThread): Parsing macros/cross_db_utils/replace.sql
2020-06-30 15:36:22.223501 (MainThread): Parsing macros/cross_db_utils/concat.sql
2020-06-30 15:36:22.225997 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2020-06-30 15:36:22.232154 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2020-06-30 15:36:22.233611 (MainThread): Parsing macros/cross_db_utils/length.sql
2020-06-30 15:36:22.234954 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2020-06-30 15:36:22.237751 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2020-06-30 15:36:22.238901 (MainThread): Parsing macros/cross_db_utils/right.sql
2020-06-30 15:36:22.241408 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2020-06-30 15:36:22.252745 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2020-06-30 15:36:22.255238 (MainThread): Parsing macros/cross_db_utils/hash.sql
2020-06-30 15:36:22.256937 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2020-06-30 15:36:22.258511 (MainThread): Parsing macros/cross_db_utils/position.sql
2020-06-30 15:36:22.260189 (MainThread): Parsing macros/cross_db_utils/literal.sql
2020-06-30 15:36:22.261136 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2020-06-30 15:36:22.264366 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2020-06-30 15:36:22.270097 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2020-06-30 15:36:22.273083 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2020-06-30 15:36:22.275019 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2020-06-30 15:36:22.276584 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2020-06-30 15:36:22.307275 (MainThread): Parsing macros/logger/pretty_log_format.sql
2020-06-30 15:36:22.308032 (MainThread): Parsing macros/logger/pretty_time.sql
2020-06-30 15:36:22.308832 (MainThread): Parsing macros/logger/log_info.sql
2020-06-30 15:36:22.309565 (MainThread): Parsing macros/datetime/date_spine.sql
2020-06-30 15:36:22.313081 (MainThread): Parsing macros/web/get_url_host.sql
2020-06-30 15:36:22.314531 (MainThread): Parsing macros/web/get_url_path.sql
2020-06-30 15:36:22.316799 (MainThread): Parsing macros/web/get_url_parameter.sql
2020-06-30 15:36:22.317968 (MainThread): Parsing macros/geo/haversine_distance.sql
2020-06-30 15:36:22.318937 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2020-06-30 15:36:22.320534 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2020-06-30 15:36:22.322672 (MainThread): Parsing macros/schema_tests/recency.sql
2020-06-30 15:36:22.324187 (MainThread): Parsing macros/schema_tests/not_constant.sql
2020-06-30 15:36:22.325842 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2020-06-30 15:36:22.326871 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2020-06-30 15:36:22.328284 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2020-06-30 15:36:22.330086 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2020-06-30 15:36:22.331208 (MainThread): Parsing macros/schema_tests/equality.sql
2020-06-30 15:36:22.334609 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2020-06-30 15:36:22.340818 (MainThread): Parsing macros/sql/nullcheck_table.sql
2020-06-30 15:36:22.341888 (MainThread): Parsing macros/sql/generate_series.sql
2020-06-30 15:36:22.345379 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2020-06-30 15:36:22.349531 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2020-06-30 15:36:22.352621 (MainThread): Parsing macros/sql/star.sql
2020-06-30 15:36:22.356507 (MainThread): Parsing macros/sql/unpivot.sql
2020-06-30 15:36:22.362922 (MainThread): Parsing macros/sql/union.sql
2020-06-30 15:36:22.376874 (MainThread): Parsing macros/sql/groupby.sql
2020-06-30 15:36:22.377933 (MainThread): Parsing macros/sql/surrogate_key.sql
2020-06-30 15:36:22.380672 (MainThread): Parsing macros/sql/safe_add.sql
2020-06-30 15:36:22.381813 (MainThread): Parsing macros/sql/nullcheck.sql
2020-06-30 15:36:22.383242 (MainThread): Parsing macros/sql/get_column_values.sql
2020-06-30 15:36:22.388160 (MainThread): Parsing macros/sql/pivot.sql
2020-06-30 15:36:22.391167 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2020-06-30 15:36:22.435739 (MainThread): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 15:36:22.435852 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:36:22.466832 (MainThread): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 15:36:22.466941 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:36:22.478733 (MainThread): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 15:36:22.478860 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:36:22.490506 (MainThread): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 15:36:22.490600 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:36:22.501626 (MainThread): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 15:36:22.501714 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:36:22.515753 (MainThread): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 15:36:22.515847 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:36:22.529105 (MainThread): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 15:36:22.529196 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:36:22.541258 (MainThread): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 15:36:22.541403 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:36:22.553536 (MainThread): Acquiring new snowflake connection "model.sample_project.sales_report_one".
2020-06-30 15:36:22.553664 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:36:22.564965 (MainThread): Acquiring new snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 15:36:22.565051 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:36:22.580347 (MainThread): Acquiring new snowflake connection "model.sample_project.sales_report_two".
2020-06-30 15:36:22.580458 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:36:23.069138 (MainThread): Found 11 models, 9 tests, 0 snapshots, 0 analyses, 265 macros, 0 operations, 0 seed files, 4 sources
2020-06-30 15:36:23.070799 (MainThread): 
2020-06-30 15:36:23.071079 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 15:36:23.071168 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:36:23.097899 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 15:36:23.098205 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-06-30 15:36:23.110937 (ThreadPoolExecutor-1_0): Using snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 15:36:23.111039 (ThreadPoolExecutor-1_0): On list_JAVEN_TESTING_TEST: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING_TEST"} */

    show terse objects in JAVEN_TESTING.TEST
2020-06-30 15:36:23.585611 (ThreadPoolExecutor-1_0): unclosed file <_io.BufferedReader name='/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/certifi/cacert.pem'>
2020-06-30 15:36:28.373430 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 10 in 5.26 seconds
2020-06-30 15:36:28.388639 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 15:36:28.388798 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:36:28.389121 (MainThread): 10:36:28 | Concurrency: 1 threads (target='dev')
2020-06-30 15:36:28.389395 (MainThread): 10:36:28 | 
2020-06-30 15:36:28.390779 (Thread-1): Began running node model.sample_project.customer
2020-06-30 15:36:28.391228 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 15:36:28.391341 (Thread-1): Re-using an available connection from the pool (formerly list_JAVEN_TESTING_TEST).
2020-06-30 15:36:28.391447 (Thread-1): Compiling model.sample_project.customer
2020-06-30 15:36:28.408939 (Thread-1): Writing injected SQL for node "model.sample_project.customer"
2020-06-30 15:36:28.409356 (Thread-1): finished collecting timing info
2020-06-30 15:36:28.409795 (Thread-1): Finished running node model.sample_project.customer
2020-06-30 15:36:28.409921 (Thread-1): Began running node model.sample_project.lineitem
2020-06-30 15:36:28.410140 (Thread-1): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 15:36:28.410225 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer).
2020-06-30 15:36:28.410308 (Thread-1): Compiling model.sample_project.lineitem
2020-06-30 15:36:28.416979 (Thread-1): Writing injected SQL for node "model.sample_project.lineitem"
2020-06-30 15:36:28.417253 (Thread-1): finished collecting timing info
2020-06-30 15:36:28.417683 (Thread-1): Finished running node model.sample_project.lineitem
2020-06-30 15:36:28.417802 (Thread-1): Began running node model.sample_project.nation
2020-06-30 15:36:28.418017 (Thread-1): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 15:36:28.418171 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.lineitem).
2020-06-30 15:36:28.418274 (Thread-1): Compiling model.sample_project.nation
2020-06-30 15:36:28.425991 (Thread-1): Writing injected SQL for node "model.sample_project.nation"
2020-06-30 15:36:28.426409 (Thread-1): finished collecting timing info
2020-06-30 15:36:28.426789 (Thread-1): Finished running node model.sample_project.nation
2020-06-30 15:36:28.426918 (Thread-1): Began running node model.sample_project.orders
2020-06-30 15:36:28.427313 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 15:36:28.427417 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.nation).
2020-06-30 15:36:28.427505 (Thread-1): Compiling model.sample_project.orders
2020-06-30 15:36:28.434860 (Thread-1): Writing injected SQL for node "model.sample_project.orders"
2020-06-30 15:36:28.435177 (Thread-1): finished collecting timing info
2020-06-30 15:36:28.435554 (Thread-1): Finished running node model.sample_project.orders
2020-06-30 15:36:28.435682 (Thread-1): Began running node test.sample_project.source_is_even_tpch_customer_c_custkey
2020-06-30 15:36:28.435923 (Thread-1): 10:36:28 | 1 of 9 START test source_is_even_tpch_customer_c_custkey............. [RUN]
2020-06-30 15:36:28.436258 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_even_tpch_customer_c_custkey".
2020-06-30 15:36:28.436344 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders).
2020-06-30 15:36:28.436427 (Thread-1): Compiling test.sample_project.source_is_even_tpch_customer_c_custkey
2020-06-30 15:36:28.451491 (Thread-1): Writing injected SQL for node "test.sample_project.source_is_even_tpch_customer_c_custkey"
2020-06-30 15:36:28.451840 (Thread-1): finished collecting timing info
2020-06-30 15:36:28.452437 (Thread-1): Using snowflake connection "test.sample_project.source_is_even_tpch_customer_c_custkey".
2020-06-30 15:36:28.452527 (Thread-1): On test.sample_project.source_is_even_tpch_customer_c_custkey: BEGIN
2020-06-30 15:36:28.848781 (Thread-1): SQL status: SUCCESS 1 in 0.40 seconds
2020-06-30 15:36:28.848944 (Thread-1): Using snowflake connection "test.sample_project.source_is_even_tpch_customer_c_custkey".
2020-06-30 15:36:28.849038 (Thread-1): On test.sample_project.source_is_even_tpch_customer_c_custkey: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "test.sample_project.source_is_even_tpch_customer_c_custkey"} */


with validation as (

    select
        c_custkey as even_field

    from snowflake_sample_data.tpch_sf1.customer

),

validation_errors as (

    select
        even_field

    from validation
    -- if this is true, then even_field is actually odd!
    where (even_field % 2) = 1

)

select count(*)
from validation_errors
2020-06-30 15:36:29.114524 (Thread-1): SQL status: SUCCESS 1 in 0.27 seconds
2020-06-30 15:36:29.115007 (Thread-1): finished collecting timing info
2020-06-30 15:36:29.115625 (Thread-1): On test.sample_project.source_is_even_tpch_customer_c_custkey: ROLLBACK
2020-06-30 15:36:29.115761 (Thread-1): initiating rollback
2020-06-30 15:36:29.393591 (Thread-1): 10:36:29 | 1 of 9 FAIL 75000 source_is_even_tpch_customer_c_custkey............. [FAIL 75000 in 0.96s]
2020-06-30 15:36:29.393778 (Thread-1): Finished running node test.sample_project.source_is_even_tpch_customer_c_custkey
2020-06-30 15:36:29.393921 (Thread-1): Began running node test.sample_project.source_is_even_tpch_customer_c_nationkey
2020-06-30 15:36:29.394123 (Thread-1): 10:36:29 | 2 of 9 START test source_is_even_tpch_customer_c_nationkey........... [RUN]
2020-06-30 15:36:29.394387 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_even_tpch_customer_c_nationkey".
2020-06-30 15:36:29.394474 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_even_tpch_customer_c_custkey).
2020-06-30 15:36:29.394570 (Thread-1): Compiling test.sample_project.source_is_even_tpch_customer_c_nationkey
2020-06-30 15:36:29.404418 (Thread-1): Writing injected SQL for node "test.sample_project.source_is_even_tpch_customer_c_nationkey"
2020-06-30 15:36:29.404829 (Thread-1): finished collecting timing info
2020-06-30 15:36:29.405427 (Thread-1): Using snowflake connection "test.sample_project.source_is_even_tpch_customer_c_nationkey".
2020-06-30 15:36:29.405518 (Thread-1): On test.sample_project.source_is_even_tpch_customer_c_nationkey: BEGIN
2020-06-30 15:36:29.602085 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2020-06-30 15:36:29.602260 (Thread-1): Using snowflake connection "test.sample_project.source_is_even_tpch_customer_c_nationkey".
2020-06-30 15:36:29.602371 (Thread-1): On test.sample_project.source_is_even_tpch_customer_c_nationkey: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "test.sample_project.source_is_even_tpch_customer_c_nationkey"} */


with validation as (

    select
        c_nationkey as even_field

    from snowflake_sample_data.tpch_sf1.customer

),

validation_errors as (

    select
        even_field

    from validation
    -- if this is true, then even_field is actually odd!
    where (even_field % 2) = 1

)

select count(*)
from validation_errors
2020-06-30 15:37:09.543631 (Thread-1): SQL status: SUCCESS 1 in 39.94 seconds
2020-06-30 15:37:09.544665 (Thread-1): finished collecting timing info
2020-06-30 15:37:09.544967 (Thread-1): On test.sample_project.source_is_even_tpch_customer_c_nationkey: ROLLBACK
2020-06-30 15:37:09.545064 (Thread-1): initiating rollback
2020-06-30 15:37:09.903178 (Thread-1): 10:37:09 | 2 of 9 FAIL 72027 source_is_even_tpch_customer_c_nationkey........... [FAIL 72027 in 40.51s]
2020-06-30 15:37:09.903347 (Thread-1): Finished running node test.sample_project.source_is_even_tpch_customer_c_nationkey
2020-06-30 15:37:09.903497 (Thread-1): Began running node test.sample_project.source_is_even_tpch_lineitem_l_extendedprice
2020-06-30 15:37:09.903707 (Thread-1): 10:37:09 | 3 of 9 START test source_is_even_tpch_lineitem_l_extendedprice....... [RUN]
2020-06-30 15:37:09.903941 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_even_tpch_lineitem_l_extendedprice".
2020-06-30 15:37:09.904021 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_even_tpch_customer_c_nationkey).
2020-06-30 15:37:09.904130 (Thread-1): Compiling test.sample_project.source_is_even_tpch_lineitem_l_extendedprice
2020-06-30 15:37:09.914061 (Thread-1): Writing injected SQL for node "test.sample_project.source_is_even_tpch_lineitem_l_extendedprice"
2020-06-30 15:37:09.914423 (Thread-1): finished collecting timing info
2020-06-30 15:37:09.915080 (Thread-1): Using snowflake connection "test.sample_project.source_is_even_tpch_lineitem_l_extendedprice".
2020-06-30 15:37:09.915165 (Thread-1): On test.sample_project.source_is_even_tpch_lineitem_l_extendedprice: BEGIN
2020-06-30 15:37:10.092972 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2020-06-30 15:37:10.093111 (Thread-1): Using snowflake connection "test.sample_project.source_is_even_tpch_lineitem_l_extendedprice".
2020-06-30 15:37:10.093192 (Thread-1): On test.sample_project.source_is_even_tpch_lineitem_l_extendedprice: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "test.sample_project.source_is_even_tpch_lineitem_l_extendedprice"} */


with validation as (

    select
        l_extendedprice as even_field

    from snowflake_sample_data.tpch_sf1.lineitem

),

validation_errors as (

    select
        even_field

    from validation
    -- if this is true, then even_field is actually odd!
    where (even_field % 2) = 1

)

select count(*)
from validation_errors
2020-06-30 15:37:10.671731 (Thread-1): SQL status: SUCCESS 1 in 0.58 seconds
2020-06-30 15:37:10.672036 (Thread-1): finished collecting timing info
2020-06-30 15:37:10.672306 (Thread-1): On test.sample_project.source_is_even_tpch_lineitem_l_extendedprice: ROLLBACK
2020-06-30 15:37:10.672396 (Thread-1): initiating rollback
2020-06-30 15:37:10.954342 (Thread-1): 10:37:10 | 3 of 9 FAIL 116905 source_is_even_tpch_lineitem_l_extendedprice...... [FAIL 116905 in 1.05s]
2020-06-30 15:37:10.954517 (Thread-1): Finished running node test.sample_project.source_is_even_tpch_lineitem_l_extendedprice
2020-06-30 15:37:10.954666 (Thread-1): Began running node test.sample_project.source_is_even_tpch_nation_n_nationkey
2020-06-30 15:37:10.954875 (Thread-1): 10:37:10 | 4 of 9 START test source_is_even_tpch_nation_n_nationkey............. [RUN]
2020-06-30 15:37:10.955138 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_even_tpch_nation_n_nationkey".
2020-06-30 15:37:10.955231 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_even_tpch_lineitem_l_extendedprice).
2020-06-30 15:37:10.955326 (Thread-1): Compiling test.sample_project.source_is_even_tpch_nation_n_nationkey
2020-06-30 15:37:10.965025 (Thread-1): Writing injected SQL for node "test.sample_project.source_is_even_tpch_nation_n_nationkey"
2020-06-30 15:37:10.965406 (Thread-1): finished collecting timing info
2020-06-30 15:37:10.966088 (Thread-1): Using snowflake connection "test.sample_project.source_is_even_tpch_nation_n_nationkey".
2020-06-30 15:37:10.966190 (Thread-1): On test.sample_project.source_is_even_tpch_nation_n_nationkey: BEGIN
2020-06-30 15:37:11.204802 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2020-06-30 15:37:11.204960 (Thread-1): Using snowflake connection "test.sample_project.source_is_even_tpch_nation_n_nationkey".
2020-06-30 15:37:11.205057 (Thread-1): On test.sample_project.source_is_even_tpch_nation_n_nationkey: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "test.sample_project.source_is_even_tpch_nation_n_nationkey"} */


with validation as (

    select
        n_nationkey as even_field

    from snowflake_sample_data.tpch_sf1.nation

),

validation_errors as (

    select
        even_field

    from validation
    -- if this is true, then even_field is actually odd!
    where (even_field % 2) = 1

)

select count(*)
from validation_errors
2020-06-30 15:37:12.190747 (Thread-1): SQL status: SUCCESS 1 in 0.99 seconds
2020-06-30 15:37:12.191164 (Thread-1): finished collecting timing info
2020-06-30 15:37:12.191414 (Thread-1): On test.sample_project.source_is_even_tpch_nation_n_nationkey: ROLLBACK
2020-06-30 15:37:12.191497 (Thread-1): initiating rollback
2020-06-30 15:37:12.452253 (Thread-1): 10:37:12 | 4 of 9 FAIL 12 source_is_even_tpch_nation_n_nationkey................ [FAIL 12 in 1.50s]
2020-06-30 15:37:12.452431 (Thread-1): Finished running node test.sample_project.source_is_even_tpch_nation_n_nationkey
2020-06-30 15:37:12.452576 (Thread-1): Began running node test.sample_project.source_is_even_tpch_orders_o_custkey
2020-06-30 15:37:12.452803 (Thread-1): 10:37:12 | 5 of 9 START test source_is_even_tpch_orders_o_custkey............... [RUN]
2020-06-30 15:37:12.453091 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_even_tpch_orders_o_custkey".
2020-06-30 15:37:12.453189 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_even_tpch_nation_n_nationkey).
2020-06-30 15:37:12.453287 (Thread-1): Compiling test.sample_project.source_is_even_tpch_orders_o_custkey
2020-06-30 15:37:12.462520 (Thread-1): Writing injected SQL for node "test.sample_project.source_is_even_tpch_orders_o_custkey"
2020-06-30 15:37:12.462857 (Thread-1): finished collecting timing info
2020-06-30 15:37:12.463548 (Thread-1): Using snowflake connection "test.sample_project.source_is_even_tpch_orders_o_custkey".
2020-06-30 15:37:12.463640 (Thread-1): On test.sample_project.source_is_even_tpch_orders_o_custkey: BEGIN
2020-06-30 15:37:12.673373 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2020-06-30 15:37:12.673517 (Thread-1): Using snowflake connection "test.sample_project.source_is_even_tpch_orders_o_custkey".
2020-06-30 15:37:12.673600 (Thread-1): On test.sample_project.source_is_even_tpch_orders_o_custkey: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "test.sample_project.source_is_even_tpch_orders_o_custkey"} */


with validation as (

    select
        o_custkey as even_field

    from snowflake_sample_data.tpch_sf1.orders

),

validation_errors as (

    select
        even_field

    from validation
    -- if this is true, then even_field is actually odd!
    where (even_field % 2) = 1

)

select count(*)
from validation_errors
2020-06-30 15:37:13.467634 (Thread-1): SQL status: SUCCESS 1 in 0.79 seconds
2020-06-30 15:37:13.467937 (Thread-1): finished collecting timing info
2020-06-30 15:37:13.468476 (Thread-1): On test.sample_project.source_is_even_tpch_orders_o_custkey: ROLLBACK
2020-06-30 15:37:13.468573 (Thread-1): initiating rollback
2020-06-30 15:37:14.283068 (Thread-1): 10:37:14 | 5 of 9 FAIL 750498 source_is_even_tpch_orders_o_custkey.............. [FAIL 750498 in 1.83s]
2020-06-30 15:37:14.283226 (Thread-1): Finished running node test.sample_project.source_is_even_tpch_orders_o_custkey
2020-06-30 15:37:14.283354 (Thread-1): Began running node test.sample_project.source_unique_tpch_customer_c_custkey
2020-06-30 15:37:14.283545 (Thread-1): 10:37:14 | 6 of 9 START test source_unique_tpch_customer_c_custkey.............. [RUN]
2020-06-30 15:37:14.283792 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_unique_tpch_customer_c_custkey".
2020-06-30 15:37:14.283878 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_even_tpch_orders_o_custkey).
2020-06-30 15:37:14.283964 (Thread-1): Compiling test.sample_project.source_unique_tpch_customer_c_custkey
2020-06-30 15:37:14.293094 (Thread-1): Writing injected SQL for node "test.sample_project.source_unique_tpch_customer_c_custkey"
2020-06-30 15:37:14.293466 (Thread-1): finished collecting timing info
2020-06-30 15:37:14.294013 (Thread-1): Using snowflake connection "test.sample_project.source_unique_tpch_customer_c_custkey".
2020-06-30 15:37:14.294102 (Thread-1): On test.sample_project.source_unique_tpch_customer_c_custkey: BEGIN
2020-06-30 15:37:14.473300 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2020-06-30 15:37:14.473478 (Thread-1): Using snowflake connection "test.sample_project.source_unique_tpch_customer_c_custkey".
2020-06-30 15:37:14.473587 (Thread-1): On test.sample_project.source_unique_tpch_customer_c_custkey: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "test.sample_project.source_unique_tpch_customer_c_custkey"} */




select count(*) as validation_errors
from (

    select
        c_custkey

    from snowflake_sample_data.tpch_sf1.customer
    where c_custkey is not null
    group by c_custkey
    having count(*) > 1

) validation_errors
2020-06-30 15:37:15.307545 (Thread-1): SQL status: SUCCESS 1 in 0.83 seconds
2020-06-30 15:37:15.307853 (Thread-1): finished collecting timing info
2020-06-30 15:37:15.308124 (Thread-1): On test.sample_project.source_unique_tpch_customer_c_custkey: ROLLBACK
2020-06-30 15:37:15.308215 (Thread-1): initiating rollback
2020-06-30 15:37:15.690575 (Thread-1): 10:37:15 | 6 of 9 PASS source_unique_tpch_customer_c_custkey.................... [PASS in 1.41s]
2020-06-30 15:37:15.690753 (Thread-1): Finished running node test.sample_project.source_unique_tpch_customer_c_custkey
2020-06-30 15:37:15.690899 (Thread-1): Began running node test.sample_project.source_unique_tpch_customer_c_nationkey
2020-06-30 15:37:15.691109 (Thread-1): 10:37:15 | 7 of 9 START test source_unique_tpch_customer_c_nationkey............ [RUN]
2020-06-30 15:37:15.691365 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_unique_tpch_customer_c_nationkey".
2020-06-30 15:37:15.691458 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_unique_tpch_customer_c_custkey).
2020-06-30 15:37:15.691555 (Thread-1): Compiling test.sample_project.source_unique_tpch_customer_c_nationkey
2020-06-30 15:37:15.701211 (Thread-1): Writing injected SQL for node "test.sample_project.source_unique_tpch_customer_c_nationkey"
2020-06-30 15:37:15.701595 (Thread-1): finished collecting timing info
2020-06-30 15:37:15.702183 (Thread-1): Using snowflake connection "test.sample_project.source_unique_tpch_customer_c_nationkey".
2020-06-30 15:37:15.702273 (Thread-1): On test.sample_project.source_unique_tpch_customer_c_nationkey: BEGIN
2020-06-30 15:37:15.888661 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2020-06-30 15:37:15.888810 (Thread-1): Using snowflake connection "test.sample_project.source_unique_tpch_customer_c_nationkey".
2020-06-30 15:37:15.888892 (Thread-1): On test.sample_project.source_unique_tpch_customer_c_nationkey: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "test.sample_project.source_unique_tpch_customer_c_nationkey"} */




select count(*) as validation_errors
from (

    select
        c_nationkey

    from snowflake_sample_data.tpch_sf1.customer
    where c_nationkey is not null
    group by c_nationkey
    having count(*) > 1

) validation_errors
2020-06-30 15:37:16.158770 (Thread-1): SQL status: SUCCESS 1 in 0.27 seconds
2020-06-30 15:37:16.159048 (Thread-1): finished collecting timing info
2020-06-30 15:37:16.159281 (Thread-1): On test.sample_project.source_unique_tpch_customer_c_nationkey: ROLLBACK
2020-06-30 15:37:16.159358 (Thread-1): initiating rollback
2020-06-30 15:37:16.929811 (Thread-1): 10:37:16 | 7 of 9 FAIL 25 source_unique_tpch_customer_c_nationkey............... [FAIL 25 in 1.24s]
2020-06-30 15:37:16.929997 (Thread-1): Finished running node test.sample_project.source_unique_tpch_customer_c_nationkey
2020-06-30 15:37:16.930149 (Thread-1): Began running node test.sample_project.source_unique_tpch_nation_n_nationkey
2020-06-30 15:37:16.930371 (Thread-1): 10:37:16 | 8 of 9 START test source_unique_tpch_nation_n_nationkey.............. [RUN]
2020-06-30 15:37:16.930664 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_unique_tpch_nation_n_nationkey".
2020-06-30 15:37:16.930762 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_unique_tpch_customer_c_nationkey).
2020-06-30 15:37:16.930860 (Thread-1): Compiling test.sample_project.source_unique_tpch_nation_n_nationkey
2020-06-30 15:37:16.940653 (Thread-1): Writing injected SQL for node "test.sample_project.source_unique_tpch_nation_n_nationkey"
2020-06-30 15:37:16.941045 (Thread-1): finished collecting timing info
2020-06-30 15:37:16.941655 (Thread-1): Using snowflake connection "test.sample_project.source_unique_tpch_nation_n_nationkey".
2020-06-30 15:37:16.941770 (Thread-1): On test.sample_project.source_unique_tpch_nation_n_nationkey: BEGIN
2020-06-30 15:37:17.355004 (Thread-1): SQL status: SUCCESS 1 in 0.41 seconds
2020-06-30 15:37:17.355159 (Thread-1): Using snowflake connection "test.sample_project.source_unique_tpch_nation_n_nationkey".
2020-06-30 15:37:17.355238 (Thread-1): On test.sample_project.source_unique_tpch_nation_n_nationkey: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "test.sample_project.source_unique_tpch_nation_n_nationkey"} */




select count(*) as validation_errors
from (

    select
        n_nationkey

    from snowflake_sample_data.tpch_sf1.nation
    where n_nationkey is not null
    group by n_nationkey
    having count(*) > 1

) validation_errors
2020-06-30 15:37:17.766421 (Thread-1): SQL status: SUCCESS 1 in 0.41 seconds
2020-06-30 15:37:17.766751 (Thread-1): finished collecting timing info
2020-06-30 15:37:17.767029 (Thread-1): On test.sample_project.source_unique_tpch_nation_n_nationkey: ROLLBACK
2020-06-30 15:37:17.767121 (Thread-1): initiating rollback
2020-06-30 15:37:18.149424 (Thread-1): 10:37:18 | 8 of 9 PASS source_unique_tpch_nation_n_nationkey.................... [PASS in 1.22s]
2020-06-30 15:37:18.149608 (Thread-1): Finished running node test.sample_project.source_unique_tpch_nation_n_nationkey
2020-06-30 15:37:18.149759 (Thread-1): Began running node test.sample_project.source_unique_tpch_orders_o_custkey
2020-06-30 15:37:18.149964 (Thread-1): 10:37:18 | 9 of 9 START test source_unique_tpch_orders_o_custkey................ [RUN]
2020-06-30 15:37:18.150220 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_unique_tpch_orders_o_custkey".
2020-06-30 15:37:18.150313 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_unique_tpch_nation_n_nationkey).
2020-06-30 15:37:18.150407 (Thread-1): Compiling test.sample_project.source_unique_tpch_orders_o_custkey
2020-06-30 15:37:18.160057 (Thread-1): Writing injected SQL for node "test.sample_project.source_unique_tpch_orders_o_custkey"
2020-06-30 15:37:18.160453 (Thread-1): finished collecting timing info
2020-06-30 15:37:18.161076 (Thread-1): Using snowflake connection "test.sample_project.source_unique_tpch_orders_o_custkey".
2020-06-30 15:37:18.161187 (Thread-1): On test.sample_project.source_unique_tpch_orders_o_custkey: BEGIN
2020-06-30 15:37:18.341816 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2020-06-30 15:37:18.342030 (Thread-1): Using snowflake connection "test.sample_project.source_unique_tpch_orders_o_custkey".
2020-06-30 15:37:18.342166 (Thread-1): On test.sample_project.source_unique_tpch_orders_o_custkey: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "test.sample_project.source_unique_tpch_orders_o_custkey"} */




select count(*) as validation_errors
from (

    select
        o_custkey

    from snowflake_sample_data.tpch_sf1.orders
    where o_custkey is not null
    group by o_custkey
    having count(*) > 1

) validation_errors
2020-06-30 15:37:18.854836 (Thread-1): SQL status: SUCCESS 1 in 0.51 seconds
2020-06-30 15:37:18.855254 (Thread-1): finished collecting timing info
2020-06-30 15:37:18.855639 (Thread-1): On test.sample_project.source_unique_tpch_orders_o_custkey: ROLLBACK
2020-06-30 15:37:18.855776 (Thread-1): initiating rollback
2020-06-30 15:37:19.404247 (Thread-1): 10:37:19 | 9 of 9 FAIL 99979 source_unique_tpch_orders_o_custkey................ [FAIL 99979 in 1.25s]
2020-06-30 15:37:19.404541 (Thread-1): Finished running node test.sample_project.source_unique_tpch_orders_o_custkey
2020-06-30 15:37:19.404797 (Thread-1): Began running node model.sample_project.customer_nation
2020-06-30 15:37:19.405423 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 15:37:19.405621 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_unique_tpch_orders_o_custkey).
2020-06-30 15:37:19.405796 (Thread-1): Compiling model.sample_project.customer_nation
2020-06-30 15:37:19.419478 (Thread-1): Writing injected SQL for node "model.sample_project.customer_nation"
2020-06-30 15:37:19.419874 (Thread-1): finished collecting timing info
2020-06-30 15:37:19.420269 (Thread-1): Finished running node model.sample_project.customer_nation
2020-06-30 15:37:19.420409 (Thread-1): Began running node model.sample_project.orders_lineitem
2020-06-30 15:37:19.420656 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 15:37:19.420754 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer_nation).
2020-06-30 15:37:19.420848 (Thread-1): Compiling model.sample_project.orders_lineitem
2020-06-30 15:37:19.434366 (Thread-1): Writing injected SQL for node "model.sample_project.orders_lineitem"
2020-06-30 15:37:19.434761 (Thread-1): finished collecting timing info
2020-06-30 15:37:19.435184 (Thread-1): Finished running node model.sample_project.orders_lineitem
2020-06-30 15:37:19.435492 (Thread-1): Began running node model.sample_project.cust_list_ord_nat
2020-06-30 15:37:19.435777 (Thread-1): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 15:37:19.435877 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders_lineitem).
2020-06-30 15:37:19.435973 (Thread-1): Compiling model.sample_project.cust_list_ord_nat
2020-06-30 15:37:19.450174 (Thread-1): Writing injected SQL for node "model.sample_project.cust_list_ord_nat"
2020-06-30 15:37:19.450976 (Thread-1): finished collecting timing info
2020-06-30 15:37:19.451423 (Thread-1): Finished running node model.sample_project.cust_list_ord_nat
2020-06-30 15:37:19.550799 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 15:37:19.551011 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:37:19.551399 (MainThread): 10:37:19 | 
2020-06-30 15:37:19.551591 (MainThread): 10:37:19 | Finished running 9 tests in 56.48s.
2020-06-30 15:37:19.551750 (MainThread): Connection 'master' was properly closed.
2020-06-30 15:37:19.551872 (MainThread): Connection 'model.sample_project.cust_list_ord_nat' was left open.
2020-06-30 15:37:19.551993 (MainThread): On model.sample_project.cust_list_ord_nat: Close
2020-06-30 15:37:19.970651 (MainThread): 
2020-06-30 15:37:19.970825 (MainThread): Completed with 7 errors and 0 warnings:
2020-06-30 15:37:19.970944 (MainThread): 
2020-06-30 15:37:19.971071 (MainThread): Failure in test source_is_even_tpch_customer_c_custkey (models/source_reads/sources.yml)
2020-06-30 15:37:19.971207 (MainThread):   Got 75000 results, expected 0.
2020-06-30 15:37:19.971313 (MainThread): 
2020-06-30 15:37:19.971424 (MainThread):   compiled SQL at target/compiled/sample_project/models/source_reads/sources.yml/schema_test/source_is_even_tpch_customer_c_custkey.sql
2020-06-30 15:37:19.971536 (MainThread): 
2020-06-30 15:37:19.971645 (MainThread): Failure in test source_is_even_tpch_customer_c_nationkey (models/source_reads/sources.yml)
2020-06-30 15:37:19.971761 (MainThread):   Got 72027 results, expected 0.
2020-06-30 15:37:19.971863 (MainThread): 
2020-06-30 15:37:19.971966 (MainThread):   compiled SQL at target/compiled/sample_project/models/source_reads/sources.yml/schema_test/source_is_even_tpch_customer_c_nationkey.sql
2020-06-30 15:37:19.972072 (MainThread): 
2020-06-30 15:37:19.972183 (MainThread): Failure in test source_is_even_tpch_lineitem_l_extendedprice (models/source_reads/sources.yml)
2020-06-30 15:37:19.972299 (MainThread):   Got 116905 results, expected 0.
2020-06-30 15:37:19.972401 (MainThread): 
2020-06-30 15:37:19.972503 (MainThread):   compiled SQL at target/compiled/sample_project/models/source_reads/sources.yml/schema_test/source_is_even_tpch_lineitem_l_extendedprice.sql
2020-06-30 15:37:19.972605 (MainThread): 
2020-06-30 15:37:19.972710 (MainThread): Failure in test source_is_even_tpch_nation_n_nationkey (models/source_reads/sources.yml)
2020-06-30 15:37:19.972836 (MainThread):   Got 12 results, expected 0.
2020-06-30 15:37:19.972936 (MainThread): 
2020-06-30 15:37:19.973039 (MainThread):   compiled SQL at target/compiled/sample_project/models/source_reads/sources.yml/schema_test/source_is_even_tpch_nation_n_nationkey.sql
2020-06-30 15:37:19.973151 (MainThread): 
2020-06-30 15:37:19.973273 (MainThread): Failure in test source_is_even_tpch_orders_o_custkey (models/source_reads/sources.yml)
2020-06-30 15:37:19.973403 (MainThread):   Got 750498 results, expected 0.
2020-06-30 15:37:19.973506 (MainThread): 
2020-06-30 15:37:19.973609 (MainThread):   compiled SQL at target/compiled/sample_project/models/source_reads/sources.yml/schema_test/source_is_even_tpch_orders_o_custkey.sql
2020-06-30 15:37:19.973712 (MainThread): 
2020-06-30 15:37:19.973817 (MainThread): Failure in test source_unique_tpch_customer_c_nationkey (models/source_reads/sources.yml)
2020-06-30 15:37:19.973930 (MainThread):   Got 25 results, expected 0.
2020-06-30 15:37:19.974029 (MainThread): 
2020-06-30 15:37:19.974132 (MainThread):   compiled SQL at target/compiled/sample_project/models/source_reads/sources.yml/schema_test/source_unique_tpch_customer_c_nationkey.sql
2020-06-30 15:37:19.974234 (MainThread): 
2020-06-30 15:37:19.974340 (MainThread): Failure in test source_unique_tpch_orders_o_custkey (models/source_reads/sources.yml)
2020-06-30 15:37:19.974455 (MainThread):   Got 99979 results, expected 0.
2020-06-30 15:37:19.974556 (MainThread): 
2020-06-30 15:37:19.974660 (MainThread):   compiled SQL at target/compiled/sample_project/models/source_reads/sources.yml/schema_test/source_unique_tpch_orders_o_custkey.sql
2020-06-30 15:37:19.974770 (MainThread): 
Done. PASS=2 WARN=0 ERROR=7 SKIP=0 TOTAL=9
2020-06-30 15:37:19.974946 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098ccd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba0b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109588e10>]}
2020-06-30 15:37:19.975213 (MainThread): Flushing usage events
2020-06-30 15:37:25.412918 (MainThread): Running with dbt=0.17.0
2020-06-30 15:37:25.851369 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2020-06-30 15:37:25.856023 (MainThread): Tracking: tracking
2020-06-30 15:37:25.856569 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c901a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b214ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8df2d0>]}
2020-06-30 15:37:25.882791 (MainThread): Partial parsing not enabled
2020-06-30 15:37:25.885110 (MainThread): Parsing macros/core.sql
2020-06-30 15:37:25.891345 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-30 15:37:25.901741 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-30 15:37:25.904170 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-30 15:37:25.926498 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-30 15:37:25.961815 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-30 15:37:25.985985 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-30 15:37:25.988191 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-30 15:37:25.995732 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-30 15:37:26.012245 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-30 15:37:26.020343 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-30 15:37:26.027986 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-30 15:37:26.033934 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-30 15:37:26.035126 (MainThread): Parsing macros/etc/query.sql
2020-06-30 15:37:26.036588 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-30 15:37:26.038560 (MainThread): Parsing macros/etc/datetime.sql
2020-06-30 15:37:26.049153 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-30 15:37:26.051588 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-30 15:37:26.053716 (MainThread): Parsing macros/adapters/common.sql
2020-06-30 15:37:26.114664 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-30 15:37:26.116761 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-30 15:37:26.117965 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-30 15:37:26.119623 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-30 15:37:26.122397 (MainThread): Parsing macros/catalog.sql
2020-06-30 15:37:26.124585 (MainThread): Parsing macros/adapters.sql
2020-06-30 15:37:26.151344 (MainThread): Parsing macros/materializations/merge.sql
2020-06-30 15:37:26.154410 (MainThread): Parsing macros/materializations/view.sql
2020-06-30 15:37:26.156042 (MainThread): Parsing macros/materializations/table.sql
2020-06-30 15:37:26.160761 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-30 15:37:26.202275 (MainThread): Partial parsing not enabled
2020-06-30 15:37:26.203036 (MainThread): Parsing macros/test_is_even.sql
2020-06-30 15:37:26.204195 (MainThread): Parsing macros/test_is_nonnegative.sql
2020-06-30 15:37:26.206757 (MainThread): Parsing macros/cross_db_utils/except.sql
2020-06-30 15:37:26.208137 (MainThread): Parsing macros/cross_db_utils/replace.sql
2020-06-30 15:37:26.209751 (MainThread): Parsing macros/cross_db_utils/concat.sql
2020-06-30 15:37:26.212401 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2020-06-30 15:37:26.219089 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2020-06-30 15:37:26.220651 (MainThread): Parsing macros/cross_db_utils/length.sql
2020-06-30 15:37:26.222382 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2020-06-30 15:37:26.225257 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2020-06-30 15:37:26.226597 (MainThread): Parsing macros/cross_db_utils/right.sql
2020-06-30 15:37:26.229492 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2020-06-30 15:37:26.240538 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2020-06-30 15:37:26.242701 (MainThread): Parsing macros/cross_db_utils/hash.sql
2020-06-30 15:37:26.244437 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2020-06-30 15:37:26.246371 (MainThread): Parsing macros/cross_db_utils/position.sql
2020-06-30 15:37:26.248298 (MainThread): Parsing macros/cross_db_utils/literal.sql
2020-06-30 15:37:26.249471 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2020-06-30 15:37:26.253356 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2020-06-30 15:37:26.259635 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2020-06-30 15:37:26.262987 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2020-06-30 15:37:26.265331 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2020-06-30 15:37:26.267539 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2020-06-30 15:37:26.296486 (MainThread): Parsing macros/logger/pretty_log_format.sql
2020-06-30 15:37:26.297573 (MainThread): Parsing macros/logger/pretty_time.sql
2020-06-30 15:37:26.298832 (MainThread): Parsing macros/logger/log_info.sql
2020-06-30 15:37:26.299713 (MainThread): Parsing macros/datetime/date_spine.sql
2020-06-30 15:37:26.304906 (MainThread): Parsing macros/web/get_url_host.sql
2020-06-30 15:37:26.307178 (MainThread): Parsing macros/web/get_url_path.sql
2020-06-30 15:37:26.310104 (MainThread): Parsing macros/web/get_url_parameter.sql
2020-06-30 15:37:26.311500 (MainThread): Parsing macros/geo/haversine_distance.sql
2020-06-30 15:37:26.312921 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2020-06-30 15:37:26.314720 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2020-06-30 15:37:26.317411 (MainThread): Parsing macros/schema_tests/recency.sql
2020-06-30 15:37:26.318996 (MainThread): Parsing macros/schema_tests/not_constant.sql
2020-06-30 15:37:26.320253 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2020-06-30 15:37:26.321550 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2020-06-30 15:37:26.323481 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2020-06-30 15:37:26.325154 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2020-06-30 15:37:26.326770 (MainThread): Parsing macros/schema_tests/equality.sql
2020-06-30 15:37:26.330335 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2020-06-30 15:37:26.336387 (MainThread): Parsing macros/sql/nullcheck_table.sql
2020-06-30 15:37:26.337569 (MainThread): Parsing macros/sql/generate_series.sql
2020-06-30 15:37:26.341245 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2020-06-30 15:37:26.345998 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2020-06-30 15:37:26.349046 (MainThread): Parsing macros/sql/star.sql
2020-06-30 15:37:26.352319 (MainThread): Parsing macros/sql/unpivot.sql
2020-06-30 15:37:26.359586 (MainThread): Parsing macros/sql/union.sql
2020-06-30 15:37:26.370806 (MainThread): Parsing macros/sql/groupby.sql
2020-06-30 15:37:26.372087 (MainThread): Parsing macros/sql/surrogate_key.sql
2020-06-30 15:37:26.375386 (MainThread): Parsing macros/sql/safe_add.sql
2020-06-30 15:37:26.376729 (MainThread): Parsing macros/sql/nullcheck.sql
2020-06-30 15:37:26.378246 (MainThread): Parsing macros/sql/get_column_values.sql
2020-06-30 15:37:26.382924 (MainThread): Parsing macros/sql/pivot.sql
2020-06-30 15:37:26.386478 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2020-06-30 15:37:26.436101 (MainThread): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 15:37:26.436229 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:37:26.467979 (MainThread): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 15:37:26.468097 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:37:26.479690 (MainThread): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 15:37:26.479786 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:37:26.492040 (MainThread): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 15:37:26.492154 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:37:26.511510 (MainThread): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 15:37:26.511638 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:37:26.526013 (MainThread): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 15:37:26.526156 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:37:26.540799 (MainThread): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 15:37:26.540912 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:37:26.557824 (MainThread): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 15:37:26.557954 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:37:26.570500 (MainThread): Acquiring new snowflake connection "model.sample_project.sales_report_one".
2020-06-30 15:37:26.570642 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:37:26.583772 (MainThread): Acquiring new snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 15:37:26.583939 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:37:26.600655 (MainThread): Acquiring new snowflake connection "model.sample_project.sales_report_two".
2020-06-30 15:37:26.600772 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:37:27.125559 (MainThread): Found 11 models, 9 tests, 0 snapshots, 0 analyses, 265 macros, 0 operations, 0 seed files, 4 sources
2020-06-30 15:37:27.128088 (MainThread): 
2020-06-30 15:37:27.128393 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 15:37:27.128486 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:37:27.153864 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 15:37:27.154061 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-06-30 15:37:27.168569 (ThreadPoolExecutor-1_0): Using snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 15:37:27.168700 (ThreadPoolExecutor-1_0): On list_JAVEN_TESTING_TEST: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING_TEST"} */

    show terse objects in JAVEN_TESTING.TEST
2020-06-30 15:37:27.611320 (ThreadPoolExecutor-1_0): unclosed file <_io.BufferedReader name='/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/certifi/cacert.pem'>
2020-06-30 15:37:38.669017 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 10 in 11.50 seconds
2020-06-30 15:37:38.684066 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 15:37:38.684193 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:37:38.684426 (MainThread): 10:37:38 | Concurrency: 1 threads (target='dev')
2020-06-30 15:37:38.684560 (MainThread): 10:37:38 | 
2020-06-30 15:37:38.685536 (Thread-1): Began running node model.sample_project.customer
2020-06-30 15:37:38.685881 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 15:37:38.685989 (Thread-1): Re-using an available connection from the pool (formerly list_JAVEN_TESTING_TEST).
2020-06-30 15:37:38.686093 (Thread-1): Compiling model.sample_project.customer
2020-06-30 15:37:38.704028 (Thread-1): Writing injected SQL for node "model.sample_project.customer"
2020-06-30 15:37:38.704428 (Thread-1): finished collecting timing info
2020-06-30 15:37:38.704854 (Thread-1): Finished running node model.sample_project.customer
2020-06-30 15:37:38.704996 (Thread-1): Began running node model.sample_project.lineitem
2020-06-30 15:37:38.705344 (Thread-1): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 15:37:38.705453 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer).
2020-06-30 15:37:38.705547 (Thread-1): Compiling model.sample_project.lineitem
2020-06-30 15:37:38.713192 (Thread-1): Writing injected SQL for node "model.sample_project.lineitem"
2020-06-30 15:37:38.713542 (Thread-1): finished collecting timing info
2020-06-30 15:37:38.713938 (Thread-1): Finished running node model.sample_project.lineitem
2020-06-30 15:37:38.714078 (Thread-1): Began running node model.sample_project.nation
2020-06-30 15:37:38.714324 (Thread-1): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 15:37:38.714421 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.lineitem).
2020-06-30 15:37:38.714514 (Thread-1): Compiling model.sample_project.nation
2020-06-30 15:37:38.722212 (Thread-1): Writing injected SQL for node "model.sample_project.nation"
2020-06-30 15:37:38.722510 (Thread-1): finished collecting timing info
2020-06-30 15:37:38.722857 (Thread-1): Finished running node model.sample_project.nation
2020-06-30 15:37:38.722980 (Thread-1): Began running node model.sample_project.orders
2020-06-30 15:37:38.723195 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 15:37:38.723281 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.nation).
2020-06-30 15:37:38.723363 (Thread-1): Compiling model.sample_project.orders
2020-06-30 15:37:38.730726 (Thread-1): Writing injected SQL for node "model.sample_project.orders"
2020-06-30 15:37:38.731038 (Thread-1): finished collecting timing info
2020-06-30 15:37:38.731377 (Thread-1): Finished running node model.sample_project.orders
2020-06-30 15:37:38.731497 (Thread-1): Began running node test.sample_project.source_is_nonnegative_tpch_customer_c_custkey
2020-06-30 15:37:38.731617 (Thread-1): 10:37:38 | 1 of 9 START test source_is_nonnegative_tpch_customer_c_custkey...... [RUN]
2020-06-30 15:37:38.731961 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_nonnegative_tpch_customer_c_custkey".
2020-06-30 15:37:38.732061 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders).
2020-06-30 15:37:38.732149 (Thread-1): Compiling test.sample_project.source_is_nonnegative_tpch_customer_c_custkey
2020-06-30 15:37:38.751288 (Thread-1): Writing injected SQL for node "test.sample_project.source_is_nonnegative_tpch_customer_c_custkey"
2020-06-30 15:37:38.751854 (Thread-1): finished collecting timing info
2020-06-30 15:37:38.752775 (Thread-1): Using snowflake connection "test.sample_project.source_is_nonnegative_tpch_customer_c_custkey".
2020-06-30 15:37:38.752869 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_customer_c_custkey: BEGIN
2020-06-30 15:37:38.989057 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2020-06-30 15:37:38.989369 (Thread-1): Using snowflake connection "test.sample_project.source_is_nonnegative_tpch_customer_c_custkey".
2020-06-30 15:37:38.989555 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_customer_c_custkey: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "test.sample_project.source_is_nonnegative_tpch_customer_c_custkey"} */


with validation as (

    select
        c_custkey as negative

    from snowflake_sample_data.tpch_sf1.customer

),

validation_errors as (

    select
        negative

    from validation
    -- if this is true, then even_field is actually odd!
    where negative < 0

)

select count(*)
from validation_errors
2020-06-30 15:37:39.258743 (Thread-1): SQL status: SUCCESS 1 in 0.27 seconds
2020-06-30 15:37:39.259223 (Thread-1): finished collecting timing info
2020-06-30 15:37:39.259636 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_customer_c_custkey: ROLLBACK
2020-06-30 15:37:39.259746 (Thread-1): initiating rollback
2020-06-30 15:37:39.526491 (Thread-1): 10:37:39 | 1 of 9 PASS source_is_nonnegative_tpch_customer_c_custkey............ [PASS in 0.79s]
2020-06-30 15:37:39.526795 (Thread-1): Finished running node test.sample_project.source_is_nonnegative_tpch_customer_c_custkey
2020-06-30 15:37:39.527051 (Thread-1): Began running node test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey
2020-06-30 15:37:39.527449 (Thread-1): 10:37:39 | 2 of 9 START test source_is_nonnegative_tpch_customer_c_nationkey.... [RUN]
2020-06-30 15:37:39.527870 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey".
2020-06-30 15:37:39.528012 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_nonnegative_tpch_customer_c_custkey).
2020-06-30 15:37:39.528150 (Thread-1): Compiling test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey
2020-06-30 15:37:39.539788 (Thread-1): Writing injected SQL for node "test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey"
2020-06-30 15:37:39.540285 (Thread-1): finished collecting timing info
2020-06-30 15:37:39.541040 (Thread-1): Using snowflake connection "test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey".
2020-06-30 15:37:39.541159 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey: BEGIN
2020-06-30 15:37:39.750119 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2020-06-30 15:37:39.750337 (Thread-1): Using snowflake connection "test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey".
2020-06-30 15:37:39.750480 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey"} */


with validation as (

    select
        c_nationkey as negative

    from snowflake_sample_data.tpch_sf1.customer

),

validation_errors as (

    select
        negative

    from validation
    -- if this is true, then even_field is actually odd!
    where negative < 0

)

select count(*)
from validation_errors
2020-06-30 15:37:40.092483 (Thread-1): SQL status: SUCCESS 1 in 0.34 seconds
2020-06-30 15:37:40.092985 (Thread-1): finished collecting timing info
2020-06-30 15:37:40.093446 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey: ROLLBACK
2020-06-30 15:37:40.093614 (Thread-1): initiating rollback
2020-06-30 15:37:40.819047 (Thread-1): 10:37:40 | 2 of 9 PASS source_is_nonnegative_tpch_customer_c_nationkey.......... [PASS in 1.29s]
2020-06-30 15:37:40.819255 (Thread-1): Finished running node test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey
2020-06-30 15:37:40.819417 (Thread-1): Began running node test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice
2020-06-30 15:37:40.819567 (Thread-1): 10:37:40 | 3 of 9 START test source_is_nonnegative_tpch_lineitem_l_extendedprice [RUN]
2020-06-30 15:37:40.819855 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice".
2020-06-30 15:37:40.819964 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey).
2020-06-30 15:37:40.820075 (Thread-1): Compiling test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice
2020-06-30 15:37:40.830803 (Thread-1): Writing injected SQL for node "test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice"
2020-06-30 15:37:40.831300 (Thread-1): finished collecting timing info
2020-06-30 15:37:40.832008 (Thread-1): Using snowflake connection "test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice".
2020-06-30 15:37:40.832119 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice: BEGIN
2020-06-30 15:37:41.081370 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2020-06-30 15:37:41.081563 (Thread-1): Using snowflake connection "test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice".
2020-06-30 15:37:41.081646 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice"} */


with validation as (

    select
        l_extendedprice as negative

    from snowflake_sample_data.tpch_sf1.lineitem

),

validation_errors as (

    select
        negative

    from validation
    -- if this is true, then even_field is actually odd!
    where negative < 0

)

select count(*)
from validation_errors
2020-06-30 15:37:41.381711 (Thread-1): SQL status: SUCCESS 1 in 0.30 seconds
2020-06-30 15:37:41.382219 (Thread-1): finished collecting timing info
2020-06-30 15:37:41.382689 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice: ROLLBACK
2020-06-30 15:37:41.382854 (Thread-1): initiating rollback
2020-06-30 15:37:41.659063 (Thread-1): 10:37:41 | 3 of 9 PASS source_is_nonnegative_tpch_lineitem_l_extendedprice...... [PASS in 0.84s]
2020-06-30 15:37:41.659357 (Thread-1): Finished running node test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice
2020-06-30 15:37:41.659625 (Thread-1): Began running node test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey
2020-06-30 15:37:41.659988 (Thread-1): 10:37:41 | 4 of 9 START test source_is_nonnegative_tpch_nation_n_nationkey...... [RUN]
2020-06-30 15:37:41.660481 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey".
2020-06-30 15:37:41.660618 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice).
2020-06-30 15:37:41.660753 (Thread-1): Compiling test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey
2020-06-30 15:37:41.671648 (Thread-1): Writing injected SQL for node "test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey"
2020-06-30 15:37:41.672016 (Thread-1): finished collecting timing info
2020-06-30 15:37:41.672701 (Thread-1): Using snowflake connection "test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey".
2020-06-30 15:37:41.672817 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey: BEGIN
2020-06-30 15:37:41.881460 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2020-06-30 15:37:41.881725 (Thread-1): Using snowflake connection "test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey".
2020-06-30 15:37:41.881897 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey"} */


with validation as (

    select
        n_nationkey as negative

    from snowflake_sample_data.tpch_sf1.nation

),

validation_errors as (

    select
        negative

    from validation
    -- if this is true, then even_field is actually odd!
    where negative < 0

)

select count(*)
from validation_errors
2020-06-30 15:37:42.204070 (Thread-1): SQL status: SUCCESS 1 in 0.32 seconds
2020-06-30 15:37:42.204543 (Thread-1): finished collecting timing info
2020-06-30 15:37:42.204922 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey: ROLLBACK
2020-06-30 15:37:42.205060 (Thread-1): initiating rollback
2020-06-30 15:37:42.480323 (Thread-1): 10:37:42 | 4 of 9 PASS source_is_nonnegative_tpch_nation_n_nationkey............ [PASS in 0.82s]
2020-06-30 15:37:42.480626 (Thread-1): Finished running node test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey
2020-06-30 15:37:42.480949 (Thread-1): Began running node test.sample_project.source_is_nonnegative_tpch_orders_o_custkey
2020-06-30 15:37:42.481379 (Thread-1): 10:37:42 | 5 of 9 START test source_is_nonnegative_tpch_orders_o_custkey........ [RUN]
2020-06-30 15:37:42.481756 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_nonnegative_tpch_orders_o_custkey".
2020-06-30 15:37:42.481892 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey).
2020-06-30 15:37:42.482027 (Thread-1): Compiling test.sample_project.source_is_nonnegative_tpch_orders_o_custkey
2020-06-30 15:37:42.493543 (Thread-1): Writing injected SQL for node "test.sample_project.source_is_nonnegative_tpch_orders_o_custkey"
2020-06-30 15:37:42.494009 (Thread-1): finished collecting timing info
2020-06-30 15:37:42.494788 (Thread-1): Using snowflake connection "test.sample_project.source_is_nonnegative_tpch_orders_o_custkey".
2020-06-30 15:37:42.494918 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_orders_o_custkey: BEGIN
2020-06-30 15:37:42.756647 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2020-06-30 15:37:42.756905 (Thread-1): Using snowflake connection "test.sample_project.source_is_nonnegative_tpch_orders_o_custkey".
2020-06-30 15:37:42.757075 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_orders_o_custkey: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "test.sample_project.source_is_nonnegative_tpch_orders_o_custkey"} */


with validation as (

    select
        o_custkey as negative

    from snowflake_sample_data.tpch_sf1.orders

),

validation_errors as (

    select
        negative

    from validation
    -- if this is true, then even_field is actually odd!
    where negative < 0

)

select count(*)
from validation_errors
2020-06-30 15:37:43.469944 (Thread-1): SQL status: SUCCESS 1 in 0.71 seconds
2020-06-30 15:37:43.470471 (Thread-1): finished collecting timing info
2020-06-30 15:37:43.471249 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_orders_o_custkey: ROLLBACK
2020-06-30 15:37:43.471450 (Thread-1): initiating rollback
2020-06-30 15:37:43.715067 (Thread-1): 10:37:43 | 5 of 9 PASS source_is_nonnegative_tpch_orders_o_custkey.............. [PASS in 1.23s]
2020-06-30 15:37:43.715364 (Thread-1): Finished running node test.sample_project.source_is_nonnegative_tpch_orders_o_custkey
2020-06-30 15:37:43.715613 (Thread-1): Began running node test.sample_project.source_unique_tpch_customer_c_custkey
2020-06-30 15:37:43.715995 (Thread-1): 10:37:43 | 6 of 9 START test source_unique_tpch_customer_c_custkey.............. [RUN]
2020-06-30 15:37:43.716477 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_unique_tpch_customer_c_custkey".
2020-06-30 15:37:43.716653 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_nonnegative_tpch_orders_o_custkey).
2020-06-30 15:37:43.716826 (Thread-1): Compiling test.sample_project.source_unique_tpch_customer_c_custkey
2020-06-30 15:37:43.727942 (Thread-1): Writing injected SQL for node "test.sample_project.source_unique_tpch_customer_c_custkey"
2020-06-30 15:37:43.728450 (Thread-1): finished collecting timing info
2020-06-30 15:37:43.729069 (Thread-1): Using snowflake connection "test.sample_project.source_unique_tpch_customer_c_custkey".
2020-06-30 15:37:43.729174 (Thread-1): On test.sample_project.source_unique_tpch_customer_c_custkey: BEGIN
2020-06-30 15:37:43.915182 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2020-06-30 15:37:43.915399 (Thread-1): Using snowflake connection "test.sample_project.source_unique_tpch_customer_c_custkey".
2020-06-30 15:37:43.915533 (Thread-1): On test.sample_project.source_unique_tpch_customer_c_custkey: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "test.sample_project.source_unique_tpch_customer_c_custkey"} */




select count(*) as validation_errors
from (

    select
        c_custkey

    from snowflake_sample_data.tpch_sf1.customer
    where c_custkey is not null
    group by c_custkey
    having count(*) > 1

) validation_errors
2020-06-30 15:37:44.156094 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2020-06-30 15:37:44.156593 (Thread-1): finished collecting timing info
2020-06-30 15:37:44.157051 (Thread-1): On test.sample_project.source_unique_tpch_customer_c_custkey: ROLLBACK
2020-06-30 15:37:44.157215 (Thread-1): initiating rollback
2020-06-30 15:37:44.443344 (Thread-1): 10:37:44 | 6 of 9 PASS source_unique_tpch_customer_c_custkey.................... [PASS in 0.73s]
2020-06-30 15:37:44.443593 (Thread-1): Finished running node test.sample_project.source_unique_tpch_customer_c_custkey
2020-06-30 15:37:44.443793 (Thread-1): Began running node test.sample_project.source_unique_tpch_customer_c_nationkey
2020-06-30 15:37:44.444117 (Thread-1): 10:37:44 | 7 of 9 START test source_unique_tpch_customer_c_nationkey............ [RUN]
2020-06-30 15:37:44.444504 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_unique_tpch_customer_c_nationkey".
2020-06-30 15:37:44.444619 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_unique_tpch_customer_c_custkey).
2020-06-30 15:37:44.444733 (Thread-1): Compiling test.sample_project.source_unique_tpch_customer_c_nationkey
2020-06-30 15:37:44.455403 (Thread-1): Writing injected SQL for node "test.sample_project.source_unique_tpch_customer_c_nationkey"
2020-06-30 15:37:44.455799 (Thread-1): finished collecting timing info
2020-06-30 15:37:44.456423 (Thread-1): Using snowflake connection "test.sample_project.source_unique_tpch_customer_c_nationkey".
2020-06-30 15:37:44.456543 (Thread-1): On test.sample_project.source_unique_tpch_customer_c_nationkey: BEGIN
2020-06-30 15:37:44.713230 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2020-06-30 15:37:44.713487 (Thread-1): Using snowflake connection "test.sample_project.source_unique_tpch_customer_c_nationkey".
2020-06-30 15:37:44.713661 (Thread-1): On test.sample_project.source_unique_tpch_customer_c_nationkey: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "test.sample_project.source_unique_tpch_customer_c_nationkey"} */




select count(*) as validation_errors
from (

    select
        c_nationkey

    from snowflake_sample_data.tpch_sf1.customer
    where c_nationkey is not null
    group by c_nationkey
    having count(*) > 1

) validation_errors
2020-06-30 15:37:44.952067 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2020-06-30 15:37:44.952481 (Thread-1): finished collecting timing info
2020-06-30 15:37:44.952850 (Thread-1): On test.sample_project.source_unique_tpch_customer_c_nationkey: ROLLBACK
2020-06-30 15:37:44.953000 (Thread-1): initiating rollback
2020-06-30 15:37:45.315887 (Thread-1): 10:37:45 | 7 of 9 FAIL 25 source_unique_tpch_customer_c_nationkey............... [FAIL 25 in 0.87s]
2020-06-30 15:37:45.316184 (Thread-1): Finished running node test.sample_project.source_unique_tpch_customer_c_nationkey
2020-06-30 15:37:45.316434 (Thread-1): Began running node test.sample_project.source_unique_tpch_nation_n_nationkey
2020-06-30 15:37:45.316670 (Thread-1): 10:37:45 | 8 of 9 START test source_unique_tpch_nation_n_nationkey.............. [RUN]
2020-06-30 15:37:45.317102 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_unique_tpch_nation_n_nationkey".
2020-06-30 15:37:45.317239 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_unique_tpch_customer_c_nationkey).
2020-06-30 15:37:45.317378 (Thread-1): Compiling test.sample_project.source_unique_tpch_nation_n_nationkey
2020-06-30 15:37:45.329104 (Thread-1): Writing injected SQL for node "test.sample_project.source_unique_tpch_nation_n_nationkey"
2020-06-30 15:37:45.329529 (Thread-1): finished collecting timing info
2020-06-30 15:37:45.330218 (Thread-1): Using snowflake connection "test.sample_project.source_unique_tpch_nation_n_nationkey".
2020-06-30 15:37:45.330335 (Thread-1): On test.sample_project.source_unique_tpch_nation_n_nationkey: BEGIN
2020-06-30 15:37:45.520435 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2020-06-30 15:37:45.520700 (Thread-1): Using snowflake connection "test.sample_project.source_unique_tpch_nation_n_nationkey".
2020-06-30 15:37:45.520867 (Thread-1): On test.sample_project.source_unique_tpch_nation_n_nationkey: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "test.sample_project.source_unique_tpch_nation_n_nationkey"} */




select count(*) as validation_errors
from (

    select
        n_nationkey

    from snowflake_sample_data.tpch_sf1.nation
    where n_nationkey is not null
    group by n_nationkey
    having count(*) > 1

) validation_errors
2020-06-30 15:37:45.781857 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2020-06-30 15:37:45.782361 (Thread-1): finished collecting timing info
2020-06-30 15:37:45.782824 (Thread-1): On test.sample_project.source_unique_tpch_nation_n_nationkey: ROLLBACK
2020-06-30 15:37:45.782991 (Thread-1): initiating rollback
2020-06-30 15:37:46.032814 (Thread-1): 10:37:46 | 8 of 9 PASS source_unique_tpch_nation_n_nationkey.................... [PASS in 0.72s]
2020-06-30 15:37:46.033117 (Thread-1): Finished running node test.sample_project.source_unique_tpch_nation_n_nationkey
2020-06-30 15:37:46.033366 (Thread-1): Began running node test.sample_project.source_unique_tpch_orders_o_custkey
2020-06-30 15:37:46.033597 (Thread-1): 10:37:46 | 9 of 9 START test source_unique_tpch_orders_o_custkey................ [RUN]
2020-06-30 15:37:46.034027 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_unique_tpch_orders_o_custkey".
2020-06-30 15:37:46.034387 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_unique_tpch_nation_n_nationkey).
2020-06-30 15:37:46.034563 (Thread-1): Compiling test.sample_project.source_unique_tpch_orders_o_custkey
2020-06-30 15:37:46.046589 (Thread-1): Writing injected SQL for node "test.sample_project.source_unique_tpch_orders_o_custkey"
2020-06-30 15:37:46.047041 (Thread-1): finished collecting timing info
2020-06-30 15:37:46.047763 (Thread-1): Using snowflake connection "test.sample_project.source_unique_tpch_orders_o_custkey".
2020-06-30 15:37:46.047887 (Thread-1): On test.sample_project.source_unique_tpch_orders_o_custkey: BEGIN
2020-06-30 15:37:46.239916 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2020-06-30 15:37:46.240132 (Thread-1): Using snowflake connection "test.sample_project.source_unique_tpch_orders_o_custkey".
2020-06-30 15:37:46.240269 (Thread-1): On test.sample_project.source_unique_tpch_orders_o_custkey: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "test.sample_project.source_unique_tpch_orders_o_custkey"} */




select count(*) as validation_errors
from (

    select
        o_custkey

    from snowflake_sample_data.tpch_sf1.orders
    where o_custkey is not null
    group by o_custkey
    having count(*) > 1

) validation_errors
2020-06-30 15:37:46.472542 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2020-06-30 15:37:46.473042 (Thread-1): finished collecting timing info
2020-06-30 15:37:46.473499 (Thread-1): On test.sample_project.source_unique_tpch_orders_o_custkey: ROLLBACK
2020-06-30 15:37:46.473663 (Thread-1): initiating rollback
2020-06-30 15:37:46.726805 (Thread-1): 10:37:46 | 9 of 9 FAIL 99979 source_unique_tpch_orders_o_custkey................ [FAIL 99979 in 0.69s]
2020-06-30 15:37:46.727105 (Thread-1): Finished running node test.sample_project.source_unique_tpch_orders_o_custkey
2020-06-30 15:37:46.727372 (Thread-1): Began running node model.sample_project.customer_nation
2020-06-30 15:37:46.727970 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 15:37:46.728170 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_unique_tpch_orders_o_custkey).
2020-06-30 15:37:46.728309 (Thread-1): Compiling model.sample_project.customer_nation
2020-06-30 15:37:46.742926 (Thread-1): Writing injected SQL for node "model.sample_project.customer_nation"
2020-06-30 15:37:46.743371 (Thread-1): finished collecting timing info
2020-06-30 15:37:46.743829 (Thread-1): Finished running node model.sample_project.customer_nation
2020-06-30 15:37:46.743989 (Thread-1): Began running node model.sample_project.orders_lineitem
2020-06-30 15:37:46.744383 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 15:37:46.744513 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer_nation).
2020-06-30 15:37:46.744627 (Thread-1): Compiling model.sample_project.orders_lineitem
2020-06-30 15:37:46.759117 (Thread-1): Writing injected SQL for node "model.sample_project.orders_lineitem"
2020-06-30 15:37:46.759511 (Thread-1): finished collecting timing info
2020-06-30 15:37:46.759949 (Thread-1): Finished running node model.sample_project.orders_lineitem
2020-06-30 15:37:46.760251 (Thread-1): Began running node model.sample_project.cust_list_ord_nat
2020-06-30 15:37:46.760547 (Thread-1): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 15:37:46.760649 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders_lineitem).
2020-06-30 15:37:46.760745 (Thread-1): Compiling model.sample_project.cust_list_ord_nat
2020-06-30 15:37:46.774819 (Thread-1): Writing injected SQL for node "model.sample_project.cust_list_ord_nat"
2020-06-30 15:37:46.775180 (Thread-1): finished collecting timing info
2020-06-30 15:37:46.775566 (Thread-1): Finished running node model.sample_project.cust_list_ord_nat
2020-06-30 15:37:46.868933 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 15:37:46.869308 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:37:46.869776 (MainThread): 10:37:46 | 
2020-06-30 15:37:46.870011 (MainThread): 10:37:46 | Finished running 9 tests in 19.74s.
2020-06-30 15:37:46.870210 (MainThread): Connection 'master' was properly closed.
2020-06-30 15:37:46.870362 (MainThread): Connection 'model.sample_project.cust_list_ord_nat' was left open.
2020-06-30 15:37:46.870514 (MainThread): On model.sample_project.cust_list_ord_nat: Close
2020-06-30 15:37:47.180740 (MainThread): 
2020-06-30 15:37:47.180915 (MainThread): Completed with 2 errors and 0 warnings:
2020-06-30 15:37:47.181038 (MainThread): 
2020-06-30 15:37:47.181156 (MainThread): Failure in test source_unique_tpch_customer_c_nationkey (models/source_reads/sources.yml)
2020-06-30 15:37:47.181291 (MainThread):   Got 25 results, expected 0.
2020-06-30 15:37:47.181398 (MainThread): 
2020-06-30 15:37:47.181558 (MainThread):   compiled SQL at target/compiled/sample_project/models/source_reads/sources.yml/schema_test/source_unique_tpch_customer_c_nationkey.sql
2020-06-30 15:37:47.181739 (MainThread): 
2020-06-30 15:37:47.181878 (MainThread): Failure in test source_unique_tpch_orders_o_custkey (models/source_reads/sources.yml)
2020-06-30 15:37:47.182050 (MainThread):   Got 99979 results, expected 0.
2020-06-30 15:37:47.182186 (MainThread): 
2020-06-30 15:37:47.182299 (MainThread):   compiled SQL at target/compiled/sample_project/models/source_reads/sources.yml/schema_test/source_unique_tpch_orders_o_custkey.sql
2020-06-30 15:37:47.182414 (MainThread): 
Done. PASS=7 WARN=0 ERROR=2 SKIP=0 TOTAL=9
2020-06-30 15:37:47.182586 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1aef50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d359790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d356190>]}
2020-06-30 15:37:47.182780 (MainThread): Flushing usage events
2020-06-30 15:41:16.219461 (MainThread): Running with dbt=0.17.0
2020-06-30 15:41:16.634630 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2020-06-30 15:41:16.635814 (MainThread): Tracking: tracking
2020-06-30 15:41:16.636111 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3a8190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed51bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed51390>]}
2020-06-30 15:41:16.657972 (MainThread): Partial parsing not enabled
2020-06-30 15:41:16.660067 (MainThread): Parsing macros/core.sql
2020-06-30 15:41:16.665394 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-30 15:41:16.674757 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-30 15:41:16.677456 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-30 15:41:16.697483 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-30 15:41:16.729615 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-30 15:41:16.753648 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-30 15:41:16.756203 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-30 15:41:16.764086 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-30 15:41:16.779014 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-30 15:41:16.786719 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-30 15:41:16.793694 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-30 15:41:16.799235 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-30 15:41:16.800384 (MainThread): Parsing macros/etc/query.sql
2020-06-30 15:41:16.801762 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-30 15:41:16.804633 (MainThread): Parsing macros/etc/datetime.sql
2020-06-30 15:41:16.814588 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-30 15:41:16.816890 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-30 15:41:16.818889 (MainThread): Parsing macros/adapters/common.sql
2020-06-30 15:41:16.874366 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-30 15:41:16.875790 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-30 15:41:16.877194 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-30 15:41:16.878658 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-30 15:41:16.881355 (MainThread): Parsing macros/catalog.sql
2020-06-30 15:41:16.883572 (MainThread): Parsing macros/adapters.sql
2020-06-30 15:41:16.908412 (MainThread): Parsing macros/materializations/merge.sql
2020-06-30 15:41:16.911166 (MainThread): Parsing macros/materializations/view.sql
2020-06-30 15:41:16.912635 (MainThread): Parsing macros/materializations/table.sql
2020-06-30 15:41:16.916975 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-30 15:41:16.957146 (MainThread): Partial parsing not enabled
2020-06-30 15:41:16.957814 (MainThread): Parsing macros/test_is_nonnegative.sql
2020-06-30 15:41:16.960770 (MainThread): Parsing macros/cross_db_utils/except.sql
2020-06-30 15:41:16.962187 (MainThread): Parsing macros/cross_db_utils/replace.sql
2020-06-30 15:41:16.963883 (MainThread): Parsing macros/cross_db_utils/concat.sql
2020-06-30 15:41:16.966442 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2020-06-30 15:41:16.973105 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2020-06-30 15:41:16.974670 (MainThread): Parsing macros/cross_db_utils/length.sql
2020-06-30 15:41:16.976250 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2020-06-30 15:41:16.979982 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2020-06-30 15:41:16.981295 (MainThread): Parsing macros/cross_db_utils/right.sql
2020-06-30 15:41:16.984351 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2020-06-30 15:41:16.995180 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2020-06-30 15:41:16.999545 (MainThread): Parsing macros/cross_db_utils/hash.sql
2020-06-30 15:41:17.001374 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2020-06-30 15:41:17.003204 (MainThread): Parsing macros/cross_db_utils/position.sql
2020-06-30 15:41:17.005313 (MainThread): Parsing macros/cross_db_utils/literal.sql
2020-06-30 15:41:17.006497 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2020-06-30 15:41:17.010424 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2020-06-30 15:41:17.016656 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2020-06-30 15:41:17.020200 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2020-06-30 15:41:17.022391 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2020-06-30 15:41:17.024199 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2020-06-30 15:41:17.051496 (MainThread): Parsing macros/logger/pretty_log_format.sql
2020-06-30 15:41:17.053168 (MainThread): Parsing macros/logger/pretty_time.sql
2020-06-30 15:41:17.054505 (MainThread): Parsing macros/logger/log_info.sql
2020-06-30 15:41:17.056205 (MainThread): Parsing macros/datetime/date_spine.sql
2020-06-30 15:41:17.062464 (MainThread): Parsing macros/web/get_url_host.sql
2020-06-30 15:41:17.064498 (MainThread): Parsing macros/web/get_url_path.sql
2020-06-30 15:41:17.067037 (MainThread): Parsing macros/web/get_url_parameter.sql
2020-06-30 15:41:17.068503 (MainThread): Parsing macros/geo/haversine_distance.sql
2020-06-30 15:41:17.069675 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2020-06-30 15:41:17.071346 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2020-06-30 15:41:17.073571 (MainThread): Parsing macros/schema_tests/recency.sql
2020-06-30 15:41:17.075174 (MainThread): Parsing macros/schema_tests/not_constant.sql
2020-06-30 15:41:17.076596 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2020-06-30 15:41:17.077896 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2020-06-30 15:41:17.079377 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2020-06-30 15:41:17.081147 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2020-06-30 15:41:17.082620 (MainThread): Parsing macros/schema_tests/equality.sql
2020-06-30 15:41:17.086146 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2020-06-30 15:41:17.092931 (MainThread): Parsing macros/sql/nullcheck_table.sql
2020-06-30 15:41:17.094301 (MainThread): Parsing macros/sql/generate_series.sql
2020-06-30 15:41:17.098587 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2020-06-30 15:41:17.103242 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2020-06-30 15:41:17.107122 (MainThread): Parsing macros/sql/star.sql
2020-06-30 15:41:17.110605 (MainThread): Parsing macros/sql/unpivot.sql
2020-06-30 15:41:17.117878 (MainThread): Parsing macros/sql/union.sql
2020-06-30 15:41:17.128223 (MainThread): Parsing macros/sql/groupby.sql
2020-06-30 15:41:17.129919 (MainThread): Parsing macros/sql/surrogate_key.sql
2020-06-30 15:41:17.133751 (MainThread): Parsing macros/sql/safe_add.sql
2020-06-30 15:41:17.136109 (MainThread): Parsing macros/sql/nullcheck.sql
2020-06-30 15:41:17.138351 (MainThread): Parsing macros/sql/get_column_values.sql
2020-06-30 15:41:17.145119 (MainThread): Parsing macros/sql/pivot.sql
2020-06-30 15:41:17.149588 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2020-06-30 15:41:17.201409 (MainThread): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 15:41:17.201540 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:41:17.232229 (MainThread): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 15:41:17.232334 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:41:17.244421 (MainThread): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 15:41:17.244516 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:41:17.256260 (MainThread): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 15:41:17.256364 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:41:17.268277 (MainThread): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 15:41:17.268373 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:41:17.281162 (MainThread): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 15:41:17.281258 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:41:17.294057 (MainThread): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 15:41:17.294153 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:41:17.307747 (MainThread): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 15:41:17.307839 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:41:17.320504 (MainThread): Acquiring new snowflake connection "model.sample_project.sales_report_one".
2020-06-30 15:41:17.320630 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:41:17.332425 (MainThread): Acquiring new snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 15:41:17.332550 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:41:17.349559 (MainThread): Acquiring new snowflake connection "model.sample_project.sales_report_two".
2020-06-30 15:41:17.349664 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:41:17.363055 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f629750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f6ba5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f6baad0>]}
2020-06-30 15:41:17.363343 (MainThread): Flushing usage events
2020-06-30 15:41:17.850586 (MainThread): Connection 'model.sample_project.sales_report_two' was properly closed.
2020-06-30 15:41:17.850836 (MainThread): Encountered an error:
2020-06-30 15:41:17.851023 (MainThread): Compilation Error
  Error reading sample_project: source_reads/sources.yml - Runtime Error
    Syntax error near line 44
    ------------------------------
    41 |       - name: orders
    42 |         columns:
    43 |           - name: o_orderkey
    44 |               tests:
    45 |                 - unique
    46 |           - name: o_custkey
    47 |             tests:
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 44, column 20
2020-06-30 15:41:17.857511 (MainThread): Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/yaml_helper.py", line 62, in load_yaml_text
    return safe_load(contents)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/yaml_helper.py", line 57, in safe_load
    return yaml.load(contents, Loader=YamlLoader)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/yaml/__init__.py", line 114, in load
    return loader.get_single_data()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/yaml/constructor.py", line 49, in get_single_data
    node = self.get_single_node()
  File "ext/_yaml.pyx", line 707, in _yaml.CParser.get_single_node
  File "ext/_yaml.pyx", line 725, in _yaml.CParser._compose_document
  File "ext/_yaml.pyx", line 776, in _yaml.CParser._compose_node
  File "ext/_yaml.pyx", line 890, in _yaml.CParser._compose_mapping_node
  File "ext/_yaml.pyx", line 774, in _yaml.CParser._compose_node
  File "ext/_yaml.pyx", line 851, in _yaml.CParser._compose_sequence_node
  File "ext/_yaml.pyx", line 776, in _yaml.CParser._compose_node
  File "ext/_yaml.pyx", line 890, in _yaml.CParser._compose_mapping_node
  File "ext/_yaml.pyx", line 774, in _yaml.CParser._compose_node
  File "ext/_yaml.pyx", line 851, in _yaml.CParser._compose_sequence_node
  File "ext/_yaml.pyx", line 776, in _yaml.CParser._compose_node
  File "ext/_yaml.pyx", line 890, in _yaml.CParser._compose_mapping_node
  File "ext/_yaml.pyx", line 774, in _yaml.CParser._compose_node
  File "ext/_yaml.pyx", line 851, in _yaml.CParser._compose_sequence_node
  File "ext/_yaml.pyx", line 776, in _yaml.CParser._compose_node
  File "ext/_yaml.pyx", line 892, in _yaml.CParser._compose_mapping_node
  File "ext/_yaml.pyx", line 905, in _yaml.CParser._parse_next_event
yaml.scanner.ScannerError: mapping values are not allowed in this context
  in "<unicode string>", line 44, column 20

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/schemas.py", line 213, in _yaml_from_file
    return load_yaml_text(source_file.contents)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/yaml_helper.py", line 69, in load_yaml_text
    raise dbt.exceptions.ValidationException(error)
dbt.exceptions.ValidationException: Runtime Error
  Syntax error near line 44
  ------------------------------
  41 |       - name: orders
  42 |         columns:
  43 |           - name: o_orderkey
  44 |               tests:
  45 |                 - unique
  46 |           - name: o_custkey
  47 |             tests:
  
  Raw Error:
  ------------------------------
  mapping values are not allowed in this context
    in "<unicode string>", line 44, column 20

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/main.py", line 81, in main
    results, succeeded = handle_and_check(args)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/main.py", line 159, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/main.py", line 212, in run_from_args
    results = task.run()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/task/runnable.py", line 389, in run
    self._runtime_initialize()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/task/runnable.py", line 103, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/task/runnable.py", line 71, in _runtime_initialize
    self.load_manifest()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/task/runnable.py", line 60, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/perf_utils.py", line 23, in get_full_manifest
    return load_manifest(config, internal, set_header)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/manifest.py", line 641, in load_manifest
    return ManifestLoader.load_all(config, internal_manifest, macro_hook)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/manifest.py", line 356, in load_all
    loader.load(internal_manifest=internal_manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/manifest.py", line 212, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/manifest.py", line 186, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/manifest.py", line 142, in parse_with_cache
    parser.parse_file(block)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/schemas.py", line 506, in parse_file
    dct = self._yaml_from_file(block.file)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/schemas.py", line 218, in _yaml_from_file
    .format(self.project.project_name, path, reason)
dbt.exceptions.CompilationException: Compilation Error
  Error reading sample_project: source_reads/sources.yml - Runtime Error
    Syntax error near line 44
    ------------------------------
    41 |       - name: orders
    42 |         columns:
    43 |           - name: o_orderkey
    44 |               tests:
    45 |                 - unique
    46 |           - name: o_custkey
    47 |             tests:
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 44, column 20

2020-06-30 15:41:40.901112 (MainThread): Running with dbt=0.17.0
2020-06-30 15:41:41.214916 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2020-06-30 15:41:41.215781 (MainThread): Tracking: tracking
2020-06-30 15:41:41.216056 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051b3b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051b3350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051b3a50>]}
2020-06-30 15:41:41.236504 (MainThread): Partial parsing not enabled
2020-06-30 15:41:41.238394 (MainThread): Parsing macros/core.sql
2020-06-30 15:41:41.243939 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-30 15:41:41.252803 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-30 15:41:41.254873 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-30 15:41:41.273572 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-30 15:41:41.306031 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-30 15:41:41.328046 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-30 15:41:41.329971 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-30 15:41:41.336937 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-30 15:41:41.351414 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-30 15:41:41.360327 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-30 15:41:41.367049 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-30 15:41:41.372600 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-30 15:41:41.373585 (MainThread): Parsing macros/etc/query.sql
2020-06-30 15:41:41.374761 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-30 15:41:41.376484 (MainThread): Parsing macros/etc/datetime.sql
2020-06-30 15:41:41.386162 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-30 15:41:41.388218 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-30 15:41:41.389929 (MainThread): Parsing macros/adapters/common.sql
2020-06-30 15:41:41.449594 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-30 15:41:41.450914 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-30 15:41:41.451846 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-30 15:41:41.453077 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-30 15:41:41.455555 (MainThread): Parsing macros/catalog.sql
2020-06-30 15:41:41.457859 (MainThread): Parsing macros/adapters.sql
2020-06-30 15:41:41.482042 (MainThread): Parsing macros/materializations/merge.sql
2020-06-30 15:41:41.484766 (MainThread): Parsing macros/materializations/view.sql
2020-06-30 15:41:41.486156 (MainThread): Parsing macros/materializations/table.sql
2020-06-30 15:41:41.490700 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-30 15:41:41.530088 (MainThread): Partial parsing not enabled
2020-06-30 15:41:41.530439 (MainThread): Parsing macros/test_is_nonnegative.sql
2020-06-30 15:41:41.532785 (MainThread): Parsing macros/cross_db_utils/except.sql
2020-06-30 15:41:41.534067 (MainThread): Parsing macros/cross_db_utils/replace.sql
2020-06-30 15:41:41.535474 (MainThread): Parsing macros/cross_db_utils/concat.sql
2020-06-30 15:41:41.537762 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2020-06-30 15:41:41.543667 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2020-06-30 15:41:41.544966 (MainThread): Parsing macros/cross_db_utils/length.sql
2020-06-30 15:41:41.546368 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2020-06-30 15:41:41.548994 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2020-06-30 15:41:41.550059 (MainThread): Parsing macros/cross_db_utils/right.sql
2020-06-30 15:41:41.552503 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2020-06-30 15:41:41.562911 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2020-06-30 15:41:41.565782 (MainThread): Parsing macros/cross_db_utils/hash.sql
2020-06-30 15:41:41.567476 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2020-06-30 15:41:41.568964 (MainThread): Parsing macros/cross_db_utils/position.sql
2020-06-30 15:41:41.570621 (MainThread): Parsing macros/cross_db_utils/literal.sql
2020-06-30 15:41:41.571577 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2020-06-30 15:41:41.574961 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2020-06-30 15:41:41.580491 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2020-06-30 15:41:41.583607 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2020-06-30 15:41:41.585548 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2020-06-30 15:41:41.587185 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2020-06-30 15:41:41.616123 (MainThread): Parsing macros/logger/pretty_log_format.sql
2020-06-30 15:41:41.616890 (MainThread): Parsing macros/logger/pretty_time.sql
2020-06-30 15:41:41.617751 (MainThread): Parsing macros/logger/log_info.sql
2020-06-30 15:41:41.618516 (MainThread): Parsing macros/datetime/date_spine.sql
2020-06-30 15:41:41.622193 (MainThread): Parsing macros/web/get_url_host.sql
2020-06-30 15:41:41.623713 (MainThread): Parsing macros/web/get_url_path.sql
2020-06-30 15:41:41.626079 (MainThread): Parsing macros/web/get_url_parameter.sql
2020-06-30 15:41:41.627286 (MainThread): Parsing macros/geo/haversine_distance.sql
2020-06-30 15:41:41.628374 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2020-06-30 15:41:41.629747 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2020-06-30 15:41:41.632044 (MainThread): Parsing macros/schema_tests/recency.sql
2020-06-30 15:41:41.633517 (MainThread): Parsing macros/schema_tests/not_constant.sql
2020-06-30 15:41:41.634582 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2020-06-30 15:41:41.635676 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2020-06-30 15:41:41.636938 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2020-06-30 15:41:41.638619 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2020-06-30 15:41:41.639741 (MainThread): Parsing macros/schema_tests/equality.sql
2020-06-30 15:41:41.642855 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2020-06-30 15:41:41.648766 (MainThread): Parsing macros/sql/nullcheck_table.sql
2020-06-30 15:41:41.649826 (MainThread): Parsing macros/sql/generate_series.sql
2020-06-30 15:41:41.653295 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2020-06-30 15:41:41.658508 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2020-06-30 15:41:41.661478 (MainThread): Parsing macros/sql/star.sql
2020-06-30 15:41:41.664282 (MainThread): Parsing macros/sql/unpivot.sql
2020-06-30 15:41:41.670797 (MainThread): Parsing macros/sql/union.sql
2020-06-30 15:41:41.680720 (MainThread): Parsing macros/sql/groupby.sql
2020-06-30 15:41:41.681876 (MainThread): Parsing macros/sql/surrogate_key.sql
2020-06-30 15:41:41.684911 (MainThread): Parsing macros/sql/safe_add.sql
2020-06-30 15:41:41.685993 (MainThread): Parsing macros/sql/nullcheck.sql
2020-06-30 15:41:41.687523 (MainThread): Parsing macros/sql/get_column_values.sql
2020-06-30 15:41:41.691797 (MainThread): Parsing macros/sql/pivot.sql
2020-06-30 15:41:41.694583 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2020-06-30 15:41:41.744850 (MainThread): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 15:41:41.744977 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:41:41.775943 (MainThread): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 15:41:41.776046 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:41:41.787532 (MainThread): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 15:41:41.787619 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:41:41.800108 (MainThread): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 15:41:41.800205 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:41:41.813851 (MainThread): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 15:41:41.813953 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:41:41.826376 (MainThread): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 15:41:41.826468 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:41:41.839161 (MainThread): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 15:41:41.839252 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:41:41.851594 (MainThread): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 15:41:41.851684 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:41:41.866643 (MainThread): Acquiring new snowflake connection "model.sample_project.sales_report_one".
2020-06-30 15:41:41.866768 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:41:41.878873 (MainThread): Acquiring new snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 15:41:41.878976 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:41:41.894259 (MainThread): Acquiring new snowflake connection "model.sample_project.sales_report_two".
2020-06-30 15:41:41.894354 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:41:42.360501 (MainThread): Found 11 models, 8 tests, 0 snapshots, 0 analyses, 264 macros, 0 operations, 0 seed files, 4 sources
2020-06-30 15:41:42.362171 (MainThread): 
2020-06-30 15:41:42.362480 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 15:41:42.362565 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:41:42.386698 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 15:41:42.386967 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-06-30 15:41:42.400413 (ThreadPoolExecutor-1_0): Using snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 15:41:42.400645 (ThreadPoolExecutor-1_0): On list_JAVEN_TESTING_TEST: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING_TEST"} */

    show terse objects in JAVEN_TESTING.TEST
2020-06-30 15:41:42.872570 (ThreadPoolExecutor-1_0): unclosed file <_io.BufferedReader name='/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/certifi/cacert.pem'>
2020-06-30 15:41:48.139389 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 10 in 5.74 seconds
2020-06-30 15:41:48.155057 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 15:41:48.155175 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:41:48.155416 (MainThread): 10:41:48 | Concurrency: 1 threads (target='dev')
2020-06-30 15:41:48.155550 (MainThread): 10:41:48 | 
2020-06-30 15:41:48.156561 (Thread-1): Began running node model.sample_project.customer
2020-06-30 15:41:48.156866 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 15:41:48.156972 (Thread-1): Re-using an available connection from the pool (formerly list_JAVEN_TESTING_TEST).
2020-06-30 15:41:48.157075 (Thread-1): Compiling model.sample_project.customer
2020-06-30 15:41:48.173125 (Thread-1): Writing injected SQL for node "model.sample_project.customer"
2020-06-30 15:41:48.173458 (Thread-1): finished collecting timing info
2020-06-30 15:41:48.173809 (Thread-1): Finished running node model.sample_project.customer
2020-06-30 15:41:48.173928 (Thread-1): Began running node model.sample_project.lineitem
2020-06-30 15:41:48.174138 (Thread-1): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 15:41:48.174223 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer).
2020-06-30 15:41:48.174384 (Thread-1): Compiling model.sample_project.lineitem
2020-06-30 15:41:48.183691 (Thread-1): Writing injected SQL for node "model.sample_project.lineitem"
2020-06-30 15:41:48.184373 (Thread-1): finished collecting timing info
2020-06-30 15:41:48.184829 (Thread-1): Finished running node model.sample_project.lineitem
2020-06-30 15:41:48.184979 (Thread-1): Began running node model.sample_project.nation
2020-06-30 15:41:48.185328 (Thread-1): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 15:41:48.185605 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.lineitem).
2020-06-30 15:41:48.185706 (Thread-1): Compiling model.sample_project.nation
2020-06-30 15:41:48.195404 (Thread-1): Writing injected SQL for node "model.sample_project.nation"
2020-06-30 15:41:48.195819 (Thread-1): finished collecting timing info
2020-06-30 15:41:48.196308 (Thread-1): Finished running node model.sample_project.nation
2020-06-30 15:41:48.196475 (Thread-1): Began running node model.sample_project.orders
2020-06-30 15:41:48.196866 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 15:41:48.196962 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.nation).
2020-06-30 15:41:48.197044 (Thread-1): Compiling model.sample_project.orders
2020-06-30 15:41:48.203444 (Thread-1): Writing injected SQL for node "model.sample_project.orders"
2020-06-30 15:41:48.203715 (Thread-1): finished collecting timing info
2020-06-30 15:41:48.204039 (Thread-1): Finished running node model.sample_project.orders
2020-06-30 15:41:48.204156 (Thread-1): Began running node test.sample_project.source_is_nonnegative_tpch_customer_c_custkey
2020-06-30 15:41:48.204339 (Thread-1): 10:41:48 | 1 of 8 START test source_is_nonnegative_tpch_customer_c_custkey...... [RUN]
2020-06-30 15:41:48.204629 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_nonnegative_tpch_customer_c_custkey".
2020-06-30 15:41:48.204736 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders).
2020-06-30 15:41:48.204829 (Thread-1): Compiling test.sample_project.source_is_nonnegative_tpch_customer_c_custkey
2020-06-30 15:41:48.217645 (Thread-1): Writing injected SQL for node "test.sample_project.source_is_nonnegative_tpch_customer_c_custkey"
2020-06-30 15:41:48.218040 (Thread-1): finished collecting timing info
2020-06-30 15:41:48.218583 (Thread-1): Using snowflake connection "test.sample_project.source_is_nonnegative_tpch_customer_c_custkey".
2020-06-30 15:41:48.218669 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_customer_c_custkey: BEGIN
2020-06-30 15:41:48.697432 (Thread-1): SQL status: SUCCESS 1 in 0.48 seconds
2020-06-30 15:41:48.697644 (Thread-1): Using snowflake connection "test.sample_project.source_is_nonnegative_tpch_customer_c_custkey".
2020-06-30 15:41:48.697783 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_customer_c_custkey: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "test.sample_project.source_is_nonnegative_tpch_customer_c_custkey"} */


with validation as (

    select
        c_custkey as negative

    from snowflake_sample_data.tpch_sf1.customer

),

validation_errors as (

    select
        negative

    from validation
    -- if this is true, then even_field is actually odd!
    where negative < 0

)

select count(*)
from validation_errors
2020-06-30 15:41:48.963180 (Thread-1): SQL status: SUCCESS 1 in 0.27 seconds
2020-06-30 15:41:48.964520 (Thread-1): finished collecting timing info
2020-06-30 15:41:48.964832 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_customer_c_custkey: ROLLBACK
2020-06-30 15:41:48.964941 (Thread-1): initiating rollback
2020-06-30 15:41:49.251304 (Thread-1): 10:41:49 | 1 of 8 PASS source_is_nonnegative_tpch_customer_c_custkey............ [PASS in 1.05s]
2020-06-30 15:41:49.251485 (Thread-1): Finished running node test.sample_project.source_is_nonnegative_tpch_customer_c_custkey
2020-06-30 15:41:49.251624 (Thread-1): Began running node test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey
2020-06-30 15:41:49.251828 (Thread-1): 10:41:49 | 2 of 8 START test source_is_nonnegative_tpch_customer_c_nationkey.... [RUN]
2020-06-30 15:41:49.252114 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey".
2020-06-30 15:41:49.252205 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_nonnegative_tpch_customer_c_custkey).
2020-06-30 15:41:49.252296 (Thread-1): Compiling test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey
2020-06-30 15:41:49.262403 (Thread-1): Writing injected SQL for node "test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey"
2020-06-30 15:41:49.262733 (Thread-1): finished collecting timing info
2020-06-30 15:41:49.263298 (Thread-1): Using snowflake connection "test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey".
2020-06-30 15:41:49.263385 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey: BEGIN
2020-06-30 15:41:49.520913 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2020-06-30 15:41:49.525841 (Thread-1): Using snowflake connection "test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey".
2020-06-30 15:41:49.526020 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey"} */


with validation as (

    select
        c_nationkey as negative

    from snowflake_sample_data.tpch_sf1.customer

),

validation_errors as (

    select
        negative

    from validation
    -- if this is true, then even_field is actually odd!
    where negative < 0

)

select count(*)
from validation_errors
2020-06-30 15:41:50.150868 (Thread-1): SQL status: SUCCESS 1 in 0.62 seconds
2020-06-30 15:41:50.151333 (Thread-1): finished collecting timing info
2020-06-30 15:41:50.151719 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey: ROLLBACK
2020-06-30 15:41:50.151854 (Thread-1): initiating rollback
2020-06-30 15:41:50.397887 (Thread-1): 10:41:50 | 2 of 8 PASS source_is_nonnegative_tpch_customer_c_nationkey.......... [PASS in 1.15s]
2020-06-30 15:41:50.398139 (Thread-1): Finished running node test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey
2020-06-30 15:41:50.398340 (Thread-1): Began running node test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice
2020-06-30 15:41:50.398641 (Thread-1): 10:41:50 | 3 of 8 START test source_is_nonnegative_tpch_lineitem_l_extendedprice [RUN]
2020-06-30 15:41:50.399027 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice".
2020-06-30 15:41:50.399166 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey).
2020-06-30 15:41:50.399304 (Thread-1): Compiling test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice
2020-06-30 15:41:50.409866 (Thread-1): Writing injected SQL for node "test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice"
2020-06-30 15:41:50.410327 (Thread-1): finished collecting timing info
2020-06-30 15:41:50.410986 (Thread-1): Using snowflake connection "test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice".
2020-06-30 15:41:50.411091 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice: BEGIN
2020-06-30 15:41:50.601319 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2020-06-30 15:41:50.601590 (Thread-1): Using snowflake connection "test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice".
2020-06-30 15:41:50.601763 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice"} */


with validation as (

    select
        l_extendedprice as negative

    from snowflake_sample_data.tpch_sf1.lineitem

),

validation_errors as (

    select
        negative

    from validation
    -- if this is true, then even_field is actually odd!
    where negative < 0

)

select count(*)
from validation_errors
2020-06-30 15:41:50.913355 (Thread-1): SQL status: SUCCESS 1 in 0.31 seconds
2020-06-30 15:41:50.913851 (Thread-1): finished collecting timing info
2020-06-30 15:41:50.914297 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice: ROLLBACK
2020-06-30 15:41:50.914432 (Thread-1): initiating rollback
2020-06-30 15:41:51.379074 (Thread-1): 10:41:51 | 3 of 8 PASS source_is_nonnegative_tpch_lineitem_l_extendedprice...... [PASS in 0.98s]
2020-06-30 15:41:51.379351 (Thread-1): Finished running node test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice
2020-06-30 15:41:51.379551 (Thread-1): Began running node test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey
2020-06-30 15:41:51.379869 (Thread-1): 10:41:51 | 4 of 8 START test source_is_nonnegative_tpch_nation_n_nationkey...... [RUN]
2020-06-30 15:41:51.380279 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey".
2020-06-30 15:41:51.380420 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice).
2020-06-30 15:41:51.380559 (Thread-1): Compiling test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey
2020-06-30 15:41:51.391422 (Thread-1): Writing injected SQL for node "test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey"
2020-06-30 15:41:51.391870 (Thread-1): finished collecting timing info
2020-06-30 15:41:51.392527 (Thread-1): Using snowflake connection "test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey".
2020-06-30 15:41:51.392632 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey: BEGIN
2020-06-30 15:41:51.618290 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2020-06-30 15:41:51.618539 (Thread-1): Using snowflake connection "test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey".
2020-06-30 15:41:51.618712 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey"} */


with validation as (

    select
        n_nationkey as negative

    from snowflake_sample_data.tpch_sf1.nation

),

validation_errors as (

    select
        negative

    from validation
    -- if this is true, then even_field is actually odd!
    where negative < 0

)

select count(*)
from validation_errors
2020-06-30 15:41:51.996928 (Thread-1): SQL status: SUCCESS 1 in 0.38 seconds
2020-06-30 15:41:51.997352 (Thread-1): finished collecting timing info
2020-06-30 15:41:51.997730 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey: ROLLBACK
2020-06-30 15:41:51.997866 (Thread-1): initiating rollback
2020-06-30 15:41:52.403362 (Thread-1): 10:41:52 | 4 of 8 PASS source_is_nonnegative_tpch_nation_n_nationkey............ [PASS in 1.02s]
2020-06-30 15:41:52.403666 (Thread-1): Finished running node test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey
2020-06-30 15:41:52.403933 (Thread-1): Began running node test.sample_project.source_is_nonnegative_tpch_orders_o_custkey
2020-06-30 15:41:52.404352 (Thread-1): 10:41:52 | 5 of 8 START test source_is_nonnegative_tpch_orders_o_custkey........ [RUN]
2020-06-30 15:41:52.404825 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_nonnegative_tpch_orders_o_custkey".
2020-06-30 15:41:52.404964 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey).
2020-06-30 15:41:52.405099 (Thread-1): Compiling test.sample_project.source_is_nonnegative_tpch_orders_o_custkey
2020-06-30 15:41:52.416837 (Thread-1): Writing injected SQL for node "test.sample_project.source_is_nonnegative_tpch_orders_o_custkey"
2020-06-30 15:41:52.417275 (Thread-1): finished collecting timing info
2020-06-30 15:41:52.417951 (Thread-1): Using snowflake connection "test.sample_project.source_is_nonnegative_tpch_orders_o_custkey".
2020-06-30 15:41:52.418057 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_orders_o_custkey: BEGIN
2020-06-30 15:41:52.745047 (Thread-1): SQL status: SUCCESS 1 in 0.33 seconds
2020-06-30 15:41:52.745306 (Thread-1): Using snowflake connection "test.sample_project.source_is_nonnegative_tpch_orders_o_custkey".
2020-06-30 15:41:52.745476 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_orders_o_custkey: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "test.sample_project.source_is_nonnegative_tpch_orders_o_custkey"} */


with validation as (

    select
        o_custkey as negative

    from snowflake_sample_data.tpch_sf1.orders

),

validation_errors as (

    select
        negative

    from validation
    -- if this is true, then even_field is actually odd!
    where negative < 0

)

select count(*)
from validation_errors
2020-06-30 15:41:53.227325 (Thread-1): SQL status: SUCCESS 1 in 0.48 seconds
2020-06-30 15:41:53.227829 (Thread-1): finished collecting timing info
2020-06-30 15:41:53.228292 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_orders_o_custkey: ROLLBACK
2020-06-30 15:41:53.228462 (Thread-1): initiating rollback
2020-06-30 15:41:53.504108 (Thread-1): 10:41:53 | 5 of 8 PASS source_is_nonnegative_tpch_orders_o_custkey.............. [PASS in 1.10s]
2020-06-30 15:41:53.504305 (Thread-1): Finished running node test.sample_project.source_is_nonnegative_tpch_orders_o_custkey
2020-06-30 15:41:53.504470 (Thread-1): Began running node test.sample_project.source_unique_tpch_customer_c_custkey
2020-06-30 15:41:53.504712 (Thread-1): 10:41:53 | 6 of 8 START test source_unique_tpch_customer_c_custkey.............. [RUN]
2020-06-30 15:41:53.505026 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_unique_tpch_customer_c_custkey".
2020-06-30 15:41:53.505137 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_nonnegative_tpch_orders_o_custkey).
2020-06-30 15:41:53.505248 (Thread-1): Compiling test.sample_project.source_unique_tpch_customer_c_custkey
2020-06-30 15:41:53.515112 (Thread-1): Writing injected SQL for node "test.sample_project.source_unique_tpch_customer_c_custkey"
2020-06-30 15:41:53.515467 (Thread-1): finished collecting timing info
2020-06-30 15:41:53.516073 (Thread-1): Using snowflake connection "test.sample_project.source_unique_tpch_customer_c_custkey".
2020-06-30 15:41:53.516176 (Thread-1): On test.sample_project.source_unique_tpch_customer_c_custkey: BEGIN
2020-06-30 15:41:53.794024 (Thread-1): SQL status: SUCCESS 1 in 0.28 seconds
2020-06-30 15:41:53.794262 (Thread-1): Using snowflake connection "test.sample_project.source_unique_tpch_customer_c_custkey".
2020-06-30 15:41:53.794398 (Thread-1): On test.sample_project.source_unique_tpch_customer_c_custkey: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "test.sample_project.source_unique_tpch_customer_c_custkey"} */




select count(*) as validation_errors
from (

    select
        c_custkey

    from snowflake_sample_data.tpch_sf1.customer
    where c_custkey is not null
    group by c_custkey
    having count(*) > 1

) validation_errors
2020-06-30 15:41:54.067322 (Thread-1): SQL status: SUCCESS 1 in 0.27 seconds
2020-06-30 15:41:54.067825 (Thread-1): finished collecting timing info
2020-06-30 15:41:54.068296 (Thread-1): On test.sample_project.source_unique_tpch_customer_c_custkey: ROLLBACK
2020-06-30 15:41:54.068463 (Thread-1): initiating rollback
2020-06-30 15:41:54.451429 (Thread-1): 10:41:54 | 6 of 8 PASS source_unique_tpch_customer_c_custkey.................... [PASS in 0.95s]
2020-06-30 15:41:54.451734 (Thread-1): Finished running node test.sample_project.source_unique_tpch_customer_c_custkey
2020-06-30 15:41:54.451993 (Thread-1): Began running node test.sample_project.source_unique_tpch_nation_n_nationkey
2020-06-30 15:41:54.452385 (Thread-1): 10:41:54 | 7 of 8 START test source_unique_tpch_nation_n_nationkey.............. [RUN]
2020-06-30 15:41:54.452903 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_unique_tpch_nation_n_nationkey".
2020-06-30 15:41:54.453046 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_unique_tpch_customer_c_custkey).
2020-06-30 15:41:54.453185 (Thread-1): Compiling test.sample_project.source_unique_tpch_nation_n_nationkey
2020-06-30 15:41:54.464069 (Thread-1): Writing injected SQL for node "test.sample_project.source_unique_tpch_nation_n_nationkey"
2020-06-30 15:41:54.464440 (Thread-1): finished collecting timing info
2020-06-30 15:41:54.465053 (Thread-1): Using snowflake connection "test.sample_project.source_unique_tpch_nation_n_nationkey".
2020-06-30 15:41:54.465156 (Thread-1): On test.sample_project.source_unique_tpch_nation_n_nationkey: BEGIN
2020-06-30 15:41:54.669488 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2020-06-30 15:41:54.669747 (Thread-1): Using snowflake connection "test.sample_project.source_unique_tpch_nation_n_nationkey".
2020-06-30 15:41:54.669916 (Thread-1): On test.sample_project.source_unique_tpch_nation_n_nationkey: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "test.sample_project.source_unique_tpch_nation_n_nationkey"} */




select count(*) as validation_errors
from (

    select
        n_nationkey

    from snowflake_sample_data.tpch_sf1.nation
    where n_nationkey is not null
    group by n_nationkey
    having count(*) > 1

) validation_errors
2020-06-30 15:41:55.068428 (Thread-1): SQL status: SUCCESS 1 in 0.40 seconds
2020-06-30 15:41:55.068768 (Thread-1): finished collecting timing info
2020-06-30 15:41:55.069076 (Thread-1): On test.sample_project.source_unique_tpch_nation_n_nationkey: ROLLBACK
2020-06-30 15:41:55.069183 (Thread-1): initiating rollback
2020-06-30 15:41:55.401803 (Thread-1): 10:41:55 | 7 of 8 PASS source_unique_tpch_nation_n_nationkey.................... [PASS in 0.95s]
2020-06-30 15:41:55.402054 (Thread-1): Finished running node test.sample_project.source_unique_tpch_nation_n_nationkey
2020-06-30 15:41:55.402263 (Thread-1): Began running node test.sample_project.source_unique_tpch_orders_o_orderkey
2020-06-30 15:41:55.402607 (Thread-1): 10:41:55 | 8 of 8 START test source_unique_tpch_orders_o_orderkey............... [RUN]
2020-06-30 15:41:55.403002 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_unique_tpch_orders_o_orderkey".
2020-06-30 15:41:55.403140 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_unique_tpch_nation_n_nationkey).
2020-06-30 15:41:55.403277 (Thread-1): Compiling test.sample_project.source_unique_tpch_orders_o_orderkey
2020-06-30 15:41:55.413409 (Thread-1): Writing injected SQL for node "test.sample_project.source_unique_tpch_orders_o_orderkey"
2020-06-30 15:41:55.413805 (Thread-1): finished collecting timing info
2020-06-30 15:41:55.414414 (Thread-1): Using snowflake connection "test.sample_project.source_unique_tpch_orders_o_orderkey".
2020-06-30 15:41:55.414517 (Thread-1): On test.sample_project.source_unique_tpch_orders_o_orderkey: BEGIN
2020-06-30 15:41:55.638806 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2020-06-30 15:41:55.639069 (Thread-1): Using snowflake connection "test.sample_project.source_unique_tpch_orders_o_orderkey".
2020-06-30 15:41:55.639244 (Thread-1): On test.sample_project.source_unique_tpch_orders_o_orderkey: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "test.sample_project.source_unique_tpch_orders_o_orderkey"} */




select count(*) as validation_errors
from (

    select
        o_orderkey

    from snowflake_sample_data.tpch_sf1.orders
    where o_orderkey is not null
    group by o_orderkey
    having count(*) > 1

) validation_errors
2020-06-30 15:41:56.912468 (Thread-1): SQL status: SUCCESS 1 in 1.27 seconds
2020-06-30 15:41:56.912963 (Thread-1): finished collecting timing info
2020-06-30 15:41:56.913434 (Thread-1): On test.sample_project.source_unique_tpch_orders_o_orderkey: ROLLBACK
2020-06-30 15:41:56.913602 (Thread-1): initiating rollback
2020-06-30 15:41:57.318804 (Thread-1): 10:41:57 | 8 of 8 PASS source_unique_tpch_orders_o_orderkey..................... [PASS in 1.92s]
2020-06-30 15:41:57.319108 (Thread-1): Finished running node test.sample_project.source_unique_tpch_orders_o_orderkey
2020-06-30 15:41:57.319360 (Thread-1): Began running node model.sample_project.customer_nation
2020-06-30 15:41:57.319976 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 15:41:57.320174 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_unique_tpch_orders_o_orderkey).
2020-06-30 15:41:57.320369 (Thread-1): Compiling model.sample_project.customer_nation
2020-06-30 15:41:57.333943 (Thread-1): Writing injected SQL for node "model.sample_project.customer_nation"
2020-06-30 15:41:57.334340 (Thread-1): finished collecting timing info
2020-06-30 15:41:57.334742 (Thread-1): Finished running node model.sample_project.customer_nation
2020-06-30 15:41:57.334881 (Thread-1): Began running node model.sample_project.orders_lineitem
2020-06-30 15:41:57.335224 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 15:41:57.335339 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer_nation).
2020-06-30 15:41:57.335434 (Thread-1): Compiling model.sample_project.orders_lineitem
2020-06-30 15:41:57.348078 (Thread-1): Writing injected SQL for node "model.sample_project.orders_lineitem"
2020-06-30 15:41:57.348451 (Thread-1): finished collecting timing info
2020-06-30 15:41:57.348827 (Thread-1): Finished running node model.sample_project.orders_lineitem
2020-06-30 15:41:57.349108 (Thread-1): Began running node model.sample_project.cust_list_ord_nat
2020-06-30 15:41:57.349339 (Thread-1): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 15:41:57.349426 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders_lineitem).
2020-06-30 15:41:57.349508 (Thread-1): Compiling model.sample_project.cust_list_ord_nat
2020-06-30 15:41:57.362564 (Thread-1): Writing injected SQL for node "model.sample_project.cust_list_ord_nat"
2020-06-30 15:41:57.362867 (Thread-1): finished collecting timing info
2020-06-30 15:41:57.363193 (Thread-1): Finished running node model.sample_project.cust_list_ord_nat
2020-06-30 15:41:57.449651 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 15:41:57.449871 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:41:57.450248 (MainThread): 10:41:57 | 
2020-06-30 15:41:57.450436 (MainThread): 10:41:57 | Finished running 8 tests in 15.09s.
2020-06-30 15:41:57.450596 (MainThread): Connection 'master' was properly closed.
2020-06-30 15:41:57.450718 (MainThread): Connection 'model.sample_project.cust_list_ord_nat' was left open.
2020-06-30 15:41:57.450847 (MainThread): On model.sample_project.cust_list_ord_nat: Close
2020-06-30 15:41:57.927644 (MainThread): 
2020-06-30 15:41:57.927790 (MainThread): Completed successfully
2020-06-30 15:41:57.927994 (MainThread): 
Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
2020-06-30 15:41:57.928337 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c16050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eea450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eea950>]}
2020-06-30 15:41:57.928514 (MainThread): Flushing usage events
2020-06-30 15:57:56.856631 (MainThread): Running with dbt=0.17.0
2020-06-30 15:57:57.286651 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-06-30 15:57:57.288029 (MainThread): Tracking: tracking
2020-06-30 15:57:57.288364 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092c7250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092ecc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092ec710>]}
2020-06-30 15:57:57.308848 (MainThread): Partial parsing not enabled
2020-06-30 15:57:57.311194 (MainThread): Parsing macros/core.sql
2020-06-30 15:57:57.316592 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-30 15:57:57.325957 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-30 15:57:57.327873 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-30 15:57:57.345186 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-30 15:57:57.381652 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-30 15:57:57.404589 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-30 15:57:57.406612 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-30 15:57:57.414373 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-30 15:57:57.434920 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-30 15:57:57.444130 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-30 15:57:57.452064 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-30 15:57:57.457710 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-30 15:57:57.459119 (MainThread): Parsing macros/etc/query.sql
2020-06-30 15:57:57.460430 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-30 15:57:57.462311 (MainThread): Parsing macros/etc/datetime.sql
2020-06-30 15:57:57.471870 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-30 15:57:57.476339 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-30 15:57:57.478566 (MainThread): Parsing macros/adapters/common.sql
2020-06-30 15:57:57.535600 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-30 15:57:57.537233 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-30 15:57:57.538413 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-30 15:57:57.539770 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-30 15:57:57.542460 (MainThread): Parsing macros/catalog.sql
2020-06-30 15:57:57.544672 (MainThread): Parsing macros/adapters.sql
2020-06-30 15:57:57.568033 (MainThread): Parsing macros/materializations/merge.sql
2020-06-30 15:57:57.570226 (MainThread): Parsing macros/materializations/view.sql
2020-06-30 15:57:57.572322 (MainThread): Parsing macros/materializations/table.sql
2020-06-30 15:57:57.578112 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-30 15:57:57.618820 (MainThread): Partial parsing not enabled
2020-06-30 15:57:57.620082 (MainThread): Parsing macros/test_is_nonnegative.sql
2020-06-30 15:57:57.624944 (MainThread): Parsing macros/cross_db_utils/except.sql
2020-06-30 15:57:57.626285 (MainThread): Parsing macros/cross_db_utils/replace.sql
2020-06-30 15:57:57.627688 (MainThread): Parsing macros/cross_db_utils/concat.sql
2020-06-30 15:57:57.630242 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2020-06-30 15:57:57.638356 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2020-06-30 15:57:57.640143 (MainThread): Parsing macros/cross_db_utils/length.sql
2020-06-30 15:57:57.641941 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2020-06-30 15:57:57.645234 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2020-06-30 15:57:57.646685 (MainThread): Parsing macros/cross_db_utils/right.sql
2020-06-30 15:57:57.649642 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2020-06-30 15:57:57.660894 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2020-06-30 15:57:57.665422 (MainThread): Parsing macros/cross_db_utils/hash.sql
2020-06-30 15:57:57.667681 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2020-06-30 15:57:57.669974 (MainThread): Parsing macros/cross_db_utils/position.sql
2020-06-30 15:57:57.672043 (MainThread): Parsing macros/cross_db_utils/literal.sql
2020-06-30 15:57:57.673700 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2020-06-30 15:57:57.677962 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2020-06-30 15:57:57.684678 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2020-06-30 15:57:57.688256 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2020-06-30 15:57:57.690835 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2020-06-30 15:57:57.692637 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2020-06-30 15:57:57.718211 (MainThread): Parsing macros/logger/pretty_log_format.sql
2020-06-30 15:57:57.719051 (MainThread): Parsing macros/logger/pretty_time.sql
2020-06-30 15:57:57.720067 (MainThread): Parsing macros/logger/log_info.sql
2020-06-30 15:57:57.721001 (MainThread): Parsing macros/datetime/date_spine.sql
2020-06-30 15:57:57.725283 (MainThread): Parsing macros/web/get_url_host.sql
2020-06-30 15:57:57.727423 (MainThread): Parsing macros/web/get_url_path.sql
2020-06-30 15:57:57.730548 (MainThread): Parsing macros/web/get_url_parameter.sql
2020-06-30 15:57:57.731937 (MainThread): Parsing macros/geo/haversine_distance.sql
2020-06-30 15:57:57.733083 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2020-06-30 15:57:57.734605 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2020-06-30 15:57:57.737158 (MainThread): Parsing macros/schema_tests/recency.sql
2020-06-30 15:57:57.738618 (MainThread): Parsing macros/schema_tests/not_constant.sql
2020-06-30 15:57:57.739838 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2020-06-30 15:57:57.741029 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2020-06-30 15:57:57.742350 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2020-06-30 15:57:57.744209 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2020-06-30 15:57:57.745600 (MainThread): Parsing macros/schema_tests/equality.sql
2020-06-30 15:57:57.749391 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2020-06-30 15:57:57.757183 (MainThread): Parsing macros/sql/nullcheck_table.sql
2020-06-30 15:57:57.758677 (MainThread): Parsing macros/sql/generate_series.sql
2020-06-30 15:57:57.762247 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2020-06-30 15:57:57.766652 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2020-06-30 15:57:57.770225 (MainThread): Parsing macros/sql/star.sql
2020-06-30 15:57:57.773902 (MainThread): Parsing macros/sql/unpivot.sql
2020-06-30 15:57:57.780582 (MainThread): Parsing macros/sql/union.sql
2020-06-30 15:57:57.790832 (MainThread): Parsing macros/sql/groupby.sql
2020-06-30 15:57:57.792022 (MainThread): Parsing macros/sql/surrogate_key.sql
2020-06-30 15:57:57.795009 (MainThread): Parsing macros/sql/safe_add.sql
2020-06-30 15:57:57.796284 (MainThread): Parsing macros/sql/nullcheck.sql
2020-06-30 15:57:57.797957 (MainThread): Parsing macros/sql/get_column_values.sql
2020-06-30 15:57:57.804151 (MainThread): Parsing macros/sql/pivot.sql
2020-06-30 15:57:57.807552 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2020-06-30 15:57:57.851540 (MainThread): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 15:57:57.851660 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:57:57.882462 (MainThread): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 15:57:57.882580 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:57:57.895420 (MainThread): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 15:57:57.895571 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:57:57.907508 (MainThread): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 15:57:57.907601 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:57:57.920388 (MainThread): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 15:57:57.920500 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:57:57.934522 (MainThread): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 15:57:57.934668 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:57:57.948533 (MainThread): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 15:57:57.948666 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:57:57.963625 (MainThread): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 15:57:57.963716 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:57:57.977848 (MainThread): Acquiring new snowflake connection "model.sample_project.sales_report_one".
2020-06-30 15:57:57.977935 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:57:57.990099 (MainThread): Acquiring new snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 15:57:57.990237 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:57:58.011071 (MainThread): Acquiring new snowflake connection "model.sample_project.sales_report_two".
2020-06-30 15:57:58.011289 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:57:58.484513 (MainThread): Found 11 models, 8 tests, 0 snapshots, 0 analyses, 264 macros, 0 operations, 0 seed files, 4 sources
2020-06-30 15:57:58.486217 (MainThread): 
2020-06-30 15:57:58.486485 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 15:57:58.486571 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:57:58.491394 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_JAVEN_TESTING".
2020-06-30 15:57:58.491549 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-06-30 15:57:58.504719 (ThreadPoolExecutor-0_0): Using snowflake connection "list_JAVEN_TESTING".
2020-06-30 15:57:58.504827 (ThreadPoolExecutor-0_0): On list_JAVEN_TESTING: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING"} */

    show terse schemas in database JAVEN_TESTING
    limit 10000
2020-06-30 15:57:59.006834 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/certifi/cacert.pem'>
2020-06-30 15:58:06.833018 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 8.33 seconds
2020-06-30 15:58:06.863594 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 15:58:06.863726 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_JAVEN_TESTING).
2020-06-30 15:58:06.870338 (ThreadPoolExecutor-1_0): Using snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 15:58:06.870435 (ThreadPoolExecutor-1_0): On list_JAVEN_TESTING_TEST: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING_TEST"} */

    show terse objects in JAVEN_TESTING.TEST
2020-06-30 15:58:07.086180 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 10 in 0.22 seconds
2020-06-30 15:58:07.095875 (MainThread): 10:58:07 | Concurrency: 1 threads (target='dev')
2020-06-30 15:58:07.096033 (MainThread): 10:58:07 | 
2020-06-30 15:58:07.096904 (Thread-1): Began running node model.sample_project.customer
2020-06-30 15:58:07.097197 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 15:58:07.097302 (Thread-1): Re-using an available connection from the pool (formerly list_JAVEN_TESTING_TEST).
2020-06-30 15:58:07.097406 (Thread-1): Compiling model.sample_project.customer
2020-06-30 15:58:07.114432 (Thread-1): Writing injected SQL for node "model.sample_project.customer"
2020-06-30 15:58:07.116093 (Thread-1): finished collecting timing info
2020-06-30 15:58:07.116482 (Thread-1): Finished running node model.sample_project.customer
2020-06-30 15:58:07.116656 (Thread-1): Began running node model.sample_project.lineitem
2020-06-30 15:58:07.116961 (Thread-1): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 15:58:07.117058 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer).
2020-06-30 15:58:07.117144 (Thread-1): Compiling model.sample_project.lineitem
2020-06-30 15:58:07.124025 (Thread-1): Writing injected SQL for node "model.sample_project.lineitem"
2020-06-30 15:58:07.124948 (Thread-1): finished collecting timing info
2020-06-30 15:58:07.125302 (Thread-1): Finished running node model.sample_project.lineitem
2020-06-30 15:58:07.125425 (Thread-1): Began running node model.sample_project.nation
2020-06-30 15:58:07.125647 (Thread-1): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 15:58:07.125736 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.lineitem).
2020-06-30 15:58:07.125819 (Thread-1): Compiling model.sample_project.nation
2020-06-30 15:58:07.132602 (Thread-1): Writing injected SQL for node "model.sample_project.nation"
2020-06-30 15:58:07.133295 (Thread-1): finished collecting timing info
2020-06-30 15:58:07.133720 (Thread-1): Finished running node model.sample_project.nation
2020-06-30 15:58:07.133852 (Thread-1): Began running node model.sample_project.orders
2020-06-30 15:58:07.134080 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 15:58:07.134167 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.nation).
2020-06-30 15:58:07.134251 (Thread-1): Compiling model.sample_project.orders
2020-06-30 15:58:07.141317 (Thread-1): Writing injected SQL for node "model.sample_project.orders"
2020-06-30 15:58:07.141609 (Thread-1): finished collecting timing info
2020-06-30 15:58:07.141955 (Thread-1): Finished running node model.sample_project.orders
2020-06-30 15:58:07.142077 (Thread-1): Began running node test.sample_project.source_is_nonnegative_tpch_customer_c_custkey
2020-06-30 15:58:07.142299 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_nonnegative_tpch_customer_c_custkey".
2020-06-30 15:58:07.142387 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders).
2020-06-30 15:58:07.142469 (Thread-1): Compiling test.sample_project.source_is_nonnegative_tpch_customer_c_custkey
2020-06-30 15:58:07.156441 (Thread-1): Writing injected SQL for node "test.sample_project.source_is_nonnegative_tpch_customer_c_custkey"
2020-06-30 15:58:07.156748 (Thread-1): finished collecting timing info
2020-06-30 15:58:07.156969 (Thread-1): finished collecting timing info
2020-06-30 15:58:07.157288 (Thread-1): Finished running node test.sample_project.source_is_nonnegative_tpch_customer_c_custkey
2020-06-30 15:58:07.157408 (Thread-1): Began running node test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey
2020-06-30 15:58:07.157673 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey".
2020-06-30 15:58:07.157758 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_nonnegative_tpch_customer_c_custkey).
2020-06-30 15:58:07.157836 (Thread-1): Compiling test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey
2020-06-30 15:58:07.165800 (Thread-1): Writing injected SQL for node "test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey"
2020-06-30 15:58:07.166382 (Thread-1): finished collecting timing info
2020-06-30 15:58:07.166609 (Thread-1): finished collecting timing info
2020-06-30 15:58:07.167192 (Thread-1): Finished running node test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey
2020-06-30 15:58:07.167335 (Thread-1): Began running node test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice
2020-06-30 15:58:07.167617 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice".
2020-06-30 15:58:07.167704 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey).
2020-06-30 15:58:07.167785 (Thread-1): Compiling test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice
2020-06-30 15:58:07.175866 (Thread-1): Writing injected SQL for node "test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice"
2020-06-30 15:58:07.176503 (Thread-1): finished collecting timing info
2020-06-30 15:58:07.176724 (Thread-1): finished collecting timing info
2020-06-30 15:58:07.177048 (Thread-1): Finished running node test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice
2020-06-30 15:58:07.177169 (Thread-1): Began running node test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey
2020-06-30 15:58:07.177434 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey".
2020-06-30 15:58:07.177520 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice).
2020-06-30 15:58:07.177600 (Thread-1): Compiling test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey
2020-06-30 15:58:07.186253 (Thread-1): Writing injected SQL for node "test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey"
2020-06-30 15:58:07.187043 (Thread-1): finished collecting timing info
2020-06-30 15:58:07.187345 (Thread-1): finished collecting timing info
2020-06-30 15:58:07.187727 (Thread-1): Finished running node test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey
2020-06-30 15:58:07.187858 (Thread-1): Began running node test.sample_project.source_is_nonnegative_tpch_orders_o_custkey
2020-06-30 15:58:07.188084 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_nonnegative_tpch_orders_o_custkey".
2020-06-30 15:58:07.188169 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey).
2020-06-30 15:58:07.188252 (Thread-1): Compiling test.sample_project.source_is_nonnegative_tpch_orders_o_custkey
2020-06-30 15:58:07.196839 (Thread-1): Writing injected SQL for node "test.sample_project.source_is_nonnegative_tpch_orders_o_custkey"
2020-06-30 15:58:07.197143 (Thread-1): finished collecting timing info
2020-06-30 15:58:07.197355 (Thread-1): finished collecting timing info
2020-06-30 15:58:07.197772 (Thread-1): Finished running node test.sample_project.source_is_nonnegative_tpch_orders_o_custkey
2020-06-30 15:58:07.197892 (Thread-1): Began running node test.sample_project.source_unique_tpch_customer_c_custkey
2020-06-30 15:58:07.198107 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_unique_tpch_customer_c_custkey".
2020-06-30 15:58:07.198191 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_nonnegative_tpch_orders_o_custkey).
2020-06-30 15:58:07.198271 (Thread-1): Compiling test.sample_project.source_unique_tpch_customer_c_custkey
2020-06-30 15:58:07.206136 (Thread-1): Writing injected SQL for node "test.sample_project.source_unique_tpch_customer_c_custkey"
2020-06-30 15:58:07.206741 (Thread-1): finished collecting timing info
2020-06-30 15:58:07.206969 (Thread-1): finished collecting timing info
2020-06-30 15:58:07.207312 (Thread-1): Finished running node test.sample_project.source_unique_tpch_customer_c_custkey
2020-06-30 15:58:07.207434 (Thread-1): Began running node test.sample_project.source_unique_tpch_nation_n_nationkey
2020-06-30 15:58:07.207769 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_unique_tpch_nation_n_nationkey".
2020-06-30 15:58:07.207865 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_unique_tpch_customer_c_custkey).
2020-06-30 15:58:07.207950 (Thread-1): Compiling test.sample_project.source_unique_tpch_nation_n_nationkey
2020-06-30 15:58:07.215765 (Thread-1): Writing injected SQL for node "test.sample_project.source_unique_tpch_nation_n_nationkey"
2020-06-30 15:58:07.216028 (Thread-1): finished collecting timing info
2020-06-30 15:58:07.216234 (Thread-1): finished collecting timing info
2020-06-30 15:58:07.216543 (Thread-1): Finished running node test.sample_project.source_unique_tpch_nation_n_nationkey
2020-06-30 15:58:07.216657 (Thread-1): Began running node test.sample_project.source_unique_tpch_orders_o_orderkey
2020-06-30 15:58:07.217022 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_unique_tpch_orders_o_orderkey".
2020-06-30 15:58:07.217113 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_unique_tpch_nation_n_nationkey).
2020-06-30 15:58:07.217192 (Thread-1): Compiling test.sample_project.source_unique_tpch_orders_o_orderkey
2020-06-30 15:58:07.224762 (Thread-1): Writing injected SQL for node "test.sample_project.source_unique_tpch_orders_o_orderkey"
2020-06-30 15:58:07.225357 (Thread-1): finished collecting timing info
2020-06-30 15:58:07.225573 (Thread-1): finished collecting timing info
2020-06-30 15:58:07.225882 (Thread-1): Finished running node test.sample_project.source_unique_tpch_orders_o_orderkey
2020-06-30 15:58:07.225999 (Thread-1): Began running node model.sample_project.customer_nation
2020-06-30 15:58:07.226212 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 15:58:07.226295 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_unique_tpch_orders_o_orderkey).
2020-06-30 15:58:07.226374 (Thread-1): Compiling model.sample_project.customer_nation
2020-06-30 15:58:07.236300 (Thread-1): Writing injected SQL for node "model.sample_project.customer_nation"
2020-06-30 15:58:07.236837 (Thread-1): finished collecting timing info
2020-06-30 15:58:07.237164 (Thread-1): Finished running node model.sample_project.customer_nation
2020-06-30 15:58:07.237277 (Thread-1): Began running node model.sample_project.orders_lineitem
2020-06-30 15:58:07.237486 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 15:58:07.237567 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer_nation).
2020-06-30 15:58:07.237644 (Thread-1): Compiling model.sample_project.orders_lineitem
2020-06-30 15:58:07.248732 (Thread-1): Writing injected SQL for node "model.sample_project.orders_lineitem"
2020-06-30 15:58:07.249072 (Thread-1): finished collecting timing info
2020-06-30 15:58:07.249413 (Thread-1): Finished running node model.sample_project.orders_lineitem
2020-06-30 15:58:07.249530 (Thread-1): Began running node model.sample_project.customers_per_nation
2020-06-30 15:58:07.249859 (Thread-1): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 15:58:07.249957 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders_lineitem).
2020-06-30 15:58:07.250037 (Thread-1): Compiling model.sample_project.customers_per_nation
2020-06-30 15:58:07.258115 (Thread-1): Writing injected SQL for node "model.sample_project.customers_per_nation"
2020-06-30 15:58:07.258825 (Thread-1): finished collecting timing info
2020-06-30 15:58:07.259038 (Thread-1): finished collecting timing info
2020-06-30 15:58:07.259350 (Thread-1): Finished running node model.sample_project.customers_per_nation
2020-06-30 15:58:07.259466 (Thread-1): Began running node model.sample_project.cust_list_ord_nat
2020-06-30 15:58:07.260068 (Thread-1): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 15:58:07.260217 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customers_per_nation).
2020-06-30 15:58:07.260351 (Thread-1): Compiling model.sample_project.cust_list_ord_nat
2020-06-30 15:58:07.274367 (Thread-1): Writing injected SQL for node "model.sample_project.cust_list_ord_nat"
2020-06-30 15:58:07.275024 (Thread-1): finished collecting timing info
2020-06-30 15:58:07.275366 (Thread-1): Finished running node model.sample_project.cust_list_ord_nat
2020-06-30 15:58:07.275483 (Thread-1): Began running node model.sample_project.average_price_per_order
2020-06-30 15:58:07.275692 (Thread-1): Acquiring new snowflake connection "model.sample_project.average_price_per_order".
2020-06-30 15:58:07.275776 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.cust_list_ord_nat).
2020-06-30 15:58:07.275854 (Thread-1): Compiling model.sample_project.average_price_per_order
2020-06-30 15:58:07.287133 (Thread-1): Writing injected SQL for node "model.sample_project.average_price_per_order"
2020-06-30 15:58:07.287406 (Thread-1): finished collecting timing info
2020-06-30 15:58:07.287609 (Thread-1): finished collecting timing info
2020-06-30 15:58:07.287912 (Thread-1): Finished running node model.sample_project.average_price_per_order
2020-06-30 15:58:07.288024 (Thread-1): Began running node model.sample_project.sales_report_one
2020-06-30 15:58:07.288227 (Thread-1): Acquiring new snowflake connection "model.sample_project.sales_report_one".
2020-06-30 15:58:07.288308 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.average_price_per_order).
2020-06-30 15:58:07.288384 (Thread-1): Compiling model.sample_project.sales_report_one
2020-06-30 15:58:07.297849 (Thread-1): Writing injected SQL for node "model.sample_project.sales_report_one"
2020-06-30 15:58:07.298125 (Thread-1): finished collecting timing info
2020-06-30 15:58:07.298331 (Thread-1): finished collecting timing info
2020-06-30 15:58:07.298640 (Thread-1): Finished running node model.sample_project.sales_report_one
2020-06-30 15:58:07.298753 (Thread-1): Began running node model.sample_project.sales_report_two
2020-06-30 15:58:07.299014 (Thread-1): Acquiring new snowflake connection "model.sample_project.sales_report_two".
2020-06-30 15:58:07.299106 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.sales_report_one).
2020-06-30 15:58:07.299186 (Thread-1): Compiling model.sample_project.sales_report_two
2020-06-30 15:58:07.310510 (Thread-1): Writing injected SQL for node "model.sample_project.sales_report_two"
2020-06-30 15:58:07.310939 (Thread-1): finished collecting timing info
2020-06-30 15:58:07.311241 (Thread-1): finished collecting timing info
2020-06-30 15:58:07.311622 (Thread-1): Finished running node model.sample_project.sales_report_two
2020-06-30 15:58:07.411706 (MainThread): Connection 'master' was properly closed.
2020-06-30 15:58:07.412100 (MainThread): Connection 'model.sample_project.sales_report_two' was left open.
2020-06-30 15:58:07.412365 (MainThread): On model.sample_project.sales_report_two: Close
2020-06-30 15:58:07.701646 (MainThread): 10:58:07 | Done.
2020-06-30 15:58:07.706217 (MainThread): Acquiring new snowflake connection "generate_catalog".
2020-06-30 15:58:07.706326 (MainThread): Opening a new connection, currently in state init
2020-06-30 15:58:07.706419 (MainThread): 10:58:07 | Building catalog
2020-06-30 15:58:07.781353 (ThreadPoolExecutor-2_0): Acquiring new snowflake connection "JAVEN_TESTING.information_schema".
2020-06-30 15:58:07.781539 (ThreadPoolExecutor-2_0): Opening a new connection, currently in state init
2020-06-30 15:58:07.788233 (ThreadPoolExecutor-2_0): Using snowflake connection "JAVEN_TESTING.information_schema".
2020-06-30 15:58:07.788323 (ThreadPoolExecutor-2_0): On JAVEN_TESTING.information_schema: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "JAVEN_TESTING.information_schema"} */

    
      with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include"

          from JAVEN_TESTING.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              null as "table_comment",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              null as "column_comment"

          from JAVEN_TESTING.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('test'))
      order by "column_index"
2020-06-30 15:58:16.580707 (ThreadPoolExecutor-2_0): SQL status: SUCCESS 82 in 8.79 seconds
2020-06-30 15:58:16.598256 (ThreadPoolExecutor-2_0): Acquiring new snowflake connection "snowflake_sample_data.information_schema".
2020-06-30 15:58:16.598433 (ThreadPoolExecutor-2_0): Re-using an available connection from the pool (formerly JAVEN_TESTING.information_schema).
2020-06-30 15:58:16.601634 (ThreadPoolExecutor-2_0): Using snowflake connection "snowflake_sample_data.information_schema".
2020-06-30 15:58:16.601740 (ThreadPoolExecutor-2_0): On snowflake_sample_data.information_schema: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "snowflake_sample_data.information_schema"} */

    
      with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include"

          from snowflake_sample_data.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              null as "table_comment",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              null as "column_comment"

          from snowflake_sample_data.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('tpch_sf1'))
      order by "column_index"
2020-06-30 15:58:19.270593 (ThreadPoolExecutor-2_0): SQL status: SUCCESS 61 in 2.67 seconds
2020-06-30 15:58:19.425045 (MainThread): 10:58:19 | Catalog written to /Users/johnaven/Documents/gitlab_projects/dbt-demo-June-2020/sample_project/target/catalog.json
2020-06-30 15:58:19.425384 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c005c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c005c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c005e10>]}
2020-06-30 15:58:19.425553 (MainThread): Flushing usage events
2020-06-30 15:58:19.817142 (MainThread): Connection 'generate_catalog' was properly closed.
2020-06-30 15:58:19.817347 (MainThread): Connection 'snowflake_sample_data.information_schema' was left open.
2020-06-30 15:58:19.817478 (MainThread): On snowflake_sample_data.information_schema: Close
2020-06-30 15:58:26.575691 (MainThread): Running with dbt=0.17.0
2020-06-30 15:58:26.890317 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', open_browser=True, partial_parse=None, port=8080, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-06-30 15:58:26.891777 (MainThread): Tracking: tracking
2020-06-30 15:58:26.892218 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2df110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2fca50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2fc990>]}
2020-06-30 15:58:26.894103 (MainThread): Serving docs at 0.0.0.0:8080
2020-06-30 15:58:26.894219 (MainThread): To access from your browser, navigate to:  http://localhost:8080
2020-06-30 15:58:26.894303 (MainThread): Press Ctrl+C to exit.


2020-06-30 18:20:28.637199 (MainThread): Flushing usage events
2020-06-30 18:20:29.180912 (MainThread): ctrl-c
2020-06-30 18:20:32.696299 (MainThread): Running with dbt=0.17.0
2020-06-30 18:20:33.138347 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.clean.CleanTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='clean', write_json=True)
2020-06-30 18:20:33.139083 (MainThread): Tracking: tracking
2020-06-30 18:20:33.139465 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aea6d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca58050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca588d0>]}
2020-06-30 18:20:33.139800 (MainThread): Checking target/*
2020-06-30 18:20:33.148143 (MainThread):  Cleaned target/*
2020-06-30 18:20:33.148276 (MainThread): Checking dbt_modules/*
2020-06-30 18:20:33.176894 (MainThread):  Cleaned dbt_modules/*
2020-06-30 18:20:33.177056 (MainThread): Finished cleaning all paths.
2020-06-30 18:20:33.177228 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca58050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca588d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aecaed0>]}
2020-06-30 18:20:33.177424 (MainThread): Flushing usage events
2020-06-30 20:26:48.099344 (MainThread): Running with dbt=0.17.0
2020-06-30 20:26:48.414354 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2020-06-30 20:26:48.415824 (MainThread): Tracking: tracking
2020-06-30 20:26:48.416186 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc63b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc63a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc3f190>]}
2020-06-30 20:26:48.439180 (MainThread): Partial parsing not enabled
2020-06-30 20:26:48.441397 (MainThread): Parsing macros/core.sql
2020-06-30 20:26:48.446509 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-30 20:26:48.456016 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-30 20:26:48.458610 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-30 20:26:48.479240 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-30 20:26:48.511819 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-30 20:26:48.536528 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-30 20:26:48.538747 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-30 20:26:48.546082 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-30 20:26:48.561563 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-30 20:26:48.569139 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-30 20:26:48.577293 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-30 20:26:48.583537 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-30 20:26:48.584687 (MainThread): Parsing macros/etc/query.sql
2020-06-30 20:26:48.585904 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-30 20:26:48.588042 (MainThread): Parsing macros/etc/datetime.sql
2020-06-30 20:26:48.597779 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-30 20:26:48.599998 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-30 20:26:48.601895 (MainThread): Parsing macros/adapters/common.sql
2020-06-30 20:26:48.661055 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-30 20:26:48.662900 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-30 20:26:48.664141 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-30 20:26:48.665368 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-30 20:26:48.667872 (MainThread): Parsing macros/catalog.sql
2020-06-30 20:26:48.669975 (MainThread): Parsing macros/adapters.sql
2020-06-30 20:26:48.693481 (MainThread): Parsing macros/materializations/merge.sql
2020-06-30 20:26:48.696021 (MainThread): Parsing macros/materializations/view.sql
2020-06-30 20:26:48.697988 (MainThread): Parsing macros/materializations/table.sql
2020-06-30 20:26:48.702369 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-30 20:26:48.737937 (MainThread): Partial parsing not enabled
2020-06-30 20:26:48.738367 (MainThread): Parsing macros/discounted_price.sql
2020-06-30 20:26:48.739138 (MainThread): Parsing macros/tax_charged.sql
2020-06-30 20:26:48.740239 (MainThread): Parsing macros/full_charge.sql
2020-06-30 20:26:48.741634 (MainThread): Parsing macros/test_is_nonnegative.sql
2020-06-30 20:26:48.785146 (MainThread): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 20:26:48.785272 (MainThread): Opening a new connection, currently in state init
2020-06-30 20:26:48.817261 (MainThread): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 20:26:48.817374 (MainThread): Opening a new connection, currently in state init
2020-06-30 20:26:48.829384 (MainThread): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 20:26:48.829480 (MainThread): Opening a new connection, currently in state init
2020-06-30 20:26:48.841576 (MainThread): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 20:26:48.841671 (MainThread): Opening a new connection, currently in state init
2020-06-30 20:26:48.853963 (MainThread): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 20:26:48.854060 (MainThread): Opening a new connection, currently in state init
2020-06-30 20:26:48.866565 (MainThread): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 20:26:48.866659 (MainThread): Opening a new connection, currently in state init
2020-06-30 20:26:48.880983 (MainThread): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 20:26:48.881085 (MainThread): Opening a new connection, currently in state init
2020-06-30 20:26:48.894455 (MainThread): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 20:26:48.894603 (MainThread): Opening a new connection, currently in state init
2020-06-30 20:26:48.906070 (MainThread): Acquiring new snowflake connection "model.sample_project.sales_report_one".
2020-06-30 20:26:48.906165 (MainThread): Opening a new connection, currently in state init
2020-06-30 20:26:48.922665 (MainThread): Acquiring new snowflake connection "model.sample_project.order_statistics".
2020-06-30 20:26:48.922761 (MainThread): Opening a new connection, currently in state init
2020-06-30 20:26:48.935644 (MainThread): Acquiring new snowflake connection "model.sample_project.sales_report_two".
2020-06-30 20:26:48.935734 (MainThread): Opening a new connection, currently in state init
2020-06-30 20:26:49.294359 (MainThread): Found 11 models, 8 tests, 0 snapshots, 0 analyses, 140 macros, 0 operations, 0 seed files, 4 sources
2020-06-30 20:26:49.296132 (MainThread): 
2020-06-30 20:26:49.296406 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 20:26:49.296493 (MainThread): Opening a new connection, currently in state init
2020-06-30 20:26:49.303435 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_JAVEN_TESTING".
2020-06-30 20:26:49.303636 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-06-30 20:26:49.318780 (ThreadPoolExecutor-0_0): Using snowflake connection "list_JAVEN_TESTING".
2020-06-30 20:26:49.318883 (ThreadPoolExecutor-0_0): On list_JAVEN_TESTING: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING"} */

    show terse schemas in database JAVEN_TESTING
    limit 10000
2020-06-30 20:26:49.877652 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/certifi/cacert.pem'>
2020-06-30 20:26:50.771550 (MainThread): Connection 'master' was properly closed.
2020-06-30 20:26:50.771709 (MainThread): Connection 'list_JAVEN_TESTING' was properly closed.
2020-06-30 20:26:50.771826 (MainThread): Flushing usage events
2020-06-30 20:26:51.199874 (MainThread): ctrl-c
2020-06-30 20:26:53.962138 (MainThread): Running with dbt=0.17.0
2020-06-30 20:26:54.281800 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-06-30 20:26:54.282665 (MainThread): Tracking: tracking
2020-06-30 20:26:54.282948 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed74e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed74a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5b2590>]}
2020-06-30 20:26:54.304880 (MainThread): Partial parsing not enabled
2020-06-30 20:26:54.306575 (MainThread): Parsing macros/core.sql
2020-06-30 20:26:54.312821 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-30 20:26:54.323004 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-30 20:26:54.325132 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-30 20:26:54.345489 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-30 20:26:54.377831 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-30 20:26:54.402515 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-30 20:26:54.404497 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-30 20:26:54.411648 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-30 20:26:54.426718 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-30 20:26:54.433976 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-30 20:26:54.440887 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-30 20:26:54.445992 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-30 20:26:54.446955 (MainThread): Parsing macros/etc/query.sql
2020-06-30 20:26:54.448043 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-30 20:26:54.449744 (MainThread): Parsing macros/etc/datetime.sql
2020-06-30 20:26:54.459085 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-30 20:26:54.461451 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-30 20:26:54.463186 (MainThread): Parsing macros/adapters/common.sql
2020-06-30 20:26:54.517983 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-30 20:26:54.519248 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-30 20:26:54.520185 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-30 20:26:54.521296 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-30 20:26:54.523963 (MainThread): Parsing macros/catalog.sql
2020-06-30 20:26:54.525874 (MainThread): Parsing macros/adapters.sql
2020-06-30 20:26:54.549087 (MainThread): Parsing macros/materializations/merge.sql
2020-06-30 20:26:54.551138 (MainThread): Parsing macros/materializations/view.sql
2020-06-30 20:26:54.552364 (MainThread): Parsing macros/materializations/table.sql
2020-06-30 20:26:54.556390 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-30 20:26:54.591927 (MainThread): Partial parsing not enabled
2020-06-30 20:26:54.592331 (MainThread): Parsing macros/discounted_price.sql
2020-06-30 20:26:54.592881 (MainThread): Parsing macros/tax_charged.sql
2020-06-30 20:26:54.593868 (MainThread): Parsing macros/full_charge.sql
2020-06-30 20:26:54.595075 (MainThread): Parsing macros/test_is_nonnegative.sql
2020-06-30 20:26:54.633925 (MainThread): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 20:26:54.634039 (MainThread): Opening a new connection, currently in state init
2020-06-30 20:26:54.663653 (MainThread): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 20:26:54.663750 (MainThread): Opening a new connection, currently in state init
2020-06-30 20:26:54.675374 (MainThread): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 20:26:54.675464 (MainThread): Opening a new connection, currently in state init
2020-06-30 20:26:54.687598 (MainThread): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 20:26:54.687700 (MainThread): Opening a new connection, currently in state init
2020-06-30 20:26:54.702547 (MainThread): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 20:26:54.702662 (MainThread): Opening a new connection, currently in state init
2020-06-30 20:26:54.715994 (MainThread): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 20:26:54.716085 (MainThread): Opening a new connection, currently in state init
2020-06-30 20:26:54.728748 (MainThread): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 20:26:54.728840 (MainThread): Opening a new connection, currently in state init
2020-06-30 20:26:54.741901 (MainThread): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 20:26:54.741990 (MainThread): Opening a new connection, currently in state init
2020-06-30 20:26:54.753281 (MainThread): Acquiring new snowflake connection "model.sample_project.sales_report_one".
2020-06-30 20:26:54.753368 (MainThread): Opening a new connection, currently in state init
2020-06-30 20:26:54.772280 (MainThread): Acquiring new snowflake connection "model.sample_project.order_statistics".
2020-06-30 20:26:54.772379 (MainThread): Opening a new connection, currently in state init
2020-06-30 20:26:54.784831 (MainThread): Acquiring new snowflake connection "model.sample_project.sales_report_two".
2020-06-30 20:26:54.784923 (MainThread): Opening a new connection, currently in state init
2020-06-30 20:26:55.140599 (MainThread): Found 11 models, 8 tests, 0 snapshots, 0 analyses, 140 macros, 0 operations, 0 seed files, 4 sources
2020-06-30 20:26:55.142813 (MainThread): 
2020-06-30 20:26:55.143086 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 20:26:55.143169 (MainThread): Opening a new connection, currently in state init
2020-06-30 20:26:55.148250 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_JAVEN_TESTING".
2020-06-30 20:26:55.148589 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-06-30 20:26:55.161916 (ThreadPoolExecutor-0_0): Using snowflake connection "list_JAVEN_TESTING".
2020-06-30 20:26:55.162010 (ThreadPoolExecutor-0_0): On list_JAVEN_TESTING: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING"} */

    show terse schemas in database JAVEN_TESTING
    limit 10000
2020-06-30 20:26:55.635438 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/certifi/cacert.pem'>
2020-06-30 20:26:59.738775 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 4.58 seconds
2020-06-30 20:26:59.771315 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 20:26:59.771532 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_JAVEN_TESTING).
2020-06-30 20:26:59.778901 (ThreadPoolExecutor-1_0): Using snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 20:26:59.779035 (ThreadPoolExecutor-1_0): On list_JAVEN_TESTING_TEST: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING_TEST"} */

    show terse objects in JAVEN_TESTING.TEST
2020-06-30 20:27:00.121651 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 10 in 0.34 seconds
2020-06-30 20:27:00.135138 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 20:27:00.135376 (MainThread): Opening a new connection, currently in state init
2020-06-30 20:27:00.135638 (MainThread): Using snowflake connection "master".
2020-06-30 20:27:00.135763 (MainThread): On master: BEGIN
2020-06-30 20:27:05.879394 (MainThread): SQL status: SUCCESS 1 in 5.74 seconds
2020-06-30 20:27:05.879624 (MainThread): On master: COMMIT
2020-06-30 20:27:05.879818 (MainThread): Using snowflake connection "master".
2020-06-30 20:27:05.879949 (MainThread): On master: COMMIT
2020-06-30 20:27:06.211952 (MainThread): SQL status: SUCCESS 1 in 0.33 seconds
2020-06-30 20:27:06.212307 (MainThread): 15:27:06 | Concurrency: 1 threads (target='dev')
2020-06-30 20:27:06.212455 (MainThread): 15:27:06 | 
2020-06-30 20:27:06.213186 (Thread-1): Began running node model.sample_project.customer
2020-06-30 20:27:06.213482 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 20:27:06.213583 (Thread-1): Re-using an available connection from the pool (formerly list_JAVEN_TESTING_TEST).
2020-06-30 20:27:06.213684 (Thread-1): Compiling model.sample_project.customer
2020-06-30 20:27:06.230314 (Thread-1): Writing injected SQL for node "model.sample_project.customer"
2020-06-30 20:27:06.231181 (Thread-1): finished collecting timing info
2020-06-30 20:27:06.231591 (Thread-1): Finished running node model.sample_project.customer
2020-06-30 20:27:06.231774 (Thread-1): Began running node model.sample_project.lineitem
2020-06-30 20:27:06.232176 (Thread-1): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 20:27:06.232259 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer).
2020-06-30 20:27:06.232336 (Thread-1): Compiling model.sample_project.lineitem
2020-06-30 20:27:06.239133 (Thread-1): Writing injected SQL for node "model.sample_project.lineitem"
2020-06-30 20:27:06.239674 (Thread-1): finished collecting timing info
2020-06-30 20:27:06.240103 (Thread-1): Finished running node model.sample_project.lineitem
2020-06-30 20:27:06.240246 (Thread-1): Began running node model.sample_project.nation
2020-06-30 20:27:06.240784 (Thread-1): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 20:27:06.241139 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.lineitem).
2020-06-30 20:27:06.241231 (Thread-1): Compiling model.sample_project.nation
2020-06-30 20:27:06.249543 (Thread-1): Writing injected SQL for node "model.sample_project.nation"
2020-06-30 20:27:06.249941 (Thread-1): finished collecting timing info
2020-06-30 20:27:06.250446 (Thread-1): Finished running node model.sample_project.nation
2020-06-30 20:27:06.250566 (Thread-1): Began running node model.sample_project.orders
2020-06-30 20:27:06.251005 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 20:27:06.251167 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.nation).
2020-06-30 20:27:06.251327 (Thread-1): Compiling model.sample_project.orders
2020-06-30 20:27:06.259184 (Thread-1): Writing injected SQL for node "model.sample_project.orders"
2020-06-30 20:27:06.259471 (Thread-1): finished collecting timing info
2020-06-30 20:27:06.259804 (Thread-1): Finished running node model.sample_project.orders
2020-06-30 20:27:06.259916 (Thread-1): Began running node model.sample_project.customer_nation
2020-06-30 20:27:06.260357 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 20:27:06.260451 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders).
2020-06-30 20:27:06.260531 (Thread-1): Compiling model.sample_project.customer_nation
2020-06-30 20:27:06.270702 (Thread-1): Writing injected SQL for node "model.sample_project.customer_nation"
2020-06-30 20:27:06.271052 (Thread-1): finished collecting timing info
2020-06-30 20:27:06.271492 (Thread-1): Finished running node model.sample_project.customer_nation
2020-06-30 20:27:06.271606 (Thread-1): Began running node model.sample_project.orders_lineitem
2020-06-30 20:27:06.271945 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 20:27:06.272035 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer_nation).
2020-06-30 20:27:06.272112 (Thread-1): Compiling model.sample_project.orders_lineitem
2020-06-30 20:27:06.285676 (Thread-1): Writing injected SQL for node "model.sample_project.orders_lineitem"
2020-06-30 20:27:06.286097 (Thread-1): finished collecting timing info
2020-06-30 20:27:06.286924 (Thread-1): Finished running node model.sample_project.orders_lineitem
2020-06-30 20:27:06.287136 (Thread-1): Began running node model.sample_project.customers_per_nation
2020-06-30 20:27:06.288476 (Thread-1): 15:27:06 | 1 of 4 START table model TEST.customers_per_nation................... [RUN]
2020-06-30 20:27:06.288913 (Thread-1): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 20:27:06.289091 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders_lineitem).
2020-06-30 20:27:06.289187 (Thread-1): Compiling model.sample_project.customers_per_nation
2020-06-30 20:27:06.299971 (Thread-1): Writing injected SQL for node "model.sample_project.customers_per_nation"
2020-06-30 20:27:06.300422 (Thread-1): finished collecting timing info
2020-06-30 20:27:06.329421 (Thread-1): Writing runtime SQL for node "model.sample_project.customers_per_nation"
2020-06-30 20:27:06.331519 (Thread-1): Using snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 20:27:06.331614 (Thread-1): On model.sample_project.customers_per_nation: BEGIN
2020-06-30 20:27:07.183185 (Thread-1): SQL status: SUCCESS 1 in 0.85 seconds
2020-06-30 20:27:07.183321 (Thread-1): Using snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 20:27:07.183402 (Thread-1): On model.sample_project.customers_per_nation: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "model.sample_project.customers_per_nation"} */


      create or replace transient table JAVEN_TESTING.TEST.customers_per_nation  as
      (with __dbt__CTE__customer as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  c_custkey as custkey,
        c_nationkey as nationkey,
        c_name as name
from snowflake_sample_data.tpch_sf1.customer
),  __dbt__CTE__nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  n_nationkey as nationkey,
        n_name as name
from snowflake_sample_data.tpch_sf1.nation
),  __dbt__CTE__customer_nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  c.custkey,
        c.nationkey,
        c.name as customer_name,
        n.name as nation_name
from __dbt__CTE__customer as c
JOIN __dbt__CTE__nation as n
ON c.nationkey=n.nationkey
)/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  count(customer_name) as customer_count,
        nation_name
from __dbt__CTE__customer_nation
group by nation_name
order by nation_name
      );
2020-06-30 20:27:12.202101 (Thread-1): SQL status: SUCCESS 1 in 5.02 seconds
2020-06-30 20:27:12.203130 (Thread-1): On model.sample_project.customers_per_nation: COMMIT
2020-06-30 20:27:12.203273 (Thread-1): Using snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 20:27:12.203364 (Thread-1): On model.sample_project.customers_per_nation: COMMIT
2020-06-30 20:27:12.369494 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2020-06-30 20:27:12.379032 (Thread-1): finished collecting timing info
2020-06-30 20:27:12.379639 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11e619df-7db1-46ac-a184-c31e5db4f231', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f7aee90>]}
2020-06-30 20:27:12.380688 (Thread-1): 15:27:12 | 1 of 4 OK created table model TEST.customers_per_nation.............. [SUCCESS 1 in 6.09s]
2020-06-30 20:27:12.380820 (Thread-1): Finished running node model.sample_project.customers_per_nation
2020-06-30 20:27:12.380950 (Thread-1): Began running node model.sample_project.cust_list_ord_nat
2020-06-30 20:27:12.381274 (Thread-1): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 20:27:12.381386 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customers_per_nation).
2020-06-30 20:27:12.381483 (Thread-1): Compiling model.sample_project.cust_list_ord_nat
2020-06-30 20:27:12.395335 (Thread-1): Writing injected SQL for node "model.sample_project.cust_list_ord_nat"
2020-06-30 20:27:12.395722 (Thread-1): finished collecting timing info
2020-06-30 20:27:12.396071 (Thread-1): Finished running node model.sample_project.cust_list_ord_nat
2020-06-30 20:27:12.396321 (Thread-1): Began running node model.sample_project.order_statistics
2020-06-30 20:27:12.397265 (Thread-1): 15:27:12 | 2 of 4 START table model TEST.order_statistics....................... [RUN]
2020-06-30 20:27:12.397600 (Thread-1): Acquiring new snowflake connection "model.sample_project.order_statistics".
2020-06-30 20:27:12.397688 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.cust_list_ord_nat).
2020-06-30 20:27:12.397768 (Thread-1): Compiling model.sample_project.order_statistics
2020-06-30 20:27:12.404354 (Thread-1): finished collecting timing info
2020-06-30 20:27:12.404677 (Thread-1): Compilation Error in model order_statistics (models/reports/order_statistics.sql)
  'dbt_utils' is undefined
Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 449, in catch_jinja
    yield
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 481, in render_template
    return template.render(ctx)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 21, in top-level template code
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/sandbox.py", line 407, in getattr
    value = getattr(obj, attribute)
jinja2.exceptions.UndefinedError: 'dbt_utils' is undefined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 165, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 340, in compile
    return compile_node(self.adapter, self.config, self.node, manifest, {})
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/compilation.py", line 255, in compile_node
    node = compiler.compile_node(node, manifest, extra_context)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/compilation.py", line 179, in compile_node
    node)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 530, in get_rendered
    return render_template(template, ctx, node)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 481, in render_template
    return template.render(ctx)
  File "/usr/local/opt/python/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 454, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in model order_statistics (models/reports/order_statistics.sql)
  'dbt_utils' is undefined
2020-06-30 20:27:12.410420 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11e619df-7db1-46ac-a184-c31e5db4f231', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f76e610>]}
2020-06-30 20:27:12.411650 (Thread-1): 15:27:12 | 2 of 4 ERROR creating table model TEST.order_statistics.............. [ERROR in 0.01s]
2020-06-30 20:27:12.411765 (Thread-1): Finished running node model.sample_project.order_statistics
2020-06-30 20:27:12.411911 (Thread-1): Began running node model.sample_project.sales_report_one
2020-06-30 20:27:12.413197 (Thread-1): 15:27:12 | 3 of 4 START table model TEST.sales_report_one....................... [RUN]
2020-06-30 20:27:12.413517 (Thread-1): Acquiring new snowflake connection "model.sample_project.sales_report_one".
2020-06-30 20:27:12.413596 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.order_statistics).
2020-06-30 20:27:12.413673 (Thread-1): Compiling model.sample_project.sales_report_one
2020-06-30 20:27:12.425613 (Thread-1): Writing injected SQL for node "model.sample_project.sales_report_one"
2020-06-30 20:27:12.425934 (Thread-1): finished collecting timing info
2020-06-30 20:27:12.431713 (Thread-1): Writing runtime SQL for node "model.sample_project.sales_report_one"
2020-06-30 20:27:12.436292 (Thread-1): Using snowflake connection "model.sample_project.sales_report_one".
2020-06-30 20:27:12.436391 (Thread-1): On model.sample_project.sales_report_one: BEGIN
2020-06-30 20:27:12.736256 (Thread-1): SQL status: SUCCESS 1 in 0.30 seconds
2020-06-30 20:27:12.736427 (Thread-1): Using snowflake connection "model.sample_project.sales_report_one".
2020-06-30 20:27:12.736535 (Thread-1): On model.sample_project.sales_report_one: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "model.sample_project.sales_report_one"} */


      create or replace transient table JAVEN_TESTING.TEST.sales_report_one  as
      (with __dbt__CTE__customer as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  c_custkey as custkey,
        c_nationkey as nationkey,
        c_name as name
from snowflake_sample_data.tpch_sf1.customer
),  __dbt__CTE__nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  n_nationkey as nationkey,
        n_name as name
from snowflake_sample_data.tpch_sf1.nation
),  __dbt__CTE__customer_nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  c.custkey,
        c.nationkey,
        c.name as customer_name,
        n.name as nation_name
from __dbt__CTE__customer as c
JOIN __dbt__CTE__nation as n
ON c.nationkey=n.nationkey
),  __dbt__CTE__orders as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  o_orderkey as orderkey,
        o_custkey as custkey,
        o_totalprice as totalprice,
        o_orderdate as orderdate
from snowflake_sample_data.tpch_sf1.orders
),  __dbt__CTE__lineitem as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  l_orderkey as orderkey,
        l_extendedprice as extendedprice,
        l_discount as discount,
        l_tax as tax,
        l_quantity as quantity
from snowflake_sample_data.tpch_sf1.lineitem
),  __dbt__CTE__orders_lineitem as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  o.orderkey,
        o.custkey,
        o.totalprice,
        o.orderdate,
        l.extendedprice,
        l.discount,
        l.tax,
        l.quantity
from __dbt__CTE__orders as o
JOIN __dbt__CTE__lineitem as l
ON o.orderkey=l.orderkey
),  __dbt__CTE__cust_list_ord_nat as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  cn.custkey,
        cn.nationkey,
        cn.customer_name,
        cn.nation_name,
        ol.orderkey,
        ol.totalprice,
        ol.orderdate,
        ol.extendedprice,
        ol.discount,
        ol.tax,
        ol.quantity
from __dbt__CTE__customer_nation as cn
JOIN __dbt__CTE__orders_lineitem as ol
ON cn.custkey=ol.custkey
)/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  

price * (1.0 - discount)

 as discounted_price_pre_tax,
        



price * (1.0 - discount)

 * (1.0 + tax_rate)

 as discounted_price,
        



price * (1.0 - discount)

 * tax_rate

 as tax_charged,
        *
from __dbt__CTE__cust_list_ord_nat
      );
2020-06-30 20:27:13.234356 (Thread-1): Snowflake query id: 019542ab-0220-3521-0000-2aed011d1b02
2020-06-30 20:27:13.234489 (Thread-1): Snowflake error: 000904 (42000): SQL compilation error: error line 193 at position 0
invalid identifier 'PRICE'
2020-06-30 20:27:13.234591 (Thread-1): On model.sample_project.sales_report_one: ROLLBACK
2020-06-30 20:27:13.234672 (Thread-1): initiating rollback
2020-06-30 20:27:13.521840 (Thread-1): finished collecting timing info
2020-06-30 20:27:13.522322 (Thread-1): Database Error in model sales_report_one (models/reports/sales_report_one.sql)
  000904 (42000): SQL compilation error: error line 193 at position 0
  invalid identifier 'PRICE'
  compiled SQL at target/run/sample_project/models/reports/sales_report_one.sql
Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 158, in exception_handler
    yield
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/cursor.py", line 597, in execute
    errvalue)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/errors.py", line 97, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, errorclass, errorvalue)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/errors.py", line 73, in default_errorhandler
    done_format_msg=errorvalue.get(u'done_format_msg'))
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 193 at position 0
invalid identifier 'PRICE'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 119, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 306, in add_query
    abridge_sql_log=abridge_sql_log
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/usr/local/opt/python/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 177, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model sales_report_one (models/reports/sales_report_one.sql)
  000904 (42000): SQL compilation error: error line 193 at position 0
  invalid identifier 'PRICE'
  compiled SQL at target/run/sample_project/models/reports/sales_report_one.sql
2020-06-30 20:27:13.527067 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11e619df-7db1-46ac-a184-c31e5db4f231', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f73c110>]}
2020-06-30 20:27:13.528197 (Thread-1): 15:27:13 | 3 of 4 ERROR creating table model TEST.sales_report_one.............. [ERROR in 1.11s]
2020-06-30 20:27:13.528332 (Thread-1): Finished running node model.sample_project.sales_report_one
2020-06-30 20:27:13.528472 (Thread-1): Began running node model.sample_project.sales_report_two
2020-06-30 20:27:13.530460 (Thread-1): 15:27:13 | 4 of 4 START table model TEST.sales_report_two....................... [RUN]
2020-06-30 20:27:13.530728 (Thread-1): Acquiring new snowflake connection "model.sample_project.sales_report_two".
2020-06-30 20:27:13.530828 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.sales_report_one).
2020-06-30 20:27:13.530927 (Thread-1): Compiling model.sample_project.sales_report_two
2020-06-30 20:27:13.542345 (Thread-1): Writing injected SQL for node "model.sample_project.sales_report_two"
2020-06-30 20:27:13.542694 (Thread-1): finished collecting timing info
2020-06-30 20:27:13.546549 (Thread-1): Writing runtime SQL for node "model.sample_project.sales_report_two"
2020-06-30 20:27:13.551405 (Thread-1): Using snowflake connection "model.sample_project.sales_report_two".
2020-06-30 20:27:13.551580 (Thread-1): On model.sample_project.sales_report_two: BEGIN
2020-06-30 20:27:13.798155 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2020-06-30 20:27:13.798292 (Thread-1): Using snowflake connection "model.sample_project.sales_report_two".
2020-06-30 20:27:13.798370 (Thread-1): On model.sample_project.sales_report_two: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "model.sample_project.sales_report_two"} */


      create or replace transient table JAVEN_TESTING.TEST.sales_report_two  as
      (with __dbt__CTE__customer as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  c_custkey as custkey,
        c_nationkey as nationkey,
        c_name as name
from snowflake_sample_data.tpch_sf1.customer
),  __dbt__CTE__nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  n_nationkey as nationkey,
        n_name as name
from snowflake_sample_data.tpch_sf1.nation
),  __dbt__CTE__customer_nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  c.custkey,
        c.nationkey,
        c.name as customer_name,
        n.name as nation_name
from __dbt__CTE__customer as c
JOIN __dbt__CTE__nation as n
ON c.nationkey=n.nationkey
),  __dbt__CTE__orders as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  o_orderkey as orderkey,
        o_custkey as custkey,
        o_totalprice as totalprice,
        o_orderdate as orderdate
from snowflake_sample_data.tpch_sf1.orders
),  __dbt__CTE__lineitem as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  l_orderkey as orderkey,
        l_extendedprice as extendedprice,
        l_discount as discount,
        l_tax as tax,
        l_quantity as quantity
from snowflake_sample_data.tpch_sf1.lineitem
),  __dbt__CTE__orders_lineitem as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  o.orderkey,
        o.custkey,
        o.totalprice,
        o.orderdate,
        l.extendedprice,
        l.discount,
        l.tax,
        l.quantity
from __dbt__CTE__orders as o
JOIN __dbt__CTE__lineitem as l
ON o.orderkey=l.orderkey
),  __dbt__CTE__cust_list_ord_nat as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  cn.custkey,
        cn.nationkey,
        cn.customer_name,
        cn.nation_name,
        ol.orderkey,
        ol.totalprice,
        ol.orderdate,
        ol.extendedprice,
        ol.discount,
        ol.tax,
        ol.quantity
from __dbt__CTE__customer_nation as cn
JOIN __dbt__CTE__orders_lineitem as ol
ON cn.custkey=ol.custkey
)/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  listagg(discount, '|~~|') as discounts,
        avg(



price * (1.0 - discount)

 * tax_rate

) as average_tax,
        orderkey,
        custkey
from __dbt__CTE__cust_list_ord_nat
group by orderkey, custkey
      );
2020-06-30 20:27:14.235375 (Thread-1): Snowflake query id: 019542ab-0203-86b8-0000-2aed011d1b0e
2020-06-30 20:27:14.235512 (Thread-1): Snowflake error: 000904 (42000): SQL compilation error: error line 196 at position 0
invalid identifier 'PRICE'
2020-06-30 20:27:14.235614 (Thread-1): On model.sample_project.sales_report_two: ROLLBACK
2020-06-30 20:27:14.235694 (Thread-1): initiating rollback
2020-06-30 20:27:14.582514 (Thread-1): finished collecting timing info
2020-06-30 20:27:14.583061 (Thread-1): Database Error in model sales_report_two (models/reports/sales_report_two.sql)
  000904 (42000): SQL compilation error: error line 196 at position 0
  invalid identifier 'PRICE'
  compiled SQL at target/run/sample_project/models/reports/sales_report_two.sql
Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 158, in exception_handler
    yield
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/cursor.py", line 597, in execute
    errvalue)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/errors.py", line 97, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, errorclass, errorvalue)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/snowflake/connector/errors.py", line 73, in default_errorhandler
    done_format_msg=errorvalue.get(u'done_format_msg'))
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 196 at position 0
invalid identifier 'PRICE'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 119, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 306, in add_query
    abridge_sql_log=abridge_sql_log
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/usr/local/opt/python/Frameworks/Python.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/adapters/snowflake/connections.py", line 177, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model sales_report_two (models/reports/sales_report_two.sql)
  000904 (42000): SQL compilation error: error line 196 at position 0
  invalid identifier 'PRICE'
  compiled SQL at target/run/sample_project/models/reports/sales_report_two.sql
2020-06-30 20:27:14.583648 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11e619df-7db1-46ac-a184-c31e5db4f231', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8070d0>]}
2020-06-30 20:27:14.584823 (Thread-1): 15:27:14 | 4 of 4 ERROR creating table model TEST.sales_report_two.............. [ERROR in 1.05s]
2020-06-30 20:27:14.584960 (Thread-1): Finished running node model.sample_project.sales_report_two
2020-06-30 20:27:14.677921 (MainThread): Using snowflake connection "master".
2020-06-30 20:27:14.678055 (MainThread): On master: BEGIN
2020-06-30 20:27:14.920725 (MainThread): SQL status: SUCCESS 1 in 0.24 seconds
2020-06-30 20:27:14.920886 (MainThread): On master: COMMIT
2020-06-30 20:27:14.921016 (MainThread): Using snowflake connection "master".
2020-06-30 20:27:14.921102 (MainThread): On master: COMMIT
2020-06-30 20:27:15.247182 (MainThread): SQL status: SUCCESS 1 in 0.33 seconds
2020-06-30 20:27:15.247604 (MainThread): 15:27:15 | 
2020-06-30 20:27:15.247762 (MainThread): 15:27:15 | Finished running 4 table models in 20.10s.
2020-06-30 20:27:15.247888 (MainThread): Connection 'master' was left open.
2020-06-30 20:27:15.247988 (MainThread): On master: Close
2020-06-30 20:27:15.573081 (MainThread): Connection 'model.sample_project.sales_report_two' was left open.
2020-06-30 20:27:15.573256 (MainThread): On model.sample_project.sales_report_two: Close
2020-06-30 20:27:15.879945 (MainThread): 
2020-06-30 20:27:15.880092 (MainThread): Completed with 3 errors and 0 warnings:
2020-06-30 20:27:15.880274 (MainThread): 
2020-06-30 20:27:15.880369 (MainThread): Compilation Error in model order_statistics (models/reports/order_statistics.sql)
2020-06-30 20:27:15.880454 (MainThread):   'dbt_utils' is undefined
2020-06-30 20:27:15.880538 (MainThread): 
2020-06-30 20:27:15.880627 (MainThread): Database Error in model sales_report_one (models/reports/sales_report_one.sql)
2020-06-30 20:27:15.880710 (MainThread):   000904 (42000): SQL compilation error: error line 193 at position 0
2020-06-30 20:27:15.880788 (MainThread):   invalid identifier 'PRICE'
2020-06-30 20:27:15.880920 (MainThread):   compiled SQL at target/run/sample_project/models/reports/sales_report_one.sql
2020-06-30 20:27:15.880999 (MainThread): 
2020-06-30 20:27:15.881083 (MainThread): Database Error in model sales_report_two (models/reports/sales_report_two.sql)
2020-06-30 20:27:15.881187 (MainThread):   000904 (42000): SQL compilation error: error line 196 at position 0
2020-06-30 20:27:15.881275 (MainThread):   invalid identifier 'PRICE'
2020-06-30 20:27:15.881478 (MainThread):   compiled SQL at target/run/sample_project/models/reports/sales_report_two.sql
2020-06-30 20:27:15.881677 (MainThread): 
Done. PASS=1 WARN=0 ERROR=3 SKIP=0 TOTAL=4
2020-06-30 20:27:15.881949 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f6cccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f77a710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f5f6690>]}
2020-06-30 20:27:15.882264 (MainThread): Flushing usage events
2020-06-30 20:27:39.296885 (MainThread): Running with dbt=0.17.0
2020-06-30 20:27:39.612662 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='deps', single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='deps', write_json=True)
2020-06-30 20:27:39.613080 (MainThread): Tracking: tracking
2020-06-30 20:27:39.613213 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11162d710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136469d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113646cd0>]}
2020-06-30 20:27:39.615057 (MainThread): Set downloads directory='/var/folders/5x/fg3q44_x4y373r2024plj4fc0000gp/T/dbt-downloads-0cx9q_9k'
2020-06-30 20:27:39.615778 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/index.json
2020-06-30 20:27:40.066617 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/index.json 200
2020-06-30 20:27:40.066811 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils.json
2020-06-30 20:27:40.363238 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils.json 200
2020-06-30 20:27:40.373139 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils/0.4.0.json
2020-06-30 20:27:40.634896 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils/0.4.0.json 200
2020-06-30 20:27:40.639052 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils.json
2020-06-30 20:27:40.939602 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils.json 200
2020-06-30 20:27:40.950059 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils/0.4.0.json
2020-06-30 20:27:41.237352 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils/0.4.0.json 200
2020-06-30 20:27:41.238144 (MainThread): Installing fishtown-analytics/dbt_utils@0.4.0
2020-06-30 20:27:41.854664 (MainThread):   Installed from version 0.4.0

2020-06-30 20:27:41.854886 (MainThread): Sending event: {'category': 'dbt', 'action': 'package', 'label': '0424d7cb-9cd4-418d-83ce-40bedfb81efb', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113646f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f76dfd0>]}
2020-06-30 20:27:41.855543 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ab1a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115cf6710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11162d710>]}
2020-06-30 20:27:41.855717 (MainThread): Flushing usage events
2020-06-30 20:30:00.184843 (MainThread): Running with dbt=0.17.0
2020-06-30 20:30:00.492826 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2020-06-30 20:30:00.493712 (MainThread): Tracking: tracking
2020-06-30 20:30:00.493979 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9259d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d93cdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d93c9d0>]}
2020-06-30 20:30:00.518845 (MainThread): Partial parsing not enabled
2020-06-30 20:30:00.521307 (MainThread): Parsing macros/core.sql
2020-06-30 20:30:00.527019 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-30 20:30:00.535784 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-30 20:30:00.537912 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-30 20:30:00.558549 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-30 20:30:00.594643 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-30 20:30:00.620493 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-30 20:30:00.622525 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-30 20:30:00.629724 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-30 20:30:00.644815 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-30 20:30:00.655228 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-30 20:30:00.662558 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-30 20:30:00.668409 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-30 20:30:00.669421 (MainThread): Parsing macros/etc/query.sql
2020-06-30 20:30:00.670608 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-30 20:30:00.672639 (MainThread): Parsing macros/etc/datetime.sql
2020-06-30 20:30:00.683342 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-30 20:30:00.687042 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-30 20:30:00.690476 (MainThread): Parsing macros/adapters/common.sql
2020-06-30 20:30:00.749424 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-30 20:30:00.750847 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-30 20:30:00.752026 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-30 20:30:00.753388 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-30 20:30:00.755966 (MainThread): Parsing macros/catalog.sql
2020-06-30 20:30:00.758262 (MainThread): Parsing macros/adapters.sql
2020-06-30 20:30:00.782932 (MainThread): Parsing macros/materializations/merge.sql
2020-06-30 20:30:00.785139 (MainThread): Parsing macros/materializations/view.sql
2020-06-30 20:30:00.786447 (MainThread): Parsing macros/materializations/table.sql
2020-06-30 20:30:00.790616 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-30 20:30:00.833898 (MainThread): Partial parsing not enabled
2020-06-30 20:30:00.834331 (MainThread): Parsing macros/discounted_price.sql
2020-06-30 20:30:00.835046 (MainThread): Parsing macros/tax_charged.sql
2020-06-30 20:30:00.835856 (MainThread): Parsing macros/full_charge.sql
2020-06-30 20:30:00.836671 (MainThread): Parsing macros/test_is_nonnegative.sql
2020-06-30 20:30:00.838885 (MainThread): Parsing macros/cross_db_utils/except.sql
2020-06-30 20:30:00.840151 (MainThread): Parsing macros/cross_db_utils/replace.sql
2020-06-30 20:30:00.841511 (MainThread): Parsing macros/cross_db_utils/concat.sql
2020-06-30 20:30:00.844099 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2020-06-30 20:30:00.850207 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2020-06-30 20:30:00.851755 (MainThread): Parsing macros/cross_db_utils/length.sql
2020-06-30 20:30:00.853363 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2020-06-30 20:30:00.855954 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2020-06-30 20:30:00.857067 (MainThread): Parsing macros/cross_db_utils/right.sql
2020-06-30 20:30:00.859613 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2020-06-30 20:30:00.870440 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2020-06-30 20:30:00.872511 (MainThread): Parsing macros/cross_db_utils/hash.sql
2020-06-30 20:30:00.874047 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2020-06-30 20:30:00.875605 (MainThread): Parsing macros/cross_db_utils/position.sql
2020-06-30 20:30:00.877339 (MainThread): Parsing macros/cross_db_utils/literal.sql
2020-06-30 20:30:00.878419 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2020-06-30 20:30:00.882463 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2020-06-30 20:30:00.892148 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2020-06-30 20:30:00.896120 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2020-06-30 20:30:00.898601 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2020-06-30 20:30:00.901530 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2020-06-30 20:30:00.930908 (MainThread): Parsing macros/logger/pretty_log_format.sql
2020-06-30 20:30:00.931685 (MainThread): Parsing macros/logger/pretty_time.sql
2020-06-30 20:30:00.933022 (MainThread): Parsing macros/logger/log_info.sql
2020-06-30 20:30:00.934084 (MainThread): Parsing macros/datetime/date_spine.sql
2020-06-30 20:30:00.937901 (MainThread): Parsing macros/web/get_url_host.sql
2020-06-30 20:30:00.939415 (MainThread): Parsing macros/web/get_url_path.sql
2020-06-30 20:30:00.941788 (MainThread): Parsing macros/web/get_url_parameter.sql
2020-06-30 20:30:00.943061 (MainThread): Parsing macros/geo/haversine_distance.sql
2020-06-30 20:30:00.944249 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2020-06-30 20:30:00.945670 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2020-06-30 20:30:00.948060 (MainThread): Parsing macros/schema_tests/recency.sql
2020-06-30 20:30:00.950382 (MainThread): Parsing macros/schema_tests/not_constant.sql
2020-06-30 20:30:00.952457 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2020-06-30 20:30:00.954472 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2020-06-30 20:30:00.956755 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2020-06-30 20:30:00.960628 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2020-06-30 20:30:00.963110 (MainThread): Parsing macros/schema_tests/equality.sql
2020-06-30 20:30:00.968135 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2020-06-30 20:30:00.977936 (MainThread): Parsing macros/sql/nullcheck_table.sql
2020-06-30 20:30:00.979961 (MainThread): Parsing macros/sql/generate_series.sql
2020-06-30 20:30:00.986133 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2020-06-30 20:30:00.992178 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2020-06-30 20:30:00.995371 (MainThread): Parsing macros/sql/star.sql
2020-06-30 20:30:00.998577 (MainThread): Parsing macros/sql/unpivot.sql
2020-06-30 20:30:01.007154 (MainThread): Parsing macros/sql/union.sql
2020-06-30 20:30:01.017444 (MainThread): Parsing macros/sql/groupby.sql
2020-06-30 20:30:01.018460 (MainThread): Parsing macros/sql/surrogate_key.sql
2020-06-30 20:30:01.021382 (MainThread): Parsing macros/sql/safe_add.sql
2020-06-30 20:30:01.022525 (MainThread): Parsing macros/sql/nullcheck.sql
2020-06-30 20:30:01.023882 (MainThread): Parsing macros/sql/get_column_values.sql
2020-06-30 20:30:01.028488 (MainThread): Parsing macros/sql/pivot.sql
2020-06-30 20:30:01.031344 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2020-06-30 20:30:01.079455 (MainThread): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 20:30:01.079739 (MainThread): Opening a new connection, currently in state init
2020-06-30 20:30:01.116934 (MainThread): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 20:30:01.117061 (MainThread): Opening a new connection, currently in state init
2020-06-30 20:30:01.129024 (MainThread): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 20:30:01.129117 (MainThread): Opening a new connection, currently in state init
2020-06-30 20:30:01.144391 (MainThread): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 20:30:01.144507 (MainThread): Opening a new connection, currently in state init
2020-06-30 20:30:01.156753 (MainThread): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 20:30:01.156851 (MainThread): Opening a new connection, currently in state init
2020-06-30 20:30:01.169952 (MainThread): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 20:30:01.170051 (MainThread): Opening a new connection, currently in state init
2020-06-30 20:30:01.183788 (MainThread): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 20:30:01.183892 (MainThread): Opening a new connection, currently in state init
2020-06-30 20:30:01.200946 (MainThread): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 20:30:01.201076 (MainThread): Opening a new connection, currently in state init
2020-06-30 20:30:01.214364 (MainThread): Acquiring new snowflake connection "model.sample_project.sales_report_one".
2020-06-30 20:30:01.214475 (MainThread): Opening a new connection, currently in state init
2020-06-30 20:30:01.231256 (MainThread): Acquiring new snowflake connection "model.sample_project.order_statistics".
2020-06-30 20:30:01.231356 (MainThread): Opening a new connection, currently in state init
2020-06-30 20:30:01.246561 (MainThread): Acquiring new snowflake connection "model.sample_project.sales_report_two".
2020-06-30 20:30:01.246663 (MainThread): Opening a new connection, currently in state init
2020-06-30 20:30:01.707195 (MainThread): Found 11 models, 8 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 4 sources
2020-06-30 20:30:01.708774 (MainThread): 
2020-06-30 20:30:01.709035 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 20:30:01.709133 (MainThread): Opening a new connection, currently in state init
2020-06-30 20:30:01.714447 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_JAVEN_TESTING".
2020-06-30 20:30:01.714622 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-06-30 20:30:01.728247 (ThreadPoolExecutor-0_0): Using snowflake connection "list_JAVEN_TESTING".
2020-06-30 20:30:01.728352 (ThreadPoolExecutor-0_0): On list_JAVEN_TESTING: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING"} */

    show terse schemas in database JAVEN_TESTING
    limit 10000
2020-06-30 20:30:02.229153 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/certifi/cacert.pem'>
2020-06-30 20:30:07.289729 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 5.56 seconds
2020-06-30 20:30:07.319437 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 20:30:07.319643 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_JAVEN_TESTING).
2020-06-30 20:30:07.325999 (ThreadPoolExecutor-1_0): Using snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 20:30:07.326228 (ThreadPoolExecutor-1_0): On list_JAVEN_TESTING_TEST: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING_TEST"} */

    show terse objects in JAVEN_TESTING.TEST
2020-06-30 20:30:07.557421 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 10 in 0.23 seconds
2020-06-30 20:30:07.566886 (MainThread): 15:30:07 | Concurrency: 1 threads (target='dev')
2020-06-30 20:30:07.567017 (MainThread): 15:30:07 | 
2020-06-30 20:30:07.567715 (Thread-1): Began running node model.sample_project.customer
2020-06-30 20:30:07.568002 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 20:30:07.568088 (Thread-1): Re-using an available connection from the pool (formerly list_JAVEN_TESTING_TEST).
2020-06-30 20:30:07.568175 (Thread-1): Compiling model.sample_project.customer
2020-06-30 20:30:07.583319 (Thread-1): Writing injected SQL for node "model.sample_project.customer"
2020-06-30 20:30:07.583640 (Thread-1): finished collecting timing info
2020-06-30 20:30:07.583974 (Thread-1): Finished running node model.sample_project.customer
2020-06-30 20:30:07.584086 (Thread-1): Began running node model.sample_project.lineitem
2020-06-30 20:30:07.584355 (Thread-1): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 20:30:07.584446 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer).
2020-06-30 20:30:07.584526 (Thread-1): Compiling model.sample_project.lineitem
2020-06-30 20:30:07.593132 (Thread-1): Writing injected SQL for node "model.sample_project.lineitem"
2020-06-30 20:30:07.593503 (Thread-1): finished collecting timing info
2020-06-30 20:30:07.594016 (Thread-1): Finished running node model.sample_project.lineitem
2020-06-30 20:30:07.594239 (Thread-1): Began running node model.sample_project.nation
2020-06-30 20:30:07.594684 (Thread-1): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 20:30:07.594810 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.lineitem).
2020-06-30 20:30:07.594955 (Thread-1): Compiling model.sample_project.nation
2020-06-30 20:30:07.602711 (Thread-1): Writing injected SQL for node "model.sample_project.nation"
2020-06-30 20:30:07.602986 (Thread-1): finished collecting timing info
2020-06-30 20:30:07.603300 (Thread-1): Finished running node model.sample_project.nation
2020-06-30 20:30:07.603410 (Thread-1): Began running node model.sample_project.orders
2020-06-30 20:30:07.603691 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 20:30:07.603896 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.nation).
2020-06-30 20:30:07.604126 (Thread-1): Compiling model.sample_project.orders
2020-06-30 20:30:07.612242 (Thread-1): Writing injected SQL for node "model.sample_project.orders"
2020-06-30 20:30:07.612523 (Thread-1): finished collecting timing info
2020-06-30 20:30:07.612854 (Thread-1): Finished running node model.sample_project.orders
2020-06-30 20:30:07.612970 (Thread-1): Began running node test.sample_project.source_is_nonnegative_tpch_customer_c_custkey
2020-06-30 20:30:07.613407 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_nonnegative_tpch_customer_c_custkey".
2020-06-30 20:30:07.613649 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders).
2020-06-30 20:30:07.613757 (Thread-1): Compiling test.sample_project.source_is_nonnegative_tpch_customer_c_custkey
2020-06-30 20:30:07.628164 (Thread-1): Writing injected SQL for node "test.sample_project.source_is_nonnegative_tpch_customer_c_custkey"
2020-06-30 20:30:07.628588 (Thread-1): finished collecting timing info
2020-06-30 20:30:07.628796 (Thread-1): finished collecting timing info
2020-06-30 20:30:07.629106 (Thread-1): Finished running node test.sample_project.source_is_nonnegative_tpch_customer_c_custkey
2020-06-30 20:30:07.629221 (Thread-1): Began running node test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey
2020-06-30 20:30:07.629483 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey".
2020-06-30 20:30:07.629572 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_nonnegative_tpch_customer_c_custkey).
2020-06-30 20:30:07.629651 (Thread-1): Compiling test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey
2020-06-30 20:30:07.637705 (Thread-1): Writing injected SQL for node "test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey"
2020-06-30 20:30:07.637980 (Thread-1): finished collecting timing info
2020-06-30 20:30:07.638183 (Thread-1): finished collecting timing info
2020-06-30 20:30:07.638514 (Thread-1): Finished running node test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey
2020-06-30 20:30:07.638638 (Thread-1): Began running node test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice
2020-06-30 20:30:07.639209 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice".
2020-06-30 20:30:07.639349 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey).
2020-06-30 20:30:07.639426 (Thread-1): Compiling test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice
2020-06-30 20:30:07.648614 (Thread-1): Writing injected SQL for node "test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice"
2020-06-30 20:30:07.648907 (Thread-1): finished collecting timing info
2020-06-30 20:30:07.649114 (Thread-1): finished collecting timing info
2020-06-30 20:30:07.649466 (Thread-1): Finished running node test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice
2020-06-30 20:30:07.649644 (Thread-1): Began running node test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey
2020-06-30 20:30:07.649891 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey".
2020-06-30 20:30:07.650022 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice).
2020-06-30 20:30:07.650119 (Thread-1): Compiling test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey
2020-06-30 20:30:07.658394 (Thread-1): Writing injected SQL for node "test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey"
2020-06-30 20:30:07.658777 (Thread-1): finished collecting timing info
2020-06-30 20:30:07.659074 (Thread-1): finished collecting timing info
2020-06-30 20:30:07.659512 (Thread-1): Finished running node test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey
2020-06-30 20:30:07.659622 (Thread-1): Began running node test.sample_project.source_is_nonnegative_tpch_orders_o_custkey
2020-06-30 20:30:07.659985 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_nonnegative_tpch_orders_o_custkey".
2020-06-30 20:30:07.660076 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey).
2020-06-30 20:30:07.660154 (Thread-1): Compiling test.sample_project.source_is_nonnegative_tpch_orders_o_custkey
2020-06-30 20:30:07.668106 (Thread-1): Writing injected SQL for node "test.sample_project.source_is_nonnegative_tpch_orders_o_custkey"
2020-06-30 20:30:07.668380 (Thread-1): finished collecting timing info
2020-06-30 20:30:07.668579 (Thread-1): finished collecting timing info
2020-06-30 20:30:07.668903 (Thread-1): Finished running node test.sample_project.source_is_nonnegative_tpch_orders_o_custkey
2020-06-30 20:30:07.669078 (Thread-1): Began running node test.sample_project.source_unique_tpch_customer_c_custkey
2020-06-30 20:30:07.669424 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_unique_tpch_customer_c_custkey".
2020-06-30 20:30:07.669514 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_nonnegative_tpch_orders_o_custkey).
2020-06-30 20:30:07.669844 (Thread-1): Compiling test.sample_project.source_unique_tpch_customer_c_custkey
2020-06-30 20:30:07.677777 (Thread-1): Writing injected SQL for node "test.sample_project.source_unique_tpch_customer_c_custkey"
2020-06-30 20:30:07.678049 (Thread-1): finished collecting timing info
2020-06-30 20:30:07.678250 (Thread-1): finished collecting timing info
2020-06-30 20:30:07.678623 (Thread-1): Finished running node test.sample_project.source_unique_tpch_customer_c_custkey
2020-06-30 20:30:07.678732 (Thread-1): Began running node test.sample_project.source_unique_tpch_nation_n_nationkey
2020-06-30 20:30:07.679006 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_unique_tpch_nation_n_nationkey".
2020-06-30 20:30:07.679097 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_unique_tpch_customer_c_custkey).
2020-06-30 20:30:07.679175 (Thread-1): Compiling test.sample_project.source_unique_tpch_nation_n_nationkey
2020-06-30 20:30:07.687552 (Thread-1): Writing injected SQL for node "test.sample_project.source_unique_tpch_nation_n_nationkey"
2020-06-30 20:30:07.688079 (Thread-1): finished collecting timing info
2020-06-30 20:30:07.688332 (Thread-1): finished collecting timing info
2020-06-30 20:30:07.688658 (Thread-1): Finished running node test.sample_project.source_unique_tpch_nation_n_nationkey
2020-06-30 20:30:07.688772 (Thread-1): Began running node test.sample_project.source_unique_tpch_orders_o_orderkey
2020-06-30 20:30:07.689045 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_unique_tpch_orders_o_orderkey".
2020-06-30 20:30:07.689135 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_unique_tpch_nation_n_nationkey).
2020-06-30 20:30:07.689212 (Thread-1): Compiling test.sample_project.source_unique_tpch_orders_o_orderkey
2020-06-30 20:30:07.697382 (Thread-1): Writing injected SQL for node "test.sample_project.source_unique_tpch_orders_o_orderkey"
2020-06-30 20:30:07.697761 (Thread-1): finished collecting timing info
2020-06-30 20:30:07.698230 (Thread-1): finished collecting timing info
2020-06-30 20:30:07.698879 (Thread-1): Finished running node test.sample_project.source_unique_tpch_orders_o_orderkey
2020-06-30 20:30:07.699210 (Thread-1): Began running node model.sample_project.customer_nation
2020-06-30 20:30:07.699733 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 20:30:07.699881 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_unique_tpch_orders_o_orderkey).
2020-06-30 20:30:07.699977 (Thread-1): Compiling model.sample_project.customer_nation
2020-06-30 20:30:07.716816 (Thread-1): Writing injected SQL for node "model.sample_project.customer_nation"
2020-06-30 20:30:07.717238 (Thread-1): finished collecting timing info
2020-06-30 20:30:07.717605 (Thread-1): Finished running node model.sample_project.customer_nation
2020-06-30 20:30:07.717727 (Thread-1): Began running node model.sample_project.orders_lineitem
2020-06-30 20:30:07.718137 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 20:30:07.718308 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer_nation).
2020-06-30 20:30:07.718406 (Thread-1): Compiling model.sample_project.orders_lineitem
2020-06-30 20:30:07.730360 (Thread-1): Writing injected SQL for node "model.sample_project.orders_lineitem"
2020-06-30 20:30:07.730649 (Thread-1): finished collecting timing info
2020-06-30 20:30:07.730998 (Thread-1): Finished running node model.sample_project.orders_lineitem
2020-06-30 20:30:07.731120 (Thread-1): Began running node model.sample_project.customers_per_nation
2020-06-30 20:30:07.731494 (Thread-1): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 20:30:07.731606 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders_lineitem).
2020-06-30 20:30:07.731691 (Thread-1): Compiling model.sample_project.customers_per_nation
2020-06-30 20:30:07.739593 (Thread-1): Writing injected SQL for node "model.sample_project.customers_per_nation"
2020-06-30 20:30:07.739876 (Thread-1): finished collecting timing info
2020-06-30 20:30:07.740087 (Thread-1): finished collecting timing info
2020-06-30 20:30:07.740435 (Thread-1): Finished running node model.sample_project.customers_per_nation
2020-06-30 20:30:07.740565 (Thread-1): Began running node model.sample_project.cust_list_ord_nat
2020-06-30 20:30:07.740963 (Thread-1): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 20:30:07.741060 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customers_per_nation).
2020-06-30 20:30:07.741144 (Thread-1): Compiling model.sample_project.cust_list_ord_nat
2020-06-30 20:30:07.754361 (Thread-1): Writing injected SQL for node "model.sample_project.cust_list_ord_nat"
2020-06-30 20:30:07.755526 (Thread-1): finished collecting timing info
2020-06-30 20:30:07.755919 (Thread-1): Finished running node model.sample_project.cust_list_ord_nat
2020-06-30 20:30:07.756045 (Thread-1): Began running node model.sample_project.order_statistics
2020-06-30 20:30:07.756274 (Thread-1): Acquiring new snowflake connection "model.sample_project.order_statistics".
2020-06-30 20:30:07.756521 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.cust_list_ord_nat).
2020-06-30 20:30:07.756636 (Thread-1): Compiling model.sample_project.order_statistics
2020-06-30 20:30:07.768416 (Thread-1): Writing injected SQL for node "model.sample_project.order_statistics"
2020-06-30 20:30:07.768719 (Thread-1): finished collecting timing info
2020-06-30 20:30:07.768939 (Thread-1): finished collecting timing info
2020-06-30 20:30:07.769308 (Thread-1): Finished running node model.sample_project.order_statistics
2020-06-30 20:30:07.769429 (Thread-1): Began running node model.sample_project.sales_report_one
2020-06-30 20:30:07.769705 (Thread-1): Acquiring new snowflake connection "model.sample_project.sales_report_one".
2020-06-30 20:30:07.769895 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.order_statistics).
2020-06-30 20:30:07.770063 (Thread-1): Compiling model.sample_project.sales_report_one
2020-06-30 20:30:07.782032 (Thread-1): Writing injected SQL for node "model.sample_project.sales_report_one"
2020-06-30 20:30:07.782349 (Thread-1): finished collecting timing info
2020-06-30 20:30:07.782560 (Thread-1): finished collecting timing info
2020-06-30 20:30:07.782878 (Thread-1): Finished running node model.sample_project.sales_report_one
2020-06-30 20:30:07.783053 (Thread-1): Began running node model.sample_project.sales_report_two
2020-06-30 20:30:07.783371 (Thread-1): Acquiring new snowflake connection "model.sample_project.sales_report_two".
2020-06-30 20:30:07.783465 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.sales_report_one).
2020-06-30 20:30:07.783546 (Thread-1): Compiling model.sample_project.sales_report_two
2020-06-30 20:30:07.794260 (Thread-1): Writing injected SQL for node "model.sample_project.sales_report_two"
2020-06-30 20:30:07.795116 (Thread-1): finished collecting timing info
2020-06-30 20:30:07.795496 (Thread-1): finished collecting timing info
2020-06-30 20:30:07.796041 (Thread-1): Finished running node model.sample_project.sales_report_two
2020-06-30 20:30:07.883497 (MainThread): Connection 'master' was properly closed.
2020-06-30 20:30:07.883641 (MainThread): Connection 'model.sample_project.sales_report_two' was left open.
2020-06-30 20:30:07.883816 (MainThread): On model.sample_project.sales_report_two: Close
2020-06-30 20:30:08.170815 (MainThread): 15:30:08 | Done.
2020-06-30 20:30:08.171011 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e06e5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e250290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110631310>]}
2020-06-30 20:30:08.171178 (MainThread): Flushing usage events
2020-06-30 20:30:16.243707 (MainThread): Running with dbt=0.17.0
2020-06-30 20:30:16.557573 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-06-30 20:30:16.558401 (MainThread): Tracking: tracking
2020-06-30 20:30:16.558715 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e71f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112928a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112928a10>]}
2020-06-30 20:30:16.586663 (MainThread): Partial parsing not enabled
2020-06-30 20:30:16.589784 (MainThread): Parsing macros/core.sql
2020-06-30 20:30:16.597570 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-30 20:30:16.608350 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-30 20:30:16.610439 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-30 20:30:16.631208 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-30 20:30:16.663764 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-30 20:30:16.687812 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-30 20:30:16.690136 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-30 20:30:16.697314 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-30 20:30:16.713476 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-30 20:30:16.721680 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-30 20:30:16.728421 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-30 20:30:16.734103 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-30 20:30:16.735137 (MainThread): Parsing macros/etc/query.sql
2020-06-30 20:30:16.736286 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-30 20:30:16.738017 (MainThread): Parsing macros/etc/datetime.sql
2020-06-30 20:30:16.747917 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-30 20:30:16.750149 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-30 20:30:16.751859 (MainThread): Parsing macros/adapters/common.sql
2020-06-30 20:30:16.806939 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-30 20:30:16.808473 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-30 20:30:16.809895 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-30 20:30:16.811266 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-30 20:30:16.814383 (MainThread): Parsing macros/catalog.sql
2020-06-30 20:30:16.816511 (MainThread): Parsing macros/adapters.sql
2020-06-30 20:30:16.840529 (MainThread): Parsing macros/materializations/merge.sql
2020-06-30 20:30:16.842593 (MainThread): Parsing macros/materializations/view.sql
2020-06-30 20:30:16.843964 (MainThread): Parsing macros/materializations/table.sql
2020-06-30 20:30:16.848496 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-30 20:30:16.890059 (MainThread): Partial parsing not enabled
2020-06-30 20:30:16.890725 (MainThread): Parsing macros/discounted_price.sql
2020-06-30 20:30:16.891582 (MainThread): Parsing macros/tax_charged.sql
2020-06-30 20:30:16.892854 (MainThread): Parsing macros/full_charge.sql
2020-06-30 20:30:16.893645 (MainThread): Parsing macros/test_is_nonnegative.sql
2020-06-30 20:30:16.895980 (MainThread): Parsing macros/cross_db_utils/except.sql
2020-06-30 20:30:16.897090 (MainThread): Parsing macros/cross_db_utils/replace.sql
2020-06-30 20:30:16.898482 (MainThread): Parsing macros/cross_db_utils/concat.sql
2020-06-30 20:30:16.901250 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2020-06-30 20:30:16.908136 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2020-06-30 20:30:16.909653 (MainThread): Parsing macros/cross_db_utils/length.sql
2020-06-30 20:30:16.911388 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2020-06-30 20:30:16.913936 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2020-06-30 20:30:16.915003 (MainThread): Parsing macros/cross_db_utils/right.sql
2020-06-30 20:30:16.917682 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2020-06-30 20:30:16.928429 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2020-06-30 20:30:16.930446 (MainThread): Parsing macros/cross_db_utils/hash.sql
2020-06-30 20:30:16.931926 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2020-06-30 20:30:16.933714 (MainThread): Parsing macros/cross_db_utils/position.sql
2020-06-30 20:30:16.935392 (MainThread): Parsing macros/cross_db_utils/literal.sql
2020-06-30 20:30:16.936349 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2020-06-30 20:30:16.939603 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2020-06-30 20:30:16.945269 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2020-06-30 20:30:16.948677 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2020-06-30 20:30:16.951704 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2020-06-30 20:30:16.954320 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2020-06-30 20:30:16.986995 (MainThread): Parsing macros/logger/pretty_log_format.sql
2020-06-30 20:30:16.987749 (MainThread): Parsing macros/logger/pretty_time.sql
2020-06-30 20:30:16.988592 (MainThread): Parsing macros/logger/log_info.sql
2020-06-30 20:30:16.989326 (MainThread): Parsing macros/datetime/date_spine.sql
2020-06-30 20:30:16.993389 (MainThread): Parsing macros/web/get_url_host.sql
2020-06-30 20:30:16.994838 (MainThread): Parsing macros/web/get_url_path.sql
2020-06-30 20:30:16.997333 (MainThread): Parsing macros/web/get_url_parameter.sql
2020-06-30 20:30:16.998498 (MainThread): Parsing macros/geo/haversine_distance.sql
2020-06-30 20:30:16.999470 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2020-06-30 20:30:17.000831 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2020-06-30 20:30:17.003428 (MainThread): Parsing macros/schema_tests/recency.sql
2020-06-30 20:30:17.005024 (MainThread): Parsing macros/schema_tests/not_constant.sql
2020-06-30 20:30:17.007341 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2020-06-30 20:30:17.008794 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2020-06-30 20:30:17.011082 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2020-06-30 20:30:17.013371 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2020-06-30 20:30:17.014760 (MainThread): Parsing macros/schema_tests/equality.sql
2020-06-30 20:30:17.018360 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2020-06-30 20:30:17.024492 (MainThread): Parsing macros/sql/nullcheck_table.sql
2020-06-30 20:30:17.025613 (MainThread): Parsing macros/sql/generate_series.sql
2020-06-30 20:30:17.029319 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2020-06-30 20:30:17.033473 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2020-06-30 20:30:17.036381 (MainThread): Parsing macros/sql/star.sql
2020-06-30 20:30:17.039632 (MainThread): Parsing macros/sql/unpivot.sql
2020-06-30 20:30:17.046271 (MainThread): Parsing macros/sql/union.sql
2020-06-30 20:30:17.057007 (MainThread): Parsing macros/sql/groupby.sql
2020-06-30 20:30:17.058038 (MainThread): Parsing macros/sql/surrogate_key.sql
2020-06-30 20:30:17.060934 (MainThread): Parsing macros/sql/safe_add.sql
2020-06-30 20:30:17.062089 (MainThread): Parsing macros/sql/nullcheck.sql
2020-06-30 20:30:17.063471 (MainThread): Parsing macros/sql/get_column_values.sql
2020-06-30 20:30:17.068401 (MainThread): Parsing macros/sql/pivot.sql
2020-06-30 20:30:17.071603 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2020-06-30 20:30:17.119416 (MainThread): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 20:30:17.119685 (MainThread): Opening a new connection, currently in state init
2020-06-30 20:30:17.151179 (MainThread): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 20:30:17.151281 (MainThread): Opening a new connection, currently in state init
2020-06-30 20:30:17.164716 (MainThread): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 20:30:17.164979 (MainThread): Opening a new connection, currently in state init
2020-06-30 20:30:17.177782 (MainThread): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 20:30:17.177930 (MainThread): Opening a new connection, currently in state init
2020-06-30 20:30:17.189767 (MainThread): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 20:30:17.189858 (MainThread): Opening a new connection, currently in state init
2020-06-30 20:30:17.203216 (MainThread): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 20:30:17.203311 (MainThread): Opening a new connection, currently in state init
2020-06-30 20:30:17.215713 (MainThread): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 20:30:17.215800 (MainThread): Opening a new connection, currently in state init
2020-06-30 20:30:17.228444 (MainThread): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 20:30:17.228531 (MainThread): Opening a new connection, currently in state init
2020-06-30 20:30:17.239304 (MainThread): Acquiring new snowflake connection "model.sample_project.sales_report_one".
2020-06-30 20:30:17.239391 (MainThread): Opening a new connection, currently in state init
2020-06-30 20:30:17.255704 (MainThread): Acquiring new snowflake connection "model.sample_project.order_statistics".
2020-06-30 20:30:17.255792 (MainThread): Opening a new connection, currently in state init
2020-06-30 20:30:17.270898 (MainThread): Acquiring new snowflake connection "model.sample_project.sales_report_two".
2020-06-30 20:30:17.270996 (MainThread): Opening a new connection, currently in state init
2020-06-30 20:30:17.748094 (MainThread): Found 11 models, 8 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 4 sources
2020-06-30 20:30:17.749692 (MainThread): 
2020-06-30 20:30:17.749971 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 20:30:17.750060 (MainThread): Opening a new connection, currently in state init
2020-06-30 20:30:17.755000 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_JAVEN_TESTING".
2020-06-30 20:30:17.755267 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-06-30 20:30:17.768317 (ThreadPoolExecutor-0_0): Using snowflake connection "list_JAVEN_TESTING".
2020-06-30 20:30:17.768412 (ThreadPoolExecutor-0_0): On list_JAVEN_TESTING: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING"} */

    show terse schemas in database JAVEN_TESTING
    limit 10000
2020-06-30 20:30:18.195090 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/certifi/cacert.pem'>
2020-06-30 20:30:22.941010 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 5.17 seconds
2020-06-30 20:30:22.970649 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 20:30:22.970821 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_JAVEN_TESTING).
2020-06-30 20:30:22.977526 (ThreadPoolExecutor-1_0): Using snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 20:30:22.977628 (ThreadPoolExecutor-1_0): On list_JAVEN_TESTING_TEST: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING_TEST"} */

    show terse objects in JAVEN_TESTING.TEST
2020-06-30 20:30:23.472621 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 10 in 0.49 seconds
2020-06-30 20:30:23.482529 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 20:30:23.482645 (MainThread): Opening a new connection, currently in state init
2020-06-30 20:30:23.482807 (MainThread): Using snowflake connection "master".
2020-06-30 20:30:23.482902 (MainThread): On master: BEGIN
2020-06-30 20:30:27.269748 (MainThread): SQL status: SUCCESS 1 in 3.79 seconds
2020-06-30 20:30:27.269910 (MainThread): On master: COMMIT
2020-06-30 20:30:27.270041 (MainThread): Using snowflake connection "master".
2020-06-30 20:30:27.270128 (MainThread): On master: COMMIT
2020-06-30 20:30:27.510795 (MainThread): SQL status: SUCCESS 1 in 0.24 seconds
2020-06-30 20:30:27.511151 (MainThread): 15:30:27 | Concurrency: 1 threads (target='dev')
2020-06-30 20:30:27.511302 (MainThread): 15:30:27 | 
2020-06-30 20:30:27.511949 (Thread-1): Began running node model.sample_project.customer
2020-06-30 20:30:27.512241 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 20:30:27.512345 (Thread-1): Re-using an available connection from the pool (formerly list_JAVEN_TESTING_TEST).
2020-06-30 20:30:27.512452 (Thread-1): Compiling model.sample_project.customer
2020-06-30 20:30:27.529104 (Thread-1): Writing injected SQL for node "model.sample_project.customer"
2020-06-30 20:30:27.529423 (Thread-1): finished collecting timing info
2020-06-30 20:30:27.529770 (Thread-1): Finished running node model.sample_project.customer
2020-06-30 20:30:27.529887 (Thread-1): Began running node model.sample_project.lineitem
2020-06-30 20:30:27.530229 (Thread-1): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 20:30:27.530312 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer).
2020-06-30 20:30:27.530389 (Thread-1): Compiling model.sample_project.lineitem
2020-06-30 20:30:27.537604 (Thread-1): Writing injected SQL for node "model.sample_project.lineitem"
2020-06-30 20:30:27.537919 (Thread-1): finished collecting timing info
2020-06-30 20:30:27.538339 (Thread-1): Finished running node model.sample_project.lineitem
2020-06-30 20:30:27.538456 (Thread-1): Began running node model.sample_project.nation
2020-06-30 20:30:27.538871 (Thread-1): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 20:30:27.538961 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.lineitem).
2020-06-30 20:30:27.539041 (Thread-1): Compiling model.sample_project.nation
2020-06-30 20:30:27.549016 (Thread-1): Writing injected SQL for node "model.sample_project.nation"
2020-06-30 20:30:27.549407 (Thread-1): finished collecting timing info
2020-06-30 20:30:27.549914 (Thread-1): Finished running node model.sample_project.nation
2020-06-30 20:30:27.550118 (Thread-1): Began running node model.sample_project.orders
2020-06-30 20:30:27.550615 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 20:30:27.550935 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.nation).
2020-06-30 20:30:27.551070 (Thread-1): Compiling model.sample_project.orders
2020-06-30 20:30:27.560751 (Thread-1): Writing injected SQL for node "model.sample_project.orders"
2020-06-30 20:30:27.561064 (Thread-1): finished collecting timing info
2020-06-30 20:30:27.561579 (Thread-1): Finished running node model.sample_project.orders
2020-06-30 20:30:27.561699 (Thread-1): Began running node model.sample_project.customer_nation
2020-06-30 20:30:27.562033 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 20:30:27.562196 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders).
2020-06-30 20:30:27.562294 (Thread-1): Compiling model.sample_project.customer_nation
2020-06-30 20:30:27.574146 (Thread-1): Writing injected SQL for node "model.sample_project.customer_nation"
2020-06-30 20:30:27.574422 (Thread-1): finished collecting timing info
2020-06-30 20:30:27.574745 (Thread-1): Finished running node model.sample_project.customer_nation
2020-06-30 20:30:27.574859 (Thread-1): Began running node model.sample_project.orders_lineitem
2020-06-30 20:30:27.575193 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 20:30:27.575302 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer_nation).
2020-06-30 20:30:27.575402 (Thread-1): Compiling model.sample_project.orders_lineitem
2020-06-30 20:30:27.587418 (Thread-1): Writing injected SQL for node "model.sample_project.orders_lineitem"
2020-06-30 20:30:27.587693 (Thread-1): finished collecting timing info
2020-06-30 20:30:27.588028 (Thread-1): Finished running node model.sample_project.orders_lineitem
2020-06-30 20:30:27.588147 (Thread-1): Began running node model.sample_project.customers_per_nation
2020-06-30 20:30:27.589395 (Thread-1): 15:30:27 | 1 of 4 START table model TEST.customers_per_nation................... [RUN]
2020-06-30 20:30:27.589912 (Thread-1): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 20:30:27.590000 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders_lineitem).
2020-06-30 20:30:27.590081 (Thread-1): Compiling model.sample_project.customers_per_nation
2020-06-30 20:30:27.598578 (Thread-1): Writing injected SQL for node "model.sample_project.customers_per_nation"
2020-06-30 20:30:27.598842 (Thread-1): finished collecting timing info
2020-06-30 20:30:27.628455 (Thread-1): Writing runtime SQL for node "model.sample_project.customers_per_nation"
2020-06-30 20:30:27.630603 (Thread-1): Using snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 20:30:27.630698 (Thread-1): On model.sample_project.customers_per_nation: BEGIN
2020-06-30 20:30:27.839205 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2020-06-30 20:30:27.839358 (Thread-1): Using snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 20:30:27.839452 (Thread-1): On model.sample_project.customers_per_nation: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "model.sample_project.customers_per_nation"} */


      create or replace transient table JAVEN_TESTING.TEST.customers_per_nation  as
      (with __dbt__CTE__customer as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  c_custkey as custkey,
        c_nationkey as nationkey,
        c_name as name
from snowflake_sample_data.tpch_sf1.customer
),  __dbt__CTE__nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  n_nationkey as nationkey,
        n_name as name
from snowflake_sample_data.tpch_sf1.nation
),  __dbt__CTE__customer_nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  c.custkey,
        c.nationkey,
        c.name as customer_name,
        n.name as nation_name
from __dbt__CTE__customer as c
JOIN __dbt__CTE__nation as n
ON c.nationkey=n.nationkey
)/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  count(customer_name) as customer_count,
        nation_name
from __dbt__CTE__customer_nation
group by nation_name
order by nation_name
      );
2020-06-30 20:30:29.742340 (Thread-1): SQL status: SUCCESS 1 in 1.90 seconds
2020-06-30 20:30:29.743261 (Thread-1): On model.sample_project.customers_per_nation: COMMIT
2020-06-30 20:30:29.743388 (Thread-1): Using snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 20:30:29.743466 (Thread-1): On model.sample_project.customers_per_nation: COMMIT
2020-06-30 20:30:29.898274 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2020-06-30 20:30:29.907288 (Thread-1): finished collecting timing info
2020-06-30 20:30:29.907843 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be7b8598-6411-449b-a22f-b69daa1cd10f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115678c90>]}
2020-06-30 20:30:29.908784 (Thread-1): 15:30:29 | 1 of 4 OK created table model TEST.customers_per_nation.............. [SUCCESS 1 in 2.32s]
2020-06-30 20:30:29.908902 (Thread-1): Finished running node model.sample_project.customers_per_nation
2020-06-30 20:30:29.909019 (Thread-1): Began running node model.sample_project.cust_list_ord_nat
2020-06-30 20:30:29.909241 (Thread-1): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 20:30:29.909423 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customers_per_nation).
2020-06-30 20:30:29.909625 (Thread-1): Compiling model.sample_project.cust_list_ord_nat
2020-06-30 20:30:29.924354 (Thread-1): Writing injected SQL for node "model.sample_project.cust_list_ord_nat"
2020-06-30 20:30:29.924751 (Thread-1): finished collecting timing info
2020-06-30 20:30:29.925105 (Thread-1): Finished running node model.sample_project.cust_list_ord_nat
2020-06-30 20:30:29.925223 (Thread-1): Began running node model.sample_project.order_statistics
2020-06-30 20:30:29.926660 (Thread-1): 15:30:29 | 2 of 4 START table model TEST.order_statistics....................... [RUN]
2020-06-30 20:30:29.927213 (Thread-1): Acquiring new snowflake connection "model.sample_project.order_statistics".
2020-06-30 20:30:29.927311 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.cust_list_ord_nat).
2020-06-30 20:30:29.927388 (Thread-1): Compiling model.sample_project.order_statistics
2020-06-30 20:30:29.942479 (Thread-1): Writing injected SQL for node "model.sample_project.order_statistics"
2020-06-30 20:30:29.942858 (Thread-1): finished collecting timing info
2020-06-30 20:30:29.948453 (Thread-1): Writing runtime SQL for node "model.sample_project.order_statistics"
2020-06-30 20:30:29.951182 (Thread-1): Using snowflake connection "model.sample_project.order_statistics".
2020-06-30 20:30:29.951419 (Thread-1): On model.sample_project.order_statistics: BEGIN
2020-06-30 20:30:30.424927 (Thread-1): SQL status: SUCCESS 1 in 0.47 seconds
2020-06-30 20:30:30.425109 (Thread-1): Using snowflake connection "model.sample_project.order_statistics".
2020-06-30 20:30:30.425221 (Thread-1): On model.sample_project.order_statistics: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "model.sample_project.order_statistics"} */


      create or replace transient table JAVEN_TESTING.TEST.order_statistics  as
      (with __dbt__CTE__orders as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  o_orderkey as orderkey,
        o_custkey as custkey,
        o_totalprice as totalprice,
        o_orderdate as orderdate
from snowflake_sample_data.tpch_sf1.orders
),  __dbt__CTE__lineitem as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  l_orderkey as orderkey,
        l_extendedprice as extendedprice,
        l_discount as discount,
        l_tax as tax,
        l_quantity as quantity
from snowflake_sample_data.tpch_sf1.lineitem
),  __dbt__CTE__orders_lineitem as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  o.orderkey,
        o.custkey,
        o.totalprice,
        o.orderdate,
        l.extendedprice,
        l.discount,
        l.tax,
        l.quantity
from __dbt__CTE__orders as o
JOIN __dbt__CTE__lineitem as l
ON o.orderkey=l.orderkey
)/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  avg(totalprice) as average_order_price,
        sum(quantity) as total_quantity_per_order,
        listagg(quantity, '|~~|') as quantities_per_order,
        count(quantity) as items_per_order,
        
  
    width_bucket(average_order_price, 184000, 200000, 10 )

 as price_histogram,
        orderdate
from __dbt__CTE__orders_lineitem
group by orderdate
      );
2020-06-30 20:30:32.988914 (Thread-1): SQL status: SUCCESS 1 in 2.56 seconds
2020-06-30 20:30:32.989839 (Thread-1): On model.sample_project.order_statistics: COMMIT
2020-06-30 20:30:32.989983 (Thread-1): Using snowflake connection "model.sample_project.order_statistics".
2020-06-30 20:30:32.990075 (Thread-1): On model.sample_project.order_statistics: COMMIT
2020-06-30 20:30:33.246520 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2020-06-30 20:30:33.248586 (Thread-1): finished collecting timing info
2020-06-30 20:30:33.249216 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be7b8598-6411-449b-a22f-b69daa1cd10f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115654fd0>]}
2020-06-30 20:30:33.250518 (Thread-1): 15:30:33 | 2 of 4 OK created table model TEST.order_statistics.................. [SUCCESS 1 in 3.32s]
2020-06-30 20:30:33.250653 (Thread-1): Finished running node model.sample_project.order_statistics
2020-06-30 20:30:33.250789 (Thread-1): Began running node model.sample_project.sales_report_one
2020-06-30 20:30:33.251883 (Thread-1): 15:30:33 | 3 of 4 START table model TEST.sales_report_one....................... [RUN]
2020-06-30 20:30:33.252170 (Thread-1): Acquiring new snowflake connection "model.sample_project.sales_report_one".
2020-06-30 20:30:33.252262 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.order_statistics).
2020-06-30 20:30:33.252352 (Thread-1): Compiling model.sample_project.sales_report_one
2020-06-30 20:30:33.264866 (Thread-1): Writing injected SQL for node "model.sample_project.sales_report_one"
2020-06-30 20:30:33.265215 (Thread-1): finished collecting timing info
2020-06-30 20:30:33.271060 (Thread-1): Writing runtime SQL for node "model.sample_project.sales_report_one"
2020-06-30 20:30:33.275242 (Thread-1): Using snowflake connection "model.sample_project.sales_report_one".
2020-06-30 20:30:33.275338 (Thread-1): On model.sample_project.sales_report_one: BEGIN
2020-06-30 20:30:33.540589 (Thread-1): SQL status: SUCCESS 1 in 0.27 seconds
2020-06-30 20:30:33.540770 (Thread-1): Using snowflake connection "model.sample_project.sales_report_one".
2020-06-30 20:30:33.540882 (Thread-1): On model.sample_project.sales_report_one: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "model.sample_project.sales_report_one"} */


      create or replace transient table JAVEN_TESTING.TEST.sales_report_one  as
      (with __dbt__CTE__customer as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  c_custkey as custkey,
        c_nationkey as nationkey,
        c_name as name
from snowflake_sample_data.tpch_sf1.customer
),  __dbt__CTE__nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  n_nationkey as nationkey,
        n_name as name
from snowflake_sample_data.tpch_sf1.nation
),  __dbt__CTE__customer_nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  c.custkey,
        c.nationkey,
        c.name as customer_name,
        n.name as nation_name
from __dbt__CTE__customer as c
JOIN __dbt__CTE__nation as n
ON c.nationkey=n.nationkey
),  __dbt__CTE__orders as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  o_orderkey as orderkey,
        o_custkey as custkey,
        o_totalprice as totalprice,
        o_orderdate as orderdate
from snowflake_sample_data.tpch_sf1.orders
),  __dbt__CTE__lineitem as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  l_orderkey as orderkey,
        l_extendedprice as extendedprice,
        l_discount as discount,
        l_tax as tax,
        l_quantity as quantity
from snowflake_sample_data.tpch_sf1.lineitem
),  __dbt__CTE__orders_lineitem as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  o.orderkey,
        o.custkey,
        o.totalprice,
        o.orderdate,
        l.extendedprice,
        l.discount,
        l.tax,
        l.quantity
from __dbt__CTE__orders as o
JOIN __dbt__CTE__lineitem as l
ON o.orderkey=l.orderkey
),  __dbt__CTE__cust_list_ord_nat as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  cn.custkey,
        cn.nationkey,
        cn.customer_name,
        cn.nation_name,
        ol.orderkey,
        ol.totalprice,
        ol.orderdate,
        ol.extendedprice,
        ol.discount,
        ol.tax,
        ol.quantity
from __dbt__CTE__customer_nation as cn
JOIN __dbt__CTE__orders_lineitem as ol
ON cn.custkey=ol.custkey
)/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  

extendedprice * (1.0 - discount)

 as discounted_price_pre_tax,
        



extendedprice * (1.0 - discount)

 * (1.0 + tax)

 as discounted_price,
        



extendedprice * (1.0 - discount)

 * tax

 as tax_charged,
        *
from __dbt__CTE__cust_list_ord_nat
      );
2020-06-30 20:30:38.621845 (Thread-1): SQL status: SUCCESS 1 in 5.08 seconds
2020-06-30 20:30:38.622922 (Thread-1): On model.sample_project.sales_report_one: COMMIT
2020-06-30 20:30:38.623072 (Thread-1): Using snowflake connection "model.sample_project.sales_report_one".
2020-06-30 20:30:38.623168 (Thread-1): On model.sample_project.sales_report_one: COMMIT
2020-06-30 20:30:38.815288 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2020-06-30 20:30:38.817360 (Thread-1): finished collecting timing info
2020-06-30 20:30:38.817954 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be7b8598-6411-449b-a22f-b69daa1cd10f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11569ac10>]}
2020-06-30 20:30:38.819021 (Thread-1): 15:30:38 | 3 of 4 OK created table model TEST.sales_report_one.................. [SUCCESS 1 in 5.57s]
2020-06-30 20:30:38.819186 (Thread-1): Finished running node model.sample_project.sales_report_one
2020-06-30 20:30:38.819321 (Thread-1): Began running node model.sample_project.sales_report_two
2020-06-30 20:30:38.820324 (Thread-1): 15:30:38 | 4 of 4 START table model TEST.sales_report_two....................... [RUN]
2020-06-30 20:30:38.820564 (Thread-1): Acquiring new snowflake connection "model.sample_project.sales_report_two".
2020-06-30 20:30:38.820650 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.sales_report_one).
2020-06-30 20:30:38.820785 (Thread-1): Compiling model.sample_project.sales_report_two
2020-06-30 20:30:38.831598 (Thread-1): Writing injected SQL for node "model.sample_project.sales_report_two"
2020-06-30 20:30:38.831932 (Thread-1): finished collecting timing info
2020-06-30 20:30:38.836115 (Thread-1): Writing runtime SQL for node "model.sample_project.sales_report_two"
2020-06-30 20:30:38.839385 (Thread-1): Using snowflake connection "model.sample_project.sales_report_two".
2020-06-30 20:30:38.839477 (Thread-1): On model.sample_project.sales_report_two: BEGIN
2020-06-30 20:30:39.097359 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2020-06-30 20:30:39.097516 (Thread-1): Using snowflake connection "model.sample_project.sales_report_two".
2020-06-30 20:30:39.097612 (Thread-1): On model.sample_project.sales_report_two: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "model.sample_project.sales_report_two"} */


      create or replace transient table JAVEN_TESTING.TEST.sales_report_two  as
      (with __dbt__CTE__customer as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  c_custkey as custkey,
        c_nationkey as nationkey,
        c_name as name
from snowflake_sample_data.tpch_sf1.customer
),  __dbt__CTE__nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  n_nationkey as nationkey,
        n_name as name
from snowflake_sample_data.tpch_sf1.nation
),  __dbt__CTE__customer_nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  c.custkey,
        c.nationkey,
        c.name as customer_name,
        n.name as nation_name
from __dbt__CTE__customer as c
JOIN __dbt__CTE__nation as n
ON c.nationkey=n.nationkey
),  __dbt__CTE__orders as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  o_orderkey as orderkey,
        o_custkey as custkey,
        o_totalprice as totalprice,
        o_orderdate as orderdate
from snowflake_sample_data.tpch_sf1.orders
),  __dbt__CTE__lineitem as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  l_orderkey as orderkey,
        l_extendedprice as extendedprice,
        l_discount as discount,
        l_tax as tax,
        l_quantity as quantity
from snowflake_sample_data.tpch_sf1.lineitem
),  __dbt__CTE__orders_lineitem as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  o.orderkey,
        o.custkey,
        o.totalprice,
        o.orderdate,
        l.extendedprice,
        l.discount,
        l.tax,
        l.quantity
from __dbt__CTE__orders as o
JOIN __dbt__CTE__lineitem as l
ON o.orderkey=l.orderkey
),  __dbt__CTE__cust_list_ord_nat as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  cn.custkey,
        cn.nationkey,
        cn.customer_name,
        cn.nation_name,
        ol.orderkey,
        ol.totalprice,
        ol.orderdate,
        ol.extendedprice,
        ol.discount,
        ol.tax,
        ol.quantity
from __dbt__CTE__customer_nation as cn
JOIN __dbt__CTE__orders_lineitem as ol
ON cn.custkey=ol.custkey
)/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  listagg(discount, '|~~|') as discounts,
        avg(



extendedprice * (1.0 - discount)

 * tax

) as average_tax,
        orderkey,
        custkey
from __dbt__CTE__cust_list_ord_nat
group by orderkey, custkey
      );
2020-06-30 20:30:43.659909 (Thread-1): SQL status: SUCCESS 1 in 4.56 seconds
2020-06-30 20:30:43.661001 (Thread-1): On model.sample_project.sales_report_two: COMMIT
2020-06-30 20:30:43.661175 (Thread-1): Using snowflake connection "model.sample_project.sales_report_two".
2020-06-30 20:30:43.661287 (Thread-1): On model.sample_project.sales_report_two: COMMIT
2020-06-30 20:30:43.899227 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2020-06-30 20:30:43.901310 (Thread-1): finished collecting timing info
2020-06-30 20:30:43.901915 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be7b8598-6411-449b-a22f-b69daa1cd10f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11565a3d0>]}
2020-06-30 20:30:43.902948 (Thread-1): 15:30:43 | 4 of 4 OK created table model TEST.sales_report_two.................. [SUCCESS 1 in 5.08s]
2020-06-30 20:30:43.903083 (Thread-1): Finished running node model.sample_project.sales_report_two
2020-06-30 20:30:43.976895 (MainThread): Using snowflake connection "master".
2020-06-30 20:30:43.977049 (MainThread): On master: BEGIN
2020-06-30 20:30:44.176722 (MainThread): SQL status: SUCCESS 1 in 0.20 seconds
2020-06-30 20:30:44.176886 (MainThread): On master: COMMIT
2020-06-30 20:30:44.177024 (MainThread): Using snowflake connection "master".
2020-06-30 20:30:44.177115 (MainThread): On master: COMMIT
2020-06-30 20:30:44.514307 (MainThread): SQL status: SUCCESS 1 in 0.34 seconds
2020-06-30 20:30:44.514684 (MainThread): 15:30:44 | 
2020-06-30 20:30:44.514827 (MainThread): 15:30:44 | Finished running 4 table models in 26.76s.
2020-06-30 20:30:44.514943 (MainThread): Connection 'master' was left open.
2020-06-30 20:30:44.515034 (MainThread): On master: Close
2020-06-30 20:30:44.794453 (MainThread): Connection 'model.sample_project.sales_report_two' was left open.
2020-06-30 20:30:44.794595 (MainThread): On model.sample_project.sales_report_two: Close
2020-06-30 20:30:45.065638 (MainThread): 
2020-06-30 20:30:45.065783 (MainThread): Completed successfully
2020-06-30 20:30:45.065963 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-06-30 20:30:45.066113 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132f4710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11350ba90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134daa90>]}
2020-06-30 20:30:45.066272 (MainThread): Flushing usage events
2020-06-30 20:48:12.002421 (MainThread): Running with dbt=0.17.0
2020-06-30 20:48:12.344984 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-06-30 20:48:12.346273 (MainThread): Tracking: tracking
2020-06-30 20:48:12.346613 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ace510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ace810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111aceb50>]}
2020-06-30 20:48:12.372513 (MainThread): Partial parsing not enabled
2020-06-30 20:48:12.375095 (MainThread): Parsing macros/core.sql
2020-06-30 20:48:12.379966 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-30 20:48:12.388977 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-30 20:48:12.391722 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-30 20:48:12.414318 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-30 20:48:12.447963 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-30 20:48:12.474561 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-30 20:48:12.476764 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-30 20:48:12.483878 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-30 20:48:12.500383 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-30 20:48:12.508847 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-30 20:48:12.515847 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-30 20:48:12.521152 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-30 20:48:12.522160 (MainThread): Parsing macros/etc/query.sql
2020-06-30 20:48:12.523303 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-30 20:48:12.525253 (MainThread): Parsing macros/etc/datetime.sql
2020-06-30 20:48:12.535342 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-30 20:48:12.537476 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-30 20:48:12.539373 (MainThread): Parsing macros/adapters/common.sql
2020-06-30 20:48:12.594792 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-30 20:48:12.596114 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-30 20:48:12.597364 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-30 20:48:12.599083 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-30 20:48:12.602361 (MainThread): Parsing macros/catalog.sql
2020-06-30 20:48:12.604701 (MainThread): Parsing macros/adapters.sql
2020-06-30 20:48:12.629439 (MainThread): Parsing macros/materializations/merge.sql
2020-06-30 20:48:12.631669 (MainThread): Parsing macros/materializations/view.sql
2020-06-30 20:48:12.633053 (MainThread): Parsing macros/materializations/table.sql
2020-06-30 20:48:12.637283 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-30 20:48:12.682749 (MainThread): Partial parsing not enabled
2020-06-30 20:48:12.683183 (MainThread): Parsing macros/discounted_price.sql
2020-06-30 20:48:12.684081 (MainThread): Parsing macros/tax_charged.sql
2020-06-30 20:48:12.684864 (MainThread): Parsing macros/full_charge.sql
2020-06-30 20:48:12.685649 (MainThread): Parsing macros/test_is_nonnegative.sql
2020-06-30 20:48:12.688584 (MainThread): Parsing macros/cross_db_utils/except.sql
2020-06-30 20:48:12.689689 (MainThread): Parsing macros/cross_db_utils/replace.sql
2020-06-30 20:48:12.690990 (MainThread): Parsing macros/cross_db_utils/concat.sql
2020-06-30 20:48:12.693720 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2020-06-30 20:48:12.700816 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2020-06-30 20:48:12.702174 (MainThread): Parsing macros/cross_db_utils/length.sql
2020-06-30 20:48:12.704709 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2020-06-30 20:48:12.707956 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2020-06-30 20:48:12.709185 (MainThread): Parsing macros/cross_db_utils/right.sql
2020-06-30 20:48:12.711829 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2020-06-30 20:48:12.722703 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2020-06-30 20:48:12.724784 (MainThread): Parsing macros/cross_db_utils/hash.sql
2020-06-30 20:48:12.726264 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2020-06-30 20:48:12.728394 (MainThread): Parsing macros/cross_db_utils/position.sql
2020-06-30 20:48:12.730723 (MainThread): Parsing macros/cross_db_utils/literal.sql
2020-06-30 20:48:12.731719 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2020-06-30 20:48:12.735527 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2020-06-30 20:48:12.742051 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2020-06-30 20:48:12.745696 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2020-06-30 20:48:12.748630 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2020-06-30 20:48:12.750411 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2020-06-30 20:48:12.778006 (MainThread): Parsing macros/logger/pretty_log_format.sql
2020-06-30 20:48:12.778762 (MainThread): Parsing macros/logger/pretty_time.sql
2020-06-30 20:48:12.779683 (MainThread): Parsing macros/logger/log_info.sql
2020-06-30 20:48:12.780542 (MainThread): Parsing macros/datetime/date_spine.sql
2020-06-30 20:48:12.784438 (MainThread): Parsing macros/web/get_url_host.sql
2020-06-30 20:48:12.785917 (MainThread): Parsing macros/web/get_url_path.sql
2020-06-30 20:48:12.788667 (MainThread): Parsing macros/web/get_url_parameter.sql
2020-06-30 20:48:12.789949 (MainThread): Parsing macros/geo/haversine_distance.sql
2020-06-30 20:48:12.790981 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2020-06-30 20:48:12.792679 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2020-06-30 20:48:12.795371 (MainThread): Parsing macros/schema_tests/recency.sql
2020-06-30 20:48:12.796894 (MainThread): Parsing macros/schema_tests/not_constant.sql
2020-06-30 20:48:12.798439 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2020-06-30 20:48:12.799553 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2020-06-30 20:48:12.800956 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2020-06-30 20:48:12.802499 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2020-06-30 20:48:12.803628 (MainThread): Parsing macros/schema_tests/equality.sql
2020-06-30 20:48:12.806770 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2020-06-30 20:48:12.812901 (MainThread): Parsing macros/sql/nullcheck_table.sql
2020-06-30 20:48:12.814179 (MainThread): Parsing macros/sql/generate_series.sql
2020-06-30 20:48:12.817904 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2020-06-30 20:48:12.822210 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2020-06-30 20:48:12.825117 (MainThread): Parsing macros/sql/star.sql
2020-06-30 20:48:12.828408 (MainThread): Parsing macros/sql/unpivot.sql
2020-06-30 20:48:12.834878 (MainThread): Parsing macros/sql/union.sql
2020-06-30 20:48:12.844913 (MainThread): Parsing macros/sql/groupby.sql
2020-06-30 20:48:12.845990 (MainThread): Parsing macros/sql/surrogate_key.sql
2020-06-30 20:48:12.848774 (MainThread): Parsing macros/sql/safe_add.sql
2020-06-30 20:48:12.850151 (MainThread): Parsing macros/sql/nullcheck.sql
2020-06-30 20:48:12.851924 (MainThread): Parsing macros/sql/get_column_values.sql
2020-06-30 20:48:12.856754 (MainThread): Parsing macros/sql/pivot.sql
2020-06-30 20:48:12.860802 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2020-06-30 20:48:12.915809 (MainThread): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 20:48:12.915995 (MainThread): Opening a new connection, currently in state init
2020-06-30 20:48:12.954482 (MainThread): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 20:48:12.954609 (MainThread): Opening a new connection, currently in state init
2020-06-30 20:48:12.966862 (MainThread): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 20:48:12.966963 (MainThread): Opening a new connection, currently in state init
2020-06-30 20:48:12.979064 (MainThread): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 20:48:12.979158 (MainThread): Opening a new connection, currently in state init
2020-06-30 20:48:12.990939 (MainThread): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 20:48:12.991030 (MainThread): Opening a new connection, currently in state init
2020-06-30 20:48:13.004182 (MainThread): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 20:48:13.004276 (MainThread): Opening a new connection, currently in state init
2020-06-30 20:48:13.016857 (MainThread): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 20:48:13.016948 (MainThread): Opening a new connection, currently in state init
2020-06-30 20:48:13.034488 (MainThread): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 20:48:13.034609 (MainThread): Opening a new connection, currently in state init
2020-06-30 20:48:13.047873 (MainThread): Acquiring new snowflake connection "model.sample_project.sales_report_one".
2020-06-30 20:48:13.047979 (MainThread): Opening a new connection, currently in state init
2020-06-30 20:48:13.065566 (MainThread): Acquiring new snowflake connection "model.sample_project.order_statistics".
2020-06-30 20:48:13.065699 (MainThread): Opening a new connection, currently in state init
2020-06-30 20:48:13.080797 (MainThread): Acquiring new snowflake connection "model.sample_project.sales_report_two".
2020-06-30 20:48:13.080896 (MainThread): Opening a new connection, currently in state init
2020-06-30 20:48:13.569321 (MainThread): Found 11 models, 8 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 4 sources
2020-06-30 20:48:13.571354 (MainThread): 
2020-06-30 20:48:13.571623 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 20:48:13.571710 (MainThread): Opening a new connection, currently in state init
2020-06-30 20:48:13.575871 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_JAVEN_TESTING".
2020-06-30 20:48:13.576143 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-06-30 20:48:13.590005 (ThreadPoolExecutor-0_0): Using snowflake connection "list_JAVEN_TESTING".
2020-06-30 20:48:13.590161 (ThreadPoolExecutor-0_0): On list_JAVEN_TESTING: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING"} */

    show terse schemas in database JAVEN_TESTING
    limit 10000
2020-06-30 20:48:14.115085 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/certifi/cacert.pem'>
2020-06-30 20:48:28.947855 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 15.36 seconds
2020-06-30 20:48:28.979431 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 20:48:28.979632 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_JAVEN_TESTING).
2020-06-30 20:48:28.986130 (ThreadPoolExecutor-1_0): Using snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 20:48:28.986273 (ThreadPoolExecutor-1_0): On list_JAVEN_TESTING_TEST: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING_TEST"} */

    show terse objects in JAVEN_TESTING.TEST
2020-06-30 20:48:29.218963 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 11 in 0.23 seconds
2020-06-30 20:48:29.230113 (MainThread): 15:48:29 | Concurrency: 1 threads (target='dev')
2020-06-30 20:48:29.230264 (MainThread): 15:48:29 | 
2020-06-30 20:48:29.231086 (Thread-1): Began running node model.sample_project.lineitem
2020-06-30 20:48:29.231382 (Thread-1): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 20:48:29.231483 (Thread-1): Re-using an available connection from the pool (formerly list_JAVEN_TESTING_TEST).
2020-06-30 20:48:29.231583 (Thread-1): Compiling model.sample_project.lineitem
2020-06-30 20:48:29.250159 (Thread-1): Writing injected SQL for node "model.sample_project.lineitem"
2020-06-30 20:48:29.250552 (Thread-1): finished collecting timing info
2020-06-30 20:48:29.251093 (Thread-1): Finished running node model.sample_project.lineitem
2020-06-30 20:48:29.251212 (Thread-1): Began running node model.sample_project.orders
2020-06-30 20:48:29.251584 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 20:48:29.251735 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.lineitem).
2020-06-30 20:48:29.251851 (Thread-1): Compiling model.sample_project.orders
2020-06-30 20:48:29.261149 (Thread-1): Writing injected SQL for node "model.sample_project.orders"
2020-06-30 20:48:29.261593 (Thread-1): finished collecting timing info
2020-06-30 20:48:29.262108 (Thread-1): Finished running node model.sample_project.orders
2020-06-30 20:48:29.262224 (Thread-1): Began running node model.sample_project.customer
2020-06-30 20:48:29.262516 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 20:48:29.262797 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders).
2020-06-30 20:48:29.263078 (Thread-1): Compiling model.sample_project.customer
2020-06-30 20:48:29.269995 (Thread-1): Writing injected SQL for node "model.sample_project.customer"
2020-06-30 20:48:29.270264 (Thread-1): finished collecting timing info
2020-06-30 20:48:29.270880 (Thread-1): Finished running node model.sample_project.customer
2020-06-30 20:48:29.271008 (Thread-1): Began running node model.sample_project.nation
2020-06-30 20:48:29.271302 (Thread-1): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 20:48:29.271390 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer).
2020-06-30 20:48:29.271467 (Thread-1): Compiling model.sample_project.nation
2020-06-30 20:48:29.278414 (Thread-1): Writing injected SQL for node "model.sample_project.nation"
2020-06-30 20:48:29.278702 (Thread-1): finished collecting timing info
2020-06-30 20:48:29.279088 (Thread-1): Finished running node model.sample_project.nation
2020-06-30 20:48:29.279204 (Thread-1): Began running node test.sample_project.source_is_nonnegative_tpch_customer_c_custkey
2020-06-30 20:48:29.279615 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_nonnegative_tpch_customer_c_custkey".
2020-06-30 20:48:29.279708 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.nation).
2020-06-30 20:48:29.279829 (Thread-1): Compiling test.sample_project.source_is_nonnegative_tpch_customer_c_custkey
2020-06-30 20:48:29.294346 (Thread-1): Writing injected SQL for node "test.sample_project.source_is_nonnegative_tpch_customer_c_custkey"
2020-06-30 20:48:29.294948 (Thread-1): finished collecting timing info
2020-06-30 20:48:29.295379 (Thread-1): finished collecting timing info
2020-06-30 20:48:29.295863 (Thread-1): Finished running node test.sample_project.source_is_nonnegative_tpch_customer_c_custkey
2020-06-30 20:48:29.296016 (Thread-1): Began running node test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey
2020-06-30 20:48:29.296333 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey".
2020-06-30 20:48:29.296423 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_nonnegative_tpch_customer_c_custkey).
2020-06-30 20:48:29.296659 (Thread-1): Compiling test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey
2020-06-30 20:48:29.306560 (Thread-1): Writing injected SQL for node "test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey"
2020-06-30 20:48:29.306901 (Thread-1): finished collecting timing info
2020-06-30 20:48:29.307134 (Thread-1): finished collecting timing info
2020-06-30 20:48:29.307505 (Thread-1): Finished running node test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey
2020-06-30 20:48:29.307615 (Thread-1): Began running node test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice
2020-06-30 20:48:29.307878 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice".
2020-06-30 20:48:29.307968 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey).
2020-06-30 20:48:29.308046 (Thread-1): Compiling test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice
2020-06-30 20:48:29.316396 (Thread-1): Writing injected SQL for node "test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice"
2020-06-30 20:48:29.316664 (Thread-1): finished collecting timing info
2020-06-30 20:48:29.316863 (Thread-1): finished collecting timing info
2020-06-30 20:48:29.317307 (Thread-1): Finished running node test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice
2020-06-30 20:48:29.317456 (Thread-1): Began running node test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey
2020-06-30 20:48:29.317721 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey".
2020-06-30 20:48:29.317809 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice).
2020-06-30 20:48:29.317886 (Thread-1): Compiling test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey
2020-06-30 20:48:29.325590 (Thread-1): Writing injected SQL for node "test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey"
2020-06-30 20:48:29.325857 (Thread-1): finished collecting timing info
2020-06-30 20:48:29.326055 (Thread-1): finished collecting timing info
2020-06-30 20:48:29.326347 (Thread-1): Finished running node test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey
2020-06-30 20:48:29.326457 (Thread-1): Began running node test.sample_project.source_is_nonnegative_tpch_orders_o_custkey
2020-06-30 20:48:29.326714 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_nonnegative_tpch_orders_o_custkey".
2020-06-30 20:48:29.326804 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey).
2020-06-30 20:48:29.326883 (Thread-1): Compiling test.sample_project.source_is_nonnegative_tpch_orders_o_custkey
2020-06-30 20:48:29.335219 (Thread-1): Writing injected SQL for node "test.sample_project.source_is_nonnegative_tpch_orders_o_custkey"
2020-06-30 20:48:29.335529 (Thread-1): finished collecting timing info
2020-06-30 20:48:29.335739 (Thread-1): finished collecting timing info
2020-06-30 20:48:29.336042 (Thread-1): Finished running node test.sample_project.source_is_nonnegative_tpch_orders_o_custkey
2020-06-30 20:48:29.336154 (Thread-1): Began running node test.sample_project.source_unique_tpch_customer_c_custkey
2020-06-30 20:48:29.336608 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_unique_tpch_customer_c_custkey".
2020-06-30 20:48:29.336688 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_nonnegative_tpch_orders_o_custkey).
2020-06-30 20:48:29.336760 (Thread-1): Compiling test.sample_project.source_unique_tpch_customer_c_custkey
2020-06-30 20:48:29.344542 (Thread-1): Writing injected SQL for node "test.sample_project.source_unique_tpch_customer_c_custkey"
2020-06-30 20:48:29.344811 (Thread-1): finished collecting timing info
2020-06-30 20:48:29.345240 (Thread-1): finished collecting timing info
2020-06-30 20:48:29.345599 (Thread-1): Finished running node test.sample_project.source_unique_tpch_customer_c_custkey
2020-06-30 20:48:29.345718 (Thread-1): Began running node test.sample_project.source_unique_tpch_nation_n_nationkey
2020-06-30 20:48:29.345993 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_unique_tpch_nation_n_nationkey".
2020-06-30 20:48:29.346090 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_unique_tpch_customer_c_custkey).
2020-06-30 20:48:29.346176 (Thread-1): Compiling test.sample_project.source_unique_tpch_nation_n_nationkey
2020-06-30 20:48:29.354007 (Thread-1): Writing injected SQL for node "test.sample_project.source_unique_tpch_nation_n_nationkey"
2020-06-30 20:48:29.354293 (Thread-1): finished collecting timing info
2020-06-30 20:48:29.354687 (Thread-1): finished collecting timing info
2020-06-30 20:48:29.355195 (Thread-1): Finished running node test.sample_project.source_unique_tpch_nation_n_nationkey
2020-06-30 20:48:29.355317 (Thread-1): Began running node test.sample_project.source_unique_tpch_orders_o_orderkey
2020-06-30 20:48:29.355598 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_unique_tpch_orders_o_orderkey".
2020-06-30 20:48:29.355695 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_unique_tpch_nation_n_nationkey).
2020-06-30 20:48:29.355780 (Thread-1): Compiling test.sample_project.source_unique_tpch_orders_o_orderkey
2020-06-30 20:48:29.363911 (Thread-1): Writing injected SQL for node "test.sample_project.source_unique_tpch_orders_o_orderkey"
2020-06-30 20:48:29.364203 (Thread-1): finished collecting timing info
2020-06-30 20:48:29.364423 (Thread-1): finished collecting timing info
2020-06-30 20:48:29.364744 (Thread-1): Finished running node test.sample_project.source_unique_tpch_orders_o_orderkey
2020-06-30 20:48:29.364943 (Thread-1): Began running node model.sample_project.orders_lineitem
2020-06-30 20:48:29.365241 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 20:48:29.365340 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_unique_tpch_orders_o_orderkey).
2020-06-30 20:48:29.365423 (Thread-1): Compiling model.sample_project.orders_lineitem
2020-06-30 20:48:29.376965 (Thread-1): Writing injected SQL for node "model.sample_project.orders_lineitem"
2020-06-30 20:48:29.377246 (Thread-1): finished collecting timing info
2020-06-30 20:48:29.377661 (Thread-1): Finished running node model.sample_project.orders_lineitem
2020-06-30 20:48:29.377784 (Thread-1): Began running node model.sample_project.customer_nation
2020-06-30 20:48:29.378075 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 20:48:29.378249 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders_lineitem).
2020-06-30 20:48:29.378343 (Thread-1): Compiling model.sample_project.customer_nation
2020-06-30 20:48:29.388458 (Thread-1): Writing injected SQL for node "model.sample_project.customer_nation"
2020-06-30 20:48:29.388745 (Thread-1): finished collecting timing info
2020-06-30 20:48:29.389093 (Thread-1): Finished running node model.sample_project.customer_nation
2020-06-30 20:48:29.389216 (Thread-1): Began running node model.sample_project.order_statistics
2020-06-30 20:48:29.389504 (Thread-1): Acquiring new snowflake connection "model.sample_project.order_statistics".
2020-06-30 20:48:29.389674 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer_nation).
2020-06-30 20:48:29.389774 (Thread-1): Compiling model.sample_project.order_statistics
2020-06-30 20:48:29.402225 (Thread-1): Writing injected SQL for node "model.sample_project.order_statistics"
2020-06-30 20:48:29.402518 (Thread-1): finished collecting timing info
2020-06-30 20:48:29.402730 (Thread-1): finished collecting timing info
2020-06-30 20:48:29.403049 (Thread-1): Finished running node model.sample_project.order_statistics
2020-06-30 20:48:29.403168 (Thread-1): Began running node model.sample_project.cust_list_ord_nat
2020-06-30 20:48:29.403441 (Thread-1): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 20:48:29.403536 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.order_statistics).
2020-06-30 20:48:29.403618 (Thread-1): Compiling model.sample_project.cust_list_ord_nat
2020-06-30 20:48:29.416063 (Thread-1): Writing injected SQL for node "model.sample_project.cust_list_ord_nat"
2020-06-30 20:48:29.417061 (Thread-1): finished collecting timing info
2020-06-30 20:48:29.417418 (Thread-1): Finished running node model.sample_project.cust_list_ord_nat
2020-06-30 20:48:29.417551 (Thread-1): Began running node model.sample_project.customers_per_nation
2020-06-30 20:48:29.417839 (Thread-1): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 20:48:29.418023 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.cust_list_ord_nat).
2020-06-30 20:48:29.418105 (Thread-1): Compiling model.sample_project.customers_per_nation
2020-06-30 20:48:29.426533 (Thread-1): Writing injected SQL for node "model.sample_project.customers_per_nation"
2020-06-30 20:48:29.426810 (Thread-1): finished collecting timing info
2020-06-30 20:48:29.427149 (Thread-1): Finished running node model.sample_project.customers_per_nation
2020-06-30 20:48:29.427270 (Thread-1): Began running node model.sample_project.sales_report_one
2020-06-30 20:48:29.427541 (Thread-1): Acquiring new snowflake connection "model.sample_project.sales_report_one".
2020-06-30 20:48:29.427636 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customers_per_nation).
2020-06-30 20:48:29.427949 (Thread-1): Compiling model.sample_project.sales_report_one
2020-06-30 20:48:29.443238 (Thread-1): Writing injected SQL for node "model.sample_project.sales_report_one"
2020-06-30 20:48:29.443645 (Thread-1): finished collecting timing info
2020-06-30 20:48:29.443870 (Thread-1): finished collecting timing info
2020-06-30 20:48:29.444203 (Thread-1): Finished running node model.sample_project.sales_report_one
2020-06-30 20:48:29.444325 (Thread-1): Began running node model.sample_project.sales_report_two
2020-06-30 20:48:29.444616 (Thread-1): Acquiring new snowflake connection "model.sample_project.sales_report_two".
2020-06-30 20:48:29.444763 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.sales_report_one).
2020-06-30 20:48:29.444938 (Thread-1): Compiling model.sample_project.sales_report_two
2020-06-30 20:48:29.456285 (Thread-1): Writing injected SQL for node "model.sample_project.sales_report_two"
2020-06-30 20:48:29.456613 (Thread-1): finished collecting timing info
2020-06-30 20:48:29.456886 (Thread-1): finished collecting timing info
2020-06-30 20:48:29.457355 (Thread-1): Finished running node model.sample_project.sales_report_two
2020-06-30 20:48:29.546902 (MainThread): Connection 'master' was properly closed.
2020-06-30 20:48:29.547046 (MainThread): Connection 'model.sample_project.sales_report_two' was left open.
2020-06-30 20:48:29.547126 (MainThread): On model.sample_project.sales_report_two: Close
2020-06-30 20:48:29.969780 (MainThread): 15:48:29 | Done.
2020-06-30 20:48:29.975529 (MainThread): Acquiring new snowflake connection "generate_catalog".
2020-06-30 20:48:29.975685 (MainThread): Opening a new connection, currently in state init
2020-06-30 20:48:29.975905 (MainThread): 15:48:29 | Building catalog
2020-06-30 20:48:30.058813 (ThreadPoolExecutor-2_0): Acquiring new snowflake connection "JAVEN_TESTING.information_schema".
2020-06-30 20:48:30.059018 (ThreadPoolExecutor-2_0): Opening a new connection, currently in state init
2020-06-30 20:48:30.066304 (ThreadPoolExecutor-2_0): Using snowflake connection "JAVEN_TESTING.information_schema".
2020-06-30 20:48:30.066400 (ThreadPoolExecutor-2_0): On JAVEN_TESTING.information_schema: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "JAVEN_TESTING.information_schema"} */

    
      with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include"

          from JAVEN_TESTING.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              null as "table_comment",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              null as "column_comment"

          from JAVEN_TESTING.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('test'))
      order by "column_index"
2020-06-30 20:48:37.167618 (ThreadPoolExecutor-2_0): SQL status: SUCCESS 88 in 7.10 seconds
2020-06-30 20:48:37.183893 (ThreadPoolExecutor-2_0): Acquiring new snowflake connection "snowflake_sample_data.information_schema".
2020-06-30 20:48:37.183993 (ThreadPoolExecutor-2_0): Re-using an available connection from the pool (formerly JAVEN_TESTING.information_schema).
2020-06-30 20:48:37.186903 (ThreadPoolExecutor-2_0): Using snowflake connection "snowflake_sample_data.information_schema".
2020-06-30 20:48:37.187004 (ThreadPoolExecutor-2_0): On snowflake_sample_data.information_schema: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "snowflake_sample_data.information_schema"} */

    
      with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include"

          from snowflake_sample_data.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              null as "table_comment",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              null as "column_comment"

          from snowflake_sample_data.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('tpch_sf1'))
      order by "column_index"
2020-06-30 20:48:40.298604 (ThreadPoolExecutor-2_0): SQL status: SUCCESS 61 in 3.11 seconds
2020-06-30 20:48:40.469583 (MainThread): 15:48:40 | Catalog written to /Users/johnaven/Documents/gitlab_projects/dbt-demo-June-2020/sample_project/target/catalog.json
2020-06-30 20:48:40.469877 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114948d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1149f4050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1149f4090>]}
2020-06-30 20:48:40.470044 (MainThread): Flushing usage events
2020-06-30 20:48:40.873024 (MainThread): Connection 'generate_catalog' was properly closed.
2020-06-30 20:48:40.873155 (MainThread): Connection 'snowflake_sample_data.information_schema' was left open.
2020-06-30 20:48:40.873233 (MainThread): On snowflake_sample_data.information_schema: Close
2020-06-30 20:48:42.186935 (MainThread): Running with dbt=0.17.0
2020-06-30 20:48:42.515418 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', open_browser=True, partial_parse=None, port=8080, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-06-30 20:48:42.516354 (MainThread): Tracking: tracking
2020-06-30 20:48:42.516675 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa61e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca49390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca49e90>]}
2020-06-30 20:48:42.518619 (MainThread): Serving docs at 0.0.0.0:8080
2020-06-30 20:48:42.518764 (MainThread): To access from your browser, navigate to:  http://localhost:8080
2020-06-30 20:48:42.518867 (MainThread): Press Ctrl+C to exit.


2020-06-30 21:12:53.885633 (MainThread): Flushing usage events
2020-06-30 21:12:54.391833 (MainThread): ctrl-c
2020-06-30 21:13:01.394815 (MainThread): Running with dbt=0.17.0
2020-06-30 21:13:01.707572 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-06-30 21:13:01.708681 (MainThread): Tracking: tracking
2020-06-30 21:13:01.709002 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11438edd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1143acb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1143aca90>]}
2020-06-30 21:13:01.733709 (MainThread): Partial parsing not enabled
2020-06-30 21:13:01.735639 (MainThread): Parsing macros/core.sql
2020-06-30 21:13:01.742076 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-30 21:13:01.752383 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-30 21:13:01.754191 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-30 21:13:01.772945 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-30 21:13:01.806124 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-30 21:13:01.829648 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-30 21:13:01.831823 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-30 21:13:01.839044 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-30 21:13:01.854929 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-30 21:13:01.862423 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-30 21:13:01.869450 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-30 21:13:01.875087 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-30 21:13:01.876052 (MainThread): Parsing macros/etc/query.sql
2020-06-30 21:13:01.877372 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-30 21:13:01.879100 (MainThread): Parsing macros/etc/datetime.sql
2020-06-30 21:13:01.889329 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-30 21:13:01.891684 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-30 21:13:01.893656 (MainThread): Parsing macros/adapters/common.sql
2020-06-30 21:13:01.949176 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-30 21:13:01.950387 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-30 21:13:01.951453 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-30 21:13:01.952776 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-30 21:13:01.955441 (MainThread): Parsing macros/catalog.sql
2020-06-30 21:13:01.957353 (MainThread): Parsing macros/adapters.sql
2020-06-30 21:13:01.981409 (MainThread): Parsing macros/materializations/merge.sql
2020-06-30 21:13:01.983509 (MainThread): Parsing macros/materializations/view.sql
2020-06-30 21:13:01.984740 (MainThread): Parsing macros/materializations/table.sql
2020-06-30 21:13:01.989246 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-30 21:13:02.034460 (MainThread): Partial parsing not enabled
2020-06-30 21:13:02.034982 (MainThread): Parsing macros/discounted_price.sql
2020-06-30 21:13:02.036489 (MainThread): Parsing macros/tax_charged.sql
2020-06-30 21:13:02.038224 (MainThread): Parsing macros/full_charge.sql
2020-06-30 21:13:02.039654 (MainThread): Parsing macros/test_is_nonnegative.sql
2020-06-30 21:13:02.044127 (MainThread): Parsing macros/cross_db_utils/except.sql
2020-06-30 21:13:02.045594 (MainThread): Parsing macros/cross_db_utils/replace.sql
2020-06-30 21:13:02.046889 (MainThread): Parsing macros/cross_db_utils/concat.sql
2020-06-30 21:13:02.049290 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2020-06-30 21:13:02.055906 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2020-06-30 21:13:02.057539 (MainThread): Parsing macros/cross_db_utils/length.sql
2020-06-30 21:13:02.059173 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2020-06-30 21:13:02.061762 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2020-06-30 21:13:02.062871 (MainThread): Parsing macros/cross_db_utils/right.sql
2020-06-30 21:13:02.065360 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2020-06-30 21:13:02.076103 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2020-06-30 21:13:02.078433 (MainThread): Parsing macros/cross_db_utils/hash.sql
2020-06-30 21:13:02.079995 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2020-06-30 21:13:02.081577 (MainThread): Parsing macros/cross_db_utils/position.sql
2020-06-30 21:13:02.083383 (MainThread): Parsing macros/cross_db_utils/literal.sql
2020-06-30 21:13:02.084401 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2020-06-30 21:13:02.088146 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2020-06-30 21:13:02.094009 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2020-06-30 21:13:02.097135 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2020-06-30 21:13:02.099188 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2020-06-30 21:13:02.100985 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2020-06-30 21:13:02.131571 (MainThread): Parsing macros/logger/pretty_log_format.sql
2020-06-30 21:13:02.133171 (MainThread): Parsing macros/logger/pretty_time.sql
2020-06-30 21:13:02.134074 (MainThread): Parsing macros/logger/log_info.sql
2020-06-30 21:13:02.134840 (MainThread): Parsing macros/datetime/date_spine.sql
2020-06-30 21:13:02.138612 (MainThread): Parsing macros/web/get_url_host.sql
2020-06-30 21:13:02.140243 (MainThread): Parsing macros/web/get_url_path.sql
2020-06-30 21:13:02.143838 (MainThread): Parsing macros/web/get_url_parameter.sql
2020-06-30 21:13:02.145331 (MainThread): Parsing macros/geo/haversine_distance.sql
2020-06-30 21:13:02.146517 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2020-06-30 21:13:02.148790 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2020-06-30 21:13:02.152045 (MainThread): Parsing macros/schema_tests/recency.sql
2020-06-30 21:13:02.154402 (MainThread): Parsing macros/schema_tests/not_constant.sql
2020-06-30 21:13:02.155961 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2020-06-30 21:13:02.157319 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2020-06-30 21:13:02.158693 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2020-06-30 21:13:02.160350 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2020-06-30 21:13:02.161572 (MainThread): Parsing macros/schema_tests/equality.sql
2020-06-30 21:13:02.165023 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2020-06-30 21:13:02.171013 (MainThread): Parsing macros/sql/nullcheck_table.sql
2020-06-30 21:13:02.172231 (MainThread): Parsing macros/sql/generate_series.sql
2020-06-30 21:13:02.175900 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2020-06-30 21:13:02.179844 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2020-06-30 21:13:02.182686 (MainThread): Parsing macros/sql/star.sql
2020-06-30 21:13:02.185628 (MainThread): Parsing macros/sql/unpivot.sql
2020-06-30 21:13:02.192133 (MainThread): Parsing macros/sql/union.sql
2020-06-30 21:13:02.202151 (MainThread): Parsing macros/sql/groupby.sql
2020-06-30 21:13:02.203153 (MainThread): Parsing macros/sql/surrogate_key.sql
2020-06-30 21:13:02.207222 (MainThread): Parsing macros/sql/safe_add.sql
2020-06-30 21:13:02.208439 (MainThread): Parsing macros/sql/nullcheck.sql
2020-06-30 21:13:02.209789 (MainThread): Parsing macros/sql/get_column_values.sql
2020-06-30 21:13:02.214340 (MainThread): Parsing macros/sql/pivot.sql
2020-06-30 21:13:02.217338 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2020-06-30 21:13:02.263208 (MainThread): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 21:13:02.263326 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:13:02.312985 (MainThread): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 21:13:02.313119 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:13:02.325527 (MainThread): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 21:13:02.325627 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:13:02.338230 (MainThread): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 21:13:02.338317 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:13:02.350223 (MainThread): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 21:13:02.350310 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:13:02.368070 (MainThread): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 21:13:02.368198 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:13:02.383689 (MainThread): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 21:13:02.383853 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:13:02.401746 (MainThread): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 21:13:02.401874 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:13:02.417305 (MainThread): Acquiring new snowflake connection "model.sample_project.sales_report_one".
2020-06-30 21:13:02.417634 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:13:02.436887 (MainThread): Acquiring new snowflake connection "model.sample_project.order_statistics".
2020-06-30 21:13:02.437019 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:13:02.452858 (MainThread): Acquiring new snowflake connection "model.sample_project.sales_report_two".
2020-06-30 21:13:02.452971 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:13:02.462757 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114cb91d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114ce70d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114d21ad0>]}
2020-06-30 21:13:02.462944 (MainThread): Flushing usage events
2020-06-30 21:13:02.881182 (MainThread): Connection 'model.sample_project.sales_report_two' was properly closed.
2020-06-30 21:13:02.881347 (MainThread): Encountered an error:
2020-06-30 21:13:02.881460 (MainThread): Compilation Error
  dbt found two resources with the name "__overview__". Since these resources have the same name,
  dbt will be unable to find the correct resource when doc("__overview__") is used. To fix this,
  change the name of one of these resources:
  - sample_project.__overview__ (docs/customer_per_nation.md)
  - sample_project.__overview__ (docs/overview.md)
2020-06-30 21:13:02.886113 (MainThread): Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/main.py", line 81, in main
    results, succeeded = handle_and_check(args)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/main.py", line 159, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/main.py", line 212, in run_from_args
    results = task.run()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/task/generate.py", line 215, in run
    compile_results = CompileTask.run(self)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/task/runnable.py", line 389, in run
    self._runtime_initialize()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/task/runnable.py", line 103, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/task/runnable.py", line 71, in _runtime_initialize
    self.load_manifest()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/task/runnable.py", line 60, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/perf_utils.py", line 23, in get_full_manifest
    return load_manifest(config, internal, set_header)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/manifest.py", line 641, in load_manifest
    return ManifestLoader.load_all(config, internal_manifest, macro_hook)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/manifest.py", line 356, in load_all
    loader.load(internal_manifest=internal_manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/manifest.py", line 212, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/manifest.py", line 186, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/manifest.py", line 142, in parse_with_cache
    parser.parse_file(block)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/docs.py", line 63, in parse_file
    self.results.add_doc(file_block.file, parsed)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/results.py", line 144, in add_doc
    _check_duplicates(doc, self.docs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/results.py", line 46, in _check_duplicates
    raise_duplicate_resource_name(value, src[value.unique_id])
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/exceptions.py", line 744, in raise_duplicate_resource_name
    node_2.unique_id, node_2.original_file_path))
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/exceptions.py", line 392, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error
  dbt found two resources with the name "__overview__". Since these resources have the same name,
  dbt will be unable to find the correct resource when doc("__overview__") is used. To fix this,
  change the name of one of these resources:
  - sample_project.__overview__ (docs/customer_per_nation.md)
  - sample_project.__overview__ (docs/overview.md)

2020-06-30 21:13:24.439736 (MainThread): Running with dbt=0.17.0
2020-06-30 21:13:24.757932 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-06-30 21:13:24.758703 (MainThread): Tracking: tracking
2020-06-30 21:13:24.759027 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106291f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106284110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062a7990>]}
2020-06-30 21:13:24.780598 (MainThread): Partial parsing not enabled
2020-06-30 21:13:24.782637 (MainThread): Parsing macros/core.sql
2020-06-30 21:13:24.787647 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-30 21:13:24.797849 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-30 21:13:24.799767 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-30 21:13:24.824465 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-30 21:13:24.857077 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-30 21:13:24.882014 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-30 21:13:24.884472 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-30 21:13:24.892197 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-30 21:13:24.907521 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-30 21:13:24.915369 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-30 21:13:24.922428 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-30 21:13:24.928024 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-30 21:13:24.929040 (MainThread): Parsing macros/etc/query.sql
2020-06-30 21:13:24.930187 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-30 21:13:24.932133 (MainThread): Parsing macros/etc/datetime.sql
2020-06-30 21:13:24.943022 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-30 21:13:24.945561 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-30 21:13:24.947561 (MainThread): Parsing macros/adapters/common.sql
2020-06-30 21:13:25.004309 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-30 21:13:25.005701 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-30 21:13:25.006671 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-30 21:13:25.007970 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-30 21:13:25.010555 (MainThread): Parsing macros/catalog.sql
2020-06-30 21:13:25.012512 (MainThread): Parsing macros/adapters.sql
2020-06-30 21:13:25.036262 (MainThread): Parsing macros/materializations/merge.sql
2020-06-30 21:13:25.038446 (MainThread): Parsing macros/materializations/view.sql
2020-06-30 21:13:25.039686 (MainThread): Parsing macros/materializations/table.sql
2020-06-30 21:13:25.043707 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-30 21:13:25.084807 (MainThread): Partial parsing not enabled
2020-06-30 21:13:25.085266 (MainThread): Parsing macros/discounted_price.sql
2020-06-30 21:13:25.085955 (MainThread): Parsing macros/tax_charged.sql
2020-06-30 21:13:25.086741 (MainThread): Parsing macros/full_charge.sql
2020-06-30 21:13:25.087708 (MainThread): Parsing macros/test_is_nonnegative.sql
2020-06-30 21:13:25.089922 (MainThread): Parsing macros/cross_db_utils/except.sql
2020-06-30 21:13:25.091129 (MainThread): Parsing macros/cross_db_utils/replace.sql
2020-06-30 21:13:25.092443 (MainThread): Parsing macros/cross_db_utils/concat.sql
2020-06-30 21:13:25.094848 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2020-06-30 21:13:25.100947 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2020-06-30 21:13:25.102589 (MainThread): Parsing macros/cross_db_utils/length.sql
2020-06-30 21:13:25.104361 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2020-06-30 21:13:25.107275 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2020-06-30 21:13:25.108840 (MainThread): Parsing macros/cross_db_utils/right.sql
2020-06-30 21:13:25.111484 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2020-06-30 21:13:25.122621 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2020-06-30 21:13:25.124676 (MainThread): Parsing macros/cross_db_utils/hash.sql
2020-06-30 21:13:25.127224 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2020-06-30 21:13:25.129206 (MainThread): Parsing macros/cross_db_utils/position.sql
2020-06-30 21:13:25.131054 (MainThread): Parsing macros/cross_db_utils/literal.sql
2020-06-30 21:13:25.132030 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2020-06-30 21:13:25.135745 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2020-06-30 21:13:25.141920 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2020-06-30 21:13:25.144812 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2020-06-30 21:13:25.146744 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2020-06-30 21:13:25.148416 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2020-06-30 21:13:25.174191 (MainThread): Parsing macros/logger/pretty_log_format.sql
2020-06-30 21:13:25.174907 (MainThread): Parsing macros/logger/pretty_time.sql
2020-06-30 21:13:25.175783 (MainThread): Parsing macros/logger/log_info.sql
2020-06-30 21:13:25.176511 (MainThread): Parsing macros/datetime/date_spine.sql
2020-06-30 21:13:25.180420 (MainThread): Parsing macros/web/get_url_host.sql
2020-06-30 21:13:25.182189 (MainThread): Parsing macros/web/get_url_path.sql
2020-06-30 21:13:25.184593 (MainThread): Parsing macros/web/get_url_parameter.sql
2020-06-30 21:13:25.186117 (MainThread): Parsing macros/geo/haversine_distance.sql
2020-06-30 21:13:25.187315 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2020-06-30 21:13:25.189693 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2020-06-30 21:13:25.193058 (MainThread): Parsing macros/schema_tests/recency.sql
2020-06-30 21:13:25.195717 (MainThread): Parsing macros/schema_tests/not_constant.sql
2020-06-30 21:13:25.197663 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2020-06-30 21:13:25.198991 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2020-06-30 21:13:25.201553 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2020-06-30 21:13:25.203872 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2020-06-30 21:13:25.205494 (MainThread): Parsing macros/schema_tests/equality.sql
2020-06-30 21:13:25.209394 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2020-06-30 21:13:25.216139 (MainThread): Parsing macros/sql/nullcheck_table.sql
2020-06-30 21:13:25.217404 (MainThread): Parsing macros/sql/generate_series.sql
2020-06-30 21:13:25.222792 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2020-06-30 21:13:25.227484 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2020-06-30 21:13:25.230284 (MainThread): Parsing macros/sql/star.sql
2020-06-30 21:13:25.234367 (MainThread): Parsing macros/sql/unpivot.sql
2020-06-30 21:13:25.242433 (MainThread): Parsing macros/sql/union.sql
2020-06-30 21:13:25.255351 (MainThread): Parsing macros/sql/groupby.sql
2020-06-30 21:13:25.256653 (MainThread): Parsing macros/sql/surrogate_key.sql
2020-06-30 21:13:25.259964 (MainThread): Parsing macros/sql/safe_add.sql
2020-06-30 21:13:25.261475 (MainThread): Parsing macros/sql/nullcheck.sql
2020-06-30 21:13:25.263320 (MainThread): Parsing macros/sql/get_column_values.sql
2020-06-30 21:13:25.269612 (MainThread): Parsing macros/sql/pivot.sql
2020-06-30 21:13:25.272693 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2020-06-30 21:13:25.322465 (MainThread): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 21:13:25.322596 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:13:25.357975 (MainThread): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 21:13:25.358103 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:13:25.370252 (MainThread): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 21:13:25.370357 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:13:25.381971 (MainThread): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 21:13:25.382068 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:13:25.400547 (MainThread): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 21:13:25.400687 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:13:25.414393 (MainThread): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 21:13:25.414492 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:13:25.428168 (MainThread): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 21:13:25.428266 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:13:25.441654 (MainThread): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 21:13:25.441749 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:13:25.454824 (MainThread): Acquiring new snowflake connection "model.sample_project.sales_report_one".
2020-06-30 21:13:25.454918 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:13:25.471313 (MainThread): Acquiring new snowflake connection "model.sample_project.order_statistics".
2020-06-30 21:13:25.471421 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:13:25.486754 (MainThread): Acquiring new snowflake connection "model.sample_project.sales_report_two".
2020-06-30 21:13:25.486857 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:13:25.542020 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ba2bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c33c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b7b450>]}
2020-06-30 21:13:25.542234 (MainThread): Flushing usage events
2020-06-30 21:13:25.974695 (MainThread): Connection 'model.sample_project.sales_report_two' was properly closed.
2020-06-30 21:13:25.974879 (MainThread): Encountered an error:
2020-06-30 21:13:25.975018 (MainThread): Compilation Error
  Error reading sample_project: reports/schema.yml - Runtime Error
    Syntax error near line 19
    ------------------------------
    16 | 
    17 | models:
    18 |     - name: customers_per_nation
    19 |       description: {{ doc(customers_per_nation.md) }}
    20 |     - name: order_statistics
    21 |     - name: sales_report_one
    22 |     - name: sales_report_two
    
    Raw Error:
    ------------------------------
    while constructing a mapping
      in "<unicode string>", line 19, column 20
    found unhashable key
      in "<unicode string>", line 19, column 21
2020-06-30 21:13:25.978324 (MainThread): Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/yaml_helper.py", line 62, in load_yaml_text
    return safe_load(contents)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/yaml_helper.py", line 57, in safe_load
    return yaml.load(contents, Loader=YamlLoader)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/yaml/__init__.py", line 114, in load
    return loader.get_single_data()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/yaml/constructor.py", line 51, in get_single_data
    return self.construct_document(node)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/yaml/constructor.py", line 60, in construct_document
    for dummy in generator:
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/yaml/constructor.py", line 413, in construct_yaml_map
    value = self.construct_mapping(node)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/yaml/constructor.py", line 218, in construct_mapping
    return super().construct_mapping(node, deep=deep)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/yaml/constructor.py", line 142, in construct_mapping
    "found unhashable key", key_node.start_mark)
yaml.constructor.ConstructorError: while constructing a mapping
  in "<unicode string>", line 19, column 20
found unhashable key
  in "<unicode string>", line 19, column 21

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/schemas.py", line 213, in _yaml_from_file
    return load_yaml_text(source_file.contents)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/yaml_helper.py", line 69, in load_yaml_text
    raise dbt.exceptions.ValidationException(error)
dbt.exceptions.ValidationException: Runtime Error
  Syntax error near line 19
  ------------------------------
  16 | 
  17 | models:
  18 |     - name: customers_per_nation
  19 |       description: {{ doc(customers_per_nation.md) }}
  20 |     - name: order_statistics
  21 |     - name: sales_report_one
  22 |     - name: sales_report_two
  
  Raw Error:
  ------------------------------
  while constructing a mapping
    in "<unicode string>", line 19, column 20
  found unhashable key
    in "<unicode string>", line 19, column 21

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/main.py", line 81, in main
    results, succeeded = handle_and_check(args)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/main.py", line 159, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/main.py", line 212, in run_from_args
    results = task.run()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/task/generate.py", line 215, in run
    compile_results = CompileTask.run(self)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/task/runnable.py", line 389, in run
    self._runtime_initialize()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/task/runnable.py", line 103, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/task/runnable.py", line 71, in _runtime_initialize
    self.load_manifest()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/task/runnable.py", line 60, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/perf_utils.py", line 23, in get_full_manifest
    return load_manifest(config, internal, set_header)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/manifest.py", line 641, in load_manifest
    return ManifestLoader.load_all(config, internal_manifest, macro_hook)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/manifest.py", line 356, in load_all
    loader.load(internal_manifest=internal_manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/manifest.py", line 212, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/manifest.py", line 186, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/manifest.py", line 142, in parse_with_cache
    parser.parse_file(block)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/schemas.py", line 506, in parse_file
    dct = self._yaml_from_file(block.file)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/schemas.py", line 218, in _yaml_from_file
    .format(self.project.project_name, path, reason)
dbt.exceptions.CompilationException: Compilation Error
  Error reading sample_project: reports/schema.yml - Runtime Error
    Syntax error near line 19
    ------------------------------
    16 | 
    17 | models:
    18 |     - name: customers_per_nation
    19 |       description: {{ doc(customers_per_nation.md) }}
    20 |     - name: order_statistics
    21 |     - name: sales_report_one
    22 |     - name: sales_report_two
    
    Raw Error:
    ------------------------------
    while constructing a mapping
      in "<unicode string>", line 19, column 20
    found unhashable key
      in "<unicode string>", line 19, column 21

2020-06-30 21:14:19.471723 (MainThread): Running with dbt=0.17.0
2020-06-30 21:14:19.794329 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-06-30 21:14:19.795054 (MainThread): Tracking: tracking
2020-06-30 21:14:19.795388 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111141f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112af0b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112af0fd0>]}
2020-06-30 21:14:19.820278 (MainThread): Partial parsing not enabled
2020-06-30 21:14:19.823836 (MainThread): Parsing macros/core.sql
2020-06-30 21:14:19.831720 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-30 21:14:19.843121 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-30 21:14:19.845545 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-30 21:14:19.865822 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-30 21:14:19.904275 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-30 21:14:19.927547 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-30 21:14:19.929564 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-30 21:14:19.938658 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-30 21:14:19.959120 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-30 21:14:19.966811 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-30 21:14:19.973945 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-30 21:14:19.979614 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-30 21:14:19.980622 (MainThread): Parsing macros/etc/query.sql
2020-06-30 21:14:19.981774 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-30 21:14:19.983665 (MainThread): Parsing macros/etc/datetime.sql
2020-06-30 21:14:19.993668 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-30 21:14:19.995812 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-30 21:14:19.997685 (MainThread): Parsing macros/adapters/common.sql
2020-06-30 21:14:20.052276 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-30 21:14:20.053588 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-30 21:14:20.054626 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-30 21:14:20.055994 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-30 21:14:20.058589 (MainThread): Parsing macros/catalog.sql
2020-06-30 21:14:20.060955 (MainThread): Parsing macros/adapters.sql
2020-06-30 21:14:20.087479 (MainThread): Parsing macros/materializations/merge.sql
2020-06-30 21:14:20.089864 (MainThread): Parsing macros/materializations/view.sql
2020-06-30 21:14:20.091116 (MainThread): Parsing macros/materializations/table.sql
2020-06-30 21:14:20.095975 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-30 21:14:20.137730 (MainThread): Partial parsing not enabled
2020-06-30 21:14:20.138156 (MainThread): Parsing macros/discounted_price.sql
2020-06-30 21:14:20.138904 (MainThread): Parsing macros/tax_charged.sql
2020-06-30 21:14:20.140010 (MainThread): Parsing macros/full_charge.sql
2020-06-30 21:14:20.140885 (MainThread): Parsing macros/test_is_nonnegative.sql
2020-06-30 21:14:20.143973 (MainThread): Parsing macros/cross_db_utils/except.sql
2020-06-30 21:14:20.145053 (MainThread): Parsing macros/cross_db_utils/replace.sql
2020-06-30 21:14:20.146377 (MainThread): Parsing macros/cross_db_utils/concat.sql
2020-06-30 21:14:20.149296 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2020-06-30 21:14:20.155601 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2020-06-30 21:14:20.157002 (MainThread): Parsing macros/cross_db_utils/length.sql
2020-06-30 21:14:20.158623 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2020-06-30 21:14:20.161170 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2020-06-30 21:14:20.162250 (MainThread): Parsing macros/cross_db_utils/right.sql
2020-06-30 21:14:20.164980 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2020-06-30 21:14:20.176562 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2020-06-30 21:14:20.178682 (MainThread): Parsing macros/cross_db_utils/hash.sql
2020-06-30 21:14:20.180340 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2020-06-30 21:14:20.181824 (MainThread): Parsing macros/cross_db_utils/position.sql
2020-06-30 21:14:20.183477 (MainThread): Parsing macros/cross_db_utils/literal.sql
2020-06-30 21:14:20.184554 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2020-06-30 21:14:20.188178 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2020-06-30 21:14:20.194076 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2020-06-30 21:14:20.196978 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2020-06-30 21:14:20.199305 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2020-06-30 21:14:20.201000 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2020-06-30 21:14:20.227322 (MainThread): Parsing macros/logger/pretty_log_format.sql
2020-06-30 21:14:20.228201 (MainThread): Parsing macros/logger/pretty_time.sql
2020-06-30 21:14:20.228987 (MainThread): Parsing macros/logger/log_info.sql
2020-06-30 21:14:20.229715 (MainThread): Parsing macros/datetime/date_spine.sql
2020-06-30 21:14:20.233296 (MainThread): Parsing macros/web/get_url_host.sql
2020-06-30 21:14:20.234825 (MainThread): Parsing macros/web/get_url_path.sql
2020-06-30 21:14:20.237071 (MainThread): Parsing macros/web/get_url_parameter.sql
2020-06-30 21:14:20.238224 (MainThread): Parsing macros/geo/haversine_distance.sql
2020-06-30 21:14:20.239184 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2020-06-30 21:14:20.241213 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2020-06-30 21:14:20.243772 (MainThread): Parsing macros/schema_tests/recency.sql
2020-06-30 21:14:20.245202 (MainThread): Parsing macros/schema_tests/not_constant.sql
2020-06-30 21:14:20.246235 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2020-06-30 21:14:20.247259 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2020-06-30 21:14:20.248476 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2020-06-30 21:14:20.250049 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2020-06-30 21:14:20.251171 (MainThread): Parsing macros/schema_tests/equality.sql
2020-06-30 21:14:20.254455 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2020-06-30 21:14:20.260279 (MainThread): Parsing macros/sql/nullcheck_table.sql
2020-06-30 21:14:20.261337 (MainThread): Parsing macros/sql/generate_series.sql
2020-06-30 21:14:20.265330 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2020-06-30 21:14:20.269152 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2020-06-30 21:14:20.272304 (MainThread): Parsing macros/sql/star.sql
2020-06-30 21:14:20.275331 (MainThread): Parsing macros/sql/unpivot.sql
2020-06-30 21:14:20.281696 (MainThread): Parsing macros/sql/union.sql
2020-06-30 21:14:20.291544 (MainThread): Parsing macros/sql/groupby.sql
2020-06-30 21:14:20.292583 (MainThread): Parsing macros/sql/surrogate_key.sql
2020-06-30 21:14:20.295568 (MainThread): Parsing macros/sql/safe_add.sql
2020-06-30 21:14:20.296672 (MainThread): Parsing macros/sql/nullcheck.sql
2020-06-30 21:14:20.297991 (MainThread): Parsing macros/sql/get_column_values.sql
2020-06-30 21:14:20.304122 (MainThread): Parsing macros/sql/pivot.sql
2020-06-30 21:14:20.308818 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2020-06-30 21:14:20.356705 (MainThread): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 21:14:20.356871 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:14:20.388128 (MainThread): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 21:14:20.388230 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:14:20.400176 (MainThread): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 21:14:20.400266 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:14:20.411681 (MainThread): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 21:14:20.411821 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:14:20.424085 (MainThread): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 21:14:20.424175 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:14:20.437613 (MainThread): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 21:14:20.437707 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:14:20.459513 (MainThread): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 21:14:20.459796 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:14:20.478038 (MainThread): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 21:14:20.478161 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:14:20.492333 (MainThread): Acquiring new snowflake connection "model.sample_project.sales_report_one".
2020-06-30 21:14:20.492441 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:14:20.508708 (MainThread): Acquiring new snowflake connection "model.sample_project.order_statistics".
2020-06-30 21:14:20.508808 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:14:20.525241 (MainThread): Acquiring new snowflake connection "model.sample_project.sales_report_two".
2020-06-30 21:14:20.525347 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:14:20.582662 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113472390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113485850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134854d0>]}
2020-06-30 21:14:20.582878 (MainThread): Flushing usage events
2020-06-30 21:14:22.081960 (MainThread): Connection 'model.sample_project.sales_report_two' was properly closed.
2020-06-30 21:14:22.082152 (MainThread): Encountered an error:
2020-06-30 21:14:22.082288 (MainThread): Compilation Error
  Error reading sample_project: reports/schema.yml - Runtime Error
    Syntax error near line 19
    ------------------------------
    16 | 
    17 | models:
    18 |     - name: customers_per_nation
    19 |       description: {{ doc('customers_per_nation') }}
    20 |     - name: order_statistics
    21 |     - name: sales_report_one
    22 |     - name: sales_report_two
    
    Raw Error:
    ------------------------------
    while constructing a mapping
      in "<unicode string>", line 19, column 20
    found unhashable key
      in "<unicode string>", line 19, column 21
2020-06-30 21:14:22.084137 (MainThread): Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/yaml_helper.py", line 62, in load_yaml_text
    return safe_load(contents)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/yaml_helper.py", line 57, in safe_load
    return yaml.load(contents, Loader=YamlLoader)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/yaml/__init__.py", line 114, in load
    return loader.get_single_data()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/yaml/constructor.py", line 51, in get_single_data
    return self.construct_document(node)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/yaml/constructor.py", line 60, in construct_document
    for dummy in generator:
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/yaml/constructor.py", line 413, in construct_yaml_map
    value = self.construct_mapping(node)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/yaml/constructor.py", line 218, in construct_mapping
    return super().construct_mapping(node, deep=deep)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/yaml/constructor.py", line 142, in construct_mapping
    "found unhashable key", key_node.start_mark)
yaml.constructor.ConstructorError: while constructing a mapping
  in "<unicode string>", line 19, column 20
found unhashable key
  in "<unicode string>", line 19, column 21

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/schemas.py", line 213, in _yaml_from_file
    return load_yaml_text(source_file.contents)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/yaml_helper.py", line 69, in load_yaml_text
    raise dbt.exceptions.ValidationException(error)
dbt.exceptions.ValidationException: Runtime Error
  Syntax error near line 19
  ------------------------------
  16 | 
  17 | models:
  18 |     - name: customers_per_nation
  19 |       description: {{ doc('customers_per_nation') }}
  20 |     - name: order_statistics
  21 |     - name: sales_report_one
  22 |     - name: sales_report_two
  
  Raw Error:
  ------------------------------
  while constructing a mapping
    in "<unicode string>", line 19, column 20
  found unhashable key
    in "<unicode string>", line 19, column 21

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/main.py", line 81, in main
    results, succeeded = handle_and_check(args)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/main.py", line 159, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/main.py", line 212, in run_from_args
    results = task.run()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/task/generate.py", line 215, in run
    compile_results = CompileTask.run(self)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/task/runnable.py", line 389, in run
    self._runtime_initialize()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/task/runnable.py", line 103, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/task/runnable.py", line 71, in _runtime_initialize
    self.load_manifest()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/task/runnable.py", line 60, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/perf_utils.py", line 23, in get_full_manifest
    return load_manifest(config, internal, set_header)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/manifest.py", line 641, in load_manifest
    return ManifestLoader.load_all(config, internal_manifest, macro_hook)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/manifest.py", line 356, in load_all
    loader.load(internal_manifest=internal_manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/manifest.py", line 212, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/manifest.py", line 186, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/manifest.py", line 142, in parse_with_cache
    parser.parse_file(block)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/schemas.py", line 506, in parse_file
    dct = self._yaml_from_file(block.file)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/schemas.py", line 218, in _yaml_from_file
    .format(self.project.project_name, path, reason)
dbt.exceptions.CompilationException: Compilation Error
  Error reading sample_project: reports/schema.yml - Runtime Error
    Syntax error near line 19
    ------------------------------
    16 | 
    17 | models:
    18 |     - name: customers_per_nation
    19 |       description: {{ doc('customers_per_nation') }}
    20 |     - name: order_statistics
    21 |     - name: sales_report_one
    22 |     - name: sales_report_two
    
    Raw Error:
    ------------------------------
    while constructing a mapping
      in "<unicode string>", line 19, column 20
    found unhashable key
      in "<unicode string>", line 19, column 21

2020-06-30 21:14:50.196312 (MainThread): Running with dbt=0.17.0
2020-06-30 21:14:50.520907 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-06-30 21:14:50.521764 (MainThread): Tracking: tracking
2020-06-30 21:14:50.522189 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b190a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b190d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1aeed0>]}
2020-06-30 21:14:50.543339 (MainThread): Partial parsing not enabled
2020-06-30 21:14:50.545271 (MainThread): Parsing macros/core.sql
2020-06-30 21:14:50.550497 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-30 21:14:50.559692 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-30 21:14:50.561621 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-30 21:14:50.581140 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-30 21:14:50.616944 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-30 21:14:50.642819 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-30 21:14:50.644994 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-30 21:14:50.652244 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-30 21:14:50.667430 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-30 21:14:50.675060 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-30 21:14:50.682245 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-30 21:14:50.687773 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-30 21:14:50.688806 (MainThread): Parsing macros/etc/query.sql
2020-06-30 21:14:50.689984 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-30 21:14:50.691992 (MainThread): Parsing macros/etc/datetime.sql
2020-06-30 21:14:50.702073 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-30 21:14:50.704259 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-30 21:14:50.706074 (MainThread): Parsing macros/adapters/common.sql
2020-06-30 21:14:50.761257 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-30 21:14:50.762500 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-30 21:14:50.763467 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-30 21:14:50.764606 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-30 21:14:50.767146 (MainThread): Parsing macros/catalog.sql
2020-06-30 21:14:50.769093 (MainThread): Parsing macros/adapters.sql
2020-06-30 21:14:50.797700 (MainThread): Parsing macros/materializations/merge.sql
2020-06-30 21:14:50.800164 (MainThread): Parsing macros/materializations/view.sql
2020-06-30 21:14:50.801427 (MainThread): Parsing macros/materializations/table.sql
2020-06-30 21:14:50.806328 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-30 21:14:50.850322 (MainThread): Partial parsing not enabled
2020-06-30 21:14:50.850731 (MainThread): Parsing macros/discounted_price.sql
2020-06-30 21:14:50.851431 (MainThread): Parsing macros/tax_charged.sql
2020-06-30 21:14:50.852539 (MainThread): Parsing macros/full_charge.sql
2020-06-30 21:14:50.853334 (MainThread): Parsing macros/test_is_nonnegative.sql
2020-06-30 21:14:50.858209 (MainThread): Parsing macros/cross_db_utils/except.sql
2020-06-30 21:14:50.859307 (MainThread): Parsing macros/cross_db_utils/replace.sql
2020-06-30 21:14:50.860751 (MainThread): Parsing macros/cross_db_utils/concat.sql
2020-06-30 21:14:50.863320 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2020-06-30 21:14:50.869360 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2020-06-30 21:14:50.870976 (MainThread): Parsing macros/cross_db_utils/length.sql
2020-06-30 21:14:50.872434 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2020-06-30 21:14:50.875861 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2020-06-30 21:14:50.876987 (MainThread): Parsing macros/cross_db_utils/right.sql
2020-06-30 21:14:50.879377 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2020-06-30 21:14:50.890226 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2020-06-30 21:14:50.892690 (MainThread): Parsing macros/cross_db_utils/hash.sql
2020-06-30 21:14:50.894348 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2020-06-30 21:14:50.896153 (MainThread): Parsing macros/cross_db_utils/position.sql
2020-06-30 21:14:50.898293 (MainThread): Parsing macros/cross_db_utils/literal.sql
2020-06-30 21:14:50.899312 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2020-06-30 21:14:50.902560 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2020-06-30 21:14:50.908569 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2020-06-30 21:14:50.911856 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2020-06-30 21:14:50.913790 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2020-06-30 21:14:50.915361 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2020-06-30 21:14:50.941326 (MainThread): Parsing macros/logger/pretty_log_format.sql
2020-06-30 21:14:50.942179 (MainThread): Parsing macros/logger/pretty_time.sql
2020-06-30 21:14:50.943098 (MainThread): Parsing macros/logger/log_info.sql
2020-06-30 21:14:50.943871 (MainThread): Parsing macros/datetime/date_spine.sql
2020-06-30 21:14:50.947419 (MainThread): Parsing macros/web/get_url_host.sql
2020-06-30 21:14:50.949046 (MainThread): Parsing macros/web/get_url_path.sql
2020-06-30 21:14:50.951313 (MainThread): Parsing macros/web/get_url_parameter.sql
2020-06-30 21:14:50.952484 (MainThread): Parsing macros/geo/haversine_distance.sql
2020-06-30 21:14:50.953710 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2020-06-30 21:14:50.955521 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2020-06-30 21:14:50.957888 (MainThread): Parsing macros/schema_tests/recency.sql
2020-06-30 21:14:50.959499 (MainThread): Parsing macros/schema_tests/not_constant.sql
2020-06-30 21:14:50.960678 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2020-06-30 21:14:50.961844 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2020-06-30 21:14:50.963081 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2020-06-30 21:14:50.964626 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2020-06-30 21:14:50.965760 (MainThread): Parsing macros/schema_tests/equality.sql
2020-06-30 21:14:50.968911 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2020-06-30 21:14:50.975184 (MainThread): Parsing macros/sql/nullcheck_table.sql
2020-06-30 21:14:50.976459 (MainThread): Parsing macros/sql/generate_series.sql
2020-06-30 21:14:50.980132 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2020-06-30 21:14:50.983946 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2020-06-30 21:14:50.986975 (MainThread): Parsing macros/sql/star.sql
2020-06-30 21:14:50.990127 (MainThread): Parsing macros/sql/unpivot.sql
2020-06-30 21:14:50.996842 (MainThread): Parsing macros/sql/union.sql
2020-06-30 21:14:51.007393 (MainThread): Parsing macros/sql/groupby.sql
2020-06-30 21:14:51.008464 (MainThread): Parsing macros/sql/surrogate_key.sql
2020-06-30 21:14:51.011194 (MainThread): Parsing macros/sql/safe_add.sql
2020-06-30 21:14:51.013075 (MainThread): Parsing macros/sql/nullcheck.sql
2020-06-30 21:14:51.014673 (MainThread): Parsing macros/sql/get_column_values.sql
2020-06-30 21:14:51.020494 (MainThread): Parsing macros/sql/pivot.sql
2020-06-30 21:14:51.023882 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2020-06-30 21:14:51.069260 (MainThread): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 21:14:51.069418 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:14:51.104988 (MainThread): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 21:14:51.105238 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:14:51.119213 (MainThread): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 21:14:51.119330 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:14:51.130680 (MainThread): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 21:14:51.130769 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:14:51.143082 (MainThread): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 21:14:51.143174 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:14:51.155568 (MainThread): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 21:14:51.155676 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:14:51.168084 (MainThread): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 21:14:51.168178 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:14:51.181447 (MainThread): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 21:14:51.181548 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:14:51.193997 (MainThread): Acquiring new snowflake connection "model.sample_project.sales_report_one".
2020-06-30 21:14:51.194096 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:14:51.211231 (MainThread): Acquiring new snowflake connection "model.sample_project.order_statistics".
2020-06-30 21:14:51.211328 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:14:51.226905 (MainThread): Acquiring new snowflake connection "model.sample_project.sales_report_two".
2020-06-30 21:14:51.227008 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:14:51.536701 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbb37d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbb3810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbb3910>]}
2020-06-30 21:14:51.536944 (MainThread): Flushing usage events
2020-06-30 21:14:51.943925 (MainThread): Connection 'model.sample_project.sales_report_two' was properly closed.
2020-06-30 21:14:51.944075 (MainThread): Encountered an error:
2020-06-30 21:14:51.944193 (MainThread): Compilation Error in model customers_per_nation (models/reports/customers_per_nation.sql)
  Documentation for 'model.sample_project.customers_per_nation' depends on doc 'customers_per_nation'  which was not found
2020-06-30 21:14:51.947133 (MainThread): Traceback (most recent call last):
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/main.py", line 81, in main
    results, succeeded = handle_and_check(args)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/main.py", line 159, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/main.py", line 212, in run_from_args
    results = task.run()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/task/generate.py", line 215, in run
    compile_results = CompileTask.run(self)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/task/runnable.py", line 389, in run
    self._runtime_initialize()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/task/runnable.py", line 103, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/task/runnable.py", line 71, in _runtime_initialize
    self.load_manifest()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/task/runnable.py", line 60, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/perf_utils.py", line 23, in get_full_manifest
    return load_manifest(config, internal, set_header)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/manifest.py", line 641, in load_manifest
    return ManifestLoader.load_all(config, internal_manifest, macro_hook)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/manifest.py", line 358, in load_all
    manifest = loader.create_manifest()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/manifest.py", line 334, in create_manifest
    self.process_manifest(manifest)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/manifest.py", line 307, in process_manifest
    process_docs(manifest, self.root_project)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/manifest.py", line 498, in process_docs
    _process_docs_for_node(ctx, node)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/parser/manifest.py", line 460, in _process_docs_for_node
    node.description = get_rendered(node.description, context)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 530, in get_rendered
    return render_template(template, ctx, node)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/clients/jinja.py", line 481, in render_template
    return template.render(ctx)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 1, in top-level template code
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/context/docs.py", line 68, in doc
    doc_target_not_found(self.node, doc_name, doc_package_name)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/exceptions.py", line 472, in doc_target_not_found
    raise_compiler_error(msg, model)
  File "/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/dbt/exceptions.py", line 392, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model customers_per_nation (models/reports/customers_per_nation.sql)
  Documentation for 'model.sample_project.customers_per_nation' depends on doc 'customers_per_nation'  which was not found

2020-06-30 21:15:03.349990 (MainThread): Running with dbt=0.17.0
2020-06-30 21:15:03.673023 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-06-30 21:15:03.673854 (MainThread): Tracking: tracking
2020-06-30 21:15:03.674109 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062e5f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062fb990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062fb8d0>]}
2020-06-30 21:15:03.695554 (MainThread): Partial parsing not enabled
2020-06-30 21:15:03.697689 (MainThread): Parsing macros/core.sql
2020-06-30 21:15:03.702800 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-30 21:15:03.712028 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-30 21:15:03.713822 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-30 21:15:03.733974 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-30 21:15:03.766865 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-30 21:15:03.790909 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-30 21:15:03.793412 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-30 21:15:03.801271 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-30 21:15:03.816552 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-30 21:15:03.824425 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-30 21:15:03.831671 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-30 21:15:03.836923 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-30 21:15:03.837886 (MainThread): Parsing macros/etc/query.sql
2020-06-30 21:15:03.838977 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-30 21:15:03.840829 (MainThread): Parsing macros/etc/datetime.sql
2020-06-30 21:15:03.851212 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-30 21:15:03.853585 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-30 21:15:03.855297 (MainThread): Parsing macros/adapters/common.sql
2020-06-30 21:15:03.920204 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-30 21:15:03.921510 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-30 21:15:03.922673 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-30 21:15:03.923803 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-30 21:15:03.926224 (MainThread): Parsing macros/catalog.sql
2020-06-30 21:15:03.928191 (MainThread): Parsing macros/adapters.sql
2020-06-30 21:15:03.952911 (MainThread): Parsing macros/materializations/merge.sql
2020-06-30 21:15:03.955378 (MainThread): Parsing macros/materializations/view.sql
2020-06-30 21:15:03.956686 (MainThread): Parsing macros/materializations/table.sql
2020-06-30 21:15:03.960898 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-30 21:15:04.000961 (MainThread): Partial parsing not enabled
2020-06-30 21:15:04.001481 (MainThread): Parsing macros/discounted_price.sql
2020-06-30 21:15:04.002222 (MainThread): Parsing macros/tax_charged.sql
2020-06-30 21:15:04.003058 (MainThread): Parsing macros/full_charge.sql
2020-06-30 21:15:04.004097 (MainThread): Parsing macros/test_is_nonnegative.sql
2020-06-30 21:15:04.006402 (MainThread): Parsing macros/cross_db_utils/except.sql
2020-06-30 21:15:04.007530 (MainThread): Parsing macros/cross_db_utils/replace.sql
2020-06-30 21:15:04.008925 (MainThread): Parsing macros/cross_db_utils/concat.sql
2020-06-30 21:15:04.011585 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2020-06-30 21:15:04.019021 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2020-06-30 21:15:04.020555 (MainThread): Parsing macros/cross_db_utils/length.sql
2020-06-30 21:15:04.022280 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2020-06-30 21:15:04.025010 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2020-06-30 21:15:04.026389 (MainThread): Parsing macros/cross_db_utils/right.sql
2020-06-30 21:15:04.028931 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2020-06-30 21:15:04.039584 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2020-06-30 21:15:04.041695 (MainThread): Parsing macros/cross_db_utils/hash.sql
2020-06-30 21:15:04.043266 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2020-06-30 21:15:04.044845 (MainThread): Parsing macros/cross_db_utils/position.sql
2020-06-30 21:15:04.046568 (MainThread): Parsing macros/cross_db_utils/literal.sql
2020-06-30 21:15:04.047632 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2020-06-30 21:15:04.051324 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2020-06-30 21:15:04.057176 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2020-06-30 21:15:04.060317 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2020-06-30 21:15:04.062283 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2020-06-30 21:15:04.063883 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2020-06-30 21:15:04.091339 (MainThread): Parsing macros/logger/pretty_log_format.sql
2020-06-30 21:15:04.092117 (MainThread): Parsing macros/logger/pretty_time.sql
2020-06-30 21:15:04.092923 (MainThread): Parsing macros/logger/log_info.sql
2020-06-30 21:15:04.093663 (MainThread): Parsing macros/datetime/date_spine.sql
2020-06-30 21:15:04.098055 (MainThread): Parsing macros/web/get_url_host.sql
2020-06-30 21:15:04.099849 (MainThread): Parsing macros/web/get_url_path.sql
2020-06-30 21:15:04.102176 (MainThread): Parsing macros/web/get_url_parameter.sql
2020-06-30 21:15:04.103394 (MainThread): Parsing macros/geo/haversine_distance.sql
2020-06-30 21:15:04.104369 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2020-06-30 21:15:04.106532 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2020-06-30 21:15:04.109130 (MainThread): Parsing macros/schema_tests/recency.sql
2020-06-30 21:15:04.111335 (MainThread): Parsing macros/schema_tests/not_constant.sql
2020-06-30 21:15:04.112549 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2020-06-30 21:15:04.113638 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2020-06-30 21:15:04.114932 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2020-06-30 21:15:04.116543 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2020-06-30 21:15:04.117987 (MainThread): Parsing macros/schema_tests/equality.sql
2020-06-30 21:15:04.121262 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2020-06-30 21:15:04.127588 (MainThread): Parsing macros/sql/nullcheck_table.sql
2020-06-30 21:15:04.128670 (MainThread): Parsing macros/sql/generate_series.sql
2020-06-30 21:15:04.133368 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2020-06-30 21:15:04.137267 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2020-06-30 21:15:04.140069 (MainThread): Parsing macros/sql/star.sql
2020-06-30 21:15:04.143150 (MainThread): Parsing macros/sql/unpivot.sql
2020-06-30 21:15:04.150153 (MainThread): Parsing macros/sql/union.sql
2020-06-30 21:15:04.161073 (MainThread): Parsing macros/sql/groupby.sql
2020-06-30 21:15:04.162057 (MainThread): Parsing macros/sql/surrogate_key.sql
2020-06-30 21:15:04.164899 (MainThread): Parsing macros/sql/safe_add.sql
2020-06-30 21:15:04.166096 (MainThread): Parsing macros/sql/nullcheck.sql
2020-06-30 21:15:04.167491 (MainThread): Parsing macros/sql/get_column_values.sql
2020-06-30 21:15:04.172123 (MainThread): Parsing macros/sql/pivot.sql
2020-06-30 21:15:04.175041 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2020-06-30 21:15:04.224770 (MainThread): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 21:15:04.224888 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:15:04.256017 (MainThread): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 21:15:04.256117 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:15:04.268242 (MainThread): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 21:15:04.268331 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:15:04.280006 (MainThread): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 21:15:04.280093 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:15:04.293307 (MainThread): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 21:15:04.293424 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:15:04.308657 (MainThread): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 21:15:04.308775 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:15:04.322300 (MainThread): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 21:15:04.322397 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:15:04.335270 (MainThread): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 21:15:04.335381 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:15:04.347987 (MainThread): Acquiring new snowflake connection "model.sample_project.sales_report_one".
2020-06-30 21:15:04.348081 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:15:04.364564 (MainThread): Acquiring new snowflake connection "model.sample_project.order_statistics".
2020-06-30 21:15:04.364655 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:15:04.380611 (MainThread): Acquiring new snowflake connection "model.sample_project.sales_report_two".
2020-06-30 21:15:04.380719 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:15:04.868324 (MainThread): Found 11 models, 8 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 4 sources
2020-06-30 21:15:04.869978 (MainThread): 
2020-06-30 21:15:04.870323 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 21:15:04.870409 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:15:04.874130 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_JAVEN_TESTING".
2020-06-30 21:15:04.874354 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-06-30 21:15:04.887512 (ThreadPoolExecutor-0_0): Using snowflake connection "list_JAVEN_TESTING".
2020-06-30 21:15:04.887616 (ThreadPoolExecutor-0_0): On list_JAVEN_TESTING: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING"} */

    show terse schemas in database JAVEN_TESTING
    limit 10000
2020-06-30 21:15:05.361083 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/certifi/cacert.pem'>
2020-06-30 21:15:11.426485 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 6.54 seconds
2020-06-30 21:15:11.454180 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 21:15:11.454333 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_JAVEN_TESTING).
2020-06-30 21:15:11.462291 (ThreadPoolExecutor-1_0): Using snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 21:15:11.462391 (ThreadPoolExecutor-1_0): On list_JAVEN_TESTING_TEST: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING_TEST"} */

    show terse objects in JAVEN_TESTING.TEST
2020-06-30 21:15:11.660964 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 11 in 0.20 seconds
2020-06-30 21:15:11.671965 (MainThread): 16:15:11 | Concurrency: 1 threads (target='dev')
2020-06-30 21:15:11.672121 (MainThread): 16:15:11 | 
2020-06-30 21:15:11.672991 (Thread-1): Began running node model.sample_project.lineitem
2020-06-30 21:15:11.673272 (Thread-1): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 21:15:11.673381 (Thread-1): Re-using an available connection from the pool (formerly list_JAVEN_TESTING_TEST).
2020-06-30 21:15:11.673486 (Thread-1): Compiling model.sample_project.lineitem
2020-06-30 21:15:11.689636 (Thread-1): Writing injected SQL for node "model.sample_project.lineitem"
2020-06-30 21:15:11.689969 (Thread-1): finished collecting timing info
2020-06-30 21:15:11.690387 (Thread-1): Finished running node model.sample_project.lineitem
2020-06-30 21:15:11.690577 (Thread-1): Began running node model.sample_project.orders
2020-06-30 21:15:11.691104 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 21:15:11.691304 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.lineitem).
2020-06-30 21:15:11.691397 (Thread-1): Compiling model.sample_project.orders
2020-06-30 21:15:11.699556 (Thread-1): Writing injected SQL for node "model.sample_project.orders"
2020-06-30 21:15:11.699900 (Thread-1): finished collecting timing info
2020-06-30 21:15:11.700460 (Thread-1): Finished running node model.sample_project.orders
2020-06-30 21:15:11.700738 (Thread-1): Began running node model.sample_project.customer
2020-06-30 21:15:11.701127 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 21:15:11.701295 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders).
2020-06-30 21:15:11.701390 (Thread-1): Compiling model.sample_project.customer
2020-06-30 21:15:11.709229 (Thread-1): Writing injected SQL for node "model.sample_project.customer"
2020-06-30 21:15:11.709535 (Thread-1): finished collecting timing info
2020-06-30 21:15:11.709982 (Thread-1): Finished running node model.sample_project.customer
2020-06-30 21:15:11.710098 (Thread-1): Began running node model.sample_project.nation
2020-06-30 21:15:11.710490 (Thread-1): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 21:15:11.710681 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer).
2020-06-30 21:15:11.710761 (Thread-1): Compiling model.sample_project.nation
2020-06-30 21:15:11.717602 (Thread-1): Writing injected SQL for node "model.sample_project.nation"
2020-06-30 21:15:11.718043 (Thread-1): finished collecting timing info
2020-06-30 21:15:11.718429 (Thread-1): Finished running node model.sample_project.nation
2020-06-30 21:15:11.718544 (Thread-1): Began running node test.sample_project.source_is_nonnegative_tpch_customer_c_custkey
2020-06-30 21:15:11.718927 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_nonnegative_tpch_customer_c_custkey".
2020-06-30 21:15:11.719083 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.nation).
2020-06-30 21:15:11.719187 (Thread-1): Compiling test.sample_project.source_is_nonnegative_tpch_customer_c_custkey
2020-06-30 21:15:11.733294 (Thread-1): Writing injected SQL for node "test.sample_project.source_is_nonnegative_tpch_customer_c_custkey"
2020-06-30 21:15:11.733586 (Thread-1): finished collecting timing info
2020-06-30 21:15:11.733891 (Thread-1): finished collecting timing info
2020-06-30 21:15:11.734192 (Thread-1): Finished running node test.sample_project.source_is_nonnegative_tpch_customer_c_custkey
2020-06-30 21:15:11.734304 (Thread-1): Began running node test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey
2020-06-30 21:15:11.734566 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey".
2020-06-30 21:15:11.734646 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_nonnegative_tpch_customer_c_custkey).
2020-06-30 21:15:11.734719 (Thread-1): Compiling test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey
2020-06-30 21:15:11.742302 (Thread-1): Writing injected SQL for node "test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey"
2020-06-30 21:15:11.742566 (Thread-1): finished collecting timing info
2020-06-30 21:15:11.742765 (Thread-1): finished collecting timing info
2020-06-30 21:15:11.743065 (Thread-1): Finished running node test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey
2020-06-30 21:15:11.743175 (Thread-1): Began running node test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice
2020-06-30 21:15:11.743437 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice".
2020-06-30 21:15:11.743526 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey).
2020-06-30 21:15:11.743604 (Thread-1): Compiling test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice
2020-06-30 21:15:11.751907 (Thread-1): Writing injected SQL for node "test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice"
2020-06-30 21:15:11.752171 (Thread-1): finished collecting timing info
2020-06-30 21:15:11.752371 (Thread-1): finished collecting timing info
2020-06-30 21:15:11.752845 (Thread-1): Finished running node test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice
2020-06-30 21:15:11.752956 (Thread-1): Began running node test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey
2020-06-30 21:15:11.753218 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey".
2020-06-30 21:15:11.753310 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice).
2020-06-30 21:15:11.753389 (Thread-1): Compiling test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey
2020-06-30 21:15:11.761335 (Thread-1): Writing injected SQL for node "test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey"
2020-06-30 21:15:11.761602 (Thread-1): finished collecting timing info
2020-06-30 21:15:11.761810 (Thread-1): finished collecting timing info
2020-06-30 21:15:11.762113 (Thread-1): Finished running node test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey
2020-06-30 21:15:11.762225 (Thread-1): Began running node test.sample_project.source_is_nonnegative_tpch_orders_o_custkey
2020-06-30 21:15:11.762489 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_nonnegative_tpch_orders_o_custkey".
2020-06-30 21:15:11.762582 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey).
2020-06-30 21:15:11.762662 (Thread-1): Compiling test.sample_project.source_is_nonnegative_tpch_orders_o_custkey
2020-06-30 21:15:11.771333 (Thread-1): Writing injected SQL for node "test.sample_project.source_is_nonnegative_tpch_orders_o_custkey"
2020-06-30 21:15:11.771596 (Thread-1): finished collecting timing info
2020-06-30 21:15:11.771798 (Thread-1): finished collecting timing info
2020-06-30 21:15:11.772099 (Thread-1): Finished running node test.sample_project.source_is_nonnegative_tpch_orders_o_custkey
2020-06-30 21:15:11.772210 (Thread-1): Began running node test.sample_project.source_unique_tpch_customer_c_custkey
2020-06-30 21:15:11.772484 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_unique_tpch_customer_c_custkey".
2020-06-30 21:15:11.772572 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_nonnegative_tpch_orders_o_custkey).
2020-06-30 21:15:11.772649 (Thread-1): Compiling test.sample_project.source_unique_tpch_customer_c_custkey
2020-06-30 21:15:11.780727 (Thread-1): Writing injected SQL for node "test.sample_project.source_unique_tpch_customer_c_custkey"
2020-06-30 21:15:11.781064 (Thread-1): finished collecting timing info
2020-06-30 21:15:11.781271 (Thread-1): finished collecting timing info
2020-06-30 21:15:11.781573 (Thread-1): Finished running node test.sample_project.source_unique_tpch_customer_c_custkey
2020-06-30 21:15:11.781683 (Thread-1): Began running node test.sample_project.source_unique_tpch_nation_n_nationkey
2020-06-30 21:15:11.781932 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_unique_tpch_nation_n_nationkey".
2020-06-30 21:15:11.782011 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_unique_tpch_customer_c_custkey).
2020-06-30 21:15:11.782083 (Thread-1): Compiling test.sample_project.source_unique_tpch_nation_n_nationkey
2020-06-30 21:15:11.790812 (Thread-1): Writing injected SQL for node "test.sample_project.source_unique_tpch_nation_n_nationkey"
2020-06-30 21:15:11.791078 (Thread-1): finished collecting timing info
2020-06-30 21:15:11.791391 (Thread-1): finished collecting timing info
2020-06-30 21:15:11.791694 (Thread-1): Finished running node test.sample_project.source_unique_tpch_nation_n_nationkey
2020-06-30 21:15:11.791808 (Thread-1): Began running node test.sample_project.source_unique_tpch_orders_o_orderkey
2020-06-30 21:15:11.792071 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_unique_tpch_orders_o_orderkey".
2020-06-30 21:15:11.792161 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_unique_tpch_nation_n_nationkey).
2020-06-30 21:15:11.792237 (Thread-1): Compiling test.sample_project.source_unique_tpch_orders_o_orderkey
2020-06-30 21:15:11.800726 (Thread-1): Writing injected SQL for node "test.sample_project.source_unique_tpch_orders_o_orderkey"
2020-06-30 21:15:11.801001 (Thread-1): finished collecting timing info
2020-06-30 21:15:11.801297 (Thread-1): finished collecting timing info
2020-06-30 21:15:11.801655 (Thread-1): Finished running node test.sample_project.source_unique_tpch_orders_o_orderkey
2020-06-30 21:15:11.801766 (Thread-1): Began running node model.sample_project.orders_lineitem
2020-06-30 21:15:11.802032 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 21:15:11.802126 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_unique_tpch_orders_o_orderkey).
2020-06-30 21:15:11.802206 (Thread-1): Compiling model.sample_project.orders_lineitem
2020-06-30 21:15:11.814039 (Thread-1): Writing injected SQL for node "model.sample_project.orders_lineitem"
2020-06-30 21:15:11.814502 (Thread-1): finished collecting timing info
2020-06-30 21:15:11.814832 (Thread-1): Finished running node model.sample_project.orders_lineitem
2020-06-30 21:15:11.814947 (Thread-1): Began running node model.sample_project.customer_nation
2020-06-30 21:15:11.815242 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 21:15:11.815396 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders_lineitem).
2020-06-30 21:15:11.815485 (Thread-1): Compiling model.sample_project.customer_nation
2020-06-30 21:15:11.825921 (Thread-1): Writing injected SQL for node "model.sample_project.customer_nation"
2020-06-30 21:15:11.826198 (Thread-1): finished collecting timing info
2020-06-30 21:15:11.826719 (Thread-1): Finished running node model.sample_project.customer_nation
2020-06-30 21:15:11.826836 (Thread-1): Began running node model.sample_project.order_statistics
2020-06-30 21:15:11.827115 (Thread-1): Acquiring new snowflake connection "model.sample_project.order_statistics".
2020-06-30 21:15:11.827291 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer_nation).
2020-06-30 21:15:11.827413 (Thread-1): Compiling model.sample_project.order_statistics
2020-06-30 21:15:11.840101 (Thread-1): Writing injected SQL for node "model.sample_project.order_statistics"
2020-06-30 21:15:11.840413 (Thread-1): finished collecting timing info
2020-06-30 21:15:11.840615 (Thread-1): finished collecting timing info
2020-06-30 21:15:11.840919 (Thread-1): Finished running node model.sample_project.order_statistics
2020-06-30 21:15:11.841031 (Thread-1): Began running node model.sample_project.cust_list_ord_nat
2020-06-30 21:15:11.841532 (Thread-1): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 21:15:11.841658 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.order_statistics).
2020-06-30 21:15:11.841737 (Thread-1): Compiling model.sample_project.cust_list_ord_nat
2020-06-30 21:15:11.854340 (Thread-1): Writing injected SQL for node "model.sample_project.cust_list_ord_nat"
2020-06-30 21:15:11.855344 (Thread-1): finished collecting timing info
2020-06-30 21:15:11.855722 (Thread-1): Finished running node model.sample_project.cust_list_ord_nat
2020-06-30 21:15:11.855863 (Thread-1): Began running node model.sample_project.customers_per_nation
2020-06-30 21:15:11.856464 (Thread-1): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 21:15:11.856601 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.cust_list_ord_nat).
2020-06-30 21:15:11.856817 (Thread-1): Compiling model.sample_project.customers_per_nation
2020-06-30 21:15:11.865375 (Thread-1): Writing injected SQL for node "model.sample_project.customers_per_nation"
2020-06-30 21:15:11.865657 (Thread-1): finished collecting timing info
2020-06-30 21:15:11.866155 (Thread-1): Finished running node model.sample_project.customers_per_nation
2020-06-30 21:15:11.866299 (Thread-1): Began running node model.sample_project.sales_report_one
2020-06-30 21:15:11.866522 (Thread-1): Acquiring new snowflake connection "model.sample_project.sales_report_one".
2020-06-30 21:15:11.866652 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customers_per_nation).
2020-06-30 21:15:11.866748 (Thread-1): Compiling model.sample_project.sales_report_one
2020-06-30 21:15:11.879122 (Thread-1): Writing injected SQL for node "model.sample_project.sales_report_one"
2020-06-30 21:15:11.879773 (Thread-1): finished collecting timing info
2020-06-30 21:15:11.880028 (Thread-1): finished collecting timing info
2020-06-30 21:15:11.880403 (Thread-1): Finished running node model.sample_project.sales_report_one
2020-06-30 21:15:11.880542 (Thread-1): Began running node model.sample_project.sales_report_two
2020-06-30 21:15:11.880980 (Thread-1): Acquiring new snowflake connection "model.sample_project.sales_report_two".
2020-06-30 21:15:11.881116 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.sales_report_one).
2020-06-30 21:15:11.881259 (Thread-1): Compiling model.sample_project.sales_report_two
2020-06-30 21:15:11.895713 (Thread-1): Writing injected SQL for node "model.sample_project.sales_report_two"
2020-06-30 21:15:11.896187 (Thread-1): finished collecting timing info
2020-06-30 21:15:11.896497 (Thread-1): finished collecting timing info
2020-06-30 21:15:11.896897 (Thread-1): Finished running node model.sample_project.sales_report_two
2020-06-30 21:15:11.994374 (MainThread): Connection 'master' was properly closed.
2020-06-30 21:15:11.994524 (MainThread): Connection 'model.sample_project.sales_report_two' was left open.
2020-06-30 21:15:11.994608 (MainThread): On model.sample_project.sales_report_two: Close
2020-06-30 21:15:12.338917 (MainThread): 16:15:12 | Done.
2020-06-30 21:15:12.340467 (MainThread): Acquiring new snowflake connection "generate_catalog".
2020-06-30 21:15:12.340559 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:15:12.340640 (MainThread): 16:15:12 | Building catalog
2020-06-30 21:15:12.417101 (ThreadPoolExecutor-2_0): Acquiring new snowflake connection "JAVEN_TESTING.information_schema".
2020-06-30 21:15:12.417241 (ThreadPoolExecutor-2_0): Opening a new connection, currently in state init
2020-06-30 21:15:12.425417 (ThreadPoolExecutor-2_0): Using snowflake connection "JAVEN_TESTING.information_schema".
2020-06-30 21:15:12.425538 (ThreadPoolExecutor-2_0): On JAVEN_TESTING.information_schema: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "JAVEN_TESTING.information_schema"} */

    
      with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include"

          from JAVEN_TESTING.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              null as "table_comment",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              null as "column_comment"

          from JAVEN_TESTING.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('test'))
      order by "column_index"
2020-06-30 21:15:20.734086 (ThreadPoolExecutor-2_0): SQL status: SUCCESS 88 in 8.31 seconds
2020-06-30 21:15:20.756403 (ThreadPoolExecutor-2_0): Acquiring new snowflake connection "snowflake_sample_data.information_schema".
2020-06-30 21:15:20.756679 (ThreadPoolExecutor-2_0): Re-using an available connection from the pool (formerly JAVEN_TESTING.information_schema).
2020-06-30 21:15:20.762147 (ThreadPoolExecutor-2_0): Using snowflake connection "snowflake_sample_data.information_schema".
2020-06-30 21:15:20.762369 (ThreadPoolExecutor-2_0): On snowflake_sample_data.information_schema: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "snowflake_sample_data.information_schema"} */

    
      with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include"

          from snowflake_sample_data.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              null as "table_comment",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              null as "column_comment"

          from snowflake_sample_data.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('tpch_sf1'))
      order by "column_index"
2020-06-30 21:15:23.943147 (ThreadPoolExecutor-2_0): SQL status: SUCCESS 61 in 3.18 seconds
2020-06-30 21:15:24.115364 (MainThread): 16:15:24 | Catalog written to /Users/johnaven/Documents/gitlab_projects/dbt-demo-June-2020/sample_project/target/catalog.json
2020-06-30 21:15:24.115867 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092775d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109172490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109310090>]}
2020-06-30 21:15:24.116308 (MainThread): Flushing usage events
2020-06-30 21:15:24.460740 (MainThread): Connection 'generate_catalog' was properly closed.
2020-06-30 21:15:24.460882 (MainThread): Connection 'snowflake_sample_data.information_schema' was left open.
2020-06-30 21:15:24.460997 (MainThread): On snowflake_sample_data.information_schema: Close
2020-06-30 21:15:25.667996 (MainThread): Running with dbt=0.17.0
2020-06-30 21:15:25.984238 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', open_browser=True, partial_parse=None, port=8080, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-06-30 21:15:25.985106 (MainThread): Tracking: tracking
2020-06-30 21:15:25.985402 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa49350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa65ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa65a10>]}
2020-06-30 21:15:25.987282 (MainThread): Serving docs at 0.0.0.0:8080
2020-06-30 21:15:25.987404 (MainThread): To access from your browser, navigate to:  http://localhost:8080
2020-06-30 21:15:25.987493 (MainThread): Press Ctrl+C to exit.


2020-06-30 21:17:49.282283 (MainThread): Flushing usage events
2020-06-30 21:17:49.802000 (MainThread): ctrl-c
2020-06-30 21:17:50.706133 (MainThread): Running with dbt=0.17.0
2020-06-30 21:17:51.065855 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-06-30 21:17:51.067004 (MainThread): Tracking: tracking
2020-06-30 21:17:51.067368 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f649ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f649a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f649f50>]}
2020-06-30 21:17:51.087772 (MainThread): Partial parsing not enabled
2020-06-30 21:17:51.090544 (MainThread): Parsing macros/core.sql
2020-06-30 21:17:51.095429 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-30 21:17:51.104209 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-30 21:17:51.106068 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-30 21:17:51.126098 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-30 21:17:51.159277 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-30 21:17:51.182635 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-30 21:17:51.185123 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-30 21:17:51.192996 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-30 21:17:51.208617 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-30 21:17:51.216959 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-30 21:17:51.225038 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-30 21:17:51.230396 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-30 21:17:51.231591 (MainThread): Parsing macros/etc/query.sql
2020-06-30 21:17:51.232777 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-30 21:17:51.234613 (MainThread): Parsing macros/etc/datetime.sql
2020-06-30 21:17:51.244579 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-30 21:17:51.246643 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-30 21:17:51.248401 (MainThread): Parsing macros/adapters/common.sql
2020-06-30 21:17:51.304757 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-30 21:17:51.307327 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-30 21:17:51.309216 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-30 21:17:51.311746 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-30 21:17:51.315841 (MainThread): Parsing macros/catalog.sql
2020-06-30 21:17:51.317812 (MainThread): Parsing macros/adapters.sql
2020-06-30 21:17:51.341045 (MainThread): Parsing macros/materializations/merge.sql
2020-06-30 21:17:51.343311 (MainThread): Parsing macros/materializations/view.sql
2020-06-30 21:17:51.344553 (MainThread): Parsing macros/materializations/table.sql
2020-06-30 21:17:51.348747 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-30 21:17:51.389517 (MainThread): Partial parsing not enabled
2020-06-30 21:17:51.389970 (MainThread): Parsing macros/discounted_price.sql
2020-06-30 21:17:51.390765 (MainThread): Parsing macros/tax_charged.sql
2020-06-30 21:17:51.391628 (MainThread): Parsing macros/full_charge.sql
2020-06-30 21:17:51.392517 (MainThread): Parsing macros/test_is_nonnegative.sql
2020-06-30 21:17:51.394818 (MainThread): Parsing macros/cross_db_utils/except.sql
2020-06-30 21:17:51.395926 (MainThread): Parsing macros/cross_db_utils/replace.sql
2020-06-30 21:17:51.397280 (MainThread): Parsing macros/cross_db_utils/concat.sql
2020-06-30 21:17:51.400025 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2020-06-30 21:17:51.406225 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2020-06-30 21:17:51.407586 (MainThread): Parsing macros/cross_db_utils/length.sql
2020-06-30 21:17:51.409091 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2020-06-30 21:17:51.411812 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2020-06-30 21:17:51.413157 (MainThread): Parsing macros/cross_db_utils/right.sql
2020-06-30 21:17:51.415833 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2020-06-30 21:17:51.427194 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2020-06-30 21:17:51.430105 (MainThread): Parsing macros/cross_db_utils/hash.sql
2020-06-30 21:17:51.431906 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2020-06-30 21:17:51.433522 (MainThread): Parsing macros/cross_db_utils/position.sql
2020-06-30 21:17:51.435267 (MainThread): Parsing macros/cross_db_utils/literal.sql
2020-06-30 21:17:51.436286 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2020-06-30 21:17:51.439856 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2020-06-30 21:17:51.445990 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2020-06-30 21:17:51.449025 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2020-06-30 21:17:51.451149 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2020-06-30 21:17:51.452818 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2020-06-30 21:17:51.479551 (MainThread): Parsing macros/logger/pretty_log_format.sql
2020-06-30 21:17:51.480292 (MainThread): Parsing macros/logger/pretty_time.sql
2020-06-30 21:17:51.481138 (MainThread): Parsing macros/logger/log_info.sql
2020-06-30 21:17:51.481876 (MainThread): Parsing macros/datetime/date_spine.sql
2020-06-30 21:17:51.485400 (MainThread): Parsing macros/web/get_url_host.sql
2020-06-30 21:17:51.486849 (MainThread): Parsing macros/web/get_url_path.sql
2020-06-30 21:17:51.489464 (MainThread): Parsing macros/web/get_url_parameter.sql
2020-06-30 21:17:51.490925 (MainThread): Parsing macros/geo/haversine_distance.sql
2020-06-30 21:17:51.491901 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2020-06-30 21:17:51.493301 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2020-06-30 21:17:51.495643 (MainThread): Parsing macros/schema_tests/recency.sql
2020-06-30 21:17:51.496960 (MainThread): Parsing macros/schema_tests/not_constant.sql
2020-06-30 21:17:51.498041 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2020-06-30 21:17:51.499355 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2020-06-30 21:17:51.500633 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2020-06-30 21:17:51.502179 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2020-06-30 21:17:51.503352 (MainThread): Parsing macros/schema_tests/equality.sql
2020-06-30 21:17:51.506630 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2020-06-30 21:17:51.512466 (MainThread): Parsing macros/sql/nullcheck_table.sql
2020-06-30 21:17:51.513769 (MainThread): Parsing macros/sql/generate_series.sql
2020-06-30 21:17:51.518454 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2020-06-30 21:17:51.522273 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2020-06-30 21:17:51.525065 (MainThread): Parsing macros/sql/star.sql
2020-06-30 21:17:51.528246 (MainThread): Parsing macros/sql/unpivot.sql
2020-06-30 21:17:51.534543 (MainThread): Parsing macros/sql/union.sql
2020-06-30 21:17:51.544895 (MainThread): Parsing macros/sql/groupby.sql
2020-06-30 21:17:51.546017 (MainThread): Parsing macros/sql/surrogate_key.sql
2020-06-30 21:17:51.549066 (MainThread): Parsing macros/sql/safe_add.sql
2020-06-30 21:17:51.550158 (MainThread): Parsing macros/sql/nullcheck.sql
2020-06-30 21:17:51.551447 (MainThread): Parsing macros/sql/get_column_values.sql
2020-06-30 21:17:51.556361 (MainThread): Parsing macros/sql/pivot.sql
2020-06-30 21:17:51.560922 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2020-06-30 21:17:51.614986 (MainThread): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 21:17:51.615111 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:17:51.646285 (MainThread): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 21:17:51.646382 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:17:51.657971 (MainThread): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 21:17:51.658067 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:17:51.670023 (MainThread): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 21:17:51.670114 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:17:51.682306 (MainThread): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 21:17:51.682403 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:17:51.697290 (MainThread): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 21:17:51.697396 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:17:51.714016 (MainThread): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 21:17:51.714163 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:17:51.729739 (MainThread): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 21:17:51.729851 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:17:51.742605 (MainThread): Acquiring new snowflake connection "model.sample_project.sales_report_one".
2020-06-30 21:17:51.742714 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:17:51.760017 (MainThread): Acquiring new snowflake connection "model.sample_project.order_statistics".
2020-06-30 21:17:51.760123 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:17:51.775516 (MainThread): Acquiring new snowflake connection "model.sample_project.sales_report_two".
2020-06-30 21:17:51.775614 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:17:52.251045 (MainThread): Found 11 models, 8 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 4 sources
2020-06-30 21:17:52.252998 (MainThread): 
2020-06-30 21:17:52.253280 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 21:17:52.253366 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:17:52.258023 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_JAVEN_TESTING".
2020-06-30 21:17:52.258438 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-06-30 21:17:52.274603 (ThreadPoolExecutor-0_0): Using snowflake connection "list_JAVEN_TESTING".
2020-06-30 21:17:52.274740 (ThreadPoolExecutor-0_0): On list_JAVEN_TESTING: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING"} */

    show terse schemas in database JAVEN_TESTING
    limit 10000
2020-06-30 21:17:52.776053 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/certifi/cacert.pem'>
2020-06-30 21:18:00.095260 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 7.82 seconds
2020-06-30 21:18:00.123755 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 21:18:00.123998 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_JAVEN_TESTING).
2020-06-30 21:18:00.131581 (ThreadPoolExecutor-1_0): Using snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 21:18:00.131693 (ThreadPoolExecutor-1_0): On list_JAVEN_TESTING_TEST: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING_TEST"} */

    show terse objects in JAVEN_TESTING.TEST
2020-06-30 21:18:00.457003 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 11 in 0.33 seconds
2020-06-30 21:18:00.467552 (MainThread): 16:18:00 | Concurrency: 1 threads (target='dev')
2020-06-30 21:18:00.467700 (MainThread): 16:18:00 | 
2020-06-30 21:18:00.468471 (Thread-1): Began running node model.sample_project.lineitem
2020-06-30 21:18:00.468755 (Thread-1): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 21:18:00.468852 (Thread-1): Re-using an available connection from the pool (formerly list_JAVEN_TESTING_TEST).
2020-06-30 21:18:00.468945 (Thread-1): Compiling model.sample_project.lineitem
2020-06-30 21:18:00.483549 (Thread-1): Writing injected SQL for node "model.sample_project.lineitem"
2020-06-30 21:18:00.484738 (Thread-1): finished collecting timing info
2020-06-30 21:18:00.485090 (Thread-1): Finished running node model.sample_project.lineitem
2020-06-30 21:18:00.485207 (Thread-1): Began running node model.sample_project.orders
2020-06-30 21:18:00.485630 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 21:18:00.485749 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.lineitem).
2020-06-30 21:18:00.485826 (Thread-1): Compiling model.sample_project.orders
2020-06-30 21:18:00.493714 (Thread-1): Writing injected SQL for node "model.sample_project.orders"
2020-06-30 21:18:00.494374 (Thread-1): finished collecting timing info
2020-06-30 21:18:00.494856 (Thread-1): Finished running node model.sample_project.orders
2020-06-30 21:18:00.494976 (Thread-1): Began running node model.sample_project.customer
2020-06-30 21:18:00.495400 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 21:18:00.495550 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders).
2020-06-30 21:18:00.495636 (Thread-1): Compiling model.sample_project.customer
2020-06-30 21:18:00.502848 (Thread-1): Writing injected SQL for node "model.sample_project.customer"
2020-06-30 21:18:00.503572 (Thread-1): finished collecting timing info
2020-06-30 21:18:00.503907 (Thread-1): Finished running node model.sample_project.customer
2020-06-30 21:18:00.504025 (Thread-1): Began running node model.sample_project.nation
2020-06-30 21:18:00.504295 (Thread-1): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 21:18:00.504386 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer).
2020-06-30 21:18:00.504503 (Thread-1): Compiling model.sample_project.nation
2020-06-30 21:18:00.511647 (Thread-1): Writing injected SQL for node "model.sample_project.nation"
2020-06-30 21:18:00.511924 (Thread-1): finished collecting timing info
2020-06-30 21:18:00.512246 (Thread-1): Finished running node model.sample_project.nation
2020-06-30 21:18:00.512361 (Thread-1): Began running node test.sample_project.source_is_nonnegative_tpch_customer_c_custkey
2020-06-30 21:18:00.512642 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_nonnegative_tpch_customer_c_custkey".
2020-06-30 21:18:00.512814 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.nation).
2020-06-30 21:18:00.512907 (Thread-1): Compiling test.sample_project.source_is_nonnegative_tpch_customer_c_custkey
2020-06-30 21:18:00.526815 (Thread-1): Writing injected SQL for node "test.sample_project.source_is_nonnegative_tpch_customer_c_custkey"
2020-06-30 21:18:00.527105 (Thread-1): finished collecting timing info
2020-06-30 21:18:00.527310 (Thread-1): finished collecting timing info
2020-06-30 21:18:00.527615 (Thread-1): Finished running node test.sample_project.source_is_nonnegative_tpch_customer_c_custkey
2020-06-30 21:18:00.527731 (Thread-1): Began running node test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey
2020-06-30 21:18:00.528002 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey".
2020-06-30 21:18:00.528094 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_nonnegative_tpch_customer_c_custkey).
2020-06-30 21:18:00.528175 (Thread-1): Compiling test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey
2020-06-30 21:18:00.536834 (Thread-1): Writing injected SQL for node "test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey"
2020-06-30 21:18:00.537110 (Thread-1): finished collecting timing info
2020-06-30 21:18:00.537314 (Thread-1): finished collecting timing info
2020-06-30 21:18:00.537621 (Thread-1): Finished running node test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey
2020-06-30 21:18:00.537736 (Thread-1): Began running node test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice
2020-06-30 21:18:00.538114 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice".
2020-06-30 21:18:00.538207 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey).
2020-06-30 21:18:00.538287 (Thread-1): Compiling test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice
2020-06-30 21:18:00.546702 (Thread-1): Writing injected SQL for node "test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice"
2020-06-30 21:18:00.547135 (Thread-1): finished collecting timing info
2020-06-30 21:18:00.547516 (Thread-1): finished collecting timing info
2020-06-30 21:18:00.547821 (Thread-1): Finished running node test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice
2020-06-30 21:18:00.547939 (Thread-1): Began running node test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey
2020-06-30 21:18:00.548147 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey".
2020-06-30 21:18:00.548413 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice).
2020-06-30 21:18:00.548617 (Thread-1): Compiling test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey
2020-06-30 21:18:00.558539 (Thread-1): Writing injected SQL for node "test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey"
2020-06-30 21:18:00.558866 (Thread-1): finished collecting timing info
2020-06-30 21:18:00.559109 (Thread-1): finished collecting timing info
2020-06-30 21:18:00.559474 (Thread-1): Finished running node test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey
2020-06-30 21:18:00.559610 (Thread-1): Began running node test.sample_project.source_is_nonnegative_tpch_orders_o_custkey
2020-06-30 21:18:00.559918 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_nonnegative_tpch_orders_o_custkey".
2020-06-30 21:18:00.560024 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey).
2020-06-30 21:18:00.560116 (Thread-1): Compiling test.sample_project.source_is_nonnegative_tpch_orders_o_custkey
2020-06-30 21:18:00.568346 (Thread-1): Writing injected SQL for node "test.sample_project.source_is_nonnegative_tpch_orders_o_custkey"
2020-06-30 21:18:00.568614 (Thread-1): finished collecting timing info
2020-06-30 21:18:00.569023 (Thread-1): finished collecting timing info
2020-06-30 21:18:00.569616 (Thread-1): Finished running node test.sample_project.source_is_nonnegative_tpch_orders_o_custkey
2020-06-30 21:18:00.569834 (Thread-1): Began running node test.sample_project.source_unique_tpch_customer_c_custkey
2020-06-30 21:18:00.570335 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_unique_tpch_customer_c_custkey".
2020-06-30 21:18:00.570536 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_nonnegative_tpch_orders_o_custkey).
2020-06-30 21:18:00.570705 (Thread-1): Compiling test.sample_project.source_unique_tpch_customer_c_custkey
2020-06-30 21:18:00.580547 (Thread-1): Writing injected SQL for node "test.sample_project.source_unique_tpch_customer_c_custkey"
2020-06-30 21:18:00.581123 (Thread-1): finished collecting timing info
2020-06-30 21:18:00.581408 (Thread-1): finished collecting timing info
2020-06-30 21:18:00.581712 (Thread-1): Finished running node test.sample_project.source_unique_tpch_customer_c_custkey
2020-06-30 21:18:00.581827 (Thread-1): Began running node test.sample_project.source_unique_tpch_nation_n_nationkey
2020-06-30 21:18:00.582192 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_unique_tpch_nation_n_nationkey".
2020-06-30 21:18:00.582284 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_unique_tpch_customer_c_custkey).
2020-06-30 21:18:00.582364 (Thread-1): Compiling test.sample_project.source_unique_tpch_nation_n_nationkey
2020-06-30 21:18:00.591343 (Thread-1): Writing injected SQL for node "test.sample_project.source_unique_tpch_nation_n_nationkey"
2020-06-30 21:18:00.591660 (Thread-1): finished collecting timing info
2020-06-30 21:18:00.591946 (Thread-1): finished collecting timing info
2020-06-30 21:18:00.592251 (Thread-1): Finished running node test.sample_project.source_unique_tpch_nation_n_nationkey
2020-06-30 21:18:00.592366 (Thread-1): Began running node test.sample_project.source_unique_tpch_orders_o_orderkey
2020-06-30 21:18:00.592633 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_unique_tpch_orders_o_orderkey".
2020-06-30 21:18:00.592727 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_unique_tpch_nation_n_nationkey).
2020-06-30 21:18:00.592808 (Thread-1): Compiling test.sample_project.source_unique_tpch_orders_o_orderkey
2020-06-30 21:18:00.602361 (Thread-1): Writing injected SQL for node "test.sample_project.source_unique_tpch_orders_o_orderkey"
2020-06-30 21:18:00.602656 (Thread-1): finished collecting timing info
2020-06-30 21:18:00.602865 (Thread-1): finished collecting timing info
2020-06-30 21:18:00.603171 (Thread-1): Finished running node test.sample_project.source_unique_tpch_orders_o_orderkey
2020-06-30 21:18:00.603287 (Thread-1): Began running node model.sample_project.orders_lineitem
2020-06-30 21:18:00.603497 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 21:18:00.603585 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_unique_tpch_orders_o_orderkey).
2020-06-30 21:18:00.603725 (Thread-1): Compiling model.sample_project.orders_lineitem
2020-06-30 21:18:00.615523 (Thread-1): Writing injected SQL for node "model.sample_project.orders_lineitem"
2020-06-30 21:18:00.616011 (Thread-1): finished collecting timing info
2020-06-30 21:18:00.616378 (Thread-1): Finished running node model.sample_project.orders_lineitem
2020-06-30 21:18:00.616492 (Thread-1): Began running node model.sample_project.customer_nation
2020-06-30 21:18:00.616699 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 21:18:00.616844 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders_lineitem).
2020-06-30 21:18:00.617000 (Thread-1): Compiling model.sample_project.customer_nation
2020-06-30 21:18:00.627281 (Thread-1): Writing injected SQL for node "model.sample_project.customer_nation"
2020-06-30 21:18:00.627564 (Thread-1): finished collecting timing info
2020-06-30 21:18:00.627897 (Thread-1): Finished running node model.sample_project.customer_nation
2020-06-30 21:18:00.628014 (Thread-1): Began running node model.sample_project.order_statistics
2020-06-30 21:18:00.628313 (Thread-1): Acquiring new snowflake connection "model.sample_project.order_statistics".
2020-06-30 21:18:00.628728 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer_nation).
2020-06-30 21:18:00.628932 (Thread-1): Compiling model.sample_project.order_statistics
2020-06-30 21:18:00.642221 (Thread-1): Writing injected SQL for node "model.sample_project.order_statistics"
2020-06-30 21:18:00.642504 (Thread-1): finished collecting timing info
2020-06-30 21:18:00.642710 (Thread-1): finished collecting timing info
2020-06-30 21:18:00.643020 (Thread-1): Finished running node model.sample_project.order_statistics
2020-06-30 21:18:00.643137 (Thread-1): Began running node model.sample_project.cust_list_ord_nat
2020-06-30 21:18:00.643443 (Thread-1): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 21:18:00.643534 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.order_statistics).
2020-06-30 21:18:00.643613 (Thread-1): Compiling model.sample_project.cust_list_ord_nat
2020-06-30 21:18:00.655756 (Thread-1): Writing injected SQL for node "model.sample_project.cust_list_ord_nat"
2020-06-30 21:18:00.656736 (Thread-1): finished collecting timing info
2020-06-30 21:18:00.657251 (Thread-1): Finished running node model.sample_project.cust_list_ord_nat
2020-06-30 21:18:00.657367 (Thread-1): Began running node model.sample_project.customers_per_nation
2020-06-30 21:18:00.657722 (Thread-1): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 21:18:00.657817 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.cust_list_ord_nat).
2020-06-30 21:18:00.658169 (Thread-1): Compiling model.sample_project.customers_per_nation
2020-06-30 21:18:00.666723 (Thread-1): Writing injected SQL for node "model.sample_project.customers_per_nation"
2020-06-30 21:18:00.667316 (Thread-1): finished collecting timing info
2020-06-30 21:18:00.667633 (Thread-1): Finished running node model.sample_project.customers_per_nation
2020-06-30 21:18:00.667746 (Thread-1): Began running node model.sample_project.sales_report_one
2020-06-30 21:18:00.668010 (Thread-1): Acquiring new snowflake connection "model.sample_project.sales_report_one".
2020-06-30 21:18:00.668104 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customers_per_nation).
2020-06-30 21:18:00.668184 (Thread-1): Compiling model.sample_project.sales_report_one
2020-06-30 21:18:00.680710 (Thread-1): Writing injected SQL for node "model.sample_project.sales_report_one"
2020-06-30 21:18:00.681025 (Thread-1): finished collecting timing info
2020-06-30 21:18:00.681250 (Thread-1): finished collecting timing info
2020-06-30 21:18:00.681576 (Thread-1): Finished running node model.sample_project.sales_report_one
2020-06-30 21:18:00.681697 (Thread-1): Began running node model.sample_project.sales_report_two
2020-06-30 21:18:00.682092 (Thread-1): Acquiring new snowflake connection "model.sample_project.sales_report_two".
2020-06-30 21:18:00.682215 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.sales_report_one).
2020-06-30 21:18:00.682318 (Thread-1): Compiling model.sample_project.sales_report_two
2020-06-30 21:18:00.693030 (Thread-1): Writing injected SQL for node "model.sample_project.sales_report_two"
2020-06-30 21:18:00.693391 (Thread-1): finished collecting timing info
2020-06-30 21:18:00.693622 (Thread-1): finished collecting timing info
2020-06-30 21:18:00.693999 (Thread-1): Finished running node model.sample_project.sales_report_two
2020-06-30 21:18:00.786360 (MainThread): Connection 'master' was properly closed.
2020-06-30 21:18:00.786504 (MainThread): Connection 'model.sample_project.sales_report_two' was left open.
2020-06-30 21:18:00.786589 (MainThread): On model.sample_project.sales_report_two: Close
2020-06-30 21:18:01.103417 (MainThread): 16:18:01 | Done.
2020-06-30 21:18:01.104899 (MainThread): Acquiring new snowflake connection "generate_catalog".
2020-06-30 21:18:01.104992 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:18:01.105072 (MainThread): 16:18:01 | Building catalog
2020-06-30 21:18:01.184259 (ThreadPoolExecutor-2_0): Acquiring new snowflake connection "JAVEN_TESTING.information_schema".
2020-06-30 21:18:01.184531 (ThreadPoolExecutor-2_0): Opening a new connection, currently in state init
2020-06-30 21:18:01.191724 (ThreadPoolExecutor-2_0): Using snowflake connection "JAVEN_TESTING.information_schema".
2020-06-30 21:18:01.191884 (ThreadPoolExecutor-2_0): On JAVEN_TESTING.information_schema: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "JAVEN_TESTING.information_schema"} */

    
      with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include"

          from JAVEN_TESTING.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              null as "table_comment",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              null as "column_comment"

          from JAVEN_TESTING.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('test'))
      order by "column_index"
2020-06-30 21:18:07.445138 (ThreadPoolExecutor-2_0): SQL status: SUCCESS 88 in 6.25 seconds
2020-06-30 21:18:07.463969 (ThreadPoolExecutor-2_0): Acquiring new snowflake connection "snowflake_sample_data.information_schema".
2020-06-30 21:18:07.464278 (ThreadPoolExecutor-2_0): Re-using an available connection from the pool (formerly JAVEN_TESTING.information_schema).
2020-06-30 21:18:07.467638 (ThreadPoolExecutor-2_0): Using snowflake connection "snowflake_sample_data.information_schema".
2020-06-30 21:18:07.467773 (ThreadPoolExecutor-2_0): On snowflake_sample_data.information_schema: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "snowflake_sample_data.information_schema"} */

    
      with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include"

          from snowflake_sample_data.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              null as "table_comment",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              null as "column_comment"

          from snowflake_sample_data.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('tpch_sf1'))
      order by "column_index"
2020-06-30 21:18:10.702022 (ThreadPoolExecutor-2_0): SQL status: SUCCESS 61 in 3.23 seconds
2020-06-30 21:18:10.891126 (MainThread): 16:18:10 | Catalog written to /Users/johnaven/Documents/gitlab_projects/dbt-demo-June-2020/sample_project/target/catalog.json
2020-06-30 21:18:10.891573 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fede090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fede0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fede110>]}
2020-06-30 21:18:10.891914 (MainThread): Flushing usage events
2020-06-30 21:18:11.228767 (MainThread): Connection 'generate_catalog' was properly closed.
2020-06-30 21:18:11.228921 (MainThread): Connection 'snowflake_sample_data.information_schema' was left open.
2020-06-30 21:18:11.229017 (MainThread): On snowflake_sample_data.information_schema: Close
2020-06-30 21:18:12.448571 (MainThread): Running with dbt=0.17.0
2020-06-30 21:18:12.806472 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', open_browser=True, partial_parse=None, port=8080, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-06-30 21:18:12.807258 (MainThread): Tracking: tracking
2020-06-30 21:18:12.807553 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6b6290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6cd990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6cd8d0>]}
2020-06-30 21:18:12.809856 (MainThread): Serving docs at 0.0.0.0:8080
2020-06-30 21:18:12.809995 (MainThread): To access from your browser, navigate to:  http://localhost:8080
2020-06-30 21:18:12.810133 (MainThread): Press Ctrl+C to exit.


2020-06-30 21:43:07.149553 (MainThread): Flushing usage events
2020-06-30 21:43:07.672268 (MainThread): ctrl-c
2020-06-30 21:43:11.416437 (MainThread): Running with dbt=0.17.0
2020-06-30 21:43:11.825034 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2020-06-30 21:43:11.826044 (MainThread): Tracking: tracking
2020-06-30 21:43:11.826368 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8ac950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8c9a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8c9990>]}
2020-06-30 21:43:11.851919 (MainThread): Partial parsing not enabled
2020-06-30 21:43:11.854567 (MainThread): Parsing macros/core.sql
2020-06-30 21:43:11.861600 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-30 21:43:11.872642 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-30 21:43:11.875536 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-30 21:43:11.899202 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-30 21:43:11.932746 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-30 21:43:11.957987 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-30 21:43:11.960527 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-30 21:43:11.972492 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-30 21:43:11.990192 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-30 21:43:11.998141 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-30 21:43:12.006244 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-30 21:43:12.012345 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-30 21:43:12.013567 (MainThread): Parsing macros/etc/query.sql
2020-06-30 21:43:12.015014 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-30 21:43:12.017007 (MainThread): Parsing macros/etc/datetime.sql
2020-06-30 21:43:12.028075 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-30 21:43:12.031004 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-30 21:43:12.033921 (MainThread): Parsing macros/adapters/common.sql
2020-06-30 21:43:12.095329 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-30 21:43:12.097158 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-30 21:43:12.098660 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-30 21:43:12.100277 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-30 21:43:12.103726 (MainThread): Parsing macros/catalog.sql
2020-06-30 21:43:12.106227 (MainThread): Parsing macros/adapters.sql
2020-06-30 21:43:12.135416 (MainThread): Parsing macros/materializations/merge.sql
2020-06-30 21:43:12.137858 (MainThread): Parsing macros/materializations/view.sql
2020-06-30 21:43:12.139229 (MainThread): Parsing macros/materializations/table.sql
2020-06-30 21:43:12.143927 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-30 21:43:12.188786 (MainThread): Partial parsing not enabled
2020-06-30 21:43:12.190014 (MainThread): Parsing macros/discounted_price.sql
2020-06-30 21:43:12.191050 (MainThread): Parsing macros/tax_charged.sql
2020-06-30 21:43:12.192335 (MainThread): Parsing macros/full_charge.sql
2020-06-30 21:43:12.193638 (MainThread): Parsing macros/test_is_nonnegative.sql
2020-06-30 21:43:12.196850 (MainThread): Parsing macros/cross_db_utils/except.sql
2020-06-30 21:43:12.198276 (MainThread): Parsing macros/cross_db_utils/replace.sql
2020-06-30 21:43:12.199854 (MainThread): Parsing macros/cross_db_utils/concat.sql
2020-06-30 21:43:12.202620 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2020-06-30 21:43:12.209430 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2020-06-30 21:43:12.210974 (MainThread): Parsing macros/cross_db_utils/length.sql
2020-06-30 21:43:12.212820 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2020-06-30 21:43:12.215656 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2020-06-30 21:43:12.217248 (MainThread): Parsing macros/cross_db_utils/right.sql
2020-06-30 21:43:12.220028 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2020-06-30 21:43:12.231284 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2020-06-30 21:43:12.233871 (MainThread): Parsing macros/cross_db_utils/hash.sql
2020-06-30 21:43:12.235554 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2020-06-30 21:43:12.237289 (MainThread): Parsing macros/cross_db_utils/position.sql
2020-06-30 21:43:12.239112 (MainThread): Parsing macros/cross_db_utils/literal.sql
2020-06-30 21:43:12.240362 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2020-06-30 21:43:12.244108 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2020-06-30 21:43:12.250538 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2020-06-30 21:43:12.253840 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2020-06-30 21:43:12.256047 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2020-06-30 21:43:12.258097 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2020-06-30 21:43:12.286331 (MainThread): Parsing macros/logger/pretty_log_format.sql
2020-06-30 21:43:12.287331 (MainThread): Parsing macros/logger/pretty_time.sql
2020-06-30 21:43:12.288281 (MainThread): Parsing macros/logger/log_info.sql
2020-06-30 21:43:12.289490 (MainThread): Parsing macros/datetime/date_spine.sql
2020-06-30 21:43:12.293446 (MainThread): Parsing macros/web/get_url_host.sql
2020-06-30 21:43:12.295114 (MainThread): Parsing macros/web/get_url_path.sql
2020-06-30 21:43:12.297738 (MainThread): Parsing macros/web/get_url_parameter.sql
2020-06-30 21:43:12.299117 (MainThread): Parsing macros/geo/haversine_distance.sql
2020-06-30 21:43:12.300873 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2020-06-30 21:43:12.302494 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2020-06-30 21:43:12.304858 (MainThread): Parsing macros/schema_tests/recency.sql
2020-06-30 21:43:12.306318 (MainThread): Parsing macros/schema_tests/not_constant.sql
2020-06-30 21:43:12.307793 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2020-06-30 21:43:12.309535 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2020-06-30 21:43:12.310930 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2020-06-30 21:43:12.312976 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2020-06-30 21:43:12.314291 (MainThread): Parsing macros/schema_tests/equality.sql
2020-06-30 21:43:12.318947 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2020-06-30 21:43:12.325672 (MainThread): Parsing macros/sql/nullcheck_table.sql
2020-06-30 21:43:12.326887 (MainThread): Parsing macros/sql/generate_series.sql
2020-06-30 21:43:12.331091 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2020-06-30 21:43:12.335799 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2020-06-30 21:43:12.339127 (MainThread): Parsing macros/sql/star.sql
2020-06-30 21:43:12.342636 (MainThread): Parsing macros/sql/unpivot.sql
2020-06-30 21:43:12.350086 (MainThread): Parsing macros/sql/union.sql
2020-06-30 21:43:12.361577 (MainThread): Parsing macros/sql/groupby.sql
2020-06-30 21:43:12.362949 (MainThread): Parsing macros/sql/surrogate_key.sql
2020-06-30 21:43:12.366578 (MainThread): Parsing macros/sql/safe_add.sql
2020-06-30 21:43:12.368622 (MainThread): Parsing macros/sql/nullcheck.sql
2020-06-30 21:43:12.370275 (MainThread): Parsing macros/sql/get_column_values.sql
2020-06-30 21:43:12.374922 (MainThread): Parsing macros/sql/pivot.sql
2020-06-30 21:43:12.378468 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2020-06-30 21:43:12.433676 (MainThread): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 21:43:12.433809 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:43:12.473441 (MainThread): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 21:43:12.473598 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:43:12.489232 (MainThread): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 21:43:12.489355 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:43:12.503099 (MainThread): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 21:43:12.503213 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:43:12.515785 (MainThread): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 21:43:12.515889 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:43:12.530383 (MainThread): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 21:43:12.530499 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:43:12.543967 (MainThread): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 21:43:12.544071 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:43:12.558588 (MainThread): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 21:43:12.558695 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:43:12.572097 (MainThread): Acquiring new snowflake connection "model.sample_project.sales_report_one".
2020-06-30 21:43:12.572203 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:43:12.591360 (MainThread): Acquiring new snowflake connection "model.sample_project.order_statistics".
2020-06-30 21:43:12.591482 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:43:12.609567 (MainThread): Acquiring new snowflake connection "model.sample_project.sales_report_two".
2020-06-30 21:43:12.609812 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:43:13.135501 (MainThread): Found 11 models, 8 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 4 sources
2020-06-30 21:43:13.137314 (MainThread): 
2020-06-30 21:43:13.137637 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 21:43:13.137768 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:43:13.165791 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 21:43:13.165983 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-06-30 21:43:13.180764 (ThreadPoolExecutor-1_0): Using snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 21:43:13.180887 (ThreadPoolExecutor-1_0): On list_JAVEN_TESTING_TEST: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING_TEST"} */

    show terse objects in JAVEN_TESTING.TEST
2020-06-30 21:43:13.670625 (ThreadPoolExecutor-1_0): unclosed file <_io.BufferedReader name='/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/certifi/cacert.pem'>
2020-06-30 21:43:36.482116 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 11 in 23.30 seconds
2020-06-30 21:43:36.496112 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 21:43:36.496218 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:43:36.496425 (MainThread): 16:43:36 | Concurrency: 1 threads (target='dev')
2020-06-30 21:43:36.496543 (MainThread): 16:43:36 | 
2020-06-30 21:43:36.497521 (Thread-1): Began running node model.sample_project.customer
2020-06-30 21:43:36.497784 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 21:43:36.497877 (Thread-1): Re-using an available connection from the pool (formerly list_JAVEN_TESTING_TEST).
2020-06-30 21:43:36.497970 (Thread-1): Compiling model.sample_project.customer
2020-06-30 21:43:36.517710 (Thread-1): Writing injected SQL for node "model.sample_project.customer"
2020-06-30 21:43:36.518773 (Thread-1): finished collecting timing info
2020-06-30 21:43:36.519257 (Thread-1): Finished running node model.sample_project.customer
2020-06-30 21:43:36.519434 (Thread-1): Began running node model.sample_project.lineitem
2020-06-30 21:43:36.519842 (Thread-1): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 21:43:36.520000 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer).
2020-06-30 21:43:36.520086 (Thread-1): Compiling model.sample_project.lineitem
2020-06-30 21:43:36.527997 (Thread-1): Writing injected SQL for node "model.sample_project.lineitem"
2020-06-30 21:43:36.528361 (Thread-1): finished collecting timing info
2020-06-30 21:43:36.528732 (Thread-1): Finished running node model.sample_project.lineitem
2020-06-30 21:43:36.528929 (Thread-1): Began running node model.sample_project.nation
2020-06-30 21:43:36.529408 (Thread-1): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 21:43:36.529497 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.lineitem).
2020-06-30 21:43:36.529576 (Thread-1): Compiling model.sample_project.nation
2020-06-30 21:43:36.536410 (Thread-1): Writing injected SQL for node "model.sample_project.nation"
2020-06-30 21:43:36.537323 (Thread-1): finished collecting timing info
2020-06-30 21:43:36.537667 (Thread-1): Finished running node model.sample_project.nation
2020-06-30 21:43:36.537786 (Thread-1): Began running node model.sample_project.orders
2020-06-30 21:43:36.538136 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 21:43:36.538223 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.nation).
2020-06-30 21:43:36.538300 (Thread-1): Compiling model.sample_project.orders
2020-06-30 21:43:36.545927 (Thread-1): Writing injected SQL for node "model.sample_project.orders"
2020-06-30 21:43:36.546202 (Thread-1): finished collecting timing info
2020-06-30 21:43:36.546621 (Thread-1): Finished running node model.sample_project.orders
2020-06-30 21:43:36.546740 (Thread-1): Began running node test.sample_project.source_is_nonnegative_tpch_customer_c_custkey
2020-06-30 21:43:36.546986 (Thread-1): 16:43:36 | 1 of 8 START test source_is_nonnegative_tpch_customer_c_custkey...... [RUN]
2020-06-30 21:43:36.547577 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_nonnegative_tpch_customer_c_custkey".
2020-06-30 21:43:36.547732 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders).
2020-06-30 21:43:36.547813 (Thread-1): Compiling test.sample_project.source_is_nonnegative_tpch_customer_c_custkey
2020-06-30 21:43:36.565934 (Thread-1): Writing injected SQL for node "test.sample_project.source_is_nonnegative_tpch_customer_c_custkey"
2020-06-30 21:43:36.566911 (Thread-1): finished collecting timing info
2020-06-30 21:43:36.568312 (Thread-1): Using snowflake connection "test.sample_project.source_is_nonnegative_tpch_customer_c_custkey".
2020-06-30 21:43:36.568523 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_customer_c_custkey: BEGIN
2020-06-30 21:43:36.802283 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2020-06-30 21:43:36.802424 (Thread-1): Using snowflake connection "test.sample_project.source_is_nonnegative_tpch_customer_c_custkey".
2020-06-30 21:43:36.802504 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_customer_c_custkey: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "test.sample_project.source_is_nonnegative_tpch_customer_c_custkey"} */


with validation as (

    select
        c_custkey as negative

    from snowflake_sample_data.tpch_sf1.customer

),

validation_errors as (

    select
        negative

    from validation
    -- if this is true, negative will have a non-zero count
    where negative < 0

)

select count(*)
from validation_errors
2020-06-30 21:43:37.043855 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2020-06-30 21:43:37.044432 (Thread-1): finished collecting timing info
2020-06-30 21:43:37.044677 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_customer_c_custkey: ROLLBACK
2020-06-30 21:43:37.044819 (Thread-1): initiating rollback
2020-06-30 21:43:37.335924 (Thread-1): 16:43:37 | 1 of 8 PASS source_is_nonnegative_tpch_customer_c_custkey............ [PASS in 0.79s]
2020-06-30 21:43:37.336077 (Thread-1): Finished running node test.sample_project.source_is_nonnegative_tpch_customer_c_custkey
2020-06-30 21:43:37.336195 (Thread-1): Began running node test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey
2020-06-30 21:43:37.336367 (Thread-1): 16:43:37 | 2 of 8 START test source_is_nonnegative_tpch_customer_c_nationkey.... [RUN]
2020-06-30 21:43:37.336578 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey".
2020-06-30 21:43:37.336658 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_nonnegative_tpch_customer_c_custkey).
2020-06-30 21:43:37.336737 (Thread-1): Compiling test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey
2020-06-30 21:43:37.345759 (Thread-1): Writing injected SQL for node "test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey"
2020-06-30 21:43:37.346759 (Thread-1): finished collecting timing info
2020-06-30 21:43:37.347410 (Thread-1): Using snowflake connection "test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey".
2020-06-30 21:43:37.347498 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey: BEGIN
2020-06-30 21:43:37.535151 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2020-06-30 21:43:37.535415 (Thread-1): Using snowflake connection "test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey".
2020-06-30 21:43:37.535491 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey"} */


with validation as (

    select
        c_nationkey as negative

    from snowflake_sample_data.tpch_sf1.customer

),

validation_errors as (

    select
        negative

    from validation
    -- if this is true, negative will have a non-zero count
    where negative < 0

)

select count(*)
from validation_errors
2020-06-30 21:43:37.761087 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2020-06-30 21:43:37.761375 (Thread-1): finished collecting timing info
2020-06-30 21:43:37.761781 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey: ROLLBACK
2020-06-30 21:43:37.761861 (Thread-1): initiating rollback
2020-06-30 21:43:38.001500 (Thread-1): 16:43:38 | 2 of 8 PASS source_is_nonnegative_tpch_customer_c_nationkey.......... [PASS in 0.66s]
2020-06-30 21:43:38.001662 (Thread-1): Finished running node test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey
2020-06-30 21:43:38.001787 (Thread-1): Began running node test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice
2020-06-30 21:43:38.002093 (Thread-1): 16:43:38 | 3 of 8 START test source_is_nonnegative_tpch_lineitem_l_extendedprice [RUN]
2020-06-30 21:43:38.002352 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice".
2020-06-30 21:43:38.002437 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey).
2020-06-30 21:43:38.002522 (Thread-1): Compiling test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice
2020-06-30 21:43:38.011587 (Thread-1): Writing injected SQL for node "test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice"
2020-06-30 21:43:38.012606 (Thread-1): finished collecting timing info
2020-06-30 21:43:38.013199 (Thread-1): Using snowflake connection "test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice".
2020-06-30 21:43:38.013290 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice: BEGIN
2020-06-30 21:43:38.196355 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2020-06-30 21:43:38.196498 (Thread-1): Using snowflake connection "test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice".
2020-06-30 21:43:38.196583 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice"} */


with validation as (

    select
        l_extendedprice as negative

    from snowflake_sample_data.tpch_sf1.lineitem

),

validation_errors as (

    select
        negative

    from validation
    -- if this is true, negative will have a non-zero count
    where negative < 0

)

select count(*)
from validation_errors
2020-06-30 21:43:38.417006 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2020-06-30 21:43:38.417297 (Thread-1): finished collecting timing info
2020-06-30 21:43:38.417536 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice: ROLLBACK
2020-06-30 21:43:38.417615 (Thread-1): initiating rollback
2020-06-30 21:43:38.675207 (Thread-1): 16:43:38 | 3 of 8 PASS source_is_nonnegative_tpch_lineitem_l_extendedprice...... [PASS in 0.67s]
2020-06-30 21:43:38.675366 (Thread-1): Finished running node test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice
2020-06-30 21:43:38.675491 (Thread-1): Began running node test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey
2020-06-30 21:43:38.675672 (Thread-1): 16:43:38 | 4 of 8 START test source_is_nonnegative_tpch_nation_n_nationkey...... [RUN]
2020-06-30 21:43:38.675890 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey".
2020-06-30 21:43:38.675969 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice).
2020-06-30 21:43:38.676050 (Thread-1): Compiling test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey
2020-06-30 21:43:38.685273 (Thread-1): Writing injected SQL for node "test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey"
2020-06-30 21:43:38.685671 (Thread-1): finished collecting timing info
2020-06-30 21:43:38.686310 (Thread-1): Using snowflake connection "test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey".
2020-06-30 21:43:38.686400 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey: BEGIN
2020-06-30 21:43:38.908137 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2020-06-30 21:43:38.908280 (Thread-1): Using snowflake connection "test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey".
2020-06-30 21:43:38.908358 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey"} */


with validation as (

    select
        n_nationkey as negative

    from snowflake_sample_data.tpch_sf1.nation

),

validation_errors as (

    select
        negative

    from validation
    -- if this is true, negative will have a non-zero count
    where negative < 0

)

select count(*)
from validation_errors
2020-06-30 21:43:39.159210 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2020-06-30 21:43:39.159548 (Thread-1): finished collecting timing info
2020-06-30 21:43:39.159914 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey: ROLLBACK
2020-06-30 21:43:39.160050 (Thread-1): initiating rollback
2020-06-30 21:43:39.500118 (Thread-1): 16:43:39 | 4 of 8 PASS source_is_nonnegative_tpch_nation_n_nationkey............ [PASS in 0.82s]
2020-06-30 21:43:39.500281 (Thread-1): Finished running node test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey
2020-06-30 21:43:39.500578 (Thread-1): Began running node test.sample_project.source_is_nonnegative_tpch_orders_o_custkey
2020-06-30 21:43:39.500754 (Thread-1): 16:43:39 | 5 of 8 START test source_is_nonnegative_tpch_orders_o_custkey........ [RUN]
2020-06-30 21:43:39.501169 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_nonnegative_tpch_orders_o_custkey".
2020-06-30 21:43:39.501261 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey).
2020-06-30 21:43:39.501345 (Thread-1): Compiling test.sample_project.source_is_nonnegative_tpch_orders_o_custkey
2020-06-30 21:43:39.512517 (Thread-1): Writing injected SQL for node "test.sample_project.source_is_nonnegative_tpch_orders_o_custkey"
2020-06-30 21:43:39.512865 (Thread-1): finished collecting timing info
2020-06-30 21:43:39.513567 (Thread-1): Using snowflake connection "test.sample_project.source_is_nonnegative_tpch_orders_o_custkey".
2020-06-30 21:43:39.513722 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_orders_o_custkey: BEGIN
2020-06-30 21:43:39.955890 (Thread-1): SQL status: SUCCESS 1 in 0.44 seconds
2020-06-30 21:43:39.956027 (Thread-1): Using snowflake connection "test.sample_project.source_is_nonnegative_tpch_orders_o_custkey".
2020-06-30 21:43:39.956107 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_orders_o_custkey: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "test.sample_project.source_is_nonnegative_tpch_orders_o_custkey"} */


with validation as (

    select
        o_custkey as negative

    from snowflake_sample_data.tpch_sf1.orders

),

validation_errors as (

    select
        negative

    from validation
    -- if this is true, negative will have a non-zero count
    where negative < 0

)

select count(*)
from validation_errors
2020-06-30 21:43:40.227119 (Thread-1): SQL status: SUCCESS 1 in 0.27 seconds
2020-06-30 21:43:40.227410 (Thread-1): finished collecting timing info
2020-06-30 21:43:40.227659 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_orders_o_custkey: ROLLBACK
2020-06-30 21:43:40.227745 (Thread-1): initiating rollback
2020-06-30 21:43:40.590499 (Thread-1): 16:43:40 | 5 of 8 PASS source_is_nonnegative_tpch_orders_o_custkey.............. [PASS in 1.09s]
2020-06-30 21:43:40.590661 (Thread-1): Finished running node test.sample_project.source_is_nonnegative_tpch_orders_o_custkey
2020-06-30 21:43:40.590882 (Thread-1): Began running node test.sample_project.source_unique_tpch_customer_c_custkey
2020-06-30 21:43:40.591284 (Thread-1): 16:43:40 | 6 of 8 START test source_unique_tpch_customer_c_custkey.............. [RUN]
2020-06-30 21:43:40.591631 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_unique_tpch_customer_c_custkey".
2020-06-30 21:43:40.591709 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_nonnegative_tpch_orders_o_custkey).
2020-06-30 21:43:40.591789 (Thread-1): Compiling test.sample_project.source_unique_tpch_customer_c_custkey
2020-06-30 21:43:40.601499 (Thread-1): Writing injected SQL for node "test.sample_project.source_unique_tpch_customer_c_custkey"
2020-06-30 21:43:40.601832 (Thread-1): finished collecting timing info
2020-06-30 21:43:40.602383 (Thread-1): Using snowflake connection "test.sample_project.source_unique_tpch_customer_c_custkey".
2020-06-30 21:43:40.602468 (Thread-1): On test.sample_project.source_unique_tpch_customer_c_custkey: BEGIN
2020-06-30 21:43:40.768936 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2020-06-30 21:43:40.769077 (Thread-1): Using snowflake connection "test.sample_project.source_unique_tpch_customer_c_custkey".
2020-06-30 21:43:40.769160 (Thread-1): On test.sample_project.source_unique_tpch_customer_c_custkey: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "test.sample_project.source_unique_tpch_customer_c_custkey"} */




select count(*) as validation_errors
from (

    select
        c_custkey

    from snowflake_sample_data.tpch_sf1.customer
    where c_custkey is not null
    group by c_custkey
    having count(*) > 1

) validation_errors
2020-06-30 21:43:41.022559 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2020-06-30 21:43:41.022843 (Thread-1): finished collecting timing info
2020-06-30 21:43:41.023089 (Thread-1): On test.sample_project.source_unique_tpch_customer_c_custkey: ROLLBACK
2020-06-30 21:43:41.023172 (Thread-1): initiating rollback
2020-06-30 21:43:41.272369 (Thread-1): 16:43:41 | 6 of 8 PASS source_unique_tpch_customer_c_custkey.................... [PASS in 0.68s]
2020-06-30 21:43:41.272570 (Thread-1): Finished running node test.sample_project.source_unique_tpch_customer_c_custkey
2020-06-30 21:43:41.272689 (Thread-1): Began running node test.sample_project.source_unique_tpch_nation_n_nationkey
2020-06-30 21:43:41.272861 (Thread-1): 16:43:41 | 7 of 8 START test source_unique_tpch_nation_n_nationkey.............. [RUN]
2020-06-30 21:43:41.273068 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_unique_tpch_nation_n_nationkey".
2020-06-30 21:43:41.273143 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_unique_tpch_customer_c_custkey).
2020-06-30 21:43:41.273221 (Thread-1): Compiling test.sample_project.source_unique_tpch_nation_n_nationkey
2020-06-30 21:43:41.282496 (Thread-1): Writing injected SQL for node "test.sample_project.source_unique_tpch_nation_n_nationkey"
2020-06-30 21:43:41.282958 (Thread-1): finished collecting timing info
2020-06-30 21:43:41.283709 (Thread-1): Using snowflake connection "test.sample_project.source_unique_tpch_nation_n_nationkey".
2020-06-30 21:43:41.283796 (Thread-1): On test.sample_project.source_unique_tpch_nation_n_nationkey: BEGIN
2020-06-30 21:43:41.565232 (Thread-1): SQL status: SUCCESS 1 in 0.28 seconds
2020-06-30 21:43:41.565369 (Thread-1): Using snowflake connection "test.sample_project.source_unique_tpch_nation_n_nationkey".
2020-06-30 21:43:41.565449 (Thread-1): On test.sample_project.source_unique_tpch_nation_n_nationkey: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "test.sample_project.source_unique_tpch_nation_n_nationkey"} */




select count(*) as validation_errors
from (

    select
        n_nationkey

    from snowflake_sample_data.tpch_sf1.nation
    where n_nationkey is not null
    group by n_nationkey
    having count(*) > 1

) validation_errors
2020-06-30 21:43:42.047334 (Thread-1): SQL status: SUCCESS 1 in 0.48 seconds
2020-06-30 21:43:42.047766 (Thread-1): finished collecting timing info
2020-06-30 21:43:42.047999 (Thread-1): On test.sample_project.source_unique_tpch_nation_n_nationkey: ROLLBACK
2020-06-30 21:43:42.048078 (Thread-1): initiating rollback
2020-06-30 21:43:42.446264 (Thread-1): 16:43:42 | 7 of 8 PASS source_unique_tpch_nation_n_nationkey.................... [PASS in 1.17s]
2020-06-30 21:43:42.446524 (Thread-1): Finished running node test.sample_project.source_unique_tpch_nation_n_nationkey
2020-06-30 21:43:42.446787 (Thread-1): Began running node test.sample_project.source_unique_tpch_orders_o_orderkey
2020-06-30 21:43:42.447050 (Thread-1): 16:43:42 | 8 of 8 START test source_unique_tpch_orders_o_orderkey............... [RUN]
2020-06-30 21:43:42.447310 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_unique_tpch_orders_o_orderkey".
2020-06-30 21:43:42.447387 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_unique_tpch_nation_n_nationkey).
2020-06-30 21:43:42.447524 (Thread-1): Compiling test.sample_project.source_unique_tpch_orders_o_orderkey
2020-06-30 21:43:42.457778 (Thread-1): Writing injected SQL for node "test.sample_project.source_unique_tpch_orders_o_orderkey"
2020-06-30 21:43:42.458222 (Thread-1): finished collecting timing info
2020-06-30 21:43:42.458975 (Thread-1): Using snowflake connection "test.sample_project.source_unique_tpch_orders_o_orderkey".
2020-06-30 21:43:42.459061 (Thread-1): On test.sample_project.source_unique_tpch_orders_o_orderkey: BEGIN
2020-06-30 21:43:42.680818 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2020-06-30 21:43:42.680981 (Thread-1): Using snowflake connection "test.sample_project.source_unique_tpch_orders_o_orderkey".
2020-06-30 21:43:42.681088 (Thread-1): On test.sample_project.source_unique_tpch_orders_o_orderkey: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "test.sample_project.source_unique_tpch_orders_o_orderkey"} */




select count(*) as validation_errors
from (

    select
        o_orderkey

    from snowflake_sample_data.tpch_sf1.orders
    where o_orderkey is not null
    group by o_orderkey
    having count(*) > 1

) validation_errors
2020-06-30 21:43:43.566149 (Thread-1): SQL status: SUCCESS 1 in 0.88 seconds
2020-06-30 21:43:43.566423 (Thread-1): finished collecting timing info
2020-06-30 21:43:43.566692 (Thread-1): On test.sample_project.source_unique_tpch_orders_o_orderkey: ROLLBACK
2020-06-30 21:43:43.566768 (Thread-1): initiating rollback
2020-06-30 21:43:43.838206 (Thread-1): 16:43:43 | 8 of 8 PASS source_unique_tpch_orders_o_orderkey..................... [PASS in 1.39s]
2020-06-30 21:43:43.838366 (Thread-1): Finished running node test.sample_project.source_unique_tpch_orders_o_orderkey
2020-06-30 21:43:43.838483 (Thread-1): Began running node model.sample_project.customer_nation
2020-06-30 21:43:43.838940 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 21:43:43.839025 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_unique_tpch_orders_o_orderkey).
2020-06-30 21:43:43.839105 (Thread-1): Compiling model.sample_project.customer_nation
2020-06-30 21:43:43.850688 (Thread-1): Writing injected SQL for node "model.sample_project.customer_nation"
2020-06-30 21:43:43.851171 (Thread-1): finished collecting timing info
2020-06-30 21:43:43.851523 (Thread-1): Finished running node model.sample_project.customer_nation
2020-06-30 21:43:43.851644 (Thread-1): Began running node model.sample_project.orders_lineitem
2020-06-30 21:43:43.852009 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 21:43:43.852216 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer_nation).
2020-06-30 21:43:43.852300 (Thread-1): Compiling model.sample_project.orders_lineitem
2020-06-30 21:43:43.866286 (Thread-1): Writing injected SQL for node "model.sample_project.orders_lineitem"
2020-06-30 21:43:43.866763 (Thread-1): finished collecting timing info
2020-06-30 21:43:43.867306 (Thread-1): Finished running node model.sample_project.orders_lineitem
2020-06-30 21:43:43.867549 (Thread-1): Began running node model.sample_project.customers_per_nation
2020-06-30 21:43:43.867952 (Thread-1): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 21:43:43.868047 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders_lineitem).
2020-06-30 21:43:43.868133 (Thread-1): Compiling model.sample_project.customers_per_nation
2020-06-30 21:43:43.878793 (Thread-1): Writing injected SQL for node "model.sample_project.customers_per_nation"
2020-06-30 21:43:43.879219 (Thread-1): finished collecting timing info
2020-06-30 21:43:43.879632 (Thread-1): Finished running node model.sample_project.customers_per_nation
2020-06-30 21:43:43.879751 (Thread-1): Began running node model.sample_project.cust_list_ord_nat
2020-06-30 21:43:43.880253 (Thread-1): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 21:43:43.880343 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customers_per_nation).
2020-06-30 21:43:43.880481 (Thread-1): Compiling model.sample_project.cust_list_ord_nat
2020-06-30 21:43:43.898577 (Thread-1): Writing injected SQL for node "model.sample_project.cust_list_ord_nat"
2020-06-30 21:43:43.899403 (Thread-1): finished collecting timing info
2020-06-30 21:43:43.899817 (Thread-1): Finished running node model.sample_project.cust_list_ord_nat
2020-06-30 21:43:44.000520 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 21:43:44.000696 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:43:44.000932 (MainThread): 16:43:44 | 
2020-06-30 21:43:44.001046 (MainThread): 16:43:44 | Finished running 8 tests in 30.86s.
2020-06-30 21:43:44.001140 (MainThread): Connection 'master' was properly closed.
2020-06-30 21:43:44.001213 (MainThread): Connection 'model.sample_project.cust_list_ord_nat' was left open.
2020-06-30 21:43:44.001286 (MainThread): On model.sample_project.cust_list_ord_nat: Close
2020-06-30 21:43:44.679380 (MainThread): 
2020-06-30 21:43:44.679530 (MainThread): Completed successfully
2020-06-30 21:43:44.679641 (MainThread): 
Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
2020-06-30 21:43:44.679804 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1cc150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1cd3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11176b2d0>]}
2020-06-30 21:43:44.680169 (MainThread): Flushing usage events
2020-06-30 21:44:19.611222 (MainThread): Running with dbt=0.17.0
2020-06-30 21:44:20.037816 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-06-30 21:44:20.038583 (MainThread): Tracking: tracking
2020-06-30 21:44:20.038902 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10809fb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066f7f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10807c490>]}
2020-06-30 21:44:20.061388 (MainThread): Partial parsing not enabled
2020-06-30 21:44:20.063465 (MainThread): Parsing macros/core.sql
2020-06-30 21:44:20.070263 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-30 21:44:20.079535 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-30 21:44:20.081767 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-30 21:44:20.102463 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-30 21:44:20.139285 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-30 21:44:20.166392 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-30 21:44:20.169213 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-30 21:44:20.176813 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-30 21:44:20.193654 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-30 21:44:20.202226 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-30 21:44:20.212155 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-30 21:44:20.218762 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-30 21:44:20.220074 (MainThread): Parsing macros/etc/query.sql
2020-06-30 21:44:20.221885 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-30 21:44:20.223782 (MainThread): Parsing macros/etc/datetime.sql
2020-06-30 21:44:20.233936 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-30 21:44:20.236267 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-30 21:44:20.238411 (MainThread): Parsing macros/adapters/common.sql
2020-06-30 21:44:20.293846 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-30 21:44:20.295257 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-30 21:44:20.296367 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-30 21:44:20.297718 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-30 21:44:20.300864 (MainThread): Parsing macros/catalog.sql
2020-06-30 21:44:20.303011 (MainThread): Parsing macros/adapters.sql
2020-06-30 21:44:20.327682 (MainThread): Parsing macros/materializations/merge.sql
2020-06-30 21:44:20.330008 (MainThread): Parsing macros/materializations/view.sql
2020-06-30 21:44:20.331564 (MainThread): Parsing macros/materializations/table.sql
2020-06-30 21:44:20.335980 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-30 21:44:20.378668 (MainThread): Partial parsing not enabled
2020-06-30 21:44:20.379387 (MainThread): Parsing macros/discounted_price.sql
2020-06-30 21:44:20.380341 (MainThread): Parsing macros/tax_charged.sql
2020-06-30 21:44:20.381416 (MainThread): Parsing macros/full_charge.sql
2020-06-30 21:44:20.382505 (MainThread): Parsing macros/test_is_nonnegative.sql
2020-06-30 21:44:20.385062 (MainThread): Parsing macros/cross_db_utils/except.sql
2020-06-30 21:44:20.386681 (MainThread): Parsing macros/cross_db_utils/replace.sql
2020-06-30 21:44:20.388210 (MainThread): Parsing macros/cross_db_utils/concat.sql
2020-06-30 21:44:20.391580 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2020-06-30 21:44:20.398037 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2020-06-30 21:44:20.400144 (MainThread): Parsing macros/cross_db_utils/length.sql
2020-06-30 21:44:20.402038 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2020-06-30 21:44:20.404643 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2020-06-30 21:44:20.405798 (MainThread): Parsing macros/cross_db_utils/right.sql
2020-06-30 21:44:20.408369 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2020-06-30 21:44:20.420754 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2020-06-30 21:44:20.423194 (MainThread): Parsing macros/cross_db_utils/hash.sql
2020-06-30 21:44:20.424967 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2020-06-30 21:44:20.426781 (MainThread): Parsing macros/cross_db_utils/position.sql
2020-06-30 21:44:20.428942 (MainThread): Parsing macros/cross_db_utils/literal.sql
2020-06-30 21:44:20.430443 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2020-06-30 21:44:20.434002 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2020-06-30 21:44:20.441368 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2020-06-30 21:44:20.445748 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2020-06-30 21:44:20.448213 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2020-06-30 21:44:20.450394 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2020-06-30 21:44:20.478848 (MainThread): Parsing macros/logger/pretty_log_format.sql
2020-06-30 21:44:20.479743 (MainThread): Parsing macros/logger/pretty_time.sql
2020-06-30 21:44:20.480743 (MainThread): Parsing macros/logger/log_info.sql
2020-06-30 21:44:20.481772 (MainThread): Parsing macros/datetime/date_spine.sql
2020-06-30 21:44:20.487141 (MainThread): Parsing macros/web/get_url_host.sql
2020-06-30 21:44:20.490068 (MainThread): Parsing macros/web/get_url_path.sql
2020-06-30 21:44:20.493258 (MainThread): Parsing macros/web/get_url_parameter.sql
2020-06-30 21:44:20.494664 (MainThread): Parsing macros/geo/haversine_distance.sql
2020-06-30 21:44:20.495829 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2020-06-30 21:44:20.498206 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2020-06-30 21:44:20.501215 (MainThread): Parsing macros/schema_tests/recency.sql
2020-06-30 21:44:20.502928 (MainThread): Parsing macros/schema_tests/not_constant.sql
2020-06-30 21:44:20.504441 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2020-06-30 21:44:20.505770 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2020-06-30 21:44:20.507160 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2020-06-30 21:44:20.509233 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2020-06-30 21:44:20.510630 (MainThread): Parsing macros/schema_tests/equality.sql
2020-06-30 21:44:20.514421 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2020-06-30 21:44:20.521995 (MainThread): Parsing macros/sql/nullcheck_table.sql
2020-06-30 21:44:20.523315 (MainThread): Parsing macros/sql/generate_series.sql
2020-06-30 21:44:20.527101 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2020-06-30 21:44:20.532142 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2020-06-30 21:44:20.535490 (MainThread): Parsing macros/sql/star.sql
2020-06-30 21:44:20.538619 (MainThread): Parsing macros/sql/unpivot.sql
2020-06-30 21:44:20.546237 (MainThread): Parsing macros/sql/union.sql
2020-06-30 21:44:20.558708 (MainThread): Parsing macros/sql/groupby.sql
2020-06-30 21:44:20.559916 (MainThread): Parsing macros/sql/surrogate_key.sql
2020-06-30 21:44:20.563040 (MainThread): Parsing macros/sql/safe_add.sql
2020-06-30 21:44:20.564874 (MainThread): Parsing macros/sql/nullcheck.sql
2020-06-30 21:44:20.566426 (MainThread): Parsing macros/sql/get_column_values.sql
2020-06-30 21:44:20.571913 (MainThread): Parsing macros/sql/pivot.sql
2020-06-30 21:44:20.575003 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2020-06-30 21:44:20.627489 (MainThread): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 21:44:20.627629 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:44:20.666253 (MainThread): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 21:44:20.666525 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:44:20.681520 (MainThread): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 21:44:20.681782 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:44:20.695519 (MainThread): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 21:44:20.695631 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:44:20.708942 (MainThread): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 21:44:20.709051 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:44:20.723205 (MainThread): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 21:44:20.723322 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:44:20.736679 (MainThread): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 21:44:20.736781 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:44:20.750653 (MainThread): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 21:44:20.750758 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:44:20.764345 (MainThread): Acquiring new snowflake connection "model.sample_project.sales_report_one".
2020-06-30 21:44:20.764446 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:44:20.783698 (MainThread): Acquiring new snowflake connection "model.sample_project.order_statistics".
2020-06-30 21:44:20.783822 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:44:20.800117 (MainThread): Acquiring new snowflake connection "model.sample_project.sales_report_two".
2020-06-30 21:44:20.800221 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:44:21.305606 (MainThread): Found 11 models, 8 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 4 sources
2020-06-30 21:44:21.307252 (MainThread): 
2020-06-30 21:44:21.307566 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 21:44:21.307651 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:44:21.311841 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_JAVEN_TESTING".
2020-06-30 21:44:21.312075 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-06-30 21:44:21.327013 (ThreadPoolExecutor-0_0): Using snowflake connection "list_JAVEN_TESTING".
2020-06-30 21:44:21.327177 (ThreadPoolExecutor-0_0): On list_JAVEN_TESTING: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING"} */

    show terse schemas in database JAVEN_TESTING
    limit 10000
2020-06-30 21:44:21.768121 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/certifi/cacert.pem'>
2020-06-30 21:44:26.973463 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 5.65 seconds
2020-06-30 21:44:27.004752 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 21:44:27.004981 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_JAVEN_TESTING).
2020-06-30 21:44:27.012420 (ThreadPoolExecutor-1_0): Using snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 21:44:27.012554 (ThreadPoolExecutor-1_0): On list_JAVEN_TESTING_TEST: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING_TEST"} */

    show terse objects in JAVEN_TESTING.TEST
2020-06-30 21:44:27.180402 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 11 in 0.17 seconds
2020-06-30 21:44:27.191363 (MainThread): 16:44:27 | Concurrency: 1 threads (target='dev')
2020-06-30 21:44:27.191618 (MainThread): 16:44:27 | 
2020-06-30 21:44:27.192737 (Thread-1): Began running node model.sample_project.lineitem
2020-06-30 21:44:27.193002 (Thread-1): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 21:44:27.193091 (Thread-1): Re-using an available connection from the pool (formerly list_JAVEN_TESTING_TEST).
2020-06-30 21:44:27.193180 (Thread-1): Compiling model.sample_project.lineitem
2020-06-30 21:44:27.209542 (Thread-1): Writing injected SQL for node "model.sample_project.lineitem"
2020-06-30 21:44:27.209922 (Thread-1): finished collecting timing info
2020-06-30 21:44:27.210310 (Thread-1): Finished running node model.sample_project.lineitem
2020-06-30 21:44:27.210506 (Thread-1): Began running node model.sample_project.orders
2020-06-30 21:44:27.210980 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 21:44:27.211072 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.lineitem).
2020-06-30 21:44:27.211156 (Thread-1): Compiling model.sample_project.orders
2020-06-30 21:44:27.218568 (Thread-1): Writing injected SQL for node "model.sample_project.orders"
2020-06-30 21:44:27.218939 (Thread-1): finished collecting timing info
2020-06-30 21:44:27.219291 (Thread-1): Finished running node model.sample_project.orders
2020-06-30 21:44:27.219450 (Thread-1): Began running node model.sample_project.customer
2020-06-30 21:44:27.219757 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 21:44:27.219922 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders).
2020-06-30 21:44:27.220226 (Thread-1): Compiling model.sample_project.customer
2020-06-30 21:44:27.227829 (Thread-1): Writing injected SQL for node "model.sample_project.customer"
2020-06-30 21:44:27.228373 (Thread-1): finished collecting timing info
2020-06-30 21:44:27.228749 (Thread-1): Finished running node model.sample_project.customer
2020-06-30 21:44:27.228873 (Thread-1): Began running node model.sample_project.nation
2020-06-30 21:44:27.229170 (Thread-1): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 21:44:27.229266 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer).
2020-06-30 21:44:27.229357 (Thread-1): Compiling model.sample_project.nation
2020-06-30 21:44:27.236708 (Thread-1): Writing injected SQL for node "model.sample_project.nation"
2020-06-30 21:44:27.237041 (Thread-1): finished collecting timing info
2020-06-30 21:44:27.237405 (Thread-1): Finished running node model.sample_project.nation
2020-06-30 21:44:27.237532 (Thread-1): Began running node test.sample_project.source_is_nonnegative_tpch_customer_c_custkey
2020-06-30 21:44:27.238024 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_nonnegative_tpch_customer_c_custkey".
2020-06-30 21:44:27.238211 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.nation).
2020-06-30 21:44:27.238297 (Thread-1): Compiling test.sample_project.source_is_nonnegative_tpch_customer_c_custkey
2020-06-30 21:44:27.253901 (Thread-1): Writing injected SQL for node "test.sample_project.source_is_nonnegative_tpch_customer_c_custkey"
2020-06-30 21:44:27.254339 (Thread-1): finished collecting timing info
2020-06-30 21:44:27.254572 (Thread-1): finished collecting timing info
2020-06-30 21:44:27.255054 (Thread-1): Finished running node test.sample_project.source_is_nonnegative_tpch_customer_c_custkey
2020-06-30 21:44:27.255245 (Thread-1): Began running node test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey
2020-06-30 21:44:27.255602 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey".
2020-06-30 21:44:27.255697 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_nonnegative_tpch_customer_c_custkey).
2020-06-30 21:44:27.255779 (Thread-1): Compiling test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey
2020-06-30 21:44:27.264522 (Thread-1): Writing injected SQL for node "test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey"
2020-06-30 21:44:27.264994 (Thread-1): finished collecting timing info
2020-06-30 21:44:27.265229 (Thread-1): finished collecting timing info
2020-06-30 21:44:27.265559 (Thread-1): Finished running node test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey
2020-06-30 21:44:27.265679 (Thread-1): Began running node test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice
2020-06-30 21:44:27.266197 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice".
2020-06-30 21:44:27.266339 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey).
2020-06-30 21:44:27.266478 (Thread-1): Compiling test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice
2020-06-30 21:44:27.276318 (Thread-1): Writing injected SQL for node "test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice"
2020-06-30 21:44:27.276883 (Thread-1): finished collecting timing info
2020-06-30 21:44:27.277113 (Thread-1): finished collecting timing info
2020-06-30 21:44:27.277455 (Thread-1): Finished running node test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice
2020-06-30 21:44:27.277578 (Thread-1): Began running node test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey
2020-06-30 21:44:27.277882 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey".
2020-06-30 21:44:27.277977 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice).
2020-06-30 21:44:27.278058 (Thread-1): Compiling test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey
2020-06-30 21:44:27.286308 (Thread-1): Writing injected SQL for node "test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey"
2020-06-30 21:44:27.286674 (Thread-1): finished collecting timing info
2020-06-30 21:44:27.286895 (Thread-1): finished collecting timing info
2020-06-30 21:44:27.287229 (Thread-1): Finished running node test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey
2020-06-30 21:44:27.287352 (Thread-1): Began running node test.sample_project.source_is_nonnegative_tpch_orders_o_custkey
2020-06-30 21:44:27.287796 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_nonnegative_tpch_orders_o_custkey".
2020-06-30 21:44:27.287914 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey).
2020-06-30 21:44:27.287997 (Thread-1): Compiling test.sample_project.source_is_nonnegative_tpch_orders_o_custkey
2020-06-30 21:44:27.296558 (Thread-1): Writing injected SQL for node "test.sample_project.source_is_nonnegative_tpch_orders_o_custkey"
2020-06-30 21:44:27.296985 (Thread-1): finished collecting timing info
2020-06-30 21:44:27.297214 (Thread-1): finished collecting timing info
2020-06-30 21:44:27.297545 (Thread-1): Finished running node test.sample_project.source_is_nonnegative_tpch_orders_o_custkey
2020-06-30 21:44:27.297666 (Thread-1): Began running node test.sample_project.source_unique_tpch_customer_c_custkey
2020-06-30 21:44:27.297980 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_unique_tpch_customer_c_custkey".
2020-06-30 21:44:27.298073 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_nonnegative_tpch_orders_o_custkey).
2020-06-30 21:44:27.298154 (Thread-1): Compiling test.sample_project.source_unique_tpch_customer_c_custkey
2020-06-30 21:44:27.306641 (Thread-1): Writing injected SQL for node "test.sample_project.source_unique_tpch_customer_c_custkey"
2020-06-30 21:44:27.307058 (Thread-1): finished collecting timing info
2020-06-30 21:44:27.307330 (Thread-1): finished collecting timing info
2020-06-30 21:44:27.307892 (Thread-1): Finished running node test.sample_project.source_unique_tpch_customer_c_custkey
2020-06-30 21:44:27.308024 (Thread-1): Began running node test.sample_project.source_unique_tpch_nation_n_nationkey
2020-06-30 21:44:27.308317 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_unique_tpch_nation_n_nationkey".
2020-06-30 21:44:27.308404 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_unique_tpch_customer_c_custkey).
2020-06-30 21:44:27.308484 (Thread-1): Compiling test.sample_project.source_unique_tpch_nation_n_nationkey
2020-06-30 21:44:27.317052 (Thread-1): Writing injected SQL for node "test.sample_project.source_unique_tpch_nation_n_nationkey"
2020-06-30 21:44:27.317358 (Thread-1): finished collecting timing info
2020-06-30 21:44:27.317591 (Thread-1): finished collecting timing info
2020-06-30 21:44:27.317927 (Thread-1): Finished running node test.sample_project.source_unique_tpch_nation_n_nationkey
2020-06-30 21:44:27.318048 (Thread-1): Began running node test.sample_project.source_unique_tpch_orders_o_orderkey
2020-06-30 21:44:27.318332 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_unique_tpch_orders_o_orderkey".
2020-06-30 21:44:27.318426 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_unique_tpch_nation_n_nationkey).
2020-06-30 21:44:27.318509 (Thread-1): Compiling test.sample_project.source_unique_tpch_orders_o_orderkey
2020-06-30 21:44:27.326778 (Thread-1): Writing injected SQL for node "test.sample_project.source_unique_tpch_orders_o_orderkey"
2020-06-30 21:44:27.327105 (Thread-1): finished collecting timing info
2020-06-30 21:44:27.327332 (Thread-1): finished collecting timing info
2020-06-30 21:44:27.327713 (Thread-1): Finished running node test.sample_project.source_unique_tpch_orders_o_orderkey
2020-06-30 21:44:27.327839 (Thread-1): Began running node model.sample_project.orders_lineitem
2020-06-30 21:44:27.328387 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 21:44:27.328504 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_unique_tpch_orders_o_orderkey).
2020-06-30 21:44:27.328586 (Thread-1): Compiling model.sample_project.orders_lineitem
2020-06-30 21:44:27.340295 (Thread-1): Writing injected SQL for node "model.sample_project.orders_lineitem"
2020-06-30 21:44:27.341224 (Thread-1): finished collecting timing info
2020-06-30 21:44:27.341619 (Thread-1): Finished running node model.sample_project.orders_lineitem
2020-06-30 21:44:27.341746 (Thread-1): Began running node model.sample_project.customer_nation
2020-06-30 21:44:27.342131 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 21:44:27.342236 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders_lineitem).
2020-06-30 21:44:27.342321 (Thread-1): Compiling model.sample_project.customer_nation
2020-06-30 21:44:27.353083 (Thread-1): Writing injected SQL for node "model.sample_project.customer_nation"
2020-06-30 21:44:27.353520 (Thread-1): finished collecting timing info
2020-06-30 21:44:27.353899 (Thread-1): Finished running node model.sample_project.customer_nation
2020-06-30 21:44:27.354022 (Thread-1): Began running node model.sample_project.order_statistics
2020-06-30 21:44:27.354327 (Thread-1): Acquiring new snowflake connection "model.sample_project.order_statistics".
2020-06-30 21:44:27.354531 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer_nation).
2020-06-30 21:44:27.354626 (Thread-1): Compiling model.sample_project.order_statistics
2020-06-30 21:44:27.368459 (Thread-1): Writing injected SQL for node "model.sample_project.order_statistics"
2020-06-30 21:44:27.368859 (Thread-1): finished collecting timing info
2020-06-30 21:44:27.369135 (Thread-1): finished collecting timing info
2020-06-30 21:44:27.369548 (Thread-1): Finished running node model.sample_project.order_statistics
2020-06-30 21:44:27.369671 (Thread-1): Began running node model.sample_project.cust_list_ord_nat
2020-06-30 21:44:27.369983 (Thread-1): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 21:44:27.370079 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.order_statistics).
2020-06-30 21:44:27.370163 (Thread-1): Compiling model.sample_project.cust_list_ord_nat
2020-06-30 21:44:27.384007 (Thread-1): Writing injected SQL for node "model.sample_project.cust_list_ord_nat"
2020-06-30 21:44:27.384779 (Thread-1): finished collecting timing info
2020-06-30 21:44:27.385250 (Thread-1): Finished running node model.sample_project.cust_list_ord_nat
2020-06-30 21:44:27.385436 (Thread-1): Began running node model.sample_project.customers_per_nation
2020-06-30 21:44:27.385738 (Thread-1): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 21:44:27.385914 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.cust_list_ord_nat).
2020-06-30 21:44:27.386015 (Thread-1): Compiling model.sample_project.customers_per_nation
2020-06-30 21:44:27.396545 (Thread-1): Writing injected SQL for node "model.sample_project.customers_per_nation"
2020-06-30 21:44:27.396910 (Thread-1): finished collecting timing info
2020-06-30 21:44:27.397277 (Thread-1): Finished running node model.sample_project.customers_per_nation
2020-06-30 21:44:27.397397 (Thread-1): Began running node model.sample_project.sales_report_one
2020-06-30 21:44:27.397804 (Thread-1): Acquiring new snowflake connection "model.sample_project.sales_report_one".
2020-06-30 21:44:27.397899 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customers_per_nation).
2020-06-30 21:44:27.397982 (Thread-1): Compiling model.sample_project.sales_report_one
2020-06-30 21:44:27.411511 (Thread-1): Writing injected SQL for node "model.sample_project.sales_report_one"
2020-06-30 21:44:27.412329 (Thread-1): finished collecting timing info
2020-06-30 21:44:27.412596 (Thread-1): finished collecting timing info
2020-06-30 21:44:27.412931 (Thread-1): Finished running node model.sample_project.sales_report_one
2020-06-30 21:44:27.413049 (Thread-1): Began running node model.sample_project.sales_report_two
2020-06-30 21:44:27.413389 (Thread-1): Acquiring new snowflake connection "model.sample_project.sales_report_two".
2020-06-30 21:44:27.413485 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.sales_report_one).
2020-06-30 21:44:27.413565 (Thread-1): Compiling model.sample_project.sales_report_two
2020-06-30 21:44:27.425706 (Thread-1): Writing injected SQL for node "model.sample_project.sales_report_two"
2020-06-30 21:44:27.426182 (Thread-1): finished collecting timing info
2020-06-30 21:44:27.426552 (Thread-1): finished collecting timing info
2020-06-30 21:44:27.427164 (Thread-1): Finished running node model.sample_project.sales_report_two
2020-06-30 21:44:27.511324 (MainThread): Connection 'master' was properly closed.
2020-06-30 21:44:27.511491 (MainThread): Connection 'model.sample_project.sales_report_two' was left open.
2020-06-30 21:44:27.511587 (MainThread): On model.sample_project.sales_report_two: Close
2020-06-30 21:44:28.076911 (MainThread): 16:44:28 | Done.
2020-06-30 21:44:28.081528 (MainThread): Acquiring new snowflake connection "generate_catalog".
2020-06-30 21:44:28.081677 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:44:28.081762 (MainThread): 16:44:28 | Building catalog
2020-06-30 21:44:28.161854 (ThreadPoolExecutor-2_0): Acquiring new snowflake connection "JAVEN_TESTING.information_schema".
2020-06-30 21:44:28.162069 (ThreadPoolExecutor-2_0): Opening a new connection, currently in state init
2020-06-30 21:44:28.169327 (ThreadPoolExecutor-2_0): Using snowflake connection "JAVEN_TESTING.information_schema".
2020-06-30 21:44:28.169425 (ThreadPoolExecutor-2_0): On JAVEN_TESTING.information_schema: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "JAVEN_TESTING.information_schema"} */

    
      with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include"

          from JAVEN_TESTING.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              null as "table_comment",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              null as "column_comment"

          from JAVEN_TESTING.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('test'))
      order by "column_index"
2020-06-30 21:44:35.101353 (ThreadPoolExecutor-2_0): SQL status: SUCCESS 88 in 6.93 seconds
2020-06-30 21:44:35.123044 (ThreadPoolExecutor-2_0): Acquiring new snowflake connection "snowflake_sample_data.information_schema".
2020-06-30 21:44:35.123396 (ThreadPoolExecutor-2_0): Re-using an available connection from the pool (formerly JAVEN_TESTING.information_schema).
2020-06-30 21:44:35.127311 (ThreadPoolExecutor-2_0): Using snowflake connection "snowflake_sample_data.information_schema".
2020-06-30 21:44:35.127410 (ThreadPoolExecutor-2_0): On snowflake_sample_data.information_schema: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "snowflake_sample_data.information_schema"} */

    
      with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include"

          from snowflake_sample_data.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              null as "table_comment",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              null as "column_comment"

          from snowflake_sample_data.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('tpch_sf1'))
      order by "column_index"
2020-06-30 21:44:38.752359 (ThreadPoolExecutor-2_0): SQL status: SUCCESS 61 in 3.62 seconds
2020-06-30 21:44:38.925582 (MainThread): 16:44:38 | Catalog written to /Users/johnaven/Documents/gitlab_projects/dbt-demo-June-2020/sample_project/target/catalog.json
2020-06-30 21:44:38.925944 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af62050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af62090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af620d0>]}
2020-06-30 21:44:38.926159 (MainThread): Flushing usage events
2020-06-30 21:44:39.328209 (MainThread): Connection 'generate_catalog' was properly closed.
2020-06-30 21:44:39.328345 (MainThread): Connection 'snowflake_sample_data.information_schema' was left open.
2020-06-30 21:44:39.328427 (MainThread): On snowflake_sample_data.information_schema: Close
2020-06-30 21:44:40.554927 (MainThread): Running with dbt=0.17.0
2020-06-30 21:44:40.900193 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', open_browser=True, partial_parse=None, port=8080, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-06-30 21:44:40.901491 (MainThread): Tracking: tracking
2020-06-30 21:44:40.901842 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109085750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac74a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac74950>]}
2020-06-30 21:44:40.903639 (MainThread): Serving docs at 0.0.0.0:8080
2020-06-30 21:44:40.903760 (MainThread): To access from your browser, navigate to:  http://localhost:8080
2020-06-30 21:44:40.903848 (MainThread): Press Ctrl+C to exit.


2020-06-30 21:51:10.904860 (MainThread): Running with dbt=0.17.0
2020-06-30 21:51:11.246495 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2020-06-30 21:51:11.247382 (MainThread): Tracking: tracking
2020-06-30 21:51:11.247758 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c49790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c49910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c49ad0>]}
2020-06-30 21:51:11.273782 (MainThread): Partial parsing not enabled
2020-06-30 21:51:11.276921 (MainThread): Parsing macros/core.sql
2020-06-30 21:51:11.285599 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-30 21:51:11.296070 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-30 21:51:11.298183 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-30 21:51:11.319545 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-30 21:51:11.353938 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-30 21:51:11.381096 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-30 21:51:11.383333 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-30 21:51:11.390708 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-30 21:51:11.406864 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-30 21:51:11.415099 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-30 21:51:11.422865 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-30 21:51:11.429315 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-30 21:51:11.431065 (MainThread): Parsing macros/etc/query.sql
2020-06-30 21:51:11.432972 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-30 21:51:11.436102 (MainThread): Parsing macros/etc/datetime.sql
2020-06-30 21:51:11.448864 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-30 21:51:11.451214 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-30 21:51:11.453148 (MainThread): Parsing macros/adapters/common.sql
2020-06-30 21:51:11.511860 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-30 21:51:11.513393 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-30 21:51:11.514502 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-30 21:51:11.515838 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-30 21:51:11.519321 (MainThread): Parsing macros/catalog.sql
2020-06-30 21:51:11.521819 (MainThread): Parsing macros/adapters.sql
2020-06-30 21:51:11.545751 (MainThread): Parsing macros/materializations/merge.sql
2020-06-30 21:51:11.548760 (MainThread): Parsing macros/materializations/view.sql
2020-06-30 21:51:11.550211 (MainThread): Parsing macros/materializations/table.sql
2020-06-30 21:51:11.554984 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-30 21:51:11.596819 (MainThread): Partial parsing not enabled
2020-06-30 21:51:11.597550 (MainThread): Parsing macros/discounted_price.sql
2020-06-30 21:51:11.598531 (MainThread): Parsing macros/tax_charged.sql
2020-06-30 21:51:11.599550 (MainThread): Parsing macros/full_charge.sql
2020-06-30 21:51:11.600597 (MainThread): Parsing macros/test_is_nonnegative.sql
2020-06-30 21:51:11.604676 (MainThread): Parsing macros/cross_db_utils/except.sql
2020-06-30 21:51:11.606176 (MainThread): Parsing macros/cross_db_utils/replace.sql
2020-06-30 21:51:11.607663 (MainThread): Parsing macros/cross_db_utils/concat.sql
2020-06-30 21:51:11.610670 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2020-06-30 21:51:11.617096 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2020-06-30 21:51:11.618568 (MainThread): Parsing macros/cross_db_utils/length.sql
2020-06-30 21:51:11.620268 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2020-06-30 21:51:11.623343 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2020-06-30 21:51:11.624647 (MainThread): Parsing macros/cross_db_utils/right.sql
2020-06-30 21:51:11.627231 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2020-06-30 21:51:11.638849 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2020-06-30 21:51:11.641688 (MainThread): Parsing macros/cross_db_utils/hash.sql
2020-06-30 21:51:11.643782 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2020-06-30 21:51:11.645516 (MainThread): Parsing macros/cross_db_utils/position.sql
2020-06-30 21:51:11.647686 (MainThread): Parsing macros/cross_db_utils/literal.sql
2020-06-30 21:51:11.648947 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2020-06-30 21:51:11.652737 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2020-06-30 21:51:11.659695 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2020-06-30 21:51:11.663142 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2020-06-30 21:51:11.665297 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2020-06-30 21:51:11.667686 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2020-06-30 21:51:11.693654 (MainThread): Parsing macros/logger/pretty_log_format.sql
2020-06-30 21:51:11.694511 (MainThread): Parsing macros/logger/pretty_time.sql
2020-06-30 21:51:11.695436 (MainThread): Parsing macros/logger/log_info.sql
2020-06-30 21:51:11.696268 (MainThread): Parsing macros/datetime/date_spine.sql
2020-06-30 21:51:11.700050 (MainThread): Parsing macros/web/get_url_host.sql
2020-06-30 21:51:11.702247 (MainThread): Parsing macros/web/get_url_path.sql
2020-06-30 21:51:11.704828 (MainThread): Parsing macros/web/get_url_parameter.sql
2020-06-30 21:51:11.706129 (MainThread): Parsing macros/geo/haversine_distance.sql
2020-06-30 21:51:11.707277 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2020-06-30 21:51:11.708807 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2020-06-30 21:51:11.711435 (MainThread): Parsing macros/schema_tests/recency.sql
2020-06-30 21:51:11.712982 (MainThread): Parsing macros/schema_tests/not_constant.sql
2020-06-30 21:51:11.714131 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2020-06-30 21:51:11.715478 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2020-06-30 21:51:11.716894 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2020-06-30 21:51:11.718776 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2020-06-30 21:51:11.720137 (MainThread): Parsing macros/schema_tests/equality.sql
2020-06-30 21:51:11.723698 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2020-06-30 21:51:11.730855 (MainThread): Parsing macros/sql/nullcheck_table.sql
2020-06-30 21:51:11.732195 (MainThread): Parsing macros/sql/generate_series.sql
2020-06-30 21:51:11.736170 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2020-06-30 21:51:11.740580 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2020-06-30 21:51:11.743587 (MainThread): Parsing macros/sql/star.sql
2020-06-30 21:51:11.746530 (MainThread): Parsing macros/sql/unpivot.sql
2020-06-30 21:51:11.753037 (MainThread): Parsing macros/sql/union.sql
2020-06-30 21:51:11.764218 (MainThread): Parsing macros/sql/groupby.sql
2020-06-30 21:51:11.765691 (MainThread): Parsing macros/sql/surrogate_key.sql
2020-06-30 21:51:11.768978 (MainThread): Parsing macros/sql/safe_add.sql
2020-06-30 21:51:11.770281 (MainThread): Parsing macros/sql/nullcheck.sql
2020-06-30 21:51:11.771683 (MainThread): Parsing macros/sql/get_column_values.sql
2020-06-30 21:51:11.776879 (MainThread): Parsing macros/sql/pivot.sql
2020-06-30 21:51:11.780011 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2020-06-30 21:51:11.826661 (MainThread): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 21:51:11.826779 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:51:11.857865 (MainThread): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 21:51:11.857971 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:51:11.869804 (MainThread): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 21:51:11.869898 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:51:11.881572 (MainThread): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 21:51:11.881664 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:51:11.895239 (MainThread): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 21:51:11.895357 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:51:11.909872 (MainThread): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 21:51:11.909979 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:51:11.922864 (MainThread): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 21:51:11.923067 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:51:11.938194 (MainThread): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 21:51:11.938306 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:51:11.952091 (MainThread): Acquiring new snowflake connection "model.sample_project.sales_report_one".
2020-06-30 21:51:11.952195 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:51:11.969921 (MainThread): Acquiring new snowflake connection "model.sample_project.order_statistics".
2020-06-30 21:51:11.970024 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:51:11.985863 (MainThread): Acquiring new snowflake connection "model.sample_project.sales_report_two".
2020-06-30 21:51:11.985974 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:51:12.481008 (MainThread): Found 11 models, 8 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 4 sources
2020-06-30 21:51:12.482707 (MainThread): 
2020-06-30 21:51:12.482994 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 21:51:12.483083 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:51:12.507594 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 21:51:12.507782 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-06-30 21:51:12.520809 (ThreadPoolExecutor-1_0): Using snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 21:51:12.520909 (ThreadPoolExecutor-1_0): On list_JAVEN_TESTING_TEST: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING_TEST"} */

    show terse objects in JAVEN_TESTING.TEST
2020-06-30 21:51:13.037741 (ThreadPoolExecutor-1_0): unclosed file <_io.BufferedReader name='/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/certifi/cacert.pem'>
2020-06-30 21:51:17.709431 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 11 in 5.19 seconds
2020-06-30 21:51:17.722247 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 21:51:17.722350 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:51:17.722659 (MainThread): 16:51:17 | Concurrency: 1 threads (target='dev')
2020-06-30 21:51:17.722778 (MainThread): 16:51:17 | 
2020-06-30 21:51:17.723608 (Thread-1): Began running node model.sample_project.customer
2020-06-30 21:51:17.723873 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 21:51:17.723962 (Thread-1): Re-using an available connection from the pool (formerly list_JAVEN_TESTING_TEST).
2020-06-30 21:51:17.724053 (Thread-1): Compiling model.sample_project.customer
2020-06-30 21:51:17.740076 (Thread-1): Writing injected SQL for node "model.sample_project.customer"
2020-06-30 21:51:17.740419 (Thread-1): finished collecting timing info
2020-06-30 21:51:17.740785 (Thread-1): Finished running node model.sample_project.customer
2020-06-30 21:51:17.740907 (Thread-1): Began running node model.sample_project.lineitem
2020-06-30 21:51:17.741203 (Thread-1): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 21:51:17.741299 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer).
2020-06-30 21:51:17.741385 (Thread-1): Compiling model.sample_project.lineitem
2020-06-30 21:51:17.748052 (Thread-1): Writing injected SQL for node "model.sample_project.lineitem"
2020-06-30 21:51:17.748359 (Thread-1): finished collecting timing info
2020-06-30 21:51:17.748713 (Thread-1): Finished running node model.sample_project.lineitem
2020-06-30 21:51:17.748837 (Thread-1): Began running node model.sample_project.nation
2020-06-30 21:51:17.749127 (Thread-1): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 21:51:17.749226 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.lineitem).
2020-06-30 21:51:17.749314 (Thread-1): Compiling model.sample_project.nation
2020-06-30 21:51:17.756255 (Thread-1): Writing injected SQL for node "model.sample_project.nation"
2020-06-30 21:51:17.756950 (Thread-1): finished collecting timing info
2020-06-30 21:51:17.757394 (Thread-1): Finished running node model.sample_project.nation
2020-06-30 21:51:17.757520 (Thread-1): Began running node model.sample_project.orders
2020-06-30 21:51:17.757824 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 21:51:17.758010 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.nation).
2020-06-30 21:51:17.758107 (Thread-1): Compiling model.sample_project.orders
2020-06-30 21:51:17.765920 (Thread-1): Writing injected SQL for node "model.sample_project.orders"
2020-06-30 21:51:17.766244 (Thread-1): finished collecting timing info
2020-06-30 21:51:17.766673 (Thread-1): Finished running node model.sample_project.orders
2020-06-30 21:51:17.766802 (Thread-1): Began running node test.sample_project.source_is_nonnegative_tpch_customer_c_custkey
2020-06-30 21:51:17.767063 (Thread-1): 16:51:17 | 1 of 8 START test source_is_nonnegative_tpch_customer_c_custkey...... [RUN]
2020-06-30 21:51:17.767334 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_nonnegative_tpch_customer_c_custkey".
2020-06-30 21:51:17.767423 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders).
2020-06-30 21:51:17.767507 (Thread-1): Compiling test.sample_project.source_is_nonnegative_tpch_customer_c_custkey
2020-06-30 21:51:17.786603 (Thread-1): Writing injected SQL for node "test.sample_project.source_is_nonnegative_tpch_customer_c_custkey"
2020-06-30 21:51:17.786983 (Thread-1): finished collecting timing info
2020-06-30 21:51:17.787772 (Thread-1): Using snowflake connection "test.sample_project.source_is_nonnegative_tpch_customer_c_custkey".
2020-06-30 21:51:17.787926 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_customer_c_custkey: BEGIN
2020-06-30 21:51:18.102707 (Thread-1): SQL status: SUCCESS 1 in 0.31 seconds
2020-06-30 21:51:18.102848 (Thread-1): Using snowflake connection "test.sample_project.source_is_nonnegative_tpch_customer_c_custkey".
2020-06-30 21:51:18.102950 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_customer_c_custkey: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "test.sample_project.source_is_nonnegative_tpch_customer_c_custkey"} */


with validation as (

    select
        c_custkey as negative

    from snowflake_sample_data.tpch_sf1.customer

),

validation_errors as (

    select
        negative

    from validation
    -- if this is true, negative will have a non-zero count
    where negative < 0

)

select count(*)
from validation_errors
2020-06-30 21:51:18.364500 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2020-06-30 21:51:18.364813 (Thread-1): finished collecting timing info
2020-06-30 21:51:18.365048 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_customer_c_custkey: ROLLBACK
2020-06-30 21:51:18.365127 (Thread-1): initiating rollback
2020-06-30 21:51:18.651203 (Thread-1): 16:51:18 | 1 of 8 PASS source_is_nonnegative_tpch_customer_c_custkey............ [PASS in 0.88s]
2020-06-30 21:51:18.651386 (Thread-1): Finished running node test.sample_project.source_is_nonnegative_tpch_customer_c_custkey
2020-06-30 21:51:18.651536 (Thread-1): Began running node test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey
2020-06-30 21:51:18.651792 (Thread-1): 16:51:18 | 2 of 8 START test source_is_nonnegative_tpch_customer_c_nationkey.... [RUN]
2020-06-30 21:51:18.652106 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey".
2020-06-30 21:51:18.652220 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_nonnegative_tpch_customer_c_custkey).
2020-06-30 21:51:18.652325 (Thread-1): Compiling test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey
2020-06-30 21:51:18.661545 (Thread-1): Writing injected SQL for node "test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey"
2020-06-30 21:51:18.662109 (Thread-1): finished collecting timing info
2020-06-30 21:51:18.662913 (Thread-1): Using snowflake connection "test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey".
2020-06-30 21:51:18.663011 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey: BEGIN
2020-06-30 21:51:18.885751 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2020-06-30 21:51:18.885912 (Thread-1): Using snowflake connection "test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey".
2020-06-30 21:51:18.886009 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey"} */


with validation as (

    select
        c_nationkey as negative

    from snowflake_sample_data.tpch_sf1.customer

),

validation_errors as (

    select
        negative

    from validation
    -- if this is true, negative will have a non-zero count
    where negative < 0

)

select count(*)
from validation_errors
2020-06-30 21:51:19.155626 (Thread-1): SQL status: SUCCESS 1 in 0.27 seconds
2020-06-30 21:51:19.155998 (Thread-1): finished collecting timing info
2020-06-30 21:51:19.156292 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey: ROLLBACK
2020-06-30 21:51:19.156435 (Thread-1): initiating rollback
2020-06-30 21:51:19.423684 (Thread-1): 16:51:19 | 2 of 8 PASS source_is_nonnegative_tpch_customer_c_nationkey.......... [PASS in 0.77s]
2020-06-30 21:51:19.423866 (Thread-1): Finished running node test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey
2020-06-30 21:51:19.424018 (Thread-1): Began running node test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice
2020-06-30 21:51:19.424253 (Thread-1): 16:51:19 | 3 of 8 START test source_is_nonnegative_tpch_lineitem_l_extendedprice [RUN]
2020-06-30 21:51:19.424588 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice".
2020-06-30 21:51:19.424697 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey).
2020-06-30 21:51:19.424796 (Thread-1): Compiling test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice
2020-06-30 21:51:19.435034 (Thread-1): Writing injected SQL for node "test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice"
2020-06-30 21:51:19.435463 (Thread-1): finished collecting timing info
2020-06-30 21:51:19.436191 (Thread-1): Using snowflake connection "test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice".
2020-06-30 21:51:19.436296 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice: BEGIN
2020-06-30 21:51:19.640991 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2020-06-30 21:51:19.641195 (Thread-1): Using snowflake connection "test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice".
2020-06-30 21:51:19.641312 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice"} */


with validation as (

    select
        l_extendedprice as negative

    from snowflake_sample_data.tpch_sf1.lineitem

),

validation_errors as (

    select
        negative

    from validation
    -- if this is true, negative will have a non-zero count
    where negative < 0

)

select count(*)
from validation_errors
2020-06-30 21:51:19.874170 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2020-06-30 21:51:19.874481 (Thread-1): finished collecting timing info
2020-06-30 21:51:19.874754 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice: ROLLBACK
2020-06-30 21:51:19.874848 (Thread-1): initiating rollback
2020-06-30 21:51:20.133886 (Thread-1): 16:51:20 | 3 of 8 PASS source_is_nonnegative_tpch_lineitem_l_extendedprice...... [PASS in 0.71s]
2020-06-30 21:51:20.134053 (Thread-1): Finished running node test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice
2020-06-30 21:51:20.134182 (Thread-1): Began running node test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey
2020-06-30 21:51:20.134369 (Thread-1): 16:51:20 | 4 of 8 START test source_is_nonnegative_tpch_nation_n_nationkey...... [RUN]
2020-06-30 21:51:20.134597 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey".
2020-06-30 21:51:20.134678 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice).
2020-06-30 21:51:20.134761 (Thread-1): Compiling test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey
2020-06-30 21:51:20.145855 (Thread-1): Writing injected SQL for node "test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey"
2020-06-30 21:51:20.146443 (Thread-1): finished collecting timing info
2020-06-30 21:51:20.147562 (Thread-1): Using snowflake connection "test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey".
2020-06-30 21:51:20.147766 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey: BEGIN
2020-06-30 21:51:20.348231 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2020-06-30 21:51:20.348384 (Thread-1): Using snowflake connection "test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey".
2020-06-30 21:51:20.348479 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey"} */


with validation as (

    select
        n_nationkey as negative

    from snowflake_sample_data.tpch_sf1.nation

),

validation_errors as (

    select
        negative

    from validation
    -- if this is true, negative will have a non-zero count
    where negative < 0

)

select count(*)
from validation_errors
2020-06-30 21:51:20.576084 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2020-06-30 21:51:20.576420 (Thread-1): finished collecting timing info
2020-06-30 21:51:20.576695 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey: ROLLBACK
2020-06-30 21:51:20.576788 (Thread-1): initiating rollback
2020-06-30 21:51:20.815472 (Thread-1): 16:51:20 | 4 of 8 PASS source_is_nonnegative_tpch_nation_n_nationkey............ [PASS in 0.68s]
2020-06-30 21:51:20.815658 (Thread-1): Finished running node test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey
2020-06-30 21:51:20.815805 (Thread-1): Began running node test.sample_project.source_is_nonnegative_tpch_orders_o_custkey
2020-06-30 21:51:20.816021 (Thread-1): 16:51:20 | 5 of 8 START test source_is_nonnegative_tpch_orders_o_custkey........ [RUN]
2020-06-30 21:51:20.816286 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_nonnegative_tpch_orders_o_custkey".
2020-06-30 21:51:20.816380 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey).
2020-06-30 21:51:20.816476 (Thread-1): Compiling test.sample_project.source_is_nonnegative_tpch_orders_o_custkey
2020-06-30 21:51:20.826124 (Thread-1): Writing injected SQL for node "test.sample_project.source_is_nonnegative_tpch_orders_o_custkey"
2020-06-30 21:51:20.826504 (Thread-1): finished collecting timing info
2020-06-30 21:51:20.827108 (Thread-1): Using snowflake connection "test.sample_project.source_is_nonnegative_tpch_orders_o_custkey".
2020-06-30 21:51:20.827202 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_orders_o_custkey: BEGIN
2020-06-30 21:51:21.042629 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2020-06-30 21:51:21.042799 (Thread-1): Using snowflake connection "test.sample_project.source_is_nonnegative_tpch_orders_o_custkey".
2020-06-30 21:51:21.042912 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_orders_o_custkey: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "test.sample_project.source_is_nonnegative_tpch_orders_o_custkey"} */


with validation as (

    select
        o_custkey as negative

    from snowflake_sample_data.tpch_sf1.orders

),

validation_errors as (

    select
        negative

    from validation
    -- if this is true, negative will have a non-zero count
    where negative < 0

)

select count(*)
from validation_errors
2020-06-30 21:51:21.276144 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2020-06-30 21:51:21.276551 (Thread-1): finished collecting timing info
2020-06-30 21:51:21.276928 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_orders_o_custkey: ROLLBACK
2020-06-30 21:51:21.277060 (Thread-1): initiating rollback
2020-06-30 21:51:21.542551 (Thread-1): 16:51:21 | 5 of 8 PASS source_is_nonnegative_tpch_orders_o_custkey.............. [PASS in 0.73s]
2020-06-30 21:51:21.542726 (Thread-1): Finished running node test.sample_project.source_is_nonnegative_tpch_orders_o_custkey
2020-06-30 21:51:21.542869 (Thread-1): Began running node test.sample_project.source_unique_tpch_customer_c_custkey
2020-06-30 21:51:21.542998 (Thread-1): 16:51:21 | 6 of 8 START test source_unique_tpch_customer_c_custkey.............. [RUN]
2020-06-30 21:51:21.543372 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_unique_tpch_customer_c_custkey".
2020-06-30 21:51:21.543480 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_nonnegative_tpch_orders_o_custkey).
2020-06-30 21:51:21.543579 (Thread-1): Compiling test.sample_project.source_unique_tpch_customer_c_custkey
2020-06-30 21:51:21.553098 (Thread-1): Writing injected SQL for node "test.sample_project.source_unique_tpch_customer_c_custkey"
2020-06-30 21:51:21.553466 (Thread-1): finished collecting timing info
2020-06-30 21:51:21.554017 (Thread-1): Using snowflake connection "test.sample_project.source_unique_tpch_customer_c_custkey".
2020-06-30 21:51:21.554109 (Thread-1): On test.sample_project.source_unique_tpch_customer_c_custkey: BEGIN
2020-06-30 21:51:21.788514 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2020-06-30 21:51:21.788748 (Thread-1): Using snowflake connection "test.sample_project.source_unique_tpch_customer_c_custkey".
2020-06-30 21:51:21.788928 (Thread-1): On test.sample_project.source_unique_tpch_customer_c_custkey: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "test.sample_project.source_unique_tpch_customer_c_custkey"} */




select count(*) as validation_errors
from (

    select
        c_custkey

    from snowflake_sample_data.tpch_sf1.customer
    where c_custkey is not null
    group by c_custkey
    having count(*) > 1

) validation_errors
2020-06-30 21:51:22.058489 (Thread-1): SQL status: SUCCESS 1 in 0.27 seconds
2020-06-30 21:51:22.058793 (Thread-1): finished collecting timing info
2020-06-30 21:51:22.059059 (Thread-1): On test.sample_project.source_unique_tpch_customer_c_custkey: ROLLBACK
2020-06-30 21:51:22.059149 (Thread-1): initiating rollback
2020-06-30 21:51:22.343337 (Thread-1): 16:51:22 | 6 of 8 PASS source_unique_tpch_customer_c_custkey.................... [PASS in 0.80s]
2020-06-30 21:51:22.343620 (Thread-1): Finished running node test.sample_project.source_unique_tpch_customer_c_custkey
2020-06-30 21:51:22.343825 (Thread-1): Began running node test.sample_project.source_unique_tpch_nation_n_nationkey
2020-06-30 21:51:22.344296 (Thread-1): 16:51:22 | 7 of 8 START test source_unique_tpch_nation_n_nationkey.............. [RUN]
2020-06-30 21:51:22.344696 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_unique_tpch_nation_n_nationkey".
2020-06-30 21:51:22.344786 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_unique_tpch_customer_c_custkey).
2020-06-30 21:51:22.344871 (Thread-1): Compiling test.sample_project.source_unique_tpch_nation_n_nationkey
2020-06-30 21:51:22.353734 (Thread-1): Writing injected SQL for node "test.sample_project.source_unique_tpch_nation_n_nationkey"
2020-06-30 21:51:22.354058 (Thread-1): finished collecting timing info
2020-06-30 21:51:22.354675 (Thread-1): Using snowflake connection "test.sample_project.source_unique_tpch_nation_n_nationkey".
2020-06-30 21:51:22.354761 (Thread-1): On test.sample_project.source_unique_tpch_nation_n_nationkey: BEGIN
2020-06-30 21:51:22.649249 (Thread-1): SQL status: SUCCESS 1 in 0.29 seconds
2020-06-30 21:51:22.649409 (Thread-1): Using snowflake connection "test.sample_project.source_unique_tpch_nation_n_nationkey".
2020-06-30 21:51:22.649507 (Thread-1): On test.sample_project.source_unique_tpch_nation_n_nationkey: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "test.sample_project.source_unique_tpch_nation_n_nationkey"} */




select count(*) as validation_errors
from (

    select
        n_nationkey

    from snowflake_sample_data.tpch_sf1.nation
    where n_nationkey is not null
    group by n_nationkey
    having count(*) > 1

) validation_errors
2020-06-30 21:51:22.880186 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2020-06-30 21:51:22.880505 (Thread-1): finished collecting timing info
2020-06-30 21:51:22.880797 (Thread-1): On test.sample_project.source_unique_tpch_nation_n_nationkey: ROLLBACK
2020-06-30 21:51:22.880889 (Thread-1): initiating rollback
2020-06-30 21:51:23.210539 (Thread-1): 16:51:23 | 7 of 8 PASS source_unique_tpch_nation_n_nationkey.................... [PASS in 0.87s]
2020-06-30 21:51:23.210732 (Thread-1): Finished running node test.sample_project.source_unique_tpch_nation_n_nationkey
2020-06-30 21:51:23.210888 (Thread-1): Began running node test.sample_project.source_unique_tpch_orders_o_orderkey
2020-06-30 21:51:23.211098 (Thread-1): 16:51:23 | 8 of 8 START test source_unique_tpch_orders_o_orderkey............... [RUN]
2020-06-30 21:51:23.211352 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_unique_tpch_orders_o_orderkey".
2020-06-30 21:51:23.211445 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_unique_tpch_nation_n_nationkey).
2020-06-30 21:51:23.211541 (Thread-1): Compiling test.sample_project.source_unique_tpch_orders_o_orderkey
2020-06-30 21:51:23.220988 (Thread-1): Writing injected SQL for node "test.sample_project.source_unique_tpch_orders_o_orderkey"
2020-06-30 21:51:23.221349 (Thread-1): finished collecting timing info
2020-06-30 21:51:23.221938 (Thread-1): Using snowflake connection "test.sample_project.source_unique_tpch_orders_o_orderkey".
2020-06-30 21:51:23.222038 (Thread-1): On test.sample_project.source_unique_tpch_orders_o_orderkey: BEGIN
2020-06-30 21:51:23.454016 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2020-06-30 21:51:23.454184 (Thread-1): Using snowflake connection "test.sample_project.source_unique_tpch_orders_o_orderkey".
2020-06-30 21:51:23.454366 (Thread-1): On test.sample_project.source_unique_tpch_orders_o_orderkey: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "test.sample_project.source_unique_tpch_orders_o_orderkey"} */




select count(*) as validation_errors
from (

    select
        o_orderkey

    from snowflake_sample_data.tpch_sf1.orders
    where o_orderkey is not null
    group by o_orderkey
    having count(*) > 1

) validation_errors
2020-06-30 21:51:23.751249 (Thread-1): SQL status: SUCCESS 1 in 0.30 seconds
2020-06-30 21:51:23.751571 (Thread-1): finished collecting timing info
2020-06-30 21:51:23.751839 (Thread-1): On test.sample_project.source_unique_tpch_orders_o_orderkey: ROLLBACK
2020-06-30 21:51:23.751930 (Thread-1): initiating rollback
2020-06-30 21:51:24.041844 (Thread-1): 16:51:24 | 8 of 8 PASS source_unique_tpch_orders_o_orderkey..................... [PASS in 0.83s]
2020-06-30 21:51:24.042051 (Thread-1): Finished running node test.sample_project.source_unique_tpch_orders_o_orderkey
2020-06-30 21:51:24.042218 (Thread-1): Began running node model.sample_project.customer_nation
2020-06-30 21:51:24.042856 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 21:51:24.042985 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_unique_tpch_orders_o_orderkey).
2020-06-30 21:51:24.043099 (Thread-1): Compiling model.sample_project.customer_nation
2020-06-30 21:51:24.054764 (Thread-1): Writing injected SQL for node "model.sample_project.customer_nation"
2020-06-30 21:51:24.055126 (Thread-1): finished collecting timing info
2020-06-30 21:51:24.055518 (Thread-1): Finished running node model.sample_project.customer_nation
2020-06-30 21:51:24.055653 (Thread-1): Began running node model.sample_project.orders_lineitem
2020-06-30 21:51:24.056029 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 21:51:24.056155 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer_nation).
2020-06-30 21:51:24.056253 (Thread-1): Compiling model.sample_project.orders_lineitem
2020-06-30 21:51:24.069458 (Thread-1): Writing injected SQL for node "model.sample_project.orders_lineitem"
2020-06-30 21:51:24.069886 (Thread-1): finished collecting timing info
2020-06-30 21:51:24.070394 (Thread-1): Finished running node model.sample_project.orders_lineitem
2020-06-30 21:51:24.070547 (Thread-1): Began running node model.sample_project.customers_per_nation
2020-06-30 21:51:24.070886 (Thread-1): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 21:51:24.071022 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders_lineitem).
2020-06-30 21:51:24.071103 (Thread-1): Compiling model.sample_project.customers_per_nation
2020-06-30 21:51:24.082501 (Thread-1): Writing injected SQL for node "model.sample_project.customers_per_nation"
2020-06-30 21:51:24.082853 (Thread-1): finished collecting timing info
2020-06-30 21:51:24.083476 (Thread-1): Finished running node model.sample_project.customers_per_nation
2020-06-30 21:51:24.083749 (Thread-1): Began running node model.sample_project.cust_list_ord_nat
2020-06-30 21:51:24.084077 (Thread-1): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 21:51:24.084198 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customers_per_nation).
2020-06-30 21:51:24.084276 (Thread-1): Compiling model.sample_project.cust_list_ord_nat
2020-06-30 21:51:24.099361 (Thread-1): Writing injected SQL for node "model.sample_project.cust_list_ord_nat"
2020-06-30 21:51:24.099903 (Thread-1): finished collecting timing info
2020-06-30 21:51:24.100603 (Thread-1): Finished running node model.sample_project.cust_list_ord_nat
2020-06-30 21:51:24.187677 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 21:51:24.187809 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:51:24.188038 (MainThread): 16:51:24 | 
2020-06-30 21:51:24.188147 (MainThread): 16:51:24 | Finished running 8 tests in 11.71s.
2020-06-30 21:51:24.188240 (MainThread): Connection 'master' was properly closed.
2020-06-30 21:51:24.188310 (MainThread): Connection 'model.sample_project.cust_list_ord_nat' was left open.
2020-06-30 21:51:24.188379 (MainThread): On model.sample_project.cust_list_ord_nat: Close
2020-06-30 21:51:24.647345 (MainThread): 
2020-06-30 21:51:24.647516 (MainThread): Completed successfully
2020-06-30 21:51:24.647639 (MainThread): 
Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
2020-06-30 21:51:24.647812 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f495d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f8f190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1149f1a50>]}
2020-06-30 21:51:24.648090 (MainThread): Flushing usage events
2020-06-30 21:55:40.535387 (MainThread): Flushing usage events
2020-06-30 21:55:41.039520 (MainThread): ctrl-c
2020-06-30 21:55:52.909584 (MainThread): Running with dbt=0.17.0
2020-06-30 21:55:53.248566 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-06-30 21:55:53.249672 (MainThread): Tracking: tracking
2020-06-30 21:55:53.249955 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b797910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7aee50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7aea50>]}
2020-06-30 21:55:53.271391 (MainThread): Partial parsing not enabled
2020-06-30 21:55:53.273635 (MainThread): Parsing macros/core.sql
2020-06-30 21:55:53.278389 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-30 21:55:53.287594 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-30 21:55:53.289657 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-30 21:55:53.308891 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-30 21:55:53.340848 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-30 21:55:53.363950 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-30 21:55:53.366089 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-30 21:55:53.373259 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-30 21:55:53.388301 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-30 21:55:53.395872 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-30 21:55:53.403129 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-30 21:55:53.408483 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-30 21:55:53.409504 (MainThread): Parsing macros/etc/query.sql
2020-06-30 21:55:53.410660 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-30 21:55:53.412589 (MainThread): Parsing macros/etc/datetime.sql
2020-06-30 21:55:53.423246 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-30 21:55:53.426036 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-30 21:55:53.427919 (MainThread): Parsing macros/adapters/common.sql
2020-06-30 21:55:53.482911 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-30 21:55:53.484452 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-30 21:55:53.485847 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-30 21:55:53.486979 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-30 21:55:53.489635 (MainThread): Parsing macros/catalog.sql
2020-06-30 21:55:53.491574 (MainThread): Parsing macros/adapters.sql
2020-06-30 21:55:53.516400 (MainThread): Parsing macros/materializations/merge.sql
2020-06-30 21:55:53.518477 (MainThread): Parsing macros/materializations/view.sql
2020-06-30 21:55:53.519913 (MainThread): Parsing macros/materializations/table.sql
2020-06-30 21:55:53.524150 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-30 21:55:53.564409 (MainThread): Partial parsing not enabled
2020-06-30 21:55:53.564803 (MainThread): Parsing macros/discounted_price.sql
2020-06-30 21:55:53.565532 (MainThread): Parsing macros/tax_charged.sql
2020-06-30 21:55:53.566321 (MainThread): Parsing macros/full_charge.sql
2020-06-30 21:55:53.567143 (MainThread): Parsing macros/test_is_nonnegative.sql
2020-06-30 21:55:53.569716 (MainThread): Parsing macros/cross_db_utils/except.sql
2020-06-30 21:55:53.570830 (MainThread): Parsing macros/cross_db_utils/replace.sql
2020-06-30 21:55:53.572125 (MainThread): Parsing macros/cross_db_utils/concat.sql
2020-06-30 21:55:53.574723 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2020-06-30 21:55:53.580784 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2020-06-30 21:55:53.582084 (MainThread): Parsing macros/cross_db_utils/length.sql
2020-06-30 21:55:53.583575 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2020-06-30 21:55:53.586049 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2020-06-30 21:55:53.587220 (MainThread): Parsing macros/cross_db_utils/right.sql
2020-06-30 21:55:53.589977 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2020-06-30 21:55:53.600665 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2020-06-30 21:55:53.602878 (MainThread): Parsing macros/cross_db_utils/hash.sql
2020-06-30 21:55:53.604409 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2020-06-30 21:55:53.605957 (MainThread): Parsing macros/cross_db_utils/position.sql
2020-06-30 21:55:53.607555 (MainThread): Parsing macros/cross_db_utils/literal.sql
2020-06-30 21:55:53.608504 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2020-06-30 21:55:53.612178 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2020-06-30 21:55:53.619115 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2020-06-30 21:55:53.622409 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2020-06-30 21:55:53.624457 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2020-06-30 21:55:53.626135 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2020-06-30 21:55:53.652915 (MainThread): Parsing macros/logger/pretty_log_format.sql
2020-06-30 21:55:53.653640 (MainThread): Parsing macros/logger/pretty_time.sql
2020-06-30 21:55:53.654551 (MainThread): Parsing macros/logger/log_info.sql
2020-06-30 21:55:53.655280 (MainThread): Parsing macros/datetime/date_spine.sql
2020-06-30 21:55:53.658939 (MainThread): Parsing macros/web/get_url_host.sql
2020-06-30 21:55:53.660459 (MainThread): Parsing macros/web/get_url_path.sql
2020-06-30 21:55:53.663260 (MainThread): Parsing macros/web/get_url_parameter.sql
2020-06-30 21:55:53.664599 (MainThread): Parsing macros/geo/haversine_distance.sql
2020-06-30 21:55:53.665952 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2020-06-30 21:55:53.667382 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2020-06-30 21:55:53.669625 (MainThread): Parsing macros/schema_tests/recency.sql
2020-06-30 21:55:53.671040 (MainThread): Parsing macros/schema_tests/not_constant.sql
2020-06-30 21:55:53.672139 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2020-06-30 21:55:53.673235 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2020-06-30 21:55:53.674482 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2020-06-30 21:55:53.676137 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2020-06-30 21:55:53.677260 (MainThread): Parsing macros/schema_tests/equality.sql
2020-06-30 21:55:53.680423 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2020-06-30 21:55:53.686846 (MainThread): Parsing macros/sql/nullcheck_table.sql
2020-06-30 21:55:53.687904 (MainThread): Parsing macros/sql/generate_series.sql
2020-06-30 21:55:53.691532 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2020-06-30 21:55:53.695496 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2020-06-30 21:55:53.698281 (MainThread): Parsing macros/sql/star.sql
2020-06-30 21:55:53.701089 (MainThread): Parsing macros/sql/unpivot.sql
2020-06-30 21:55:53.707658 (MainThread): Parsing macros/sql/union.sql
2020-06-30 21:55:53.717792 (MainThread): Parsing macros/sql/groupby.sql
2020-06-30 21:55:53.718750 (MainThread): Parsing macros/sql/surrogate_key.sql
2020-06-30 21:55:53.721549 (MainThread): Parsing macros/sql/safe_add.sql
2020-06-30 21:55:53.722630 (MainThread): Parsing macros/sql/nullcheck.sql
2020-06-30 21:55:53.724301 (MainThread): Parsing macros/sql/get_column_values.sql
2020-06-30 21:55:53.729776 (MainThread): Parsing macros/sql/pivot.sql
2020-06-30 21:55:53.732491 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2020-06-30 21:55:53.784328 (MainThread): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 21:55:53.784451 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:55:53.816403 (MainThread): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 21:55:53.816565 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:55:53.831726 (MainThread): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 21:55:53.831870 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:55:53.845427 (MainThread): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 21:55:53.845532 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:55:53.857969 (MainThread): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 21:55:53.858068 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:55:53.871587 (MainThread): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 21:55:53.871684 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:55:53.884391 (MainThread): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 21:55:53.884484 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:55:53.898109 (MainThread): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 21:55:53.898202 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:55:53.910809 (MainThread): Acquiring new snowflake connection "model.sample_project.sales_report_one".
2020-06-30 21:55:53.910971 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:55:53.928473 (MainThread): Acquiring new snowflake connection "model.sample_project.order_statistics".
2020-06-30 21:55:53.928577 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:55:53.945213 (MainThread): Acquiring new snowflake connection "model.sample_project.sales_report_two".
2020-06-30 21:55:53.945311 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:55:54.434084 (MainThread): Found 11 models, 8 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 4 sources
2020-06-30 21:55:54.435916 (MainThread): 
2020-06-30 21:55:54.436203 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 21:55:54.436287 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:55:54.441210 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_JAVEN_TESTING".
2020-06-30 21:55:54.441488 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-06-30 21:55:54.457542 (ThreadPoolExecutor-0_0): Using snowflake connection "list_JAVEN_TESTING".
2020-06-30 21:55:54.457664 (ThreadPoolExecutor-0_0): On list_JAVEN_TESTING: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING"} */

    show terse schemas in database JAVEN_TESTING
    limit 10000
2020-06-30 21:55:54.963206 (ThreadPoolExecutor-0_0): unclosed file <_io.BufferedReader name='/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/certifi/cacert.pem'>
2020-06-30 21:55:59.905968 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 5.45 seconds
2020-06-30 21:55:59.935680 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 21:55:59.935847 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_JAVEN_TESTING).
2020-06-30 21:55:59.941801 (ThreadPoolExecutor-1_0): Using snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 21:55:59.941891 (ThreadPoolExecutor-1_0): On list_JAVEN_TESTING_TEST: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING_TEST"} */

    show terse objects in JAVEN_TESTING.TEST
2020-06-30 21:56:00.142217 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 11 in 0.20 seconds
2020-06-30 21:56:00.153561 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 21:56:00.153701 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:56:00.153868 (MainThread): Using snowflake connection "master".
2020-06-30 21:56:00.153958 (MainThread): On master: BEGIN
2020-06-30 21:56:04.877267 (MainThread): SQL status: SUCCESS 1 in 4.72 seconds
2020-06-30 21:56:04.877449 (MainThread): On master: COMMIT
2020-06-30 21:56:04.877587 (MainThread): Using snowflake connection "master".
2020-06-30 21:56:04.877678 (MainThread): On master: COMMIT
2020-06-30 21:56:05.210952 (MainThread): SQL status: SUCCESS 1 in 0.33 seconds
2020-06-30 21:56:05.211298 (MainThread): 16:56:05 | Concurrency: 1 threads (target='dev')
2020-06-30 21:56:05.211438 (MainThread): 16:56:05 | 
2020-06-30 21:56:05.212123 (Thread-1): Began running node model.sample_project.customer
2020-06-30 21:56:05.212425 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 21:56:05.212530 (Thread-1): Re-using an available connection from the pool (formerly list_JAVEN_TESTING_TEST).
2020-06-30 21:56:05.212633 (Thread-1): Compiling model.sample_project.customer
2020-06-30 21:56:05.229569 (Thread-1): Writing injected SQL for node "model.sample_project.customer"
2020-06-30 21:56:05.229928 (Thread-1): finished collecting timing info
2020-06-30 21:56:05.230302 (Thread-1): Finished running node model.sample_project.customer
2020-06-30 21:56:05.230423 (Thread-1): Began running node model.sample_project.lineitem
2020-06-30 21:56:05.230714 (Thread-1): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 21:56:05.230811 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer).
2020-06-30 21:56:05.230895 (Thread-1): Compiling model.sample_project.lineitem
2020-06-30 21:56:05.238111 (Thread-1): Writing injected SQL for node "model.sample_project.lineitem"
2020-06-30 21:56:05.238430 (Thread-1): finished collecting timing info
2020-06-30 21:56:05.238794 (Thread-1): Finished running node model.sample_project.lineitem
2020-06-30 21:56:05.238918 (Thread-1): Began running node model.sample_project.nation
2020-06-30 21:56:05.239235 (Thread-1): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 21:56:05.239328 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.lineitem).
2020-06-30 21:56:05.239411 (Thread-1): Compiling model.sample_project.nation
2020-06-30 21:56:05.246521 (Thread-1): Writing injected SQL for node "model.sample_project.nation"
2020-06-30 21:56:05.246837 (Thread-1): finished collecting timing info
2020-06-30 21:56:05.247189 (Thread-1): Finished running node model.sample_project.nation
2020-06-30 21:56:05.247311 (Thread-1): Began running node model.sample_project.orders
2020-06-30 21:56:05.247628 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 21:56:05.247796 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.nation).
2020-06-30 21:56:05.247883 (Thread-1): Compiling model.sample_project.orders
2020-06-30 21:56:05.254921 (Thread-1): Writing injected SQL for node "model.sample_project.orders"
2020-06-30 21:56:05.255213 (Thread-1): finished collecting timing info
2020-06-30 21:56:05.255568 (Thread-1): Finished running node model.sample_project.orders
2020-06-30 21:56:05.255701 (Thread-1): Began running node model.sample_project.customer_nation
2020-06-30 21:56:05.255995 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 21:56:05.256094 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders).
2020-06-30 21:56:05.256180 (Thread-1): Compiling model.sample_project.customer_nation
2020-06-30 21:56:05.266506 (Thread-1): Writing injected SQL for node "model.sample_project.customer_nation"
2020-06-30 21:56:05.266821 (Thread-1): finished collecting timing info
2020-06-30 21:56:05.267169 (Thread-1): Finished running node model.sample_project.customer_nation
2020-06-30 21:56:05.267291 (Thread-1): Began running node model.sample_project.orders_lineitem
2020-06-30 21:56:05.267634 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 21:56:05.267732 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer_nation).
2020-06-30 21:56:05.267824 (Thread-1): Compiling model.sample_project.orders_lineitem
2020-06-30 21:56:05.279951 (Thread-1): Writing injected SQL for node "model.sample_project.orders_lineitem"
2020-06-30 21:56:05.280240 (Thread-1): finished collecting timing info
2020-06-30 21:56:05.280587 (Thread-1): Finished running node model.sample_project.orders_lineitem
2020-06-30 21:56:05.280709 (Thread-1): Began running node model.sample_project.customers_per_nation
2020-06-30 21:56:05.281655 (Thread-1): 16:56:05 | 1 of 4 START view model TEST.customers_per_nation.................... [RUN]
2020-06-30 21:56:05.282028 (Thread-1): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 21:56:05.282121 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders_lineitem).
2020-06-30 21:56:05.282251 (Thread-1): Compiling model.sample_project.customers_per_nation
2020-06-30 21:56:05.291402 (Thread-1): Writing injected SQL for node "model.sample_project.customers_per_nation"
2020-06-30 21:56:05.291690 (Thread-1): finished collecting timing info
2020-06-30 21:56:05.327890 (Thread-1): Using snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 21:56:05.328057 (Thread-1): On model.sample_project.customers_per_nation: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "model.sample_project.customers_per_nation"} */
drop table if exists "JAVEN_TESTING"."TEST"."CUSTOMERS_PER_NATION" cascade
2020-06-30 21:56:05.633116 (Thread-1): SQL status: SUCCESS 1 in 0.30 seconds
2020-06-30 21:56:05.638971 (Thread-1): Writing runtime SQL for node "model.sample_project.customers_per_nation"
2020-06-30 21:56:05.641005 (Thread-1): Using snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 21:56:05.641096 (Thread-1): On model.sample_project.customers_per_nation: BEGIN
2020-06-30 21:56:05.805522 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2020-06-30 21:56:05.805674 (Thread-1): Using snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 21:56:05.805789 (Thread-1): On model.sample_project.customers_per_nation: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "model.sample_project.customers_per_nation"} */

  create or replace  view JAVEN_TESTING.TEST.customers_per_nation  as (
    with __dbt__CTE__customer as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  c_custkey as custkey,
        c_nationkey as nationkey,
        c_name as name
from snowflake_sample_data.tpch_sf1.customer
),  __dbt__CTE__nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  n_nationkey as nationkey,
        n_name as name
from snowflake_sample_data.tpch_sf1.nation
),  __dbt__CTE__customer_nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  c.custkey,
        c.nationkey,
        c.name as customer_name,
        n.name as nation_name
from __dbt__CTE__customer as c
JOIN __dbt__CTE__nation as n
ON c.nationkey=n.nationkey
)/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/



select  count(customer_name) as customer_count,
        nation_name
from __dbt__CTE__customer_nation
group by nation_name
order by nation_name
  );
2020-06-30 21:56:06.452510 (Thread-1): SQL status: SUCCESS 1 in 0.65 seconds
2020-06-30 21:56:06.453733 (Thread-1): On model.sample_project.customers_per_nation: COMMIT
2020-06-30 21:56:06.453907 (Thread-1): Using snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 21:56:06.454002 (Thread-1): On model.sample_project.customers_per_nation: COMMIT
2020-06-30 21:56:06.654300 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2020-06-30 21:56:06.666317 (Thread-1): finished collecting timing info
2020-06-30 21:56:06.667027 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b48c5b9a-b836-4733-b620-38f624a6b583', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c65b8d0>]}
2020-06-30 21:56:06.668155 (Thread-1): 16:56:06 | 1 of 4 OK created view model TEST.customers_per_nation............... [SUCCESS 1 in 1.38s]
2020-06-30 21:56:06.668305 (Thread-1): Finished running node model.sample_project.customers_per_nation
2020-06-30 21:56:06.668452 (Thread-1): Began running node model.sample_project.cust_list_ord_nat
2020-06-30 21:56:06.668977 (Thread-1): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 21:56:06.669092 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customers_per_nation).
2020-06-30 21:56:06.669193 (Thread-1): Compiling model.sample_project.cust_list_ord_nat
2020-06-30 21:56:06.685979 (Thread-1): Writing injected SQL for node "model.sample_project.cust_list_ord_nat"
2020-06-30 21:56:06.686510 (Thread-1): finished collecting timing info
2020-06-30 21:56:06.686999 (Thread-1): Finished running node model.sample_project.cust_list_ord_nat
2020-06-30 21:56:06.687151 (Thread-1): Began running node model.sample_project.order_statistics
2020-06-30 21:56:06.688489 (Thread-1): 16:56:06 | 2 of 4 START table model TEST.order_statistics....................... [RUN]
2020-06-30 21:56:06.689070 (Thread-1): Acquiring new snowflake connection "model.sample_project.order_statistics".
2020-06-30 21:56:06.689197 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.cust_list_ord_nat).
2020-06-30 21:56:06.689300 (Thread-1): Compiling model.sample_project.order_statistics
2020-06-30 21:56:06.707120 (Thread-1): Writing injected SQL for node "model.sample_project.order_statistics"
2020-06-30 21:56:06.708160 (Thread-1): finished collecting timing info
2020-06-30 21:56:06.738761 (Thread-1): Writing runtime SQL for node "model.sample_project.order_statistics"
2020-06-30 21:56:06.744100 (Thread-1): Using snowflake connection "model.sample_project.order_statistics".
2020-06-30 21:56:06.744325 (Thread-1): On model.sample_project.order_statistics: BEGIN
2020-06-30 21:56:06.980705 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2020-06-30 21:56:06.980851 (Thread-1): Using snowflake connection "model.sample_project.order_statistics".
2020-06-30 21:56:06.980933 (Thread-1): On model.sample_project.order_statistics: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "model.sample_project.order_statistics"} */


      create or replace transient table JAVEN_TESTING.TEST.order_statistics  as
      (with __dbt__CTE__orders as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  o_orderkey as orderkey,
        o_custkey as custkey,
        o_totalprice as totalprice,
        o_orderdate as orderdate
from snowflake_sample_data.tpch_sf1.orders
),  __dbt__CTE__lineitem as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  l_orderkey as orderkey,
        l_extendedprice as extendedprice,
        l_discount as discount,
        l_tax as tax,
        l_quantity as quantity
from snowflake_sample_data.tpch_sf1.lineitem
),  __dbt__CTE__orders_lineitem as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  o.orderkey,
        o.custkey,
        o.totalprice,
        o.orderdate,
        l.extendedprice,
        l.discount,
        l.tax,
        l.quantity
from __dbt__CTE__orders as o
JOIN __dbt__CTE__lineitem as l
ON o.orderkey=l.orderkey
)/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  avg(totalprice) as average_order_price,
        sum(quantity) as total_quantity_per_order,
        listagg(quantity, '|~~|') as quantities_per_order,
        count(quantity) as items_per_order,
        
  
    width_bucket(average_order_price, 184000, 200000, 10 )

 as price_histogram,
        orderdate
from __dbt__CTE__orders_lineitem
group by orderdate
      );
2020-06-30 21:56:11.488459 (Thread-1): SQL status: SUCCESS 1 in 4.51 seconds
2020-06-30 21:56:11.489399 (Thread-1): On model.sample_project.order_statistics: COMMIT
2020-06-30 21:56:11.489549 (Thread-1): Using snowflake connection "model.sample_project.order_statistics".
2020-06-30 21:56:11.489641 (Thread-1): On model.sample_project.order_statistics: COMMIT
2020-06-30 21:56:11.734214 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2020-06-30 21:56:11.737282 (Thread-1): finished collecting timing info
2020-06-30 21:56:11.737911 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b48c5b9a-b836-4733-b620-38f624a6b583', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7c51d0>]}
2020-06-30 21:56:11.738967 (Thread-1): 16:56:11 | 2 of 4 OK created table model TEST.order_statistics.................. [SUCCESS 1 in 5.05s]
2020-06-30 21:56:11.739100 (Thread-1): Finished running node model.sample_project.order_statistics
2020-06-30 21:56:11.739234 (Thread-1): Began running node model.sample_project.sales_report_one
2020-06-30 21:56:11.740189 (Thread-1): 16:56:11 | 3 of 4 START table model TEST.sales_report_one....................... [RUN]
2020-06-30 21:56:11.740510 (Thread-1): Acquiring new snowflake connection "model.sample_project.sales_report_one".
2020-06-30 21:56:11.740610 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.order_statistics).
2020-06-30 21:56:11.740703 (Thread-1): Compiling model.sample_project.sales_report_one
2020-06-30 21:56:11.753823 (Thread-1): Writing injected SQL for node "model.sample_project.sales_report_one"
2020-06-30 21:56:11.754845 (Thread-1): finished collecting timing info
2020-06-30 21:56:11.759182 (Thread-1): Writing runtime SQL for node "model.sample_project.sales_report_one"
2020-06-30 21:56:11.762776 (Thread-1): Using snowflake connection "model.sample_project.sales_report_one".
2020-06-30 21:56:11.762873 (Thread-1): On model.sample_project.sales_report_one: BEGIN
2020-06-30 21:56:11.946121 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2020-06-30 21:56:11.946272 (Thread-1): Using snowflake connection "model.sample_project.sales_report_one".
2020-06-30 21:56:11.946370 (Thread-1): On model.sample_project.sales_report_one: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "model.sample_project.sales_report_one"} */


      create or replace transient table JAVEN_TESTING.TEST.sales_report_one  as
      (with __dbt__CTE__customer as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  c_custkey as custkey,
        c_nationkey as nationkey,
        c_name as name
from snowflake_sample_data.tpch_sf1.customer
),  __dbt__CTE__nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  n_nationkey as nationkey,
        n_name as name
from snowflake_sample_data.tpch_sf1.nation
),  __dbt__CTE__customer_nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  c.custkey,
        c.nationkey,
        c.name as customer_name,
        n.name as nation_name
from __dbt__CTE__customer as c
JOIN __dbt__CTE__nation as n
ON c.nationkey=n.nationkey
),  __dbt__CTE__orders as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  o_orderkey as orderkey,
        o_custkey as custkey,
        o_totalprice as totalprice,
        o_orderdate as orderdate
from snowflake_sample_data.tpch_sf1.orders
),  __dbt__CTE__lineitem as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  l_orderkey as orderkey,
        l_extendedprice as extendedprice,
        l_discount as discount,
        l_tax as tax,
        l_quantity as quantity
from snowflake_sample_data.tpch_sf1.lineitem
),  __dbt__CTE__orders_lineitem as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  o.orderkey,
        o.custkey,
        o.totalprice,
        o.orderdate,
        l.extendedprice,
        l.discount,
        l.tax,
        l.quantity
from __dbt__CTE__orders as o
JOIN __dbt__CTE__lineitem as l
ON o.orderkey=l.orderkey
),  __dbt__CTE__cust_list_ord_nat as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  cn.custkey,
        cn.nationkey,
        cn.customer_name,
        cn.nation_name,
        ol.orderkey,
        ol.totalprice,
        ol.orderdate,
        ol.extendedprice,
        ol.discount,
        ol.tax,
        ol.quantity
from __dbt__CTE__customer_nation as cn
JOIN __dbt__CTE__orders_lineitem as ol
ON cn.custkey=ol.custkey
)/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  

extendedprice * (1.0 - discount)

 as discounted_price_pre_tax,
        



extendedprice * (1.0 - discount)

 * (1.0 + tax)

 as discounted_price,
        



extendedprice * (1.0 - discount)

 * tax

 as tax_charged,
        *
from __dbt__CTE__cust_list_ord_nat
      );
2020-06-30 21:56:17.767059 (Thread-1): SQL status: SUCCESS 1 in 5.82 seconds
2020-06-30 21:56:17.767994 (Thread-1): On model.sample_project.sales_report_one: COMMIT
2020-06-30 21:56:17.768141 (Thread-1): Using snowflake connection "model.sample_project.sales_report_one".
2020-06-30 21:56:17.768233 (Thread-1): On model.sample_project.sales_report_one: COMMIT
2020-06-30 21:56:18.031538 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2020-06-30 21:56:18.033672 (Thread-1): finished collecting timing info
2020-06-30 21:56:18.034308 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b48c5b9a-b836-4733-b620-38f624a6b583', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c512090>]}
2020-06-30 21:56:18.035386 (Thread-1): 16:56:18 | 3 of 4 OK created table model TEST.sales_report_one.................. [SUCCESS 1 in 6.29s]
2020-06-30 21:56:18.035521 (Thread-1): Finished running node model.sample_project.sales_report_one
2020-06-30 21:56:18.035656 (Thread-1): Began running node model.sample_project.sales_report_two
2020-06-30 21:56:18.036700 (Thread-1): 16:56:18 | 4 of 4 START table model TEST.sales_report_two....................... [RUN]
2020-06-30 21:56:18.036974 (Thread-1): Acquiring new snowflake connection "model.sample_project.sales_report_two".
2020-06-30 21:56:18.037063 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.sales_report_one).
2020-06-30 21:56:18.037154 (Thread-1): Compiling model.sample_project.sales_report_two
2020-06-30 21:56:18.049189 (Thread-1): Writing injected SQL for node "model.sample_project.sales_report_two"
2020-06-30 21:56:18.050399 (Thread-1): finished collecting timing info
2020-06-30 21:56:18.055666 (Thread-1): Writing runtime SQL for node "model.sample_project.sales_report_two"
2020-06-30 21:56:18.059023 (Thread-1): Using snowflake connection "model.sample_project.sales_report_two".
2020-06-30 21:56:18.059110 (Thread-1): On model.sample_project.sales_report_two: BEGIN
2020-06-30 21:56:18.255071 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2020-06-30 21:56:18.255226 (Thread-1): Using snowflake connection "model.sample_project.sales_report_two".
2020-06-30 21:56:18.255321 (Thread-1): On model.sample_project.sales_report_two: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "model.sample_project.sales_report_two"} */


      create or replace transient table JAVEN_TESTING.TEST.sales_report_two  as
      (with __dbt__CTE__customer as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  c_custkey as custkey,
        c_nationkey as nationkey,
        c_name as name
from snowflake_sample_data.tpch_sf1.customer
),  __dbt__CTE__nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  n_nationkey as nationkey,
        n_name as name
from snowflake_sample_data.tpch_sf1.nation
),  __dbt__CTE__customer_nation as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  c.custkey,
        c.nationkey,
        c.name as customer_name,
        n.name as nation_name
from __dbt__CTE__customer as c
JOIN __dbt__CTE__nation as n
ON c.nationkey=n.nationkey
),  __dbt__CTE__orders as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  o_orderkey as orderkey,
        o_custkey as custkey,
        o_totalprice as totalprice,
        o_orderdate as orderdate
from snowflake_sample_data.tpch_sf1.orders
),  __dbt__CTE__lineitem as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/


select  l_orderkey as orderkey,
        l_extendedprice as extendedprice,
        l_discount as discount,
        l_tax as tax,
        l_quantity as quantity
from snowflake_sample_data.tpch_sf1.lineitem
),  __dbt__CTE__orders_lineitem as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  o.orderkey,
        o.custkey,
        o.totalprice,
        o.orderdate,
        l.extendedprice,
        l.discount,
        l.tax,
        l.quantity
from __dbt__CTE__orders as o
JOIN __dbt__CTE__lineitem as l
ON o.orderkey=l.orderkey
),  __dbt__CTE__cust_list_ord_nat as (
/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  cn.custkey,
        cn.nationkey,
        cn.customer_name,
        cn.nation_name,
        ol.orderkey,
        ol.totalprice,
        ol.orderdate,
        ol.extendedprice,
        ol.discount,
        ol.tax,
        ol.quantity
from __dbt__CTE__customer_nation as cn
JOIN __dbt__CTE__orders_lineitem as ol
ON cn.custkey=ol.custkey
)/*
Copyright  2020 Hashmap, Inc

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

select  listagg(discount, '|~~|') as discounts,
        avg(



extendedprice * (1.0 - discount)

 * tax

) as average_tax,
        orderkey,
        custkey
from __dbt__CTE__cust_list_ord_nat
group by orderkey, custkey
      );
2020-06-30 21:56:21.549241 (Thread-1): SQL status: SUCCESS 1 in 3.29 seconds
2020-06-30 21:56:21.550089 (Thread-1): On model.sample_project.sales_report_two: COMMIT
2020-06-30 21:56:21.550221 (Thread-1): Using snowflake connection "model.sample_project.sales_report_two".
2020-06-30 21:56:21.550301 (Thread-1): On model.sample_project.sales_report_two: COMMIT
2020-06-30 21:56:21.815276 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2020-06-30 21:56:21.817303 (Thread-1): finished collecting timing info
2020-06-30 21:56:21.817883 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b48c5b9a-b836-4733-b620-38f624a6b583', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5123d0>]}
2020-06-30 21:56:21.818852 (Thread-1): 16:56:21 | 4 of 4 OK created table model TEST.sales_report_two.................. [SUCCESS 1 in 3.78s]
2020-06-30 21:56:21.818972 (Thread-1): Finished running node model.sample_project.sales_report_two
2020-06-30 21:56:21.871285 (MainThread): Using snowflake connection "master".
2020-06-30 21:56:21.871420 (MainThread): On master: BEGIN
2020-06-30 21:56:22.222125 (MainThread): SQL status: SUCCESS 1 in 0.35 seconds
2020-06-30 21:56:22.222296 (MainThread): On master: COMMIT
2020-06-30 21:56:22.222432 (MainThread): Using snowflake connection "master".
2020-06-30 21:56:22.222520 (MainThread): On master: COMMIT
2020-06-30 21:56:22.716138 (MainThread): SQL status: SUCCESS 1 in 0.49 seconds
2020-06-30 21:56:22.716490 (MainThread): 16:56:22 | 
2020-06-30 21:56:22.716611 (MainThread): 16:56:22 | Finished running 1 view model, 3 table models in 28.28s.
2020-06-30 21:56:22.716704 (MainThread): Connection 'master' was left open.
2020-06-30 21:56:22.716780 (MainThread): On master: Close
2020-06-30 21:56:23.105070 (MainThread): Connection 'model.sample_project.sales_report_two' was left open.
2020-06-30 21:56:23.105203 (MainThread): On model.sample_project.sales_report_two: Close
2020-06-30 21:56:23.720203 (MainThread): 
2020-06-30 21:56:23.720347 (MainThread): Completed successfully
2020-06-30 21:56:23.720454 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-06-30 21:56:23.720599 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c79f790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4eaf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0f8210>]}
2020-06-30 21:56:23.720757 (MainThread): Flushing usage events
2020-06-30 21:56:24.991893 (MainThread): Running with dbt=0.17.0
2020-06-30 21:56:25.323463 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2020-06-30 21:56:25.324263 (MainThread): Tracking: tracking
2020-06-30 21:56:25.324506 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f4c290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058f48d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058f4390>]}
2020-06-30 21:56:25.355947 (MainThread): Partial parsing not enabled
2020-06-30 21:56:25.357804 (MainThread): Parsing macros/core.sql
2020-06-30 21:56:25.363411 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-30 21:56:25.372345 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-30 21:56:25.374719 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-30 21:56:25.394850 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-30 21:56:25.427162 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-30 21:56:25.450696 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-30 21:56:25.452999 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-30 21:56:25.463014 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-30 21:56:25.481547 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-30 21:56:25.489410 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-30 21:56:25.496882 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-30 21:56:25.502618 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-30 21:56:25.503741 (MainThread): Parsing macros/etc/query.sql
2020-06-30 21:56:25.504886 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-30 21:56:25.506667 (MainThread): Parsing macros/etc/datetime.sql
2020-06-30 21:56:25.517846 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-30 21:56:25.520182 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-30 21:56:25.521993 (MainThread): Parsing macros/adapters/common.sql
2020-06-30 21:56:25.577038 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-30 21:56:25.578352 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-30 21:56:25.579426 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-30 21:56:25.580587 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-30 21:56:25.583022 (MainThread): Parsing macros/catalog.sql
2020-06-30 21:56:25.585018 (MainThread): Parsing macros/adapters.sql
2020-06-30 21:56:25.609571 (MainThread): Parsing macros/materializations/merge.sql
2020-06-30 21:56:25.611948 (MainThread): Parsing macros/materializations/view.sql
2020-06-30 21:56:25.613267 (MainThread): Parsing macros/materializations/table.sql
2020-06-30 21:56:25.617525 (MainThread): Parsing macros/materializations/incremental.sql
2020-06-30 21:56:25.663465 (MainThread): Partial parsing not enabled
2020-06-30 21:56:25.663935 (MainThread): Parsing macros/discounted_price.sql
2020-06-30 21:56:25.664757 (MainThread): Parsing macros/tax_charged.sql
2020-06-30 21:56:25.666124 (MainThread): Parsing macros/full_charge.sql
2020-06-30 21:56:25.667400 (MainThread): Parsing macros/test_is_nonnegative.sql
2020-06-30 21:56:25.670764 (MainThread): Parsing macros/cross_db_utils/except.sql
2020-06-30 21:56:25.672139 (MainThread): Parsing macros/cross_db_utils/replace.sql
2020-06-30 21:56:25.674189 (MainThread): Parsing macros/cross_db_utils/concat.sql
2020-06-30 21:56:25.677361 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2020-06-30 21:56:25.684831 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2020-06-30 21:56:25.686137 (MainThread): Parsing macros/cross_db_utils/length.sql
2020-06-30 21:56:25.687975 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2020-06-30 21:56:25.690696 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2020-06-30 21:56:25.691748 (MainThread): Parsing macros/cross_db_utils/right.sql
2020-06-30 21:56:25.694281 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2020-06-30 21:56:25.705803 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2020-06-30 21:56:25.707898 (MainThread): Parsing macros/cross_db_utils/hash.sql
2020-06-30 21:56:25.709497 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2020-06-30 21:56:25.711192 (MainThread): Parsing macros/cross_db_utils/position.sql
2020-06-30 21:56:25.713194 (MainThread): Parsing macros/cross_db_utils/literal.sql
2020-06-30 21:56:25.714189 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2020-06-30 21:56:25.718050 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2020-06-30 21:56:25.723920 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2020-06-30 21:56:25.727307 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2020-06-30 21:56:25.729316 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2020-06-30 21:56:25.730947 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2020-06-30 21:56:25.759023 (MainThread): Parsing macros/logger/pretty_log_format.sql
2020-06-30 21:56:25.759843 (MainThread): Parsing macros/logger/pretty_time.sql
2020-06-30 21:56:25.760779 (MainThread): Parsing macros/logger/log_info.sql
2020-06-30 21:56:25.761549 (MainThread): Parsing macros/datetime/date_spine.sql
2020-06-30 21:56:25.765409 (MainThread): Parsing macros/web/get_url_host.sql
2020-06-30 21:56:25.767558 (MainThread): Parsing macros/web/get_url_path.sql
2020-06-30 21:56:25.770005 (MainThread): Parsing macros/web/get_url_parameter.sql
2020-06-30 21:56:25.771254 (MainThread): Parsing macros/geo/haversine_distance.sql
2020-06-30 21:56:25.772450 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2020-06-30 21:56:25.774712 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2020-06-30 21:56:25.777107 (MainThread): Parsing macros/schema_tests/recency.sql
2020-06-30 21:56:25.778493 (MainThread): Parsing macros/schema_tests/not_constant.sql
2020-06-30 21:56:25.779721 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2020-06-30 21:56:25.780960 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2020-06-30 21:56:25.782384 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2020-06-30 21:56:25.784029 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2020-06-30 21:56:25.785230 (MainThread): Parsing macros/schema_tests/equality.sql
2020-06-30 21:56:25.789035 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2020-06-30 21:56:25.795583 (MainThread): Parsing macros/sql/nullcheck_table.sql
2020-06-30 21:56:25.796789 (MainThread): Parsing macros/sql/generate_series.sql
2020-06-30 21:56:25.800810 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2020-06-30 21:56:25.804982 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2020-06-30 21:56:25.808200 (MainThread): Parsing macros/sql/star.sql
2020-06-30 21:56:25.811292 (MainThread): Parsing macros/sql/unpivot.sql
2020-06-30 21:56:25.818028 (MainThread): Parsing macros/sql/union.sql
2020-06-30 21:56:25.828424 (MainThread): Parsing macros/sql/groupby.sql
2020-06-30 21:56:25.829434 (MainThread): Parsing macros/sql/surrogate_key.sql
2020-06-30 21:56:25.832326 (MainThread): Parsing macros/sql/safe_add.sql
2020-06-30 21:56:25.833459 (MainThread): Parsing macros/sql/nullcheck.sql
2020-06-30 21:56:25.834789 (MainThread): Parsing macros/sql/get_column_values.sql
2020-06-30 21:56:25.839306 (MainThread): Parsing macros/sql/pivot.sql
2020-06-30 21:56:25.842142 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2020-06-30 21:56:25.887034 (MainThread): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 21:56:25.887294 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:56:25.922963 (MainThread): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 21:56:25.923086 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:56:25.936722 (MainThread): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 21:56:25.936820 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:56:25.949102 (MainThread): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 21:56:25.949235 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:56:25.960962 (MainThread): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 21:56:25.961050 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:56:25.975882 (MainThread): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 21:56:25.975974 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:56:25.989523 (MainThread): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 21:56:25.989614 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:56:26.003455 (MainThread): Acquiring new snowflake connection "model.sample_project.customers_per_nation".
2020-06-30 21:56:26.003579 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:56:26.016438 (MainThread): Acquiring new snowflake connection "model.sample_project.sales_report_one".
2020-06-30 21:56:26.016529 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:56:26.032264 (MainThread): Acquiring new snowflake connection "model.sample_project.order_statistics".
2020-06-30 21:56:26.032356 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:56:26.047291 (MainThread): Acquiring new snowflake connection "model.sample_project.sales_report_two".
2020-06-30 21:56:26.047378 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:56:26.530698 (MainThread): Found 11 models, 8 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 4 sources
2020-06-30 21:56:26.532351 (MainThread): 
2020-06-30 21:56:26.532623 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 21:56:26.532709 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:56:26.556145 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 21:56:26.556333 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-06-30 21:56:26.569261 (ThreadPoolExecutor-1_0): Using snowflake connection "list_JAVEN_TESTING_TEST".
2020-06-30 21:56:26.569356 (ThreadPoolExecutor-1_0): On list_JAVEN_TESTING_TEST: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "connection_name": "list_JAVEN_TESTING_TEST"} */

    show terse objects in JAVEN_TESTING.TEST
2020-06-30 21:56:26.996774 (ThreadPoolExecutor-1_0): unclosed file <_io.BufferedReader name='/Users/johnaven/.local/share/virtualenvs/dbt-demo-June-2020-_KpdxRBe/lib/python3.7/site-packages/certifi/cacert.pem'>
2020-06-30 21:58:40.379293 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 11 in 133.81 seconds
2020-06-30 21:58:40.394033 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 21:58:40.394140 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:58:40.394360 (MainThread): 16:58:40 | Concurrency: 1 threads (target='dev')
2020-06-30 21:58:40.394481 (MainThread): 16:58:40 | 
2020-06-30 21:58:40.395251 (Thread-1): Began running node model.sample_project.customer
2020-06-30 21:58:40.395532 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer".
2020-06-30 21:58:40.395622 (Thread-1): Re-using an available connection from the pool (formerly list_JAVEN_TESTING_TEST).
2020-06-30 21:58:40.395713 (Thread-1): Compiling model.sample_project.customer
2020-06-30 21:58:40.418101 (Thread-1): Writing injected SQL for node "model.sample_project.customer"
2020-06-30 21:58:40.418475 (Thread-1): finished collecting timing info
2020-06-30 21:58:40.418892 (Thread-1): Finished running node model.sample_project.customer
2020-06-30 21:58:40.419022 (Thread-1): Began running node model.sample_project.lineitem
2020-06-30 21:58:40.419312 (Thread-1): Acquiring new snowflake connection "model.sample_project.lineitem".
2020-06-30 21:58:40.419403 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer).
2020-06-30 21:58:40.419485 (Thread-1): Compiling model.sample_project.lineitem
2020-06-30 21:58:40.426269 (Thread-1): Writing injected SQL for node "model.sample_project.lineitem"
2020-06-30 21:58:40.426590 (Thread-1): finished collecting timing info
2020-06-30 21:58:40.426935 (Thread-1): Finished running node model.sample_project.lineitem
2020-06-30 21:58:40.427057 (Thread-1): Began running node model.sample_project.nation
2020-06-30 21:58:40.427355 (Thread-1): Acquiring new snowflake connection "model.sample_project.nation".
2020-06-30 21:58:40.427453 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.lineitem).
2020-06-30 21:58:40.427535 (Thread-1): Compiling model.sample_project.nation
2020-06-30 21:58:40.434341 (Thread-1): Writing injected SQL for node "model.sample_project.nation"
2020-06-30 21:58:40.434618 (Thread-1): finished collecting timing info
2020-06-30 21:58:40.434952 (Thread-1): Finished running node model.sample_project.nation
2020-06-30 21:58:40.435072 (Thread-1): Began running node model.sample_project.orders
2020-06-30 21:58:40.435367 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders".
2020-06-30 21:58:40.435544 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.nation).
2020-06-30 21:58:40.435642 (Thread-1): Compiling model.sample_project.orders
2020-06-30 21:58:40.442190 (Thread-1): Writing injected SQL for node "model.sample_project.orders"
2020-06-30 21:58:40.442460 (Thread-1): finished collecting timing info
2020-06-30 21:58:40.442795 (Thread-1): Finished running node model.sample_project.orders
2020-06-30 21:58:40.442915 (Thread-1): Began running node test.sample_project.source_is_nonnegative_tpch_customer_c_custkey
2020-06-30 21:58:40.443200 (Thread-1): 16:58:40 | 1 of 8 START test source_is_nonnegative_tpch_customer_c_custkey...... [RUN]
2020-06-30 21:58:40.443498 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_nonnegative_tpch_customer_c_custkey".
2020-06-30 21:58:40.443587 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders).
2020-06-30 21:58:40.443669 (Thread-1): Compiling test.sample_project.source_is_nonnegative_tpch_customer_c_custkey
2020-06-30 21:58:40.458229 (Thread-1): Writing injected SQL for node "test.sample_project.source_is_nonnegative_tpch_customer_c_custkey"
2020-06-30 21:58:40.458534 (Thread-1): finished collecting timing info
2020-06-30 21:58:40.459099 (Thread-1): Using snowflake connection "test.sample_project.source_is_nonnegative_tpch_customer_c_custkey".
2020-06-30 21:58:40.459187 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_customer_c_custkey: BEGIN
2020-06-30 21:58:40.635505 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2020-06-30 21:58:40.635658 (Thread-1): Using snowflake connection "test.sample_project.source_is_nonnegative_tpch_customer_c_custkey".
2020-06-30 21:58:40.635751 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_customer_c_custkey: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "test.sample_project.source_is_nonnegative_tpch_customer_c_custkey"} */


with validation as (

    select
        c_custkey as negative

    from snowflake_sample_data.tpch_sf1.customer

),

validation_errors as (

    select
        negative

    from validation
    -- if this is true, negative will have a non-zero count
    where negative < 0

)

select count(*)
from validation_errors
2020-06-30 21:58:40.900799 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2020-06-30 21:58:40.901193 (Thread-1): finished collecting timing info
2020-06-30 21:58:40.901500 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_customer_c_custkey: ROLLBACK
2020-06-30 21:58:40.901606 (Thread-1): initiating rollback
2020-06-30 21:58:41.123732 (Thread-1): 16:58:41 | 1 of 8 PASS source_is_nonnegative_tpch_customer_c_custkey............ [PASS in 0.68s]
2020-06-30 21:58:41.123913 (Thread-1): Finished running node test.sample_project.source_is_nonnegative_tpch_customer_c_custkey
2020-06-30 21:58:41.124057 (Thread-1): Began running node test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey
2020-06-30 21:58:41.124266 (Thread-1): 16:58:41 | 2 of 8 START test source_is_nonnegative_tpch_customer_c_nationkey.... [RUN]
2020-06-30 21:58:41.124517 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey".
2020-06-30 21:58:41.124608 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_nonnegative_tpch_customer_c_custkey).
2020-06-30 21:58:41.124702 (Thread-1): Compiling test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey
2020-06-30 21:58:41.134097 (Thread-1): Writing injected SQL for node "test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey"
2020-06-30 21:58:41.134490 (Thread-1): finished collecting timing info
2020-06-30 21:58:41.135096 (Thread-1): Using snowflake connection "test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey".
2020-06-30 21:58:41.135193 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey: BEGIN
2020-06-30 21:58:41.378455 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2020-06-30 21:58:41.378613 (Thread-1): Using snowflake connection "test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey".
2020-06-30 21:58:41.378719 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey"} */


with validation as (

    select
        c_nationkey as negative

    from snowflake_sample_data.tpch_sf1.customer

),

validation_errors as (

    select
        negative

    from validation
    -- if this is true, negative will have a non-zero count
    where negative < 0

)

select count(*)
from validation_errors
2020-06-30 21:58:41.650328 (Thread-1): SQL status: SUCCESS 1 in 0.27 seconds
2020-06-30 21:58:41.650664 (Thread-1): finished collecting timing info
2020-06-30 21:58:41.650971 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey: ROLLBACK
2020-06-30 21:58:41.651076 (Thread-1): initiating rollback
2020-06-30 21:58:41.886522 (Thread-1): 16:58:41 | 2 of 8 PASS source_is_nonnegative_tpch_customer_c_nationkey.......... [PASS in 0.76s]
2020-06-30 21:58:41.886698 (Thread-1): Finished running node test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey
2020-06-30 21:58:41.886838 (Thread-1): Began running node test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice
2020-06-30 21:58:41.886980 (Thread-1): 16:58:41 | 3 of 8 START test source_is_nonnegative_tpch_lineitem_l_extendedprice [RUN]
2020-06-30 21:58:41.887345 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice".
2020-06-30 21:58:41.887448 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_nonnegative_tpch_customer_c_nationkey).
2020-06-30 21:58:41.887545 (Thread-1): Compiling test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice
2020-06-30 21:58:41.897570 (Thread-1): Writing injected SQL for node "test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice"
2020-06-30 21:58:41.897917 (Thread-1): finished collecting timing info
2020-06-30 21:58:41.898552 (Thread-1): Using snowflake connection "test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice".
2020-06-30 21:58:41.898647 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice: BEGIN
2020-06-30 21:58:42.078084 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2020-06-30 21:58:42.078240 (Thread-1): Using snowflake connection "test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice".
2020-06-30 21:58:42.078332 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice"} */


with validation as (

    select
        l_extendedprice as negative

    from snowflake_sample_data.tpch_sf1.lineitem

),

validation_errors as (

    select
        negative

    from validation
    -- if this is true, negative will have a non-zero count
    where negative < 0

)

select count(*)
from validation_errors
2020-06-30 21:58:42.808349 (Thread-1): SQL status: SUCCESS 1 in 0.73 seconds
2020-06-30 21:58:42.808684 (Thread-1): finished collecting timing info
2020-06-30 21:58:42.808985 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice: ROLLBACK
2020-06-30 21:58:42.809089 (Thread-1): initiating rollback
2020-06-30 21:58:43.050183 (Thread-1): 16:58:43 | 3 of 8 PASS source_is_nonnegative_tpch_lineitem_l_extendedprice...... [PASS in 1.16s]
2020-06-30 21:58:43.050359 (Thread-1): Finished running node test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice
2020-06-30 21:58:43.050499 (Thread-1): Began running node test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey
2020-06-30 21:58:43.050700 (Thread-1): 16:58:43 | 4 of 8 START test source_is_nonnegative_tpch_nation_n_nationkey...... [RUN]
2020-06-30 21:58:43.050946 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey".
2020-06-30 21:58:43.051036 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_nonnegative_tpch_lineitem_l_extendedprice).
2020-06-30 21:58:43.051126 (Thread-1): Compiling test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey
2020-06-30 21:58:43.060148 (Thread-1): Writing injected SQL for node "test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey"
2020-06-30 21:58:43.060496 (Thread-1): finished collecting timing info
2020-06-30 21:58:43.061077 (Thread-1): Using snowflake connection "test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey".
2020-06-30 21:58:43.061167 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey: BEGIN
2020-06-30 21:58:43.253723 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2020-06-30 21:58:43.253896 (Thread-1): Using snowflake connection "test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey".
2020-06-30 21:58:43.254003 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey"} */


with validation as (

    select
        n_nationkey as negative

    from snowflake_sample_data.tpch_sf1.nation

),

validation_errors as (

    select
        negative

    from validation
    -- if this is true, negative will have a non-zero count
    where negative < 0

)

select count(*)
from validation_errors
2020-06-30 21:58:43.496314 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2020-06-30 21:58:43.496628 (Thread-1): finished collecting timing info
2020-06-30 21:58:43.496894 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey: ROLLBACK
2020-06-30 21:58:43.496984 (Thread-1): initiating rollback
2020-06-30 21:58:43.761020 (Thread-1): 16:58:43 | 4 of 8 PASS source_is_nonnegative_tpch_nation_n_nationkey............ [PASS in 0.71s]
2020-06-30 21:58:43.761227 (Thread-1): Finished running node test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey
2020-06-30 21:58:43.761473 (Thread-1): Began running node test.sample_project.source_is_nonnegative_tpch_orders_o_custkey
2020-06-30 21:58:43.761846 (Thread-1): 16:58:43 | 5 of 8 START test source_is_nonnegative_tpch_orders_o_custkey........ [RUN]
2020-06-30 21:58:43.762145 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_is_nonnegative_tpch_orders_o_custkey".
2020-06-30 21:58:43.762273 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_nonnegative_tpch_nation_n_nationkey).
2020-06-30 21:58:43.762350 (Thread-1): Compiling test.sample_project.source_is_nonnegative_tpch_orders_o_custkey
2020-06-30 21:58:43.771766 (Thread-1): Writing injected SQL for node "test.sample_project.source_is_nonnegative_tpch_orders_o_custkey"
2020-06-30 21:58:43.772076 (Thread-1): finished collecting timing info
2020-06-30 21:58:43.772720 (Thread-1): Using snowflake connection "test.sample_project.source_is_nonnegative_tpch_orders_o_custkey".
2020-06-30 21:58:43.772806 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_orders_o_custkey: BEGIN
2020-06-30 21:58:44.032797 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2020-06-30 21:58:44.033011 (Thread-1): Using snowflake connection "test.sample_project.source_is_nonnegative_tpch_orders_o_custkey".
2020-06-30 21:58:44.033090 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_orders_o_custkey: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "test.sample_project.source_is_nonnegative_tpch_orders_o_custkey"} */


with validation as (

    select
        o_custkey as negative

    from snowflake_sample_data.tpch_sf1.orders

),

validation_errors as (

    select
        negative

    from validation
    -- if this is true, negative will have a non-zero count
    where negative < 0

)

select count(*)
from validation_errors
2020-06-30 21:58:44.319030 (Thread-1): SQL status: SUCCESS 1 in 0.29 seconds
2020-06-30 21:58:44.319338 (Thread-1): finished collecting timing info
2020-06-30 21:58:44.319617 (Thread-1): On test.sample_project.source_is_nonnegative_tpch_orders_o_custkey: ROLLBACK
2020-06-30 21:58:44.319711 (Thread-1): initiating rollback
2020-06-30 21:58:44.738356 (Thread-1): 16:58:44 | 5 of 8 PASS source_is_nonnegative_tpch_orders_o_custkey.............. [PASS in 0.98s]
2020-06-30 21:58:44.738539 (Thread-1): Finished running node test.sample_project.source_is_nonnegative_tpch_orders_o_custkey
2020-06-30 21:58:44.738688 (Thread-1): Began running node test.sample_project.source_unique_tpch_customer_c_custkey
2020-06-30 21:58:44.738914 (Thread-1): 16:58:44 | 6 of 8 START test source_unique_tpch_customer_c_custkey.............. [RUN]
2020-06-30 21:58:44.739170 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_unique_tpch_customer_c_custkey".
2020-06-30 21:58:44.739262 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_is_nonnegative_tpch_orders_o_custkey).
2020-06-30 21:58:44.739358 (Thread-1): Compiling test.sample_project.source_unique_tpch_customer_c_custkey
2020-06-30 21:58:44.748477 (Thread-1): Writing injected SQL for node "test.sample_project.source_unique_tpch_customer_c_custkey"
2020-06-30 21:58:44.748820 (Thread-1): finished collecting timing info
2020-06-30 21:58:44.749354 (Thread-1): Using snowflake connection "test.sample_project.source_unique_tpch_customer_c_custkey".
2020-06-30 21:58:44.749443 (Thread-1): On test.sample_project.source_unique_tpch_customer_c_custkey: BEGIN
2020-06-30 21:58:45.303035 (Thread-1): SQL status: SUCCESS 1 in 0.55 seconds
2020-06-30 21:58:45.303243 (Thread-1): Using snowflake connection "test.sample_project.source_unique_tpch_customer_c_custkey".
2020-06-30 21:58:45.303378 (Thread-1): On test.sample_project.source_unique_tpch_customer_c_custkey: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "test.sample_project.source_unique_tpch_customer_c_custkey"} */




select count(*) as validation_errors
from (

    select
        c_custkey

    from snowflake_sample_data.tpch_sf1.customer
    where c_custkey is not null
    group by c_custkey
    having count(*) > 1

) validation_errors
2020-06-30 21:58:45.580396 (Thread-1): SQL status: SUCCESS 1 in 0.28 seconds
2020-06-30 21:58:45.580757 (Thread-1): finished collecting timing info
2020-06-30 21:58:45.580996 (Thread-1): On test.sample_project.source_unique_tpch_customer_c_custkey: ROLLBACK
2020-06-30 21:58:45.581173 (Thread-1): initiating rollback
2020-06-30 21:58:45.866017 (Thread-1): 16:58:45 | 6 of 8 PASS source_unique_tpch_customer_c_custkey.................... [PASS in 1.13s]
2020-06-30 21:58:45.866181 (Thread-1): Finished running node test.sample_project.source_unique_tpch_customer_c_custkey
2020-06-30 21:58:45.866446 (Thread-1): Began running node test.sample_project.source_unique_tpch_nation_n_nationkey
2020-06-30 21:58:45.866628 (Thread-1): 16:58:45 | 7 of 8 START test source_unique_tpch_nation_n_nationkey.............. [RUN]
2020-06-30 21:58:45.866842 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_unique_tpch_nation_n_nationkey".
2020-06-30 21:58:45.866919 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_unique_tpch_customer_c_custkey).
2020-06-30 21:58:45.866998 (Thread-1): Compiling test.sample_project.source_unique_tpch_nation_n_nationkey
2020-06-30 21:58:45.876783 (Thread-1): Writing injected SQL for node "test.sample_project.source_unique_tpch_nation_n_nationkey"
2020-06-30 21:58:45.877287 (Thread-1): finished collecting timing info
2020-06-30 21:58:45.878261 (Thread-1): Using snowflake connection "test.sample_project.source_unique_tpch_nation_n_nationkey".
2020-06-30 21:58:45.878526 (Thread-1): On test.sample_project.source_unique_tpch_nation_n_nationkey: BEGIN
2020-06-30 21:58:46.206750 (Thread-1): SQL status: SUCCESS 1 in 0.33 seconds
2020-06-30 21:58:46.206903 (Thread-1): Using snowflake connection "test.sample_project.source_unique_tpch_nation_n_nationkey".
2020-06-30 21:58:46.206999 (Thread-1): On test.sample_project.source_unique_tpch_nation_n_nationkey: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "test.sample_project.source_unique_tpch_nation_n_nationkey"} */




select count(*) as validation_errors
from (

    select
        n_nationkey

    from snowflake_sample_data.tpch_sf1.nation
    where n_nationkey is not null
    group by n_nationkey
    having count(*) > 1

) validation_errors
2020-06-30 21:58:46.486223 (Thread-1): SQL status: SUCCESS 1 in 0.28 seconds
2020-06-30 21:58:46.486524 (Thread-1): finished collecting timing info
2020-06-30 21:58:46.486789 (Thread-1): On test.sample_project.source_unique_tpch_nation_n_nationkey: ROLLBACK
2020-06-30 21:58:46.486879 (Thread-1): initiating rollback
2020-06-30 21:58:46.766831 (Thread-1): 16:58:46 | 7 of 8 PASS source_unique_tpch_nation_n_nationkey.................... [PASS in 0.90s]
2020-06-30 21:58:46.767029 (Thread-1): Finished running node test.sample_project.source_unique_tpch_nation_n_nationkey
2020-06-30 21:58:46.767193 (Thread-1): Began running node test.sample_project.source_unique_tpch_orders_o_orderkey
2020-06-30 21:58:46.767434 (Thread-1): 16:58:46 | 8 of 8 START test source_unique_tpch_orders_o_orderkey............... [RUN]
2020-06-30 21:58:46.767747 (Thread-1): Acquiring new snowflake connection "test.sample_project.source_unique_tpch_orders_o_orderkey".
2020-06-30 21:58:46.767855 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_unique_tpch_nation_n_nationkey).
2020-06-30 21:58:46.767962 (Thread-1): Compiling test.sample_project.source_unique_tpch_orders_o_orderkey
2020-06-30 21:58:46.777538 (Thread-1): Writing injected SQL for node "test.sample_project.source_unique_tpch_orders_o_orderkey"
2020-06-30 21:58:46.777902 (Thread-1): finished collecting timing info
2020-06-30 21:58:46.778486 (Thread-1): Using snowflake connection "test.sample_project.source_unique_tpch_orders_o_orderkey".
2020-06-30 21:58:46.778583 (Thread-1): On test.sample_project.source_unique_tpch_orders_o_orderkey: BEGIN
2020-06-30 21:58:46.981888 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2020-06-30 21:58:46.982040 (Thread-1): Using snowflake connection "test.sample_project.source_unique_tpch_orders_o_orderkey".
2020-06-30 21:58:46.982132 (Thread-1): On test.sample_project.source_unique_tpch_orders_o_orderkey: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "sf", "target_name": "dev", "node_id": "test.sample_project.source_unique_tpch_orders_o_orderkey"} */




select count(*) as validation_errors
from (

    select
        o_orderkey

    from snowflake_sample_data.tpch_sf1.orders
    where o_orderkey is not null
    group by o_orderkey
    having count(*) > 1

) validation_errors
2020-06-30 21:58:47.204722 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2020-06-30 21:58:47.205020 (Thread-1): finished collecting timing info
2020-06-30 21:58:47.205283 (Thread-1): On test.sample_project.source_unique_tpch_orders_o_orderkey: ROLLBACK
2020-06-30 21:58:47.205372 (Thread-1): initiating rollback
2020-06-30 21:58:47.581899 (Thread-1): 16:58:47 | 8 of 8 PASS source_unique_tpch_orders_o_orderkey..................... [PASS in 0.81s]
2020-06-30 21:58:47.582070 (Thread-1): Finished running node test.sample_project.source_unique_tpch_orders_o_orderkey
2020-06-30 21:58:47.582208 (Thread-1): Began running node model.sample_project.customer_nation
2020-06-30 21:58:47.582548 (Thread-1): Acquiring new snowflake connection "model.sample_project.customer_nation".
2020-06-30 21:58:47.582643 (Thread-1): Re-using an available connection from the pool (formerly test.sample_project.source_unique_tpch_orders_o_orderkey).
2020-06-30 21:58:47.582736 (Thread-1): Compiling model.sample_project.customer_nation
2020-06-30 21:58:47.594061 (Thread-1): Writing injected SQL for node "model.sample_project.customer_nation"
2020-06-30 21:58:47.594865 (Thread-1): finished collecting timing info
2020-06-30 21:58:47.595223 (Thread-1): Finished running node model.sample_project.customer_nation
2020-06-30 21:58:47.595344 (Thread-1): Began running node model.sample_project.orders_lineitem
2020-06-30 21:58:47.595636 (Thread-1): Acquiring new snowflake connection "model.sample_project.orders_lineitem".
2020-06-30 21:58:47.595719 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.customer_nation).
2020-06-30 21:58:47.595795 (Thread-1): Compiling model.sample_project.orders_lineitem
2020-06-30 21:58:47.611468 (Thread-1): Writing injected SQL for node "model.sample_project.orders_lineitem"
2020-06-30 21:58:47.612051 (Thread-1): finished collecting timing info
2020-06-30 21:58:47.612624 (Thread-1): Finished running node model.sample_project.orders_lineitem
2020-06-30 21:58:47.613286 (Thread-1): Began running node model.sample_project.cust_list_ord_nat
2020-06-30 21:58:47.613665 (Thread-1): Acquiring new snowflake connection "model.sample_project.cust_list_ord_nat".
2020-06-30 21:58:47.613783 (Thread-1): Re-using an available connection from the pool (formerly model.sample_project.orders_lineitem).
2020-06-30 21:58:47.613877 (Thread-1): Compiling model.sample_project.cust_list_ord_nat
2020-06-30 21:58:47.627380 (Thread-1): Writing injected SQL for node "model.sample_project.cust_list_ord_nat"
2020-06-30 21:58:47.627802 (Thread-1): finished collecting timing info
2020-06-30 21:58:47.628219 (Thread-1): Finished running node model.sample_project.cust_list_ord_nat
2020-06-30 21:58:47.649581 (MainThread): Acquiring new snowflake connection "master".
2020-06-30 21:58:47.649702 (MainThread): Opening a new connection, currently in state init
2020-06-30 21:58:47.649963 (MainThread): 16:58:47 | 
2020-06-30 21:58:47.650092 (MainThread): 16:58:47 | Finished running 8 tests in 141.12s.
2020-06-30 21:58:47.650198 (MainThread): Connection 'master' was properly closed.
2020-06-30 21:58:47.650278 (MainThread): Connection 'model.sample_project.cust_list_ord_nat' was left open.
2020-06-30 21:58:47.650359 (MainThread): On model.sample_project.cust_list_ord_nat: Close
2020-06-30 21:58:48.015553 (MainThread): 
2020-06-30 21:58:48.015698 (MainThread): Completed successfully
2020-06-30 21:58:48.015799 (MainThread): 
Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
2020-06-30 21:58:48.015941 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106553810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059a5b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106016190>]}
2020-06-30 21:58:48.016097 (MainThread): Flushing usage events
2020-07-01 13:20:20.868430 (MainThread): Running with dbt=0.17.0
2020-07-01 13:20:21.274652 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.clean.CleanTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/johnaven/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='clean', write_json=True)
2020-07-01 13:20:21.275744 (MainThread): Tracking: tracking
2020-07-01 13:20:21.276081 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a609ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a609390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a609b50>]}
2020-07-01 13:20:21.276441 (MainThread): Checking target/*
2020-07-01 13:20:21.285081 (MainThread):  Cleaned target/*
2020-07-01 13:20:21.285212 (MainThread): Checking dbt_modules/*
2020-07-01 13:20:21.309729 (MainThread):  Cleaned dbt_modules/*
2020-07-01 13:20:21.309907 (MainThread): Finished cleaning all paths.
2020-07-01 13:20:21.310069 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a609b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a609490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108644d10>]}
2020-07-01 13:20:21.310251 (MainThread): Flushing usage events
